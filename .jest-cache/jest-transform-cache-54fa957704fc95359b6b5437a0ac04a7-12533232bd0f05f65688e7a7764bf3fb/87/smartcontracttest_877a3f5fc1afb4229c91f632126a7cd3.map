{"version":3,"names":["request","require","express","createTestApp","app","use","json","post","req","res","contractCode","parameters","body","status","error","deployment","contractId","Date","now","address","Math","random","toString","substr","transactionHash","gasUsed","floor","timestamp","toISOString","contractAddress","method","params","execution","executionId","result","success","get","deployed","balance","methods","describe","beforeEach","it","response","send","name","expect","toBe","toHaveProperty","toMatch"],"sources":["smart-contract.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\n\r\nfunction createTestApp() {\r\n  const app = express();\r\n  app.use(express.json());\r\n\r\n  app.post('/api/blockchain/deploy-contract', (req, res) => {\r\n    const { contractCode, parameters } = req.body;\r\n\r\n    if (!contractCode) {\r\n      return res.status(400).json({ error: 'Contract code is required' });\r\n    }\r\n\r\n    const deployment = {\r\n      contractId: `contract_${Date.now()}`,\r\n      address: `0x${Math.random().toString(16).substr(2, 40)}`,\r\n      transactionHash: `0x${Math.random().toString(16).substr(2, 64)}`,\r\n      status: 'deployed',\r\n      gasUsed: Math.floor(Math.random() * 100000),\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    res.json(deployment);\r\n  });\r\n\r\n  app.post('/api/blockchain/execute-contract', (req, res) => {\r\n    const { contractAddress, method, params } = req.body;\r\n\r\n    if (!contractAddress || !method) {\r\n      return res.status(400).json({ error: 'Contract address and method are required' });\r\n    }\r\n\r\n    const execution = {\r\n      executionId: `exec_${Date.now()}`,\r\n      contractAddress,\r\n      method,\r\n      result: { success: true },\r\n      transactionHash: `0x${Math.random().toString(16).substr(2, 64)}`,\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    res.json(execution);\r\n  });\r\n\r\n  app.get('/api/blockchain/contract/:address', (req, res) => {\r\n    const { address } = req.params;\r\n\r\n    res.json({\r\n      address,\r\n      deployed: true,\r\n      balance: '0',\r\n      methods: ['transfer', 'approve', 'balanceOf']\r\n    });\r\n  });\r\n\r\n  return app;\r\n}\r\n\r\ndescribe('Azora Blockchain - Smart Contract Tests', () => {\r\n  let app;\r\n\r\n  beforeEach(() => {\r\n    app = createTestApp();\r\n  });\r\n\r\n  describe('POST /api/blockchain/deploy-contract', () => {\r\n    it('should deploy smart contract', async () => {\r\n      const response = await request(app)\r\n        .post('/api/blockchain/deploy-contract')\r\n        .send({\r\n          contractCode: 'pragma solidity ^0.8.0; contract Test {}',\r\n          parameters: { name: 'TestToken' }\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('contractId');\r\n      expect(response.body).toHaveProperty('address');\r\n      expect(response.body.address).toMatch(/^0x[a-f0-9]{40}$/);\r\n      expect(response.body.status).toBe('deployed');\r\n    });\r\n\r\n    it('should return error when contract code is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/blockchain/deploy-contract')\r\n        .send({ parameters: {} });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Contract code is required');\r\n    });\r\n\r\n    it('should include transaction hash', async () => {\r\n      const response = await request(app)\r\n        .post('/api/blockchain/deploy-contract')\r\n        .send({ contractCode: 'contract Test {}' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('transactionHash');\r\n      expect(response.body.transactionHash).toMatch(/^0x[a-f0-9]{64}$/);\r\n    });\r\n\r\n    it('should report gas used', async () => {\r\n      const response = await request(app)\r\n        .post('/api/blockchain/deploy-contract')\r\n        .send({ contractCode: 'contract Test {}' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('gasUsed');\r\n      expect(typeof response.body.gasUsed).toBe('number');\r\n    });\r\n  });\r\n\r\n  describe('POST /api/blockchain/execute-contract', () => {\r\n    it('should execute contract method', async () => {\r\n      const response = await request(app)\r\n        .post('/api/blockchain/execute-contract')\r\n        .send({\r\n          contractAddress: '0x1234567890123456789012345678901234567890',\r\n          method: 'transfer',\r\n          params: ['0xabcd', 100]\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('executionId');\r\n      expect(response.body.contractAddress).toBe('0x1234567890123456789012345678901234567890');\r\n      expect(response.body.method).toBe('transfer');\r\n    });\r\n\r\n    it('should return error when contract address is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/blockchain/execute-contract')\r\n        .send({ method: 'transfer' });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Contract address and method are required');\r\n    });\r\n\r\n    it('should return error when method is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/blockchain/execute-contract')\r\n        .send({ contractAddress: '0x1234' });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Contract address and method are required');\r\n    });\r\n\r\n    it('should include execution result', async () => {\r\n      const response = await request(app)\r\n        .post('/api/blockchain/execute-contract')\r\n        .send({\r\n          contractAddress: '0x1234',\r\n          method: 'balanceOf'\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('result');\r\n      expect(response.body.result).toHaveProperty('success');\r\n    });\r\n  });\r\n\r\n  describe('GET /api/blockchain/contract/:address', () => {\r\n    it('should retrieve contract information', async () => {\r\n      const address = '0x1234567890123456789012345678901234567890';\r\n      const response = await request(app)\r\n        .get(`/api/blockchain/contract/${address}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.address).toBe(address);\r\n      expect(response.body).toHaveProperty('deployed');\r\n      expect(response.body).toHaveProperty('methods');\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}