{"version":3,"names":["request","require","app","describe","it","response","get","expect","body","status","toBe","service","success","data","metrics","toBeDefined","timestamp","type","value","error","metricData","total","active","new","put","send","reportData","period","post","id","Array","isArray","reportId","beforeAll"],"sources":["analytics.test.js"],"sourcesContent":["const request = require('supertest');\nconst app = require('../index.js');\n\ndescribe('Analytics Dashboard Service', () => {\n  // Health check test\n  describe('GET /health', () => {\n    it('should return health status', async () => {\n      const response = await request(app)\n        .get('/health')\n        .expect(200);\n\n      expect(response.body.status).toBe('healthy');\n      expect(response.body.service).toBe('analytics-dashboard');\n    });\n  });\n\n  // Get all metrics test\n  describe('GET /api/metrics', () => {\n    it('should return all metrics', async () => {\n      const response = await request(app)\n        .get('/api/metrics')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.metrics).toBeDefined();\n      expect(response.body.data.timestamp).toBeDefined();\n    });\n  });\n\n  // Get specific metric test\n  describe('GET /api/metrics/:metricType', () => {\n    it('should return specific metric data', async () => {\n      const response = await request(app)\n        .get('/api/metrics/users')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.type).toBe('users');\n      expect(response.body.data.value).toBeDefined();\n    });\n\n    it('should return 404 for non-existent metric', async () => {\n      const response = await request(app)\n        .get('/api/metrics/non-existent')\n        .expect(404);\n\n      expect(response.body.error).toBe('Metric not found');\n    });\n  });\n\n  // Update metric test\n  describe('PUT /api/metrics/:metricType', () => {\n    it('should update a metric', async () => {\n      const metricData = {\n        value: {\n          total: 15000,\n          active: 10000,\n          new: 500\n        }\n      };\n\n      const response = await request(app)\n        .put('/api/metrics/users')\n        .send(metricData)\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.type).toBe('users');\n      expect(response.body.data.value.total).toBe(15000);\n    });\n\n    it('should return 400 for missing value', async () => {\n      const response = await request(app)\n        .put('/api/metrics/users')\n        .send({})\n        .expect(400);\n\n      expect(response.body.error).toBe('Value is required');\n    });\n  });\n\n  // Report generation test\n  describe('POST /api/reports', () => {\n    it('should generate a report', async () => {\n      const reportData = {\n        type: 'user-engagement',\n        period: 'monthly'\n      };\n\n      const response = await request(app)\n        .post('/api/reports')\n        .send(reportData)\n        .expect(201);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.type).toBe('user-engagement');\n      expect(response.body.data.period).toBe('monthly');\n      expect(response.body.data.id).toBeDefined();\n    });\n\n    it('should return 400 for missing type or period', async () => {\n      const reportData = {\n        type: 'user-engagement'\n      };\n\n      const response = await request(app)\n        .post('/api/reports')\n        .send(reportData)\n        .expect(400);\n\n      expect(response.body.error).toBe('Type and period are required');\n    });\n  });\n\n  // Get all reports test\n  describe('GET /api/reports', () => {\n    it('should return all reports', async () => {\n      const response = await request(app)\n        .get('/api/reports')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(Array.isArray(response.body.data)).toBe(true);\n    });\n  });\n\n  // Get specific report test\n  describe('GET /api/reports/:reportId', () => {\n    let reportId;\n\n    beforeAll(async () => {\n      // Create a report first\n      const reportData = {\n        type: 'revenue',\n        period: 'quarterly'\n      };\n\n      const response = await request(app)\n        .post('/api/reports')\n        .send(reportData);\n\n      reportId = response.body.data.id;\n    });\n\n    it('should return specific report', async () => {\n      const response = await request(app)\n        .get(`/api/reports/${reportId}`)\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.id).toBe(reportId);\n    });\n\n    it('should return 404 for non-existent report', async () => {\n      const response = await request(app)\n        .get('/api/reports/non-existent')\n        .expect(404);\n\n      expect(response.body.error).toBe('Report not found');\n    });\n  });\n\n  // Data visualization test\n  describe('GET /api/visualizations/:type', () => {\n    it('should generate a visualization', async () => {\n      const response = await request(app)\n        .get('/api/visualizations/bar-chart')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.type).toBe('bar-chart');\n      expect(Array.isArray(response.body.data.data)).toBe(true);\n      expect(response.body.data.id).toBeDefined();\n    });\n  });\n\n  // Get all visualizations test\n  describe('GET /api/visualizations', () => {\n    it('should return all visualizations', async () => {\n      const response = await request(app)\n        .get('/api/visualizations')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(Array.isArray(response.body.data)).toBe(true);\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}