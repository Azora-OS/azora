{"version":3,"names":["request","require","express","createTestApp","app","use","json","post","req","res","system","components","body","status","error","assessment","assessmentId","Date","now","vulnerabilities","riskScore","recommendations","timestamp","toISOString","get","params","summary","critical","high","medium","low","describe","beforeEach","it","response","send","expect","toBe","toHaveProperty","toEqual","Array","isArray"],"sources":["vulnerability-assessment.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\n\r\nfunction createTestApp() {\r\n  const app = express();\r\n  app.use(express.json());\r\n\r\n  app.post('/api/security/assess-vulnerability', (req, res) => {\r\n    const { system, components } = req.body;\r\n\r\n    if (!system) {\r\n      return res.status(400).json({ error: 'System identifier is required' });\r\n    }\r\n\r\n    const assessment = {\r\n      assessmentId: `vuln_${Date.now()}`,\r\n      system,\r\n      components: components || [],\r\n      vulnerabilities: [],\r\n      riskScore: 0,\r\n      recommendations: [],\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    res.json(assessment);\r\n  });\r\n\r\n  app.get('/api/security/vulnerability-report/:assessmentId', (req, res) => {\r\n    const { assessmentId } = req.params;\r\n\r\n    res.json({\r\n      assessmentId,\r\n      status: 'completed',\r\n      summary: {\r\n        critical: 0,\r\n        high: 0,\r\n        medium: 0,\r\n        low: 0\r\n      }\r\n    });\r\n  });\r\n\r\n  return app;\r\n}\r\n\r\ndescribe('Azora Aegis - Vulnerability Assessment Tests', () => {\r\n  let app;\r\n\r\n  beforeEach(() => {\r\n    app = createTestApp();\r\n  });\r\n\r\n  describe('POST /api/security/assess-vulnerability', () => {\r\n    it('should perform vulnerability assessment', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/assess-vulnerability')\r\n        .send({\r\n          system: 'payment-service',\r\n          components: ['api', 'database', 'cache']\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('assessmentId');\r\n      expect(response.body.system).toBe('payment-service');\r\n      expect(response.body.components).toEqual(['api', 'database', 'cache']);\r\n    });\r\n\r\n    it('should return error when system is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/assess-vulnerability')\r\n        .send({ components: ['api'] });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('System identifier is required');\r\n    });\r\n\r\n    it('should include risk score in assessment', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/assess-vulnerability')\r\n        .send({ system: 'auth-service' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('riskScore');\r\n      expect(typeof response.body.riskScore).toBe('number');\r\n    });\r\n\r\n    it('should provide recommendations', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/assess-vulnerability')\r\n        .send({ system: 'api-gateway' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('recommendations');\r\n      expect(Array.isArray(response.body.recommendations)).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/security/vulnerability-report/:assessmentId', () => {\r\n    it('should retrieve vulnerability report', async () => {\r\n      const assessmentId = 'vuln_123456';\r\n      const response = await request(app)\r\n        .get(`/api/security/vulnerability-report/${assessmentId}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.assessmentId).toBe(assessmentId);\r\n      expect(response.body).toHaveProperty('status');\r\n      expect(response.body).toHaveProperty('summary');\r\n    });\r\n\r\n    it('should include vulnerability severity summary', async () => {\r\n      const response = await request(app)\r\n        .get('/api/security/vulnerability-report/vuln_123');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.summary).toHaveProperty('critical');\r\n      expect(response.body.summary).toHaveProperty('high');\r\n      expect(response.body.summary).toHaveProperty('medium');\r\n      expect(response.body.summary).toHaveProperty('low');\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}