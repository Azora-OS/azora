{"version":3,"names":["_types","require","describe","it","metrics","RoutingTier","LOCAL_LLM","RAP_SYSTEM","EXTERNAL_LLM","totalRequests","Object","values","reduce","sum","count","expect","toBe","tierMetrics","successfulRequests","successRate","responseTimes","averageResponseTime","time","length","cacheMetrics","hits","misses","hitRate","costs","tier","cost","totalCost","c","toBeCloseTo","requests","averageCost","r","queries","complexity","QueryComplexity","SIMPLE","MODERATE","simpleCount","filter","q","id","responseTime","slowQueries","cacheHits","averageCostPerRequest","costSavings","hourlyRequests","hour","peakHour","max","h"],"sources":["analytics.test.ts"],"sourcesContent":["import { RoutingTier, QueryComplexity } from '../types';\r\n\r\ndescribe('AI Routing - Analytics', () => {\r\n  it('should track total requests per tier', () => {\r\n    const metrics = {\r\n      [RoutingTier.LOCAL_LLM]: 150,\r\n      [RoutingTier.RAP_SYSTEM]: 75,\r\n      [RoutingTier.EXTERNAL_LLM]: 25,\r\n    };\r\n\r\n    const totalRequests = Object.values(metrics).reduce((sum, count) => sum + count, 0);\r\n\r\n    expect(totalRequests).toBe(250);\r\n  });\r\n\r\n  it('should calculate success rate per tier', () => {\r\n    const tierMetrics = {\r\n      totalRequests: 100,\r\n      successfulRequests: 95,\r\n    };\r\n\r\n    const successRate = (tierMetrics.successfulRequests / tierMetrics.totalRequests) * 100;\r\n\r\n    expect(successRate).toBe(95);\r\n  });\r\n\r\n  it('should track average response time', () => {\r\n    const responseTimes = [100, 150, 120, 180, 110];\r\n    const averageResponseTime = responseTimes.reduce((sum, time) => sum + time, 0) / responseTimes.length;\r\n\r\n    expect(averageResponseTime).toBe(132);\r\n  });\r\n\r\n  it('should calculate cache hit rate', () => {\r\n    const cacheMetrics = { hits: 80, misses: 20 };\r\n    const hitRate = (cacheMetrics.hits / (cacheMetrics.hits + cacheMetrics.misses)) * 100;\r\n\r\n    expect(hitRate).toBe(80);\r\n  });\r\n\r\n  it('should track cost per tier', () => {\r\n    const costs = [\r\n      { tier: RoutingTier.LOCAL_LLM, cost: 0.001 },\r\n      { tier: RoutingTier.LOCAL_LLM, cost: 0.0015 },\r\n    ];\r\n\r\n    const totalCost = costs.reduce((sum, c) => sum + c.cost, 0);\r\n\r\n    expect(totalCost).toBeCloseTo(0.0025, 4);\r\n  });\r\n\r\n  it('should calculate average cost per request', () => {\r\n    const requests = [{ cost: 0.01 }, { cost: 0.02 }];\r\n    const averageCost = requests.reduce((sum, r) => sum + r.cost, 0) / requests.length;\r\n\r\n    expect(averageCost).toBe(0.015);\r\n  });\r\n\r\n  it('should track query complexity distribution', () => {\r\n    const queries = [\r\n      { complexity: QueryComplexity.SIMPLE },\r\n      { complexity: QueryComplexity.SIMPLE },\r\n      { complexity: QueryComplexity.MODERATE },\r\n    ];\r\n\r\n    const simpleCount = queries.filter(q => q.complexity === QueryComplexity.SIMPLE).length;\r\n\r\n    expect(simpleCount).toBe(2);\r\n  });\r\n\r\n  it('should identify slow queries', () => {\r\n    const queries = [\r\n      { id: 'q1', responseTime: 100 },\r\n      { id: 'q2', responseTime: 5000 },\r\n    ];\r\n\r\n    const slowQueries = queries.filter(q => q.responseTime > 1000);\r\n\r\n    expect(slowQueries.length).toBe(1);\r\n    expect(slowQueries[0].id).toBe('q2');\r\n  });\r\n\r\n  it('should calculate cost savings from caching', () => {\r\n    const cacheHits = 80;\r\n    const averageCostPerRequest = 0.01;\r\n    const costSavings = cacheHits * averageCostPerRequest;\r\n\r\n    expect(costSavings).toBe(0.8);\r\n  });\r\n\r\n  it('should identify peak usage hours', () => {\r\n    const hourlyRequests = [\r\n      { hour: 9, count: 50 },\r\n      { hour: 10, count: 100 },\r\n      { hour: 11, count: 75 },\r\n    ];\r\n\r\n    const peakHour = hourlyRequests.reduce((max, h) => h.count > max.count ? h : max);\r\n\r\n    expect(peakHour.hour).toBe(10);\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}