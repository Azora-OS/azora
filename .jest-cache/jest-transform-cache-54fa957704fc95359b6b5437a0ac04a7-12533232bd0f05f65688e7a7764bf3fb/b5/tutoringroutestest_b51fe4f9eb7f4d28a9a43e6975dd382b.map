{"version":3,"names":["_getJestObj","mock","_supertest","_interopRequireDefault","require","_express","_tutoring","_elaraIntegration","e","__esModule","default","jest","app","express","use","json","tutoringRoutes","describe","beforeEach","clearAllMocks","it","questionData","studentId","enrollmentId","courseId","moduleId","question","context","difficulty","mockResponse","id","answer","confidence","sources","timestamp","Date","tutoringService","askQuestion","mockResolvedValue","response","request","post","send","expect","status","toBe","body","success","data","mockRejectedValue","Error","mockHistory","totalQuestions","responses","averageConfidence","getTutoringHistory","get","toHaveLength","mockRecommendations","recommendations","topic","suggestedResources","estimatedTime","strugglingAreas","getRecommendations"],"sources":["tutoring.routes.test.ts"],"sourcesContent":["import request from 'supertest';\r\nimport express from 'express';\r\nimport tutoringRoutes from '../tutoring.routes';\r\nimport { tutoringService } from '../../integrations/elara-integration';\r\n\r\njest.mock('../../integrations/elara-integration');\r\n\r\nconst app = express();\r\napp.use(express.json());\r\napp.use('/api/v1/tutoring', tutoringRoutes);\r\n\r\ndescribe('Tutoring Routes', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('POST /api/v1/tutoring/ask', () => {\r\n    it('should ask a tutoring question and get an answer', async () => {\r\n      const questionData = {\r\n        studentId: 'student-1',\r\n        enrollmentId: 'enrollment-1',\r\n        courseId: 'course-1',\r\n        moduleId: 'module-1',\r\n        question: 'What is TypeScript?',\r\n        context: { difficulty: 'beginner' },\r\n      };\r\n\r\n      const mockResponse = {\r\n        id: 'tutoring-1',\r\n        studentId: 'student-1',\r\n        question: 'What is TypeScript?',\r\n        answer: 'TypeScript is a typed superset of JavaScript that compiles to plain JavaScript.',\r\n        confidence: 0.95,\r\n        sources: ['typescript-docs', 'course-module-1'],\r\n        timestamp: new Date(),\r\n      };\r\n\r\n      (tutoringService.askQuestion as jest.Mock).mockResolvedValue(mockResponse);\r\n\r\n      const response = await request(app)\r\n        .post('/api/v1/tutoring/ask')\r\n        .send(questionData);\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.answer).toBe(\r\n        'TypeScript is a typed superset of JavaScript that compiles to plain JavaScript.'\r\n      );\r\n      expect(response.body.data.confidence).toBe(0.95);\r\n    });\r\n\r\n    it('should handle validation errors', async () => {\r\n      (tutoringService.askQuestion as jest.Mock).mockRejectedValue(\r\n        new Error('Validation error: question is required')\r\n      );\r\n\r\n      const response = await request(app)\r\n        .post('/api/v1/tutoring/ask')\r\n        .send({\r\n          studentId: 'student-1',\r\n          enrollmentId: 'enrollment-1',\r\n          courseId: 'course-1',\r\n          moduleId: 'module-1',\r\n        });\r\n\r\n      expect(response.status).toBe(500);\r\n    });\r\n\r\n    it('should handle Elara service errors', async () => {\r\n      (tutoringService.askQuestion as jest.Mock).mockRejectedValue(\r\n        new Error('Failed to connect to Elara Orchestrator')\r\n      );\r\n\r\n      const response = await request(app)\r\n        .post('/api/v1/tutoring/ask')\r\n        .send({\r\n          studentId: 'student-1',\r\n          enrollmentId: 'enrollment-1',\r\n          courseId: 'course-1',\r\n          moduleId: 'module-1',\r\n          question: 'What is TypeScript?',\r\n        });\r\n\r\n      expect(response.status).toBe(500);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/v1/tutoring/history/:studentId', () => {\r\n    it('should get tutoring history for a student', async () => {\r\n      const mockHistory = {\r\n        studentId: 'student-1',\r\n        totalQuestions: 5,\r\n        responses: [\r\n          {\r\n            id: 'tutoring-1',\r\n            studentId: 'student-1',\r\n            question: 'What is TypeScript?',\r\n            answer: 'TypeScript is a typed superset of JavaScript.',\r\n            confidence: 0.95,\r\n            sources: ['typescript-docs'],\r\n            timestamp: new Date(),\r\n          },\r\n          {\r\n            id: 'tutoring-2',\r\n            studentId: 'student-1',\r\n            question: 'How do I use interfaces?',\r\n            answer: 'Interfaces define the structure of objects.',\r\n            confidence: 0.92,\r\n            sources: ['typescript-docs'],\r\n            timestamp: new Date(),\r\n          },\r\n        ],\r\n        averageConfidence: 0.935,\r\n      };\r\n\r\n      (tutoringService.getTutoringHistory as jest.Mock).mockResolvedValue(mockHistory);\r\n\r\n      const response = await request(app).get('/api/v1/tutoring/history/student-1');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.totalQuestions).toBe(5);\r\n      expect(response.body.data.responses).toHaveLength(2);\r\n      expect(response.body.data.averageConfidence).toBe(0.935);\r\n    });\r\n\r\n    it('should return empty history for new student', async () => {\r\n      const mockHistory = {\r\n        studentId: 'new-student',\r\n        totalQuestions: 0,\r\n        responses: [],\r\n        averageConfidence: 0,\r\n      };\r\n\r\n      (tutoringService.getTutoringHistory as jest.Mock).mockResolvedValue(mockHistory);\r\n\r\n      const response = await request(app).get('/api/v1/tutoring/history/new-student');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.totalQuestions).toBe(0);\r\n      expect(response.body.data.responses).toHaveLength(0);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/v1/tutoring/recommendations/:studentId/:enrollmentId', () => {\r\n    it('should get personalized tutoring recommendations', async () => {\r\n      const mockRecommendations = {\r\n        studentId: 'student-1',\r\n        enrollmentId: 'enrollment-1',\r\n        recommendations: [\r\n          {\r\n            topic: 'Interfaces',\r\n            difficulty: 'intermediate',\r\n            suggestedResources: ['interface-tutorial', 'interface-examples'],\r\n            estimatedTime: 30,\r\n          },\r\n          {\r\n            topic: 'Generics',\r\n            difficulty: 'advanced',\r\n            suggestedResources: ['generics-guide', 'generics-patterns'],\r\n            estimatedTime: 45,\r\n          },\r\n        ],\r\n        strugglingAreas: 2,\r\n        timestamp: new Date(),\r\n      };\r\n\r\n      (tutoringService.getRecommendations as jest.Mock).mockResolvedValue(\r\n        mockRecommendations\r\n      );\r\n\r\n      const response = await request(app).get(\r\n        '/api/v1/tutoring/recommendations/student-1/enrollment-1'\r\n      );\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.recommendations).toHaveLength(2);\r\n      expect(response.body.data.strugglingAreas).toBe(2);\r\n    });\r\n\r\n    it('should handle missing enrollment', async () => {\r\n      (tutoringService.getRecommendations as jest.Mock).mockRejectedValue(\r\n        new Error('Enrollment not found')\r\n      );\r\n\r\n      const response = await request(app).get(\r\n        '/api/v1/tutoring/recommendations/student-1/non-existent'\r\n      );\r\n\r\n      expect(response.status).toBe(500);\r\n    });\r\n\r\n    it('should return empty recommendations for student with no struggling areas', async () => {\r\n      const mockRecommendations = {\r\n        studentId: 'student-2',\r\n        enrollmentId: 'enrollment-2',\r\n        recommendations: [],\r\n        strugglingAreas: 0,\r\n        timestamp: new Date(),\r\n      };\r\n\r\n      (tutoringService.getRecommendations as jest.Mock).mockResolvedValue(\r\n        mockRecommendations\r\n      );\r\n\r\n      const response = await request(app).get(\r\n        '/api/v1/tutoring/recommendations/student-2/enrollment-2'\r\n      );\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.recommendations).toHaveLength(0);\r\n      expect(response.body.data.strugglingAreas).toBe(0);\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}