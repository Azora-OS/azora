{"version":3,"names":["cov_1zxgfqbxas","actualCoverage","crypto","s","require","v4","uuidv4","createLogger","TamperProofDataService","constructor","f","logger","dataStore","Map","auditTrail","storeData","userId","dataType","data","metadata","b","dataId","dataHash","createHash","signature","createSignature","entry","id","createdAt","Date","updatedAt","set","addToAuditTrail","info","error","retrieveData","get","Error","isValid","verifyDataIntegrity","updateData","newData","newDataHash","newSignature","deleteData","delete","success","message","currentHash","isValidSignature","verifySignature","dataString","JSON","stringify","update","digest","secret","process","env","SIGNATURE_SECRET","signatureData","createHmac","expectedSignature","timingSafeEqual","Buffer","from","action","auditEntry","timestamp","push","getAuditTrail","filter","listUserData","userEntries","entries","verifyAllUserData","results","module","exports"],"sources":["index.js"],"sourcesContent":["const crypto = require('crypto');\nconst { v4: uuidv4 } = require('uuid');\nconst { createLogger } = require('@azora/shared-services/logging');\n\nclass TamperProofDataService {\n  constructor() {\n    this.logger = createLogger('TamperProofDataService');\n    this.dataStore = new Map(); // In production, this would be a database\n    this.auditTrail = [];\n  }\n\n  /**\n   * Store data with tamper-proof signature\n   */\n  storeData(userId, dataType, data, metadata = {}) {\n    try {\n      // Generate unique ID for this data entry\n      const dataId = uuidv4();\n\n      // Create hash of the data\n      const dataHash = this.createHash(data);\n\n      // Create digital signature\n      const signature = this.createSignature(dataHash, userId);\n\n      // Create tamper-proof entry\n      const entry = {\n        id: dataId,\n        userId,\n        dataType,\n        data,\n        dataHash,\n        signature,\n        metadata,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      };\n\n      // Store in data store\n      this.dataStore.set(dataId, entry);\n\n      // Add to audit trail\n      this.addToAuditTrail('CREATE', dataId, userId, dataType);\n\n      this.logger.info(`Data stored with ID: ${dataId}`, { userId, dataType });\n\n      return {\n        id: dataId,\n        dataHash,\n        signature,\n        createdAt: entry.createdAt\n      };\n    } catch (error) {\n      this.logger.error('Error storing data', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Retrieve data and verify its integrity\n   */\n  retrieveData(dataId, userId) {\n    try {\n      const entry = this.dataStore.get(dataId);\n\n      if (!entry) {\n        throw new Error('Data not found');\n      }\n\n      // Verify user has access\n      if (entry.userId !== userId) {\n        throw new Error('Unauthorized access');\n      }\n\n      // Verify data integrity\n      const isValid = this.verifyDataIntegrity(entry);\n\n      // Add to audit trail\n      this.addToAuditTrail('READ', dataId, userId, entry.dataType);\n\n      this.logger.info(`Data retrieved with ID: ${dataId}`, { userId, isValid });\n\n      return {\n        id: entry.id,\n        data: entry.data,\n        dataType: entry.dataType,\n        metadata: entry.metadata,\n        isValid,\n        createdAt: entry.createdAt,\n        updatedAt: entry.updatedAt\n      };\n    } catch (error) {\n      this.logger.error('Error retrieving data', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update data with new signature\n   */\n  updateData(dataId, userId, newData, metadata = {}) {\n    try {\n      const entry = this.dataStore.get(dataId);\n\n      if (!entry) {\n        throw new Error('Data not found');\n      }\n\n      // Verify user has access\n      if (entry.userId !== userId) {\n        throw new Error('Unauthorized access');\n      }\n\n      // Verify current data integrity before update\n      if (!this.verifyDataIntegrity(entry)) {\n        throw new Error('Data has been tampered with');\n      }\n\n      // Create new hash and signature\n      const newDataHash = this.createHash(newData);\n      const newSignature = this.createSignature(newDataHash, userId);\n\n      // Update entry\n      entry.data = newData;\n      entry.dataHash = newDataHash;\n      entry.signature = newSignature;\n      entry.metadata = { ...entry.metadata, ...metadata };\n      entry.updatedAt = new Date();\n\n      // Store updated entry\n      this.dataStore.set(dataId, entry);\n\n      // Add to audit trail\n      this.addToAuditTrail('UPDATE', dataId, userId, entry.dataType);\n\n      this.logger.info(`Data updated with ID: ${dataId}`, { userId, dataType: entry.dataType });\n\n      return {\n        id: dataId,\n        dataHash: newDataHash,\n        signature: newSignature,\n        updatedAt: entry.updatedAt\n      };\n    } catch (error) {\n      this.logger.error('Error updating data', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Delete data\n   */\n  deleteData(dataId, userId) {\n    try {\n      const entry = this.dataStore.get(dataId);\n\n      if (!entry) {\n        throw new Error('Data not found');\n      }\n\n      // Verify user has access\n      if (entry.userId !== userId) {\n        throw new Error('Unauthorized access');\n      }\n\n      // Remove from data store\n      this.dataStore.delete(dataId);\n\n      // Add to audit trail\n      this.addToAuditTrail('DELETE', dataId, userId, entry.dataType);\n\n      this.logger.info(`Data deleted with ID: ${dataId}`, { userId, dataType: entry.dataType });\n\n      return {\n        success: true,\n        message: 'Data deleted successfully'\n      };\n    } catch (error) {\n      this.logger.error('Error deleting data', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Verify data integrity\n   */\n  verifyDataIntegrity(entry) {\n    try {\n      // Recreate hash of the data\n      const currentHash = this.createHash(entry.data);\n\n      // Verify hash matches\n      if (currentHash !== entry.dataHash) {\n        return false;\n      }\n\n      // Verify signature\n      const isValidSignature = this.verifySignature(entry.dataHash, entry.signature, entry.userId);\n\n      return isValidSignature;\n    } catch (error) {\n      this.logger.error('Error verifying data integrity', error);\n      return false;\n    }\n  }\n\n  /**\n   * Create hash of data\n   */\n  createHash(data) {\n    const dataString = typeof data === 'string' ? data : JSON.stringify(data);\n    return crypto.createHash('sha256').update(dataString).digest('hex');\n  }\n\n  /**\n   * Create digital signature\n   */\n  createSignature(dataHash, userId) {\n    // In production, this would use proper cryptographic keys\n    // For demo purposes, we'll use a simple approach\n    const secret = process.env.SIGNATURE_SECRET || 'azora-tamper-proof-secret';\n    const signatureData = `${dataHash}:${userId}:${secret}`;\n    return crypto.createHmac('sha256', secret).update(signatureData).digest('hex');\n  }\n\n  /**\n   * Verify digital signature\n   */\n  verifySignature(dataHash, signature, userId) {\n    try {\n      const expectedSignature = this.createSignature(dataHash, userId);\n      return crypto.timingSafeEqual(\n        Buffer.from(signature, 'hex'),\n        Buffer.from(expectedSignature, 'hex')\n      );\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Add entry to audit trail\n   */\n  addToAuditTrail(action, dataId, userId, dataType) {\n    const auditEntry = {\n      id: uuidv4(),\n      action,\n      dataId,\n      userId,\n      dataType,\n      timestamp: new Date()\n    };\n\n    this.auditTrail.push(auditEntry);\n  }\n\n  /**\n   * Get audit trail for a specific data entry\n   */\n  getAuditTrail(dataId) {\n    return this.auditTrail.filter(entry => entry.dataId === dataId);\n  }\n\n  /**\n   * List all data entries for a user\n   */\n  listUserData(userId) {\n    const userEntries = [];\n\n    for (const [id, entry] of this.dataStore.entries()) {\n      if (entry.userId === userId) {\n        userEntries.push({\n          id: entry.id,\n          dataType: entry.dataType,\n          dataHash: entry.dataHash,\n          createdAt: entry.createdAt,\n          updatedAt: entry.updatedAt\n        });\n      }\n    }\n\n    return userEntries;\n  }\n\n  /**\n   * Verify all data for a user\n   */\n  verifyAllUserData(userId) {\n    const results = [];\n\n    for (const [id, entry] of this.dataStore.entries()) {\n      if (entry.userId === userId) {\n        const isValid = this.verifyDataIntegrity(entry);\n        results.push({\n          id: entry.id,\n          dataType: entry.dataType,\n          isValid,\n          createdAt: entry.createdAt\n        });\n      }\n    }\n\n    return results;\n  }\n}\n\nmodule.exports = new TamperProofDataService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}