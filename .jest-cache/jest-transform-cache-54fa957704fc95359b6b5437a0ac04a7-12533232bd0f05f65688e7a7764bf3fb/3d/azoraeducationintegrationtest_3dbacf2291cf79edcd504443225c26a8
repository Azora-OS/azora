ecec13efcf5846c1c68d14f3e34a7c62
"use strict";

const request = require('supertest');
const app = require('../server');
describe('azora-education Integration Tests', () => {
  beforeAll(async () => {
    // Setup test database
  });
  afterAll(async () => {
    // Cleanup test database
  });
  describe('API Integration', () => {
    it('should handle concurrent requests', async () => {
      const promises = Array(10).fill().map(() => request(app).get('/health'));
      const responses = await Promise.all(promises);
      responses.forEach(res => {
        expect(res.status).toBe(200);
      });
    });
    it('should handle malformed requests gracefully', async () => {
      const res = await request(app).post('/api/test').send('invalid json').expect(400);
    });
    it('should enforce rate limiting', async () => {
      const promises = Array(200).fill().map(() => request(app).get('/health'));
      const responses = await Promise.all(promises);
      const rateLimited = responses.some(r => r.status === 429);
      expect(rateLimited).toBe(true);
    });
  });
  describe('Security Tests', () => {
    it('should have security headers', async () => {
      const res = await request(app).get('/health');
      expect(res.headers['x-content-type-options']).toBe('nosniff');
      expect(res.headers['x-frame-options']).toBe('DENY');
    });
    it('should sanitize XSS attempts', async () => {
      const malicious = '<script>alert("xss")</script>';
      const res = await request(app).post('/api/test').send({
        data: malicious
      });
      expect(JSON.stringify(res.body)).not.toContain('<script>');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1ZXN0IiwicmVxdWlyZSIsImFwcCIsImRlc2NyaWJlIiwiYmVmb3JlQWxsIiwiYWZ0ZXJBbGwiLCJpdCIsInByb21pc2VzIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiZ2V0IiwicmVzcG9uc2VzIiwiUHJvbWlzZSIsImFsbCIsImZvckVhY2giLCJyZXMiLCJleHBlY3QiLCJzdGF0dXMiLCJ0b0JlIiwicG9zdCIsInNlbmQiLCJyYXRlTGltaXRlZCIsInNvbWUiLCJyIiwiaGVhZGVycyIsIm1hbGljaW91cyIsImRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwiYm9keSIsIm5vdCIsInRvQ29udGFpbiJdLCJzb3VyY2VzIjpbImF6b3JhLWVkdWNhdGlvbi5pbnRlZ3JhdGlvbi50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHJlcXVlc3QgPSByZXF1aXJlKCdzdXBlcnRlc3QnKTtcbmNvbnN0IGFwcCA9IHJlcXVpcmUoJy4uL3NlcnZlcicpO1xuXG5kZXNjcmliZSgnYXpvcmEtZWR1Y2F0aW9uIEludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIC8vIFNldHVwIHRlc3QgZGF0YWJhc2VcbiAgfSk7XG5cbiAgYWZ0ZXJBbGwoYXN5bmMgKCkgPT4ge1xuICAgIC8vIENsZWFudXAgdGVzdCBkYXRhYmFzZVxuICB9KTtcblxuICBkZXNjcmliZSgnQVBJIEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9taXNlcyA9IEFycmF5KDEwKS5maWxsKCkubWFwKCgpID0+IFxuICAgICAgICByZXF1ZXN0KGFwcCkuZ2V0KCcvaGVhbHRoJylcbiAgICAgICk7XG4gICAgICBjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgICByZXNwb25zZXMuZm9yRWFjaChyZXMgPT4ge1xuICAgICAgICBleHBlY3QocmVzLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtYWxmb3JtZWQgcmVxdWVzdHMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAucG9zdCgnL2FwaS90ZXN0JylcbiAgICAgICAgLnNlbmQoJ2ludmFsaWQganNvbicpXG4gICAgICAgIC5leHBlY3QoNDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW5mb3JjZSByYXRlIGxpbWl0aW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvbWlzZXMgPSBBcnJheSgyMDApLmZpbGwoKS5tYXAoKCkgPT4gXG4gICAgICAgIHJlcXVlc3QoYXBwKS5nZXQoJy9oZWFsdGgnKVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgICAgIGNvbnN0IHJhdGVMaW1pdGVkID0gcmVzcG9uc2VzLnNvbWUociA9PiByLnN0YXR1cyA9PT0gNDI5KTtcbiAgICAgIGV4cGVjdChyYXRlTGltaXRlZCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlY3VyaXR5IFRlc3RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBzZWN1cml0eSBoZWFkZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdChhcHApLmdldCgnL2hlYWx0aCcpO1xuICAgICAgZXhwZWN0KHJlcy5oZWFkZXJzWyd4LWNvbnRlbnQtdHlwZS1vcHRpb25zJ10pLnRvQmUoJ25vc25pZmYnKTtcbiAgICAgIGV4cGVjdChyZXMuaGVhZGVyc1sneC1mcmFtZS1vcHRpb25zJ10pLnRvQmUoJ0RFTlknKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2FuaXRpemUgWFNTIGF0dGVtcHRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWFsaWNpb3VzID0gJzxzY3JpcHQ+YWxlcnQoXCJ4c3NcIik8L3NjcmlwdD4nO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL3Rlc3QnKVxuICAgICAgICAuc2VuZCh7IGRhdGE6IG1hbGljaW91cyB9KTtcbiAgICAgIGV4cGVjdChKU09OLnN0cmluZ2lmeShyZXMuYm9keSkpLm5vdC50b0NvbnRhaW4oJzxzY3JpcHQ+Jyk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUNwQyxNQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxXQUFXLENBQUM7QUFFaENFLFFBQVEsQ0FBQyxtQ0FBbUMsRUFBRSxNQUFNO0VBQ2xEQyxTQUFTLENBQUMsWUFBWTtJQUNwQjtFQUFBLENBQ0QsQ0FBQztFQUVGQyxRQUFRLENBQUMsWUFBWTtJQUNuQjtFQUFBLENBQ0QsQ0FBQztFQUVGRixRQUFRLENBQUMsaUJBQWlCLEVBQUUsTUFBTTtJQUNoQ0csRUFBRSxDQUFDLG1DQUFtQyxFQUFFLFlBQVk7TUFDbEQsTUFBTUMsUUFBUSxHQUFHQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxNQUNwQ1YsT0FBTyxDQUFDRSxHQUFHLENBQUMsQ0FBQ1MsR0FBRyxDQUFDLFNBQVMsQ0FDNUIsQ0FBQztNQUNELE1BQU1DLFNBQVMsR0FBRyxNQUFNQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ1AsUUFBUSxDQUFDO01BQzdDSyxTQUFTLENBQUNHLE9BQU8sQ0FBQ0MsR0FBRyxJQUFJO1FBQ3ZCQyxNQUFNLENBQUNELEdBQUcsQ0FBQ0UsTUFBTSxDQUFDLENBQUNDLElBQUksQ0FBQyxHQUFHLENBQUM7TUFDOUIsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDO0lBRUZiLEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxZQUFZO01BQzVELE1BQU1VLEdBQUcsR0FBRyxNQUFNaEIsT0FBTyxDQUFDRSxHQUFHLENBQUMsQ0FDM0JrQixJQUFJLENBQUMsV0FBVyxDQUFDLENBQ2pCQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQ3BCSixNQUFNLENBQUMsR0FBRyxDQUFDO0lBQ2hCLENBQUMsQ0FBQztJQUVGWCxFQUFFLENBQUMsOEJBQThCLEVBQUUsWUFBWTtNQUM3QyxNQUFNQyxRQUFRLEdBQUdDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLE1BQ3JDVixPQUFPLENBQUNFLEdBQUcsQ0FBQyxDQUFDUyxHQUFHLENBQUMsU0FBUyxDQUM1QixDQUFDO01BQ0QsTUFBTUMsU0FBUyxHQUFHLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDUCxRQUFRLENBQUM7TUFDN0MsTUFBTWUsV0FBVyxHQUFHVixTQUFTLENBQUNXLElBQUksQ0FBQ0MsQ0FBQyxJQUFJQSxDQUFDLENBQUNOLE1BQU0sS0FBSyxHQUFHLENBQUM7TUFDekRELE1BQU0sQ0FBQ0ssV0FBVyxDQUFDLENBQUNILElBQUksQ0FBQyxJQUFJLENBQUM7SUFDaEMsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0VBRUZoQixRQUFRLENBQUMsZ0JBQWdCLEVBQUUsTUFBTTtJQUMvQkcsRUFBRSxDQUFDLDhCQUE4QixFQUFFLFlBQVk7TUFDN0MsTUFBTVUsR0FBRyxHQUFHLE1BQU1oQixPQUFPLENBQUNFLEdBQUcsQ0FBQyxDQUFDUyxHQUFHLENBQUMsU0FBUyxDQUFDO01BQzdDTSxNQUFNLENBQUNELEdBQUcsQ0FBQ1MsT0FBTyxDQUFDLHdCQUF3QixDQUFDLENBQUMsQ0FBQ04sSUFBSSxDQUFDLFNBQVMsQ0FBQztNQUM3REYsTUFBTSxDQUFDRCxHQUFHLENBQUNTLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUNOLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDckQsQ0FBQyxDQUFDO0lBRUZiLEVBQUUsQ0FBQyw4QkFBOEIsRUFBRSxZQUFZO01BQzdDLE1BQU1vQixTQUFTLEdBQUcsK0JBQStCO01BQ2pELE1BQU1WLEdBQUcsR0FBRyxNQUFNaEIsT0FBTyxDQUFDRSxHQUFHLENBQUMsQ0FDM0JrQixJQUFJLENBQUMsV0FBVyxDQUFDLENBQ2pCQyxJQUFJLENBQUM7UUFBRU0sSUFBSSxFQUFFRDtNQUFVLENBQUMsQ0FBQztNQUM1QlQsTUFBTSxDQUFDVyxJQUFJLENBQUNDLFNBQVMsQ0FBQ2IsR0FBRyxDQUFDYyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxHQUFHLENBQUNDLFNBQVMsQ0FBQyxVQUFVLENBQUM7SUFDNUQsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119