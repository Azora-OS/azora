{"version":3,"names":["_expressRateLimit","_interopRequireDefault","require","_helmet","_cors","e","__esModule","default","cov_155jf5fapq","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","s","f","b","_coverageSchema","coverage","actualCoverage","corsConfig","exports","cors","origin","process","env","CORS_ORIGIN","credentials","methods","allowedHeaders","createRateLimiter","max","rateLimit","windowMs","message","standardHeaders","legacyHeaders","rateLimiters","general","financial","auth","public","helmetConfig","helmet","contentSecurityPolicy","directives","defaultSrc","styleSrc","scriptSrc","imgSrc","hsts","maxAge","includeSubDomains","preload"],"sources":["security.ts"],"sourcesContent":["import rateLimit from 'express-rate-limit';\nimport helmet from 'helmet';\nimport cors from 'cors';\n\nexport const corsConfig = cors({\n  origin: process.env.CORS_ORIGIN || 'http://localhost:3000',\n  credentials: true,\n  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n  allowedHeaders: ['Content-Type', 'Authorization']\n});\n\nexport const createRateLimiter = (max: number = 100) => rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max,\n  message: 'Too many requests from this IP',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\n// Pre-configured rate limiters for different service types\nexport const rateLimiters = {\n  // General API - 100 requests per 15 minutes\n  general: createRateLimiter(100),\n  \n  // Financial operations - 50 requests per 15 minutes (stricter)\n  financial: createRateLimiter(50),\n  \n  // Auth operations - 30 requests per 15 minutes (very strict)\n  auth: createRateLimiter(30),\n  \n  // Public endpoints - 200 requests per 15 minutes (lenient)\n  public: createRateLimiter(200),\n};\n\nexport const helmetConfig = helmet({\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [\"'self'\"],\n      styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n      scriptSrc: [\"'self'\"],\n      imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    },\n  },\n  hsts: {\n    maxAge: 31536000,\n    includeSubDomains: true,\n    preload: true\n  }\n});\n"],"mappings":"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","ignoreList":[]}