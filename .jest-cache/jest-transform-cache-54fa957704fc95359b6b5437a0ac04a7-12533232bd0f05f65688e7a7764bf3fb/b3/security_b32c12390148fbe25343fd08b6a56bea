20250e3e2623f780ca0accf14cef7ce7
/* istanbul ignore next */
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.rateLimiters = exports.helmetConfig = exports.createRateLimiter = exports.corsConfig = void 0;
var
/* istanbul ignore next */
_expressRateLimit = _interopRequireDefault(require("express-rate-limit"));
var
/* istanbul ignore next */
_helmet = _interopRequireDefault(require("helmet"));
var
/* istanbul ignore next */
_cors = _interopRequireDefault(require("cors"));
/* istanbul ignore next */ function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function cov_155jf5fapq() {
  var path = "C:\\Users\\Azora Sapiens\\Documents\\azora\\services\\shared\\middleware\\security.ts";
  var hash = "90e34a54048309bc7c4b79b583f7a2a83cb548bb";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\Azora Sapiens\\Documents\\azora\\services\\shared\\middleware\\security.ts",
    statementMap: {
      "0": {
        start: {
          line: 5,
          column: 26
        },
        end: {
          line: 10,
          column: 2
        }
      },
      "1": {
        start: {
          line: 12,
          column: 33
        },
        end: {
          line: 18,
          column: 2
        }
      },
      "2": {
        start: {
          line: 12,
          column: 56
        },
        end: {
          line: 18,
          column: 2
        }
      },
      "3": {
        start: {
          line: 21,
          column: 28
        },
        end: {
          line: 33,
          column: 1
        }
      },
      "4": {
        start: {
          line: 35,
          column: 28
        },
        end: {
          line: 49,
          column: 2
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 12,
            column: 33
          },
          end: {
            line: 12,
            column: 34
          }
        },
        loc: {
          start: {
            line: 12,
            column: 56
          },
          end: {
            line: 18,
            column: 2
          }
        },
        line: 12
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 6,
            column: 10
          },
          end: {
            line: 6,
            column: 60
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 6,
            column: 10
          },
          end: {
            line: 6,
            column: 33
          }
        }, {
          start: {
            line: 6,
            column: 37
          },
          end: {
            line: 6,
            column: 60
          }
        }],
        line: 6
      },
      "1": {
        loc: {
          start: {
            line: 12,
            column: 34
          },
          end: {
            line: 12,
            column: 51
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 12,
            column: 48
          },
          end: {
            line: 12,
            column: 51
          }
        }],
        line: 12
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0
    },
    f: {
      "0": 0
    },
    b: {
      "0": [0, 0],
      "1": [0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "90e34a54048309bc7c4b79b583f7a2a83cb548bb"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_155jf5fapq = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_155jf5fapq();
const corsConfig =
/* istanbul ignore next */
exports.corsConfig = (cov_155jf5fapq().s[0]++,
/* istanbul ignore next */
(0,
/* istanbul ignore next */
_cors.
/* istanbul ignore next */
default)({
  origin:
  /* istanbul ignore next */
  (cov_155jf5fapq().b[0][0]++, process.env.CORS_ORIGIN) ||
  /* istanbul ignore next */
  (cov_155jf5fapq().b[0][1]++, 'http://localhost:3000'),
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],
  allowedHeaders: ['Content-Type', 'Authorization']
}));
/* istanbul ignore next */
cov_155jf5fapq().s[1]++;
const createRateLimiter = (max =
/* istanbul ignore next */
(cov_155jf5fapq().b[1][0]++, 100)) => {
  /* istanbul ignore next */
  cov_155jf5fapq().f[0]++;
  cov_155jf5fapq().s[2]++;
  return /* istanbul ignore next */(0,
  /* istanbul ignore next */
  _expressRateLimit.
  /* istanbul ignore next */
  default)({
    windowMs: 15 * 60 * 1000,
    max,
    message: 'Too many requests from this IP',
    standardHeaders: true,
    legacyHeaders: false
  });
};

// Pre-configured rate limiters for different service types
/* istanbul ignore next */
exports.createRateLimiter = createRateLimiter;
const rateLimiters =
/* istanbul ignore next */
exports.rateLimiters = (cov_155jf5fapq().s[3]++, {
  // General API - 100 requests per 15 minutes
  general: createRateLimiter(100),
  // Financial operations - 50 requests per 15 minutes (stricter)
  financial: createRateLimiter(50),
  // Auth operations - 30 requests per 15 minutes (very strict)
  auth: createRateLimiter(30),
  // Public endpoints - 200 requests per 15 minutes (lenient)
  public: createRateLimiter(200)
});
const helmetConfig =
/* istanbul ignore next */
exports.helmetConfig = (cov_155jf5fapq().s[4]++,
/* istanbul ignore next */
(0,
/* istanbul ignore next */
_helmet.
/* istanbul ignore next */
default)({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      scriptSrc: ["'self'"],
      imgSrc: ["'self'", "data:", "https:"]
    }
  },
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  }
}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzc1JhdGVMaW1pdCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2hlbG1ldCIsIl9jb3JzIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY292XzE1NWpmNWZhcHEiLCJwYXRoIiwiaGFzaCIsImdsb2JhbCIsIkZ1bmN0aW9uIiwiZ2N2IiwiY292ZXJhZ2VEYXRhIiwic3RhdGVtZW50TWFwIiwic3RhcnQiLCJsaW5lIiwiY29sdW1uIiwiZW5kIiwiZm5NYXAiLCJuYW1lIiwiZGVjbCIsImxvYyIsImJyYW5jaE1hcCIsInR5cGUiLCJsb2NhdGlvbnMiLCJzIiwiZiIsImIiLCJfY292ZXJhZ2VTY2hlbWEiLCJjb3ZlcmFnZSIsImFjdHVhbENvdmVyYWdlIiwiY29yc0NvbmZpZyIsImV4cG9ydHMiLCJjb3JzIiwib3JpZ2luIiwicHJvY2VzcyIsImVudiIsIkNPUlNfT1JJR0lOIiwiY3JlZGVudGlhbHMiLCJtZXRob2RzIiwiYWxsb3dlZEhlYWRlcnMiLCJjcmVhdGVSYXRlTGltaXRlciIsIm1heCIsInJhdGVMaW1pdCIsIndpbmRvd01zIiwibWVzc2FnZSIsInN0YW5kYXJkSGVhZGVycyIsImxlZ2FjeUhlYWRlcnMiLCJyYXRlTGltaXRlcnMiLCJnZW5lcmFsIiwiZmluYW5jaWFsIiwiYXV0aCIsInB1YmxpYyIsImhlbG1ldENvbmZpZyIsImhlbG1ldCIsImNvbnRlbnRTZWN1cml0eVBvbGljeSIsImRpcmVjdGl2ZXMiLCJkZWZhdWx0U3JjIiwic3R5bGVTcmMiLCJzY3JpcHRTcmMiLCJpbWdTcmMiLCJoc3RzIiwibWF4QWdlIiwiaW5jbHVkZVN1YkRvbWFpbnMiLCJwcmVsb2FkIl0sInNvdXJjZXMiOlsic2VjdXJpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHJhdGVMaW1pdCBmcm9tICdleHByZXNzLXJhdGUtbGltaXQnO1xuaW1wb3J0IGhlbG1ldCBmcm9tICdoZWxtZXQnO1xuaW1wb3J0IGNvcnMgZnJvbSAnY29ycyc7XG5cbmV4cG9ydCBjb25zdCBjb3JzQ29uZmlnID0gY29ycyh7XG4gIG9yaWdpbjogcHJvY2Vzcy5lbnYuQ09SU19PUklHSU4gfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsXG4gIGNyZWRlbnRpYWxzOiB0cnVlLFxuICBtZXRob2RzOiBbJ0dFVCcsICdQT1NUJywgJ1BVVCcsICdERUxFVEUnLCAnUEFUQ0gnXSxcbiAgYWxsb3dlZEhlYWRlcnM6IFsnQ29udGVudC1UeXBlJywgJ0F1dGhvcml6YXRpb24nXVxufSk7XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVSYXRlTGltaXRlciA9IChtYXg6IG51bWJlciA9IDEwMCkgPT4gcmF0ZUxpbWl0KHtcbiAgd2luZG93TXM6IDE1ICogNjAgKiAxMDAwLFxuICBtYXgsXG4gIG1lc3NhZ2U6ICdUb28gbWFueSByZXF1ZXN0cyBmcm9tIHRoaXMgSVAnLFxuICBzdGFuZGFyZEhlYWRlcnM6IHRydWUsXG4gIGxlZ2FjeUhlYWRlcnM6IGZhbHNlLFxufSk7XG5cbi8vIFByZS1jb25maWd1cmVkIHJhdGUgbGltaXRlcnMgZm9yIGRpZmZlcmVudCBzZXJ2aWNlIHR5cGVzXG5leHBvcnQgY29uc3QgcmF0ZUxpbWl0ZXJzID0ge1xuICAvLyBHZW5lcmFsIEFQSSAtIDEwMCByZXF1ZXN0cyBwZXIgMTUgbWludXRlc1xuICBnZW5lcmFsOiBjcmVhdGVSYXRlTGltaXRlcigxMDApLFxuICBcbiAgLy8gRmluYW5jaWFsIG9wZXJhdGlvbnMgLSA1MCByZXF1ZXN0cyBwZXIgMTUgbWludXRlcyAoc3RyaWN0ZXIpXG4gIGZpbmFuY2lhbDogY3JlYXRlUmF0ZUxpbWl0ZXIoNTApLFxuICBcbiAgLy8gQXV0aCBvcGVyYXRpb25zIC0gMzAgcmVxdWVzdHMgcGVyIDE1IG1pbnV0ZXMgKHZlcnkgc3RyaWN0KVxuICBhdXRoOiBjcmVhdGVSYXRlTGltaXRlcigzMCksXG4gIFxuICAvLyBQdWJsaWMgZW5kcG9pbnRzIC0gMjAwIHJlcXVlc3RzIHBlciAxNSBtaW51dGVzIChsZW5pZW50KVxuICBwdWJsaWM6IGNyZWF0ZVJhdGVMaW1pdGVyKDIwMCksXG59O1xuXG5leHBvcnQgY29uc3QgaGVsbWV0Q29uZmlnID0gaGVsbWV0KHtcbiAgY29udGVudFNlY3VyaXR5UG9saWN5OiB7XG4gICAgZGlyZWN0aXZlczoge1xuICAgICAgZGVmYXVsdFNyYzogW1wiJ3NlbGYnXCJdLFxuICAgICAgc3R5bGVTcmM6IFtcIidzZWxmJ1wiLCBcIid1bnNhZmUtaW5saW5lJ1wiXSxcbiAgICAgIHNjcmlwdFNyYzogW1wiJ3NlbGYnXCJdLFxuICAgICAgaW1nU3JjOiBbXCInc2VsZidcIiwgXCJkYXRhOlwiLCBcImh0dHBzOlwiXSxcbiAgICB9LFxuICB9LFxuICBoc3RzOiB7XG4gICAgbWF4QWdlOiAzMTUzNjAwMCxcbiAgICBpbmNsdWRlU3ViRG9tYWluczogdHJ1ZSxcbiAgICBwcmVsb2FkOiB0cnVlXG4gIH1cbn0pO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFBQTtBQUFBQSxpQkFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0E7QUFBQTtBQUFBQyxPQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQTtBQUFBO0FBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUF3QixvQ0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxTQUFBRyxlQUFBO0VBQUEsSUFBQUMsSUFBQTtFQUFBLElBQUFDLElBQUE7RUFBQSxJQUFBQyxNQUFBLE9BQUFDLFFBQUE7RUFBQSxJQUFBQyxHQUFBO0VBQUEsSUFBQUMsWUFBQTtJQUFBTCxJQUFBO0lBQUFNLFlBQUE7TUFBQTtRQUFBQyxLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtNQUFBO1FBQUFGLEtBQUE7VUFBQUMsSUFBQTtVQUFBQyxNQUFBO1FBQUE7UUFBQUMsR0FBQTtVQUFBRixJQUFBO1VBQUFDLE1BQUE7UUFBQTtNQUFBO01BQUE7UUFBQUYsS0FBQTtVQUFBQyxJQUFBO1VBQUFDLE1BQUE7UUFBQTtRQUFBQyxHQUFBO1VBQUFGLElBQUE7VUFBQUMsTUFBQTtRQUFBO01BQUE7TUFBQTtRQUFBRixLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtNQUFBO1FBQUFGLEtBQUE7VUFBQUMsSUFBQTtVQUFBQyxNQUFBO1FBQUE7UUFBQUMsR0FBQTtVQUFBRixJQUFBO1VBQUFDLE1BQUE7UUFBQTtNQUFBO0lBQUE7SUFBQUUsS0FBQTtNQUFBO1FBQUFDLElBQUE7UUFBQUMsSUFBQTtVQUFBTixLQUFBO1lBQUFDLElBQUE7WUFBQUMsTUFBQTtVQUFBO1VBQUFDLEdBQUE7WUFBQUYsSUFBQTtZQUFBQyxNQUFBO1VBQUE7UUFBQTtRQUFBSyxHQUFBO1VBQUFQLEtBQUE7WUFBQUMsSUFBQTtZQUFBQyxNQUFBO1VBQUE7VUFBQUMsR0FBQTtZQUFBRixJQUFBO1lBQUFDLE1BQUE7VUFBQTtRQUFBO1FBQUFELElBQUE7TUFBQTtJQUFBO0lBQUFPLFNBQUE7TUFBQTtRQUFBRCxHQUFBO1VBQUFQLEtBQUE7WUFBQUMsSUFBQTtZQUFBQyxNQUFBO1VBQUE7VUFBQUMsR0FBQTtZQUFBRixJQUFBO1lBQUFDLE1BQUE7VUFBQTtRQUFBO1FBQUFPLElBQUE7UUFBQUMsU0FBQTtVQUFBVixLQUFBO1lBQUFDLElBQUE7WUFBQUMsTUFBQTtVQUFBO1VBQUFDLEdBQUE7WUFBQUYsSUFBQTtZQUFBQyxNQUFBO1VBQUE7UUFBQTtVQUFBRixLQUFBO1lBQUFDLElBQUE7WUFBQUMsTUFBQTtVQUFBO1VBQUFDLEdBQUE7WUFBQUYsSUFBQTtZQUFBQyxNQUFBO1VBQUE7UUFBQTtRQUFBRCxJQUFBO01BQUE7TUFBQTtRQUFBTSxHQUFBO1VBQUFQLEtBQUE7WUFBQUMsSUFBQTtZ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