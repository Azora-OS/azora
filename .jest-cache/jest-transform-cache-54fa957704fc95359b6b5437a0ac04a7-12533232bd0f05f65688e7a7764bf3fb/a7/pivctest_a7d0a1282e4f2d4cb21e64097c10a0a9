fe8ea56d8a35ce48ce73dd0911a5972c
"use strict";

var _pivc = require("../path/to/pivc");
describe('PIVC Validation', () => {
  it('should correctly apply 5% PIVC to a standard transaction', () => {
    const transaction = {
      amount: 100
    };
    const {
      pivcAmount,
      finalAmount
    } = (0, _pivc.validatePIVC)(transaction);
    expect(pivcAmount).toBe(5);
    expect(finalAmount).toBe(95);
  });
  it('should handle high-volume transactions without race conditions', async () => {
    const transactions = Array(1000).fill({
      amount: 10
    });
    const results = await Promise.all(transactions.map(tx => Promise.resolve((0, _pivc.validatePIVC)(tx))));
    results.forEach(({
      pivcAmount,
      finalAmount
    }) => {
      expect(pivcAmount).toBe(0.5);
      expect(finalAmount).toBe(9.5);
    });
  });
  it('should not apply PIVC to a zero-value transaction', () => {
    const transaction = {
      amount: 0
    };
    const {
      pivcAmount,
      finalAmount
    } = (0, _pivc.validatePIVC)(transaction);
    expect(pivcAmount).toBe(0);
    expect(finalAmount).toBe(0);
  });
  it('should reject transactions attempting to bypass PIVC', () => {
    const transaction = {
      amount: 100,
      bypassPIVC: true
    };
    expect(() => (0, _pivc.validatePIVC)(transaction)).toThrow('PIVC bypass detected');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcGl2YyIsInJlcXVpcmUiLCJkZXNjcmliZSIsIml0IiwidHJhbnNhY3Rpb24iLCJhbW91bnQiLCJwaXZjQW1vdW50IiwiZmluYWxBbW91bnQiLCJ2YWxpZGF0ZVBJVkMiLCJleHBlY3QiLCJ0b0JlIiwidHJhbnNhY3Rpb25zIiwiQXJyYXkiLCJmaWxsIiwicmVzdWx0cyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJ0eCIsInJlc29sdmUiLCJmb3JFYWNoIiwiYnlwYXNzUElWQyIsInRvVGhyb3ciXSwic291cmNlcyI6WyJwaXZjLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdmFsaWRhdGVQSVZDIH0gZnJvbSAnLi4vcGF0aC90by9waXZjJztcclxuXHJcbmRlc2NyaWJlKCdQSVZDIFZhbGlkYXRpb24nLCAoKSA9PiB7XHJcbiAgaXQoJ3Nob3VsZCBjb3JyZWN0bHkgYXBwbHkgNSUgUElWQyB0byBhIHN0YW5kYXJkIHRyYW5zYWN0aW9uJywgKCkgPT4ge1xyXG4gICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7IGFtb3VudDogMTAwIH07XHJcbiAgICBjb25zdCB7IHBpdmNBbW91bnQsIGZpbmFsQW1vdW50IH0gPSB2YWxpZGF0ZVBJVkModHJhbnNhY3Rpb24pO1xyXG4gICAgZXhwZWN0KHBpdmNBbW91bnQpLnRvQmUoNSk7XHJcbiAgICBleHBlY3QoZmluYWxBbW91bnQpLnRvQmUoOTUpO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnc2hvdWxkIGhhbmRsZSBoaWdoLXZvbHVtZSB0cmFuc2FjdGlvbnMgd2l0aG91dCByYWNlIGNvbmRpdGlvbnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBBcnJheSgxMDAwKS5maWxsKHsgYW1vdW50OiAxMCB9KTtcclxuICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbCh0cmFuc2FjdGlvbnMubWFwKHR4ID0+IFByb21pc2UucmVzb2x2ZSh2YWxpZGF0ZVBJVkModHgpKSkpO1xyXG4gICAgcmVzdWx0cy5mb3JFYWNoKCh7IHBpdmNBbW91bnQsIGZpbmFsQW1vdW50IH0pID0+IHtcclxuICAgICAgZXhwZWN0KHBpdmNBbW91bnQpLnRvQmUoMC41KTtcclxuICAgICAgZXhwZWN0KGZpbmFsQW1vdW50KS50b0JlKDkuNSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ3Nob3VsZCBub3QgYXBwbHkgUElWQyB0byBhIHplcm8tdmFsdWUgdHJhbnNhY3Rpb24nLCAoKSA9PiB7XHJcbiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHsgYW1vdW50OiAwIH07XHJcbiAgICBjb25zdCB7IHBpdmNBbW91bnQsIGZpbmFsQW1vdW50IH0gPSB2YWxpZGF0ZVBJVkModHJhbnNhY3Rpb24pO1xyXG4gICAgZXhwZWN0KHBpdmNBbW91bnQpLnRvQmUoMCk7XHJcbiAgICBleHBlY3QoZmluYWxBbW91bnQpLnRvQmUoMCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdzaG91bGQgcmVqZWN0IHRyYW5zYWN0aW9ucyBhdHRlbXB0aW5nIHRvIGJ5cGFzcyBQSVZDJywgKCkgPT4ge1xyXG4gICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7IGFtb3VudDogMTAwLCBieXBhc3NQSVZDOiB0cnVlIH07XHJcbiAgICBleHBlY3QoKCkgPT4gdmFsaWRhdGVQSVZDKHRyYW5zYWN0aW9uKSkudG9UaHJvdygnUElWQyBieXBhc3MgZGV0ZWN0ZWQnKTtcclxuICB9KTtcclxufSk7Il0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLEtBQUEsR0FBQUMsT0FBQTtBQUVBQyxRQUFRLENBQUMsaUJBQWlCLEVBQUUsTUFBTTtFQUNoQ0MsRUFBRSxDQUFDLDBEQUEwRCxFQUFFLE1BQU07SUFDbkUsTUFBTUMsV0FBVyxHQUFHO01BQUVDLE1BQU0sRUFBRTtJQUFJLENBQUM7SUFDbkMsTUFBTTtNQUFFQyxVQUFVO01BQUVDO0lBQVksQ0FBQyxHQUFHLElBQUFDLGtCQUFZLEVBQUNKLFdBQVcsQ0FBQztJQUM3REssTUFBTSxDQUFDSCxVQUFVLENBQUMsQ0FBQ0ksSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMxQkQsTUFBTSxDQUFDRixXQUFXLENBQUMsQ0FBQ0csSUFBSSxDQUFDLEVBQUUsQ0FBQztFQUM5QixDQUFDLENBQUM7RUFFRlAsRUFBRSxDQUFDLGdFQUFnRSxFQUFFLFlBQVk7SUFDL0UsTUFBTVEsWUFBWSxHQUFHQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUNDLElBQUksQ0FBQztNQUFFUixNQUFNLEVBQUU7SUFBRyxDQUFDLENBQUM7SUFDckQsTUFBTVMsT0FBTyxHQUFHLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDTCxZQUFZLENBQUNNLEdBQUcsQ0FBQ0MsRUFBRSxJQUFJSCxPQUFPLENBQUNJLE9BQU8sQ0FBQyxJQUFBWCxrQkFBWSxFQUFDVSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDNUZKLE9BQU8sQ0FBQ00sT0FBTyxDQUFDLENBQUM7TUFBRWQsVUFBVTtNQUFFQztJQUFZLENBQUMsS0FBSztNQUMvQ0UsTUFBTSxDQUFDSCxVQUFVLENBQUMsQ0FBQ0ksSUFBSSxDQUFDLEdBQUcsQ0FBQztNQUM1QkQsTUFBTSxDQUFDRixXQUFXLENBQUMsQ0FBQ0csSUFBSSxDQUFDLEdBQUcsQ0FBQztJQUMvQixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7RUFFRlAsRUFBRSxDQUFDLG1EQUFtRCxFQUFFLE1BQU07SUFDNUQsTUFBTUMsV0FBVyxHQUFHO01BQUVDLE1BQU0sRUFBRTtJQUFFLENBQUM7SUFDakMsTUFBTTtNQUFFQyxVQUFVO01BQUVDO0lBQVksQ0FBQyxHQUFHLElBQUFDLGtCQUFZLEVBQUNKLFdBQVcsQ0FBQztJQUM3REssTUFBTSxDQUFDSCxVQUFVLENBQUMsQ0FBQ0ksSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMxQkQsTUFBTSxDQUFDRixXQUFXLENBQUMsQ0FBQ0csSUFBSSxDQUFDLENBQUMsQ0FBQztFQUM3QixDQUFDLENBQUM7RUFFRlAsRUFBRSxDQUFDLHNEQUFzRCxFQUFFLE1BQU07SUFDL0QsTUFBTUMsV0FBVyxHQUFHO01BQUVDLE1BQU0sRUFBRSxHQUFHO01BQUVnQixVQUFVLEVBQUU7SUFBSyxDQUFDO0lBQ3JEWixNQUFNLENBQUMsTUFBTSxJQUFBRCxrQkFBWSxFQUFDSixXQUFXLENBQUMsQ0FBQyxDQUFDa0IsT0FBTyxDQUFDLHNCQUFzQixDQUFDO0VBQ3pFLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==