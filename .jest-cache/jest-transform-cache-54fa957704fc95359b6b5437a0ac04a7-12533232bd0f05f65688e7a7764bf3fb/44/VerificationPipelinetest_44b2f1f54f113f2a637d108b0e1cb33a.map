{"version":3,"names":["_VerificationPipeline","require","path","_interopRequireWildcard","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","describe","pipeline","projectRoot","join","__dirname","beforeEach","VerificationPipeline","afterEach","close","it","results","runTests","expect","toBeDefined","toHaveProperty","Array","isArray","failures","toBe","report","verify","e2eTests","toBeUndefined","accessibility","previewUrl","url","blockers","passed","checkAccessibility","length","toBeGreaterThan","options","blockOnCritical","blockOnSerious","includeFixSuggestions","urls","reports","checkMultiplePages","forEach","index","outputPath","generateAccessibilityReport","tests"],"sources":["VerificationPipeline.test.ts"],"sourcesContent":["import { VerificationPipeline, VerificationReport } from '../VerificationPipeline';\nimport * as path from 'path';\n\ndescribe('VerificationPipeline', () => {\n  let pipeline: VerificationPipeline;\n  const projectRoot = path.join(__dirname, '../../__fixtures__/test-project');\n\n  beforeEach(() => {\n    pipeline = new VerificationPipeline(projectRoot);\n  });\n\n  afterEach(async () => {\n    await pipeline.close();\n  });\n\n  describe('runTests', () => {\n    it('should run unit tests', async () => {\n      const results = await pipeline.runTests();\n      \n      expect(results).toBeDefined();\n      expect(results).toHaveProperty('passed');\n      expect(results).toHaveProperty('failed');\n      expect(results).toHaveProperty('total');\n      expect(results).toHaveProperty('duration');\n      expect(results).toHaveProperty('failures');\n    });\n\n    it('should handle test failures', async () => {\n      const results = await pipeline.runTests();\n      \n      expect(Array.isArray(results.failures)).toBe(true);\n    });\n  });\n\n  describe('verify', () => {\n    it('should run basic verification without E2E or accessibility', async () => {\n      const report = await pipeline.verify(false, false);\n      \n      expect(report).toBeDefined();\n      expect(report).toHaveProperty('tests');\n      expect(report).toHaveProperty('passed');\n      expect(report).toHaveProperty('blockers');\n      expect(report).toHaveProperty('timestamp');\n      expect(report.e2eTests).toBeUndefined();\n      expect(report.accessibility).toBeUndefined();\n    });\n\n    it('should include E2E tests when requested', async () => {\n      const report = await pipeline.verify(true, false);\n      \n      expect(report).toBeDefined();\n      expect(report.e2eTests).toBeDefined();\n    });\n\n    it('should include accessibility check when requested with URL', async () => {\n      const previewUrl = 'http://localhost:3000';\n      const report = await pipeline.verify(false, true, previewUrl);\n      \n      expect(report).toBeDefined();\n      expect(report.accessibility).toBeDefined();\n      expect(report.accessibility?.url).toBe(previewUrl);\n    });\n\n    it('should not include accessibility check without URL', async () => {\n      const report = await pipeline.verify(false, true);\n      \n      expect(report).toBeDefined();\n      expect(report.accessibility).toBeUndefined();\n    });\n\n    it('should aggregate blockers from all checks', async () => {\n      const report = await pipeline.verify(false, false);\n      \n      expect(Array.isArray(report.blockers)).toBe(true);\n    });\n\n    it('should mark as failed if any check fails', async () => {\n      const report = await pipeline.verify(false, false);\n      \n      expect(typeof report.passed).toBe('boolean');\n    });\n  });\n\n  describe('checkAccessibility', () => {\n    it('should check accessibility of a URL', async () => {\n      const url = 'http://localhost:3000';\n      const report = await pipeline.checkAccessibility(url);\n      \n      expect(report).toBeDefined();\n      expect(report.url).toBe(url);\n      expect(report).toHaveProperty('violations');\n      expect(report).toHaveProperty('summary');\n      expect(report).toHaveProperty('passed');\n      expect(report).toHaveProperty('blockers');\n    });\n\n    it('should handle accessibility check failures', async () => {\n      const url = 'http://invalid-url.local';\n      const report = await pipeline.checkAccessibility(url);\n      \n      expect(report.passed).toBe(false);\n      expect(report.blockers.length).toBeGreaterThan(0);\n    });\n\n    it('should respect custom options', async () => {\n      const url = 'http://localhost:3000';\n      const options = {\n        blockOnCritical: true,\n        blockOnSerious: true,\n        includeFixSuggestions: true,\n      };\n      \n      const report = await pipeline.checkAccessibility(url, options);\n      \n      expect(report).toBeDefined();\n    });\n  });\n\n  describe('checkMultiplePages', () => {\n    it('should check multiple URLs', async () => {\n      const urls = [\n        'http://localhost:3000',\n        'http://localhost:3000/about',\n      ];\n      \n      const reports = await pipeline.checkMultiplePages(urls);\n      \n      expect(Array.isArray(reports)).toBe(true);\n      expect(reports.length).toBe(urls.length);\n      \n      reports.forEach((report, index) => {\n        expect(report.url).toBe(urls[index]);\n      });\n    });\n\n    it('should handle mixed results', async () => {\n      const urls = [\n        'http://invalid-1.local',\n        'http://invalid-2.local',\n      ];\n      \n      const reports = await pipeline.checkMultiplePages(urls);\n      \n      expect(reports.length).toBe(2);\n      reports.forEach(report => {\n        expect(report.passed).toBe(false);\n      });\n    });\n  });\n\n  describe('generateAccessibilityReport', () => {\n    it('should generate HTML report', async () => {\n      const url = 'http://localhost:3000';\n      const report = await pipeline.checkAccessibility(url);\n      const outputPath = path.join(projectRoot, '.azstudio', 'test-a11y-report.html');\n      \n      await pipeline.generateAccessibilityReport(report, outputPath);\n      \n      // Check that method completes without error\n      expect(true).toBe(true);\n    });\n  });\n\n  describe('integration with E2E and accessibility', () => {\n    it('should run full verification with all checks', async () => {\n      const previewUrl = 'http://localhost:3000';\n      const report = await pipeline.verify(true, true, previewUrl);\n      \n      expect(report).toBeDefined();\n      expect(report.tests).toBeDefined();\n      expect(report.e2eTests).toBeDefined();\n      expect(report.accessibility).toBeDefined();\n      \n      // All checks should contribute to overall pass/fail\n      expect(typeof report.passed).toBe('boolean');\n      \n      // Blockers should aggregate from all sources\n      expect(Array.isArray(report.blockers)).toBe(true);\n    });\n\n    it('should fail if accessibility has critical violations', async () => {\n      // This would require mocking or actual violations\n      // For now, test the structure\n      const previewUrl = 'http://localhost:3000';\n      const report = await pipeline.verify(false, true, previewUrl);\n      \n      if (report.accessibility && !report.accessibility.passed) {\n        expect(report.passed).toBe(false);\n        expect(report.blockers.length).toBeGreaterThan(0);\n      }\n    });\n  });\n\n  describe('close', () => {\n    it('should close all resources', async () => {\n      await pipeline.close();\n      \n      // Should complete without error\n      expect(true).toBe(true);\n    });\n  });\n});\n"],"mappings":";;AAAA,IAAAA,qBAAA,GAAAC,OAAA;AACA,IAAAC,IAAA,GAAAC,uBAAA,CAAAF,OAAA;AAA6B,SAAAE,wBAAAC,CAAA,EAAAC,CAAA,6BAAAC,OAAA,MAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAH,uBAAA,YAAAA,CAAAC,CAAA,EAAAC,CAAA,SAAAA,CAAA,IAAAD,CAAA,IAAAA,CAAA,CAAAK,UAAA,SAAAL,CAAA,MAAAM,CAAA,EAAAC,CAAA,EAAAC,CAAA,KAAAC,SAAA,QAAAC,OAAA,EAAAV,CAAA,iBAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,SAAAQ,CAAA,MAAAF,CAAA,GAAAL,CAAA,GAAAG,CAAA,GAAAD,CAAA,QAAAG,CAAA,CAAAK,GAAA,CAAAX,CAAA,UAAAM,CAAA,CAAAM,GAAA,CAAAZ,CAAA,GAAAM,CAAA,CAAAO,GAAA,CAAAb,CAAA,EAAAQ,CAAA,gBAAAP,CAAA,IAAAD,CAAA,gBAAAC,CAAA,OAAAa,cAAA,CAAAC,IAAA,CAAAf,CAAA,EAAAC,CAAA,OAAAM,CAAA,IAAAD,CAAA,GAAAU,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAAE,wBAAA,CAAAlB,CAAA,EAAAC,CAAA,OAAAM,CAAA,CAAAK,GAAA,IAAAL,CAAA,CAAAM,GAAA,IAAAP,CAAA,CAAAE,CAAA,EAAAP,CAAA,EAAAM,CAAA,IAAAC,CAAA,CAAAP,CAAA,IAAAD,CAAA,CAAAC,CAAA,WAAAO,CAAA,KAAAR,CAAA,EAAAC,CAAA;AAE7BkB,QAAQ,CAAC,sBAAsB,EAAE,MAAM;EACrC,IAAIC,QAA8B;EAClC,MAAMC,WAAW,GAAGvB,IAAI,CAACwB,IAAI,CAACC,SAAS,EAAE,iCAAiC,CAAC;EAE3EC,UAAU,CAAC,MAAM;IACfJ,QAAQ,GAAG,IAAIK,0CAAoB,CAACJ,WAAW,CAAC;EAClD,CAAC,CAAC;EAEFK,SAAS,CAAC,YAAY;IACpB,MAAMN,QAAQ,CAACO,KAAK,CAAC,CAAC;EACxB,CAAC,CAAC;EAEFR,QAAQ,CAAC,UAAU,EAAE,MAAM;IACzBS,EAAE,CAAC,uBAAuB,EAAE,YAAY;MACtC,MAAMC,OAAO,GAAG,MAAMT,QAAQ,CAACU,QAAQ,CAAC,CAAC;MAEzCC,MAAM,CAACF,OAAO,CAAC,CAACG,WAAW,CAAC,CAAC;MAC7BD,MAAM,CAACF,OAAO,CAAC,CAACI,cAAc,CAAC,QAAQ,CAAC;MACxCF,MAAM,CAACF,OAAO,CAAC,CAACI,cAAc,CAAC,QAAQ,CAAC;MACxCF,MAAM,CAACF,OAAO,CAAC,CAACI,cAAc,CAAC,OAAO,CAAC;MACvCF,MAAM,CAACF,OAAO,CAAC,CAACI,cAAc,CAAC,UAAU,CAAC;MAC1CF,MAAM,CAACF,OAAO,CAAC,CAACI,cAAc,CAAC,UAAU,CAAC;IAC5C,CAAC,CAAC;IAEFL,EAAE,CAAC,6BAA6B,EAAE,YAAY;MAC5C,MAAMC,OAAO,GAAG,MAAMT,QAAQ,CAACU,QAAQ,CAAC,CAAC;MAEzCC,MAAM,CAACG,KAAK,CAACC,OAAO,CAACN,OAAO,CAACO,QAAQ,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC;IACpD,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFlB,QAAQ,CAAC,QAAQ,EAAE,MAAM;IACvBS,EAAE,CAAC,4DAA4D,EAAE,YAAY;MAC3E,MAAMU,MAAM,GAAG,MAAMlB,QAAQ,CAACmB,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC;MAElDR,MAAM,CAACO,MAAM,CAAC,CAACN,WAAW,CAAC,CAAC;MAC5BD,MAAM,CAACO,MAAM,CAAC,CAACL,cAAc,CAAC,OAAO,CAAC;MACtCF,MAAM,CAACO,MAAM,CAAC,CAACL,cAAc,CAAC,QAAQ,CAAC;MACvCF,MAAM,CAACO,MAAM,CAAC,CAACL,cAAc,CAAC,UAAU,CAAC;MACzCF,MAAM,CAACO,MAAM,CAAC,CAACL,cAAc,CAAC,WAAW,CAAC;MAC1CF,MAAM,CAACO,MAAM,CAACE,QAAQ,CAAC,CAACC,aAAa,CAAC,CAAC;MACvCV,MAAM,CAACO,MAAM,CAACI,aAAa,CAAC,CAACD,aAAa,CAAC,CAAC;IAC9C,CAAC,CAAC;IAEFb,EAAE,CAAC,yCAAyC,EAAE,YAAY;MACxD,MAAMU,MAAM,GAAG,MAAMlB,QAAQ,CAACmB,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC;MAEjDR,MAAM,CAACO,MAAM,CAAC,CAACN,WAAW,CAAC,CAAC;MAC5BD,MAAM,CAACO,MAAM,CAACE,QAAQ,CAAC,CAACR,WAAW,CAAC,CAAC;IACvC,CAAC,CAAC;IAEFJ,EAAE,CAAC,4DAA4D,EAAE,YAAY;MAC3E,MAAMe,UAAU,GAAG,uBAAuB;MAC1C,MAAML,MAAM,GAAG,MAAMlB,QAAQ,CAACmB,MAAM,CAAC,KAAK,EAAE,IAAI,EAAEI,UAAU,CAAC;MAE7DZ,MAAM,CAACO,MAAM,CAAC,CAACN,WAAW,CAAC,CAAC;MAC5BD,MAAM,CAACO,MAAM,CAACI,aAAa,CAAC,CAACV,WAAW,CAAC,CAAC;MAC1CD,MAAM,CAACO,MAAM,CAACI,aAAa,EAAEE,GAAG,CAAC,CAACP,IAAI,CAACM,UAAU,CAAC;IACpD,CAAC,CAAC;IAEFf,EAAE,CAAC,oDAAoD,EAAE,YAAY;MACnE,MAAMU,MAAM,GAAG,MAAMlB,QAAQ,CAACmB,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC;MAEjDR,MAAM,CAACO,MAAM,CAAC,CAACN,WAAW,CAAC,CAAC;MAC5BD,MAAM,CAACO,MAAM,CAACI,aAAa,CAAC,CAACD,aAAa,CAAC,CAAC;IAC9C,CAAC,CAAC;IAEFb,EAAE,CAAC,2CAA2C,EAAE,YAAY;MAC1D,MAAMU,MAAM,GAAG,MAAMlB,QAAQ,CAACmB,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC;MAElDR,MAAM,CAACG,KAAK,CAACC,OAAO,CAACG,MAAM,CAACO,QAAQ,CAAC,CAAC,CAACR,IAAI,CAAC,IAAI,CAAC;IACnD,CAAC,CAAC;IAEFT,EAAE,CAAC,0CAA0C,EAAE,YAAY;MACzD,MAAMU,MAAM,GAAG,MAAMlB,QAAQ,CAACmB,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC;MAElDR,MAAM,CAAC,OAAOO,MAAM,CAACQ,MAAM,CAAC,CAACT,IAAI,CAAC,SAAS,CAAC;IAC9C,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFlB,QAAQ,CAAC,oBAAoB,EAAE,MAAM;IACnCS,EAAE,CAAC,qCAAqC,EAAE,YAAY;MACpD,MAAMgB,GAAG,GAAG,uBAAuB;MACnC,MAAMN,MAAM,GAAG,MAAMlB,QAAQ,CAAC2B,kBAAkB,CAACH,GAAG,CAAC;MAErDb,MAAM,CAACO,MAAM,CAAC,CAACN,WAAW,CAAC,CAAC;MAC5BD,MAAM,CAACO,MAAM,CAACM,GAAG,CAAC,CAACP,IAAI,CAACO,GAAG,CAAC;MAC5Bb,MAAM,CAACO,MAAM,CAAC,CAACL,cAAc,CAAC,YAAY,CAAC;MAC3CF,MAAM,CAACO,MAAM,CAAC,CAACL,cAAc,CAAC,SAAS,CAAC;MACxCF,MAAM,CAACO,MAAM,CAAC,CAACL,cAAc,CAAC,QAAQ,CAAC;MACvCF,MAAM,CAACO,MAAM,CAAC,CAACL,cAAc,CAAC,UAAU,CAAC;IAC3C,CAAC,CAAC;IAEFL,EAAE,CAAC,4CAA4C,EAAE,YAAY;MAC3D,MAAMgB,GAAG,GAAG,0BAA0B;MACtC,MAAMN,MAAM,GAAG,MAAMlB,QAAQ,CAAC2B,kBAAkB,CAACH,GAAG,CAAC;MAErDb,MAAM,CAACO,MAAM,CAACQ,MAAM,CAAC,CAACT,IAAI,CAAC,KAAK,CAAC;MACjCN,MAAM,CAACO,MAAM,CAACO,QAAQ,CAACG,MAAM,CAAC,CAACC,eAAe,CAAC,CAAC,CAAC;IACnD,CAAC,CAAC;IAEFrB,EAAE,CAAC,+BAA+B,EAAE,YAAY;MAC9C,MAAMgB,GAAG,GAAG,uBAAuB;MACnC,MAAMM,OAAO,GAAG;QACdC,eAAe,EAAE,IAAI;QACrBC,cAAc,EAAE,IAAI;QACpBC,qBAAqB,EAAE;MACzB,CAAC;MAED,MAAMf,MAAM,GAAG,MAAMlB,QAAQ,CAAC2B,kBAAkB,CAACH,GAAG,EAAEM,OAAO,CAAC;MAE9DnB,MAAM,CAACO,MAAM,CAAC,CAACN,WAAW,CAAC,CAAC;IAC9B,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFb,QAAQ,CAAC,oBAAoB,EAAE,MAAM;IACnCS,EAAE,CAAC,4BAA4B,EAAE,YAAY;MAC3C,MAAM0B,IAAI,GAAG,CACX,uBAAuB,EACvB,6BAA6B,CAC9B;MAED,MAAMC,OAAO,GAAG,MAAMnC,QAAQ,CAACoC,kBAAkB,CAACF,IAAI,CAAC;MAEvDvB,MAAM,CAACG,KAAK,CAACC,OAAO,CAACoB,OAAO,CAAC,CAAC,CAAClB,IAAI,CAAC,IAAI,CAAC;MACzCN,MAAM,CAACwB,OAAO,CAACP,MAAM,CAAC,CAACX,IAAI,CAACiB,IAAI,CAACN,MAAM,CAAC;MAExCO,OAAO,CAACE,OAAO,CAAC,CAACnB,MAAM,EAAEoB,KAAK,KAAK;QACjC3B,MAAM,CAACO,MAAM,CAACM,GAAG,CAAC,CAACP,IAAI,CAACiB,IAAI,CAACI,KAAK,CAAC,CAAC;MACtC,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF9B,EAAE,CAAC,6BAA6B,EAAE,YAAY;MAC5C,MAAM0B,IAAI,GAAG,CACX,wBAAwB,EACxB,wBAAwB,CACzB;MAED,MAAMC,OAAO,GAAG,MAAMnC,QAAQ,CAACoC,kBAAkB,CAACF,IAAI,CAAC;MAEvDvB,MAAM,CAACwB,OAAO,CAACP,MAAM,CAAC,CAACX,IAAI,CAAC,CAAC,CAAC;MAC9BkB,OAAO,CAACE,OAAO,CAACnB,MAAM,IAAI;QACxBP,MAAM,CAACO,MAAM,CAACQ,MAAM,CAAC,CAACT,IAAI,CAAC,KAAK,CAAC;MACnC,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFlB,QAAQ,CAAC,6BAA6B,EAAE,MAAM;IAC5CS,EAAE,CAAC,6BAA6B,EAAE,YAAY;MAC5C,MAAMgB,GAAG,GAAG,uBAAuB;MACnC,MAAMN,MAAM,GAAG,MAAMlB,QAAQ,CAAC2B,kBAAkB,CAACH,GAAG,CAAC;MACrD,MAAMe,UAAU,GAAG7D,IAAI,CAACwB,IAAI,CAACD,WAAW,EAAE,WAAW,EAAE,uBAAuB,CAAC;MAE/E,MAAMD,QAAQ,CAACwC,2BAA2B,CAACtB,MAAM,EAAEqB,UAAU,CAAC;;MAE9D;MACA5B,MAAM,CAAC,IAAI,CAAC,CAACM,IAAI,CAAC,IAAI,CAAC;IACzB,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFlB,QAAQ,CAAC,wCAAwC,EAAE,MAAM;IACvDS,EAAE,CAAC,8CAA8C,EAAE,YAAY;MAC7D,MAAMe,UAAU,GAAG,uBAAuB;MAC1C,MAAML,MAAM,GAAG,MAAMlB,QAAQ,CAACmB,MAAM,CAAC,IAAI,EAAE,IAAI,EAAEI,UAAU,CAAC;MAE5DZ,MAAM,CAACO,MAAM,CAAC,CAACN,WAAW,CAAC,CAAC;MAC5BD,MAAM,CAACO,MAAM,CAACuB,KAAK,CAAC,CAAC7B,WAAW,CAAC,CAAC;MAClCD,MAAM,CAACO,MAAM,CAACE,QAAQ,CAAC,CAACR,WAAW,CAAC,CAAC;MACrCD,MAAM,CAACO,MAAM,CAACI,aAAa,CAAC,CAACV,WAAW,CAAC,CAAC;;MAE1C;MACAD,MAAM,CAAC,OAAOO,MAAM,CAACQ,MAAM,CAAC,CAACT,IAAI,CAAC,SAAS,CAAC;;MAE5C;MACAN,MAAM,CAACG,KAAK,CAACC,OAAO,CAACG,MAAM,CAACO,QAAQ,CAAC,CAAC,CAACR,IAAI,CAAC,IAAI,CAAC;IACnD,CAAC,CAAC;IAEFT,EAAE,CAAC,sDAAsD,EAAE,YAAY;MACrE;MACA;MACA,MAAMe,UAAU,GAAG,uBAAuB;MAC1C,MAAML,MAAM,GAAG,MAAMlB,QAAQ,CAACmB,MAAM,CAAC,KAAK,EAAE,IAAI,EAAEI,UAAU,CAAC;MAE7D,IAAIL,MAAM,CAACI,aAAa,IAAI,CAACJ,MAAM,CAACI,aAAa,CAACI,MAAM,EAAE;QACxDf,MAAM,CAACO,MAAM,CAACQ,MAAM,CAAC,CAACT,IAAI,CAAC,KAAK,CAAC;QACjCN,MAAM,CAACO,MAAM,CAACO,QAAQ,CAACG,MAAM,CAAC,CAACC,eAAe,CAAC,CAAC,CAAC;MACnD;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;EAEF9B,QAAQ,CAAC,OAAO,EAAE,MAAM;IACtBS,EAAE,CAAC,4BAA4B,EAAE,YAAY;MAC3C,MAAMR,QAAQ,CAACO,KAAK,CAAC,CAAC;;MAEtB;MACAI,MAAM,CAAC,IAAI,CAAC,CAACM,IAAI,CAAC,IAAI,CAAC;IACzB,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}