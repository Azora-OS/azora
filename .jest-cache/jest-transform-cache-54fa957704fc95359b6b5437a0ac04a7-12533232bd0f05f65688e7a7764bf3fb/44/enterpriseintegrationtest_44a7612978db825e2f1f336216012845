3c8bcd725785aa8e29da72ffaf0a8996
"use strict";

const request = require('supertest');
const app = require('../server');
describe('enterprise Integration Tests', () => {
  beforeAll(async () => {
    // Setup test database
  });
  afterAll(async () => {
    // Cleanup test database
  });
  describe('API Integration', () => {
    it('should handle concurrent requests', async () => {
      const promises = Array(10).fill().map(() => request(app).get('/health'));
      const responses = await Promise.all(promises);
      responses.forEach(res => {
        expect(res.status).toBe(200);
      });
    });
    it('should handle malformed requests gracefully', async () => {
      const res = await request(app).post('/api/test').send('invalid json').expect(400);
    });
    it('should enforce rate limiting', async () => {
      const promises = Array(200).fill().map(() => request(app).get('/health'));
      const responses = await Promise.all(promises);
      const rateLimited = responses.some(r => r.status === 429);
      expect(rateLimited).toBe(true);
    });
  });
  describe('Security Tests', () => {
    it('should have security headers', async () => {
      const res = await request(app).get('/health');
      expect(res.headers['x-content-type-options']).toBe('nosniff');
      expect(res.headers['x-frame-options']).toBe('DENY');
    });
    it('should sanitize XSS attempts', async () => {
      const malicious = '<script>alert("xss")</script>';
      const res = await request(app).post('/api/test').send({
        data: malicious
      });
      expect(JSON.stringify(res.body)).not.toContain('<script>');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1ZXN0IiwicmVxdWlyZSIsImFwcCIsImRlc2NyaWJlIiwiYmVmb3JlQWxsIiwiYWZ0ZXJBbGwiLCJpdCIsInByb21pc2VzIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiZ2V0IiwicmVzcG9uc2VzIiwiUHJvbWlzZSIsImFsbCIsImZvckVhY2giLCJyZXMiLCJleHBlY3QiLCJzdGF0dXMiLCJ0b0JlIiwicG9zdCIsInNlbmQiLCJyYXRlTGltaXRlZCIsInNvbWUiLCJyIiwiaGVhZGVycyIsIm1hbGljaW91cyIsImRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwiYm9keSIsIm5vdCIsInRvQ29udGFpbiJdLCJzb3VyY2VzIjpbImVudGVycHJpc2UuaW50ZWdyYXRpb24udGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCByZXF1ZXN0ID0gcmVxdWlyZSgnc3VwZXJ0ZXN0Jyk7XG5jb25zdCBhcHAgPSByZXF1aXJlKCcuLi9zZXJ2ZXInKTtcblxuZGVzY3JpYmUoJ2VudGVycHJpc2UgSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gU2V0dXAgdGVzdCBkYXRhYmFzZVxuICB9KTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ2xlYW51cCB0ZXN0IGRhdGFiYXNlXG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBUEkgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29uY3VycmVudCByZXF1ZXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHByb21pc2VzID0gQXJyYXkoMTApLmZpbGwoKS5tYXAoKCkgPT4gXG4gICAgICAgIHJlcXVlc3QoYXBwKS5nZXQoJy9oZWFsdGgnKVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgICAgIHJlc3BvbnNlcy5mb3JFYWNoKHJlcyA9PiB7XG4gICAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1hbGZvcm1lZCByZXF1ZXN0cyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5wb3N0KCcvYXBpL3Rlc3QnKVxuICAgICAgICAuc2VuZCgnaW52YWxpZCBqc29uJylcbiAgICAgICAgLmV4cGVjdCg0MDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbmZvcmNlIHJhdGUgbGltaXRpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9taXNlcyA9IEFycmF5KDIwMCkuZmlsbCgpLm1hcCgoKSA9PiBcbiAgICAgICAgcmVxdWVzdChhcHApLmdldCgnL2hlYWx0aCcpXG4gICAgICApO1xuICAgICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgICAgY29uc3QgcmF0ZUxpbWl0ZWQgPSByZXNwb25zZXMuc29tZShyID0+IHIuc3RhdHVzID09PSA0MjkpO1xuICAgICAgZXhwZWN0KHJhdGVMaW1pdGVkKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VjdXJpdHkgVGVzdHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHNlY3VyaXR5IGhlYWRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0KGFwcCkuZ2V0KCcvaGVhbHRoJyk7XG4gICAgICBleHBlY3QocmVzLmhlYWRlcnNbJ3gtY29udGVudC10eXBlLW9wdGlvbnMnXSkudG9CZSgnbm9zbmlmZicpO1xuICAgICAgZXhwZWN0KHJlcy5oZWFkZXJzWyd4LWZyYW1lLW9wdGlvbnMnXSkudG9CZSgnREVOWScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBYU1MgYXR0ZW1wdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtYWxpY2lvdXMgPSAnPHNjcmlwdD5hbGVydChcInhzc1wiKTwvc2NyaXB0Pic7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLnBvc3QoJy9hcGkvdGVzdCcpXG4gICAgICAgIC5zZW5kKHsgZGF0YTogbWFsaWNpb3VzIH0pO1xuICAgICAgZXhwZWN0KEpTT04uc3RyaW5naWZ5KHJlcy5ib2R5KSkubm90LnRvQ29udGFpbignPHNjcmlwdD4nKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQ3BDLE1BQU1DLEdBQUcsR0FBR0QsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUVoQ0UsUUFBUSxDQUFDLDhCQUE4QixFQUFFLE1BQU07RUFDN0NDLFNBQVMsQ0FBQyxZQUFZO0lBQ3BCO0VBQUEsQ0FDRCxDQUFDO0VBRUZDLFFBQVEsQ0FBQyxZQUFZO0lBQ25CO0VBQUEsQ0FDRCxDQUFDO0VBRUZGLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxNQUFNO0lBQ2hDRyxFQUFFLENBQUMsbUNBQW1DLEVBQUUsWUFBWTtNQUNsRCxNQUFNQyxRQUFRLEdBQUdDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLE1BQ3BDVixPQUFPLENBQUNFLEdBQUcsQ0FBQyxDQUFDUyxHQUFHLENBQUMsU0FBUyxDQUM1QixDQUFDO01BQ0QsTUFBTUMsU0FBUyxHQUFHLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDUCxRQUFRLENBQUM7TUFDN0NLLFNBQVMsQ0FBQ0csT0FBTyxDQUFDQyxHQUFHLElBQUk7UUFDdkJDLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDRSxNQUFNLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEdBQUcsQ0FBQztNQUM5QixDQUFDLENBQUM7SUFDSixDQUFDLENBQUM7SUFFRmIsRUFBRSxDQUFDLDZDQUE2QyxFQUFFLFlBQVk7TUFDNUQsTUFBTVUsR0FBRyxHQUFHLE1BQU1oQixPQUFPLENBQUNFLEdBQUcsQ0FBQyxDQUMzQmtCLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FDakJDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FDcEJKLE1BQU0sQ0FBQyxHQUFHLENBQUM7SUFDaEIsQ0FBQyxDQUFDO0lBRUZYLEVBQUUsQ0FBQyw4QkFBOEIsRUFBRSxZQUFZO01BQzdDLE1BQU1DLFFBQVEsR0FBR0MsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxHQUFHLENBQUMsTUFDckNWLE9BQU8sQ0FBQ0UsR0FBRyxDQUFDLENBQUNTLEdBQUcsQ0FBQyxTQUFTLENBQzVCLENBQUM7TUFDRCxNQUFNQyxTQUFTLEdBQUcsTUFBTUMsT0FBTyxDQUFDQyxHQUFHLENBQUNQLFFBQVEsQ0FBQztNQUM3QyxNQUFNZSxXQUFXLEdBQUdWLFNBQVMsQ0FBQ1csSUFBSSxDQUFDQyxDQUFDLElBQUlBLENBQUMsQ0FBQ04sTUFBTSxLQUFLLEdBQUcsQ0FBQztNQUN6REQsTUFBTSxDQUFDSyxXQUFXLENBQUMsQ0FBQ0gsSUFBSSxDQUFDLElBQUksQ0FBQztJQUNoQyxDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7RUFFRmhCLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxNQUFNO0lBQy9CRyxFQUFFLENBQUMsOEJBQThCLEVBQUUsWUFBWTtNQUM3QyxNQUFNVSxHQUFHLEdBQUcsTUFBTWhCLE9BQU8sQ0FBQ0UsR0FBRyxDQUFDLENBQUNTLEdBQUcsQ0FBQyxTQUFTLENBQUM7TUFDN0NNLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDUyxPQUFPLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDTixJQUFJLENBQUMsU0FBUyxDQUFDO01BQzdERixNQUFNLENBQUNELEdBQUcsQ0FBQ1MsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQ04sSUFBSSxDQUFDLE1BQU0sQ0FBQztJQUNyRCxDQUFDLENBQUM7SUFFRmIsRUFBRSxDQUFDLDhCQUE4QixFQUFFLFlBQVk7TUFDN0MsTUFBTW9CLFNBQVMsR0FBRywrQkFBK0I7TUFDakQsTUFBTVYsR0FBRyxHQUFHLE1BQU1oQixPQUFPLENBQUNFLEdBQUcsQ0FBQyxDQUMzQmtCLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FDakJDLElBQUksQ0FBQztRQUFFTSxJQUFJLEVBQUVEO01BQVUsQ0FBQyxDQUFDO01BQzVCVCxNQUFNLENBQUNXLElBQUksQ0FBQ0MsU0FBUyxDQUFDYixHQUFHLENBQUNjLElBQUksQ0FBQyxDQUFDLENBQUNDLEdBQUcsQ0FBQ0MsU0FBUyxDQUFDLFVBQVUsQ0FBQztJQUM1RCxDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=