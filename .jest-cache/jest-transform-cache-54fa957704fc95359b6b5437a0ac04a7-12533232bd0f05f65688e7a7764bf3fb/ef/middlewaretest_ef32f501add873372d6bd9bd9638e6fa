6e965f1919166328597e8a2122213047
"use strict";

var _orchestrator = require("../orchestrator");
var _constitutionalMiddleware = require("../middleware/constitutional-middleware");
/**
 * Constitutional AI Middleware Tests
 * Integration tests for API Gateway middleware
 */

describe('Constitutional AI Middleware', () => {
  let orchestrator;
  let middleware;
  let mockReq;
  let mockRes;
  let mockNext;
  beforeEach(() => {
    orchestrator = new _orchestrator.ConstitutionalOrchestrator({
      ubuntuEnabled: true,
      biasDetectionEnabled: true,
      privacyFilterEnabled: true,
      harmPreventionEnabled: true,
      auditLoggingEnabled: false
    });
    middleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
      enabled: true,
      skipPaths: ['/health', '/metrics'],
      skipMethods: ['OPTIONS', 'HEAD'],
      onViolation: 'block',
      includeMetadata: true
    });
    mockReq = {
      path: '/api/generate',
      method: 'POST',
      body: {}
    };
    mockRes = {
      status: jest.fn().mockReturnThis(),
      json: jest.fn().mockReturnThis(),
      send: jest.fn().mockReturnThis()
    };
    mockNext = jest.fn();
  });
  describe('Middleware Initialization', () => {
    it('should create middleware with default configuration', () => {
      const defaultMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator);
      expect(defaultMiddleware).toBeDefined();
      expect(typeof defaultMiddleware).toBe('function');
    });
    it('should create middleware with custom configuration', () => {
      const customMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        enabled: false,
        onViolation: 'warn'
      });
      expect(customMiddleware).toBeDefined();
    });
  });
  describe('Middleware Execution', () => {
    it('should call next() when middleware is disabled', async () => {
      const disabledMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        enabled: false
      });
      await disabledMiddleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should call next() for skipped paths', async () => {
      mockReq.path = '/health';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should call next() for skipped methods', async () => {
      mockReq.method = 'OPTIONS';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should call next() for non-AI responses', async () => {
      mockReq.path = '/api/data';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should intercept and validate AI responses', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
      expect(mockRes.json).toBeDefined();
    });
  });
  describe('Response Validation', () => {
    it('should validate response with AI output field', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      const responseBody = {
        output: 'This is a community-focused solution that benefits everyone.'
      };

      // Simulate calling res.json with AI output
      if (typeof mockRes.json === 'function') {
        mockRes.json(responseBody);
      }
      expect(mockNext).toHaveBeenCalled();
    });
    it('should validate response with response field', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      const responseBody = {
        response: 'This is a community-focused solution that benefits everyone.'
      };
      if (typeof mockRes.json === 'function') {
        mockRes.json(responseBody);
      }
      expect(mockNext).toHaveBeenCalled();
    });
    it('should validate response with message field', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      const responseBody = {
        message: 'This is a community-focused solution that benefits everyone.'
      };
      if (typeof mockRes.json === 'function') {
        mockRes.json(responseBody);
      }
      expect(mockNext).toHaveBeenCalled();
    });
    it('should validate response with content field', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      const responseBody = {
        content: 'This is a community-focused solution that benefits everyone.'
      };
      if (typeof mockRes.json === 'function') {
        mockRes.json(responseBody);
      }
      expect(mockNext).toHaveBeenCalled();
    });
  });
  describe('Violation Handling', () => {
    it('should block response on violation when configured', async () => {
      const blockMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        onViolation: 'block'
      });
      mockReq.path = '/api/generate';
      await blockMiddleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should warn on violation when configured', async () => {
      const warnMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        onViolation: 'warn'
      });
      mockReq.path = '/api/generate';
      await warnMiddleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should log violation when configured', async () => {
      const logMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        onViolation: 'log'
      });
      mockReq.path = '/api/generate';
      await logMiddleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
  });
  describe('Metadata Inclusion', () => {
    it('should include validation metadata when configured', async () => {
      const metadataMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        includeMetadata: true
      });
      mockReq.path = '/api/generate';
      await metadataMiddleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should exclude validation metadata when configured', async () => {
      const noMetadataMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        includeMetadata: false
      });
      mockReq.path = '/api/generate';
      await noMetadataMiddleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
  });
  describe('Request Attachment', () => {
    it('should attach constitutional validation data to request', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should preserve original request properties', async () => {
      mockReq.path = '/api/generate';
      mockReq.body = {
        query: 'test'
      };
      await middleware(mockReq, mockRes, mockNext);
      expect(mockReq.body).toEqual({
        query: 'test'
      });
      expect(mockNext).toHaveBeenCalled();
    });
  });
  describe('Error Handling', () => {
    it('should handle validation errors gracefully', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should not crash on invalid response body', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should handle null response body', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      if (typeof mockRes.json === 'function') {
        mockRes.json(null);
      }
      expect(mockNext).toHaveBeenCalled();
    });
  });
  describe('Path Filtering', () => {
    it('should skip validation for health check endpoint', async () => {
      mockReq.path = '/health';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should skip validation for metrics endpoint', async () => {
      mockReq.path = '/metrics';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should validate non-skipped paths', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should support custom skip paths', async () => {
      const customMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        skipPaths: ['/custom', '/skip']
      });
      mockReq.path = '/custom';
      await customMiddleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
  });
  describe('Method Filtering', () => {
    it('should skip validation for OPTIONS method', async () => {
      mockReq.method = 'OPTIONS';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should skip validation for HEAD method', async () => {
      mockReq.method = 'HEAD';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should validate POST requests', async () => {
      mockReq.method = 'POST';
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should validate GET requests', async () => {
      mockReq.method = 'GET';
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should support custom skip methods', async () => {
      const customMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {
        skipMethods: ['PATCH', 'DELETE']
      });
      mockReq.method = 'PATCH';
      await customMiddleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
  });
  describe('Integration Scenarios', () => {
    it('should validate compliant AI output', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
    it('should handle multiple sequential requests', async () => {
      for (let i = 0; i < 3; i++) {
        mockReq.path = '/api/generate';
        mockNext.mockClear();
        await middleware(mockReq, mockRes, mockNext);
        expect(mockNext).toHaveBeenCalled();
      }
    });
    it('should maintain state across requests', async () => {
      mockReq.path = '/api/generate';
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();

      // Second request should work independently
      mockNext.mockClear();
      await middleware(mockReq, mockRes, mockNext);
      expect(mockNext).toHaveBeenCalled();
    });
  });
  describe('Configuration Validation', () => {
    it('should accept valid configuration', () => {
      const validConfig = {
        enabled: true,
        skipPaths: ['/health'],
        skipMethods: ['OPTIONS'],
        onViolation: 'block',
        includeMetadata: true
      };
      const testMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, validConfig);
      expect(testMiddleware).toBeDefined();
    });
    it('should work with partial configuration', () => {
      const partialConfig = {
        enabled: true
      };
      const testMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, partialConfig);
      expect(testMiddleware).toBeDefined();
    });
    it('should work with empty configuration', () => {
      const testMiddleware = (0, _constitutionalMiddleware.createConstitutionalMiddleware)(orchestrator, {});
      expect(testMiddleware).toBeDefined();
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfb3JjaGVzdHJhdG9yIiwicmVxdWlyZSIsIl9jb25zdGl0dXRpb25hbE1pZGRsZXdhcmUiLCJkZXNjcmliZSIsIm9yY2hlc3RyYXRvciIsIm1pZGRsZXdhcmUiLCJtb2NrUmVxIiwibW9ja1JlcyIsIm1vY2tOZXh0IiwiYmVmb3JlRWFjaCIsIkNvbnN0aXR1dGlvbmFsT3JjaGVzdHJhdG9yIiwidWJ1bnR1RW5hYmxlZCIsImJpYXNEZXRlY3Rpb25FbmFibGVkIiwicHJpdmFjeUZpbHRlckVuYWJsZWQiLCJoYXJtUHJldmVudGlvbkVuYWJsZWQiLCJhdWRpdExvZ2dpbmdFbmFibGVkIiwiY3JlYXRlQ29uc3RpdHV0aW9uYWxNaWRkbGV3YXJlIiwiZW5hYmxlZCIsInNraXBQYXRocyIsInNraXBNZXRob2RzIiwib25WaW9sYXRpb24iLCJpbmNsdWRlTWV0YWRhdGEiLCJwYXRoIiwibWV0aG9kIiwiYm9keSIsInN0YXR1cyIsImplc3QiLCJmbiIsIm1vY2tSZXR1cm5UaGlzIiwianNvbiIsInNlbmQiLCJpdCIsImRlZmF1bHRNaWRkbGV3YXJlIiwiZXhwZWN0IiwidG9CZURlZmluZWQiLCJ0b0JlIiwiY3VzdG9tTWlkZGxld2FyZSIsImRpc2FibGVkTWlkZGxld2FyZSIsInRvSGF2ZUJlZW5DYWxsZWQiLCJyZXNwb25zZUJvZHkiLCJvdXRwdXQiLCJyZXNwb25zZSIsIm1lc3NhZ2UiLCJjb250ZW50IiwiYmxvY2tNaWRkbGV3YXJlIiwid2Fybk1pZGRsZXdhcmUiLCJsb2dNaWRkbGV3YXJlIiwibWV0YWRhdGFNaWRkbGV3YXJlIiwibm9NZXRhZGF0YU1pZGRsZXdhcmUiLCJxdWVyeSIsInRvRXF1YWwiLCJpIiwibW9ja0NsZWFyIiwidmFsaWRDb25maWciLCJ0ZXN0TWlkZGxld2FyZSIsInBhcnRpYWxDb25maWciXSwic291cmNlcyI6WyJtaWRkbGV3YXJlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvbnN0aXR1dGlvbmFsIEFJIE1pZGRsZXdhcmUgVGVzdHNcclxuICogSW50ZWdyYXRpb24gdGVzdHMgZm9yIEFQSSBHYXRld2F5IG1pZGRsZXdhcmVcclxuICovXHJcblxyXG5pbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSwgTmV4dEZ1bmN0aW9uIH0gZnJvbSAnZXhwcmVzcyc7XHJcbmltcG9ydCB7IENvbnN0aXR1dGlvbmFsT3JjaGVzdHJhdG9yIH0gZnJvbSAnLi4vb3JjaGVzdHJhdG9yJztcclxuaW1wb3J0IHsgY3JlYXRlQ29uc3RpdHV0aW9uYWxNaWRkbGV3YXJlLCBDb25zdGl0dXRpb25hbFJlcXVlc3QgfSBmcm9tICcuLi9taWRkbGV3YXJlL2NvbnN0aXR1dGlvbmFsLW1pZGRsZXdhcmUnO1xyXG5cclxuZGVzY3JpYmUoJ0NvbnN0aXR1dGlvbmFsIEFJIE1pZGRsZXdhcmUnLCAoKSA9PiB7XHJcbiAgbGV0IG9yY2hlc3RyYXRvcjogQ29uc3RpdHV0aW9uYWxPcmNoZXN0cmF0b3I7XHJcbiAgbGV0IG1pZGRsZXdhcmU6IGFueTtcclxuICBsZXQgbW9ja1JlcTogUGFydGlhbDxDb25zdGl0dXRpb25hbFJlcXVlc3Q+O1xyXG4gIGxldCBtb2NrUmVzOiBQYXJ0aWFsPFJlc3BvbnNlPjtcclxuICBsZXQgbW9ja05leHQ6IE5leHRGdW5jdGlvbjtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBvcmNoZXN0cmF0b3IgPSBuZXcgQ29uc3RpdHV0aW9uYWxPcmNoZXN0cmF0b3Ioe1xyXG4gICAgICB1YnVudHVFbmFibGVkOiB0cnVlLFxyXG4gICAgICBiaWFzRGV0ZWN0aW9uRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgcHJpdmFjeUZpbHRlckVuYWJsZWQ6IHRydWUsXHJcbiAgICAgIGhhcm1QcmV2ZW50aW9uRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgYXVkaXRMb2dnaW5nRW5hYmxlZDogZmFsc2VcclxuICAgIH0pO1xyXG5cclxuICAgIG1pZGRsZXdhcmUgPSBjcmVhdGVDb25zdGl0dXRpb25hbE1pZGRsZXdhcmUob3JjaGVzdHJhdG9yLCB7XHJcbiAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgIHNraXBQYXRoczogWycvaGVhbHRoJywgJy9tZXRyaWNzJ10sXHJcbiAgICAgIHNraXBNZXRob2RzOiBbJ09QVElPTlMnLCAnSEVBRCddLFxyXG4gICAgICBvblZpb2xhdGlvbjogJ2Jsb2NrJyxcclxuICAgICAgaW5jbHVkZU1ldGFkYXRhOiB0cnVlXHJcbiAgICB9KTtcclxuXHJcbiAgICBtb2NrUmVxID0ge1xyXG4gICAgICBwYXRoOiAnL2FwaS9nZW5lcmF0ZScsXHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBib2R5OiB7fVxyXG4gICAgfTtcclxuXHJcbiAgICBtb2NrUmVzID0ge1xyXG4gICAgICBzdGF0dXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxyXG4gICAgICBqc29uOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcclxuICAgICAgc2VuZDogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKClcclxuICAgIH07XHJcblxyXG4gICAgbW9ja05leHQgPSBqZXN0LmZuKCk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdNaWRkbGV3YXJlIEluaXRpYWxpemF0aW9uJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgbWlkZGxld2FyZSB3aXRoIGRlZmF1bHQgY29uZmlndXJhdGlvbicsICgpID0+IHtcclxuICAgICAgY29uc3QgZGVmYXVsdE1pZGRsZXdhcmUgPSBjcmVhdGVDb25zdGl0dXRpb25hbE1pZGRsZXdhcmUob3JjaGVzdHJhdG9yKTtcclxuICAgICAgZXhwZWN0KGRlZmF1bHRNaWRkbGV3YXJlKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QodHlwZW9mIGRlZmF1bHRNaWRkbGV3YXJlKS50b0JlKCdmdW5jdGlvbicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgbWlkZGxld2FyZSB3aXRoIGN1c3RvbSBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjdXN0b21NaWRkbGV3YXJlID0gY3JlYXRlQ29uc3RpdHV0aW9uYWxNaWRkbGV3YXJlKG9yY2hlc3RyYXRvciwge1xyXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgIG9uVmlvbGF0aW9uOiAnd2FybidcclxuICAgICAgfSk7XHJcbiAgICAgIGV4cGVjdChjdXN0b21NaWRkbGV3YXJlKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdNaWRkbGV3YXJlIEV4ZWN1dGlvbicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgY2FsbCBuZXh0KCkgd2hlbiBtaWRkbGV3YXJlIGlzIGRpc2FibGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBkaXNhYmxlZE1pZGRsZXdhcmUgPSBjcmVhdGVDb25zdGl0dXRpb25hbE1pZGRsZXdhcmUob3JjaGVzdHJhdG9yLCB7XHJcbiAgICAgICAgZW5hYmxlZDogZmFsc2VcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBhd2FpdCBkaXNhYmxlZE1pZGRsZXdhcmUobW9ja1JlcSBhcyBDb25zdGl0dXRpb25hbFJlcXVlc3QsIG1vY2tSZXMgYXMgUmVzcG9uc2UsIG1vY2tOZXh0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBjYWxsIG5leHQoKSBmb3Igc2tpcHBlZCBwYXRocycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5wYXRoID0gJy9oZWFsdGgnO1xyXG5cclxuICAgICAgYXdhaXQgbWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNhbGwgbmV4dCgpIGZvciBza2lwcGVkIG1ldGhvZHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXEubWV0aG9kID0gJ09QVElPTlMnO1xyXG5cclxuICAgICAgYXdhaXQgbWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNhbGwgbmV4dCgpIGZvciBub24tQUkgcmVzcG9uc2VzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2FwaS9kYXRhJztcclxuXHJcbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUobW9ja1JlcSBhcyBDb25zdGl0dXRpb25hbFJlcXVlc3QsIG1vY2tSZXMgYXMgUmVzcG9uc2UsIG1vY2tOZXh0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBpbnRlcmNlcHQgYW5kIHZhbGlkYXRlIEFJIHJlc3BvbnNlcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5wYXRoID0gJy9hcGkvZ2VuZXJhdGUnO1xyXG5cclxuICAgICAgYXdhaXQgbWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUmVzLmpzb24pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1Jlc3BvbnNlIFZhbGlkYXRpb24nLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHJlc3BvbnNlIHdpdGggQUkgb3V0cHV0IGZpZWxkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2FwaS9nZW5lcmF0ZSc7XHJcblxyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZUJvZHkgPSB7XHJcbiAgICAgICAgb3V0cHV0OiAnVGhpcyBpcyBhIGNvbW11bml0eS1mb2N1c2VkIHNvbHV0aW9uIHRoYXQgYmVuZWZpdHMgZXZlcnlvbmUuJ1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gU2ltdWxhdGUgY2FsbGluZyByZXMuanNvbiB3aXRoIEFJIG91dHB1dFxyXG4gICAgICBpZiAodHlwZW9mIG1vY2tSZXMuanNvbiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIG1vY2tSZXMuanNvbihyZXNwb25zZUJvZHkpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcmVzcG9uc2Ugd2l0aCByZXNwb25zZSBmaWVsZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5wYXRoID0gJy9hcGkvZ2VuZXJhdGUnO1xyXG5cclxuICAgICAgYXdhaXQgbWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2VCb2R5ID0ge1xyXG4gICAgICAgIHJlc3BvbnNlOiAnVGhpcyBpcyBhIGNvbW11bml0eS1mb2N1c2VkIHNvbHV0aW9uIHRoYXQgYmVuZWZpdHMgZXZlcnlvbmUuJ1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWYgKHR5cGVvZiBtb2NrUmVzLmpzb24gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBtb2NrUmVzLmpzb24ocmVzcG9uc2VCb2R5KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHJlc3BvbnNlIHdpdGggbWVzc2FnZSBmaWVsZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5wYXRoID0gJy9hcGkvZ2VuZXJhdGUnO1xyXG5cclxuICAgICAgYXdhaXQgbWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2VCb2R5ID0ge1xyXG4gICAgICAgIG1lc3NhZ2U6ICdUaGlzIGlzIGEgY29tbXVuaXR5LWZvY3VzZWQgc29sdXRpb24gdGhhdCBiZW5lZml0cyBldmVyeW9uZS4nXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBpZiAodHlwZW9mIG1vY2tSZXMuanNvbiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIG1vY2tSZXMuanNvbihyZXNwb25zZUJvZHkpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcmVzcG9uc2Ugd2l0aCBjb250ZW50IGZpZWxkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2FwaS9nZW5lcmF0ZSc7XHJcblxyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZUJvZHkgPSB7XHJcbiAgICAgICAgY29udGVudDogJ1RoaXMgaXMgYSBjb21tdW5pdHktZm9jdXNlZCBzb2x1dGlvbiB0aGF0IGJlbmVmaXRzIGV2ZXJ5b25lLidcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGlmICh0eXBlb2YgbW9ja1Jlcy5qc29uID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgbW9ja1Jlcy5qc29uKHJlc3BvbnNlQm9keSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdWaW9sYXRpb24gSGFuZGxpbmcnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGJsb2NrIHJlc3BvbnNlIG9uIHZpb2xhdGlvbiB3aGVuIGNvbmZpZ3VyZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJsb2NrTWlkZGxld2FyZSA9IGNyZWF0ZUNvbnN0aXR1dGlvbmFsTWlkZGxld2FyZShvcmNoZXN0cmF0b3IsIHtcclxuICAgICAgICBvblZpb2xhdGlvbjogJ2Jsb2NrJ1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvYXBpL2dlbmVyYXRlJztcclxuXHJcbiAgICAgIGF3YWl0IGJsb2NrTWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHdhcm4gb24gdmlvbGF0aW9uIHdoZW4gY29uZmlndXJlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3Qgd2Fybk1pZGRsZXdhcmUgPSBjcmVhdGVDb25zdGl0dXRpb25hbE1pZGRsZXdhcmUob3JjaGVzdHJhdG9yLCB7XHJcbiAgICAgICAgb25WaW9sYXRpb246ICd3YXJuJ1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvYXBpL2dlbmVyYXRlJztcclxuXHJcbiAgICAgIGF3YWl0IHdhcm5NaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgbG9nIHZpb2xhdGlvbiB3aGVuIGNvbmZpZ3VyZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGxvZ01pZGRsZXdhcmUgPSBjcmVhdGVDb25zdGl0dXRpb25hbE1pZGRsZXdhcmUob3JjaGVzdHJhdG9yLCB7XHJcbiAgICAgICAgb25WaW9sYXRpb246ICdsb2cnXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbW9ja1JlcS5wYXRoID0gJy9hcGkvZ2VuZXJhdGUnO1xyXG5cclxuICAgICAgYXdhaXQgbG9nTWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ01ldGFkYXRhIEluY2x1c2lvbicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSB2YWxpZGF0aW9uIG1ldGFkYXRhIHdoZW4gY29uZmlndXJlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgbWV0YWRhdGFNaWRkbGV3YXJlID0gY3JlYXRlQ29uc3RpdHV0aW9uYWxNaWRkbGV3YXJlKG9yY2hlc3RyYXRvciwge1xyXG4gICAgICAgIGluY2x1ZGVNZXRhZGF0YTogdHJ1ZVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvYXBpL2dlbmVyYXRlJztcclxuXHJcbiAgICAgIGF3YWl0IG1ldGFkYXRhTWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGV4Y2x1ZGUgdmFsaWRhdGlvbiBtZXRhZGF0YSB3aGVuIGNvbmZpZ3VyZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5vTWV0YWRhdGFNaWRkbGV3YXJlID0gY3JlYXRlQ29uc3RpdHV0aW9uYWxNaWRkbGV3YXJlKG9yY2hlc3RyYXRvciwge1xyXG4gICAgICAgIGluY2x1ZGVNZXRhZGF0YTogZmFsc2VcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2FwaS9nZW5lcmF0ZSc7XHJcblxyXG4gICAgICBhd2FpdCBub01ldGFkYXRhTWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1JlcXVlc3QgQXR0YWNobWVudCcsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgYXR0YWNoIGNvbnN0aXR1dGlvbmFsIHZhbGlkYXRpb24gZGF0YSB0byByZXF1ZXN0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2FwaS9nZW5lcmF0ZSc7XHJcblxyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcHJlc2VydmUgb3JpZ2luYWwgcmVxdWVzdCBwcm9wZXJ0aWVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2FwaS9nZW5lcmF0ZSc7XHJcbiAgICAgIG1vY2tSZXEuYm9keSA9IHsgcXVlcnk6ICd0ZXN0JyB9O1xyXG5cclxuICAgICAgYXdhaXQgbWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tSZXEuYm9keSkudG9FcXVhbCh7IHF1ZXJ5OiAndGVzdCcgfSk7XHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdFcnJvciBIYW5kbGluZycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHZhbGlkYXRpb24gZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvYXBpL2dlbmVyYXRlJztcclxuXHJcbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUobW9ja1JlcSBhcyBDb25zdGl0dXRpb25hbFJlcXVlc3QsIG1vY2tSZXMgYXMgUmVzcG9uc2UsIG1vY2tOZXh0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBub3QgY3Jhc2ggb24gaW52YWxpZCByZXNwb25zZSBib2R5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2FwaS9nZW5lcmF0ZSc7XHJcblxyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG51bGwgcmVzcG9uc2UgYm9keScsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5wYXRoID0gJy9hcGkvZ2VuZXJhdGUnO1xyXG5cclxuICAgICAgYXdhaXQgbWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgaWYgKHR5cGVvZiBtb2NrUmVzLmpzb24gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBtb2NrUmVzLmpzb24obnVsbCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdQYXRoIEZpbHRlcmluZycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgc2tpcCB2YWxpZGF0aW9uIGZvciBoZWFsdGggY2hlY2sgZW5kcG9pbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvaGVhbHRoJztcclxuXHJcbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUobW9ja1JlcSBhcyBDb25zdGl0dXRpb25hbFJlcXVlc3QsIG1vY2tSZXMgYXMgUmVzcG9uc2UsIG1vY2tOZXh0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBza2lwIHZhbGlkYXRpb24gZm9yIG1ldHJpY3MgZW5kcG9pbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvbWV0cmljcyc7XHJcblxyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgbm9uLXNraXBwZWQgcGF0aHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvYXBpL2dlbmVyYXRlJztcclxuXHJcbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUobW9ja1JlcSBhcyBDb25zdGl0dXRpb25hbFJlcXVlc3QsIG1vY2tSZXMgYXMgUmVzcG9uc2UsIG1vY2tOZXh0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBzdXBwb3J0IGN1c3RvbSBza2lwIHBhdGhzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjdXN0b21NaWRkbGV3YXJlID0gY3JlYXRlQ29uc3RpdHV0aW9uYWxNaWRkbGV3YXJlKG9yY2hlc3RyYXRvciwge1xyXG4gICAgICAgIHNraXBQYXRoczogWycvY3VzdG9tJywgJy9za2lwJ11cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2N1c3RvbSc7XHJcblxyXG4gICAgICBhd2FpdCBjdXN0b21NaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnTWV0aG9kIEZpbHRlcmluZycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgc2tpcCB2YWxpZGF0aW9uIGZvciBPUFRJT05TIG1ldGhvZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5tZXRob2QgPSAnT1BUSU9OUyc7XHJcblxyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgc2tpcCB2YWxpZGF0aW9uIGZvciBIRUFEIG1ldGhvZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5tZXRob2QgPSAnSEVBRCc7XHJcblxyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgUE9TVCByZXF1ZXN0cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5tZXRob2QgPSAnUE9TVCc7XHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvYXBpL2dlbmVyYXRlJztcclxuXHJcbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUobW9ja1JlcSBhcyBDb25zdGl0dXRpb25hbFJlcXVlc3QsIG1vY2tSZXMgYXMgUmVzcG9uc2UsIG1vY2tOZXh0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBHRVQgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXEubWV0aG9kID0gJ0dFVCc7XHJcbiAgICAgIG1vY2tSZXEucGF0aCA9ICcvYXBpL2dlbmVyYXRlJztcclxuXHJcbiAgICAgIGF3YWl0IG1pZGRsZXdhcmUobW9ja1JlcSBhcyBDb25zdGl0dXRpb25hbFJlcXVlc3QsIG1vY2tSZXMgYXMgUmVzcG9uc2UsIG1vY2tOZXh0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBzdXBwb3J0IGN1c3RvbSBza2lwIG1ldGhvZHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGN1c3RvbU1pZGRsZXdhcmUgPSBjcmVhdGVDb25zdGl0dXRpb25hbE1pZGRsZXdhcmUob3JjaGVzdHJhdG9yLCB7XHJcbiAgICAgICAgc2tpcE1ldGhvZHM6IFsnUEFUQ0gnLCAnREVMRVRFJ11cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrUmVxLm1ldGhvZCA9ICdQQVRDSCc7XHJcblxyXG4gICAgICBhd2FpdCBjdXN0b21NaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnSW50ZWdyYXRpb24gU2NlbmFyaW9zJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjb21wbGlhbnQgQUkgb3V0cHV0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxLnBhdGggPSAnL2FwaS9nZW5lcmF0ZSc7XHJcblxyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG11bHRpcGxlIHNlcXVlbnRpYWwgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzsgaSsrKSB7XHJcbiAgICAgICAgbW9ja1JlcS5wYXRoID0gJy9hcGkvZ2VuZXJhdGUnO1xyXG4gICAgICAgIG1vY2tOZXh0Lm1vY2tDbGVhcigpO1xyXG5cclxuICAgICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICAgIGV4cGVjdChtb2NrTmV4dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIG1haW50YWluIHN0YXRlIGFjcm9zcyByZXF1ZXN0cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcS5wYXRoID0gJy9hcGkvZ2VuZXJhdGUnO1xyXG5cclxuICAgICAgYXdhaXQgbWlkZGxld2FyZShtb2NrUmVxIGFzIENvbnN0aXR1dGlvbmFsUmVxdWVzdCwgbW9ja1JlcyBhcyBSZXNwb25zZSwgbW9ja05leHQpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcblxyXG4gICAgICAvLyBTZWNvbmQgcmVxdWVzdCBzaG91bGQgd29yayBpbmRlcGVuZGVudGx5XHJcbiAgICAgIG1vY2tOZXh0Lm1vY2tDbGVhcigpO1xyXG4gICAgICBhd2FpdCBtaWRkbGV3YXJlKG1vY2tSZXEgYXMgQ29uc3RpdHV0aW9uYWxSZXF1ZXN0LCBtb2NrUmVzIGFzIFJlc3BvbnNlLCBtb2NrTmV4dCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja05leHQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnQ29uZmlndXJhdGlvbiBWYWxpZGF0aW9uJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBhY2NlcHQgdmFsaWQgY29uZmlndXJhdGlvbicsICgpID0+IHtcclxuICAgICAgY29uc3QgdmFsaWRDb25maWcgPSB7XHJcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICBza2lwUGF0aHM6IFsnL2hlYWx0aCddLFxyXG4gICAgICAgIHNraXBNZXRob2RzOiBbJ09QVElPTlMnXSxcclxuICAgICAgICBvblZpb2xhdGlvbjogJ2Jsb2NrJyBhcyBjb25zdCxcclxuICAgICAgICBpbmNsdWRlTWV0YWRhdGE6IHRydWVcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHRlc3RNaWRkbGV3YXJlID0gY3JlYXRlQ29uc3RpdHV0aW9uYWxNaWRkbGV3YXJlKG9yY2hlc3RyYXRvciwgdmFsaWRDb25maWcpO1xyXG4gICAgICBleHBlY3QodGVzdE1pZGRsZXdhcmUpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHdvcmsgd2l0aCBwYXJ0aWFsIGNvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHBhcnRpYWxDb25maWcgPSB7XHJcbiAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgdGVzdE1pZGRsZXdhcmUgPSBjcmVhdGVDb25zdGl0dXRpb25hbE1pZGRsZXdhcmUob3JjaGVzdHJhdG9yLCBwYXJ0aWFsQ29uZmlnKTtcclxuICAgICAgZXhwZWN0KHRlc3RNaWRkbGV3YXJlKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB3b3JrIHdpdGggZW1wdHkgY29uZmlndXJhdGlvbicsICgpID0+IHtcclxuICAgICAgY29uc3QgdGVzdE1pZGRsZXdhcmUgPSBjcmVhdGVDb25zdGl0dXRpb25hbE1pZGRsZXdhcmUob3JjaGVzdHJhdG9yLCB7fSk7XHJcbiAgICAgIGV4cGVjdCh0ZXN0TWlkZGxld2FyZSkudG9CZURlZmluZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sIm1hcHBpbmdzIjoiOztBQU1BLElBQUFBLGFBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLHlCQUFBLEdBQUFELE9BQUE7QUFQQTtBQUNBO0FBQ0E7QUFDQTs7QUFNQUUsUUFBUSxDQUFDLDhCQUE4QixFQUFFLE1BQU07RUFDN0MsSUFBSUMsWUFBd0M7RUFDNUMsSUFBSUMsVUFBZTtFQUNuQixJQUFJQyxPQUF1QztFQUMzQyxJQUFJQyxPQUEwQjtFQUM5QixJQUFJQyxRQUFzQjtFQUUxQkMsVUFBVSxDQUFDLE1BQU07SUFDZkwsWUFBWSxHQUFHLElBQUlNLHdDQUEwQixDQUFDO01BQzVDQyxhQUFhLEVBQUUsSUFBSTtNQUNuQkMsb0JBQW9CLEVBQUUsSUFBSTtNQUMxQkMsb0JBQW9CLEVBQUUsSUFBSTtNQUMxQkMscUJBQXFCLEVBQUUsSUFBSTtNQUMzQkMsbUJBQW1CLEVBQUU7SUFDdkIsQ0FBQyxDQUFDO0lBRUZWLFVBQVUsR0FBRyxJQUFBVyx3REFBOEIsRUFBQ1osWUFBWSxFQUFFO01BQ3hEYSxPQUFPLEVBQUUsSUFBSTtNQUNiQyxTQUFTLEVBQUUsQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDO01BQ2xDQyxXQUFXLEVBQUUsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDO01BQ2hDQyxXQUFXLEVBQUUsT0FBTztNQUNwQkMsZUFBZSxFQUFFO0lBQ25CLENBQUMsQ0FBQztJQUVGZixPQUFPLEdBQUc7TUFDUmdCLElBQUksRUFBRSxlQUFlO01BQ3JCQyxNQUFNLEVBQUUsTUFBTTtNQUNkQyxJQUFJLEVBQUUsQ0FBQztJQUNULENBQUM7SUFFRGpCLE9BQU8sR0FBRztNQUNSa0IsTUFBTSxFQUFFQyxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGNBQWMsQ0FB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