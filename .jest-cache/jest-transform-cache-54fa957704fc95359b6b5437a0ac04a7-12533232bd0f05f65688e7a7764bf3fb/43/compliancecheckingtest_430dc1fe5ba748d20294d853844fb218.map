{"version":3,"names":["request","require","express","createTestApp","app","use","json","post","req","res","service","standards","body","status","error","complianceCheck","checkId","Date","now","compliant","violations","score","timestamp","toISOString","get","overallCompliance","services","lastAudit","describe","beforeEach","it","response","send","expect","toBe","toHaveProperty","toEqual","toBeGreaterThanOrEqual","toBeLessThanOrEqual","Array","isArray"],"sources":["compliance-checking.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\n\r\nfunction createTestApp() {\r\n  const app = express();\r\n  app.use(express.json());\r\n\r\n  app.post('/api/security/check-compliance', (req, res) => {\r\n    const { service, standards } = req.body;\r\n\r\n    if (!service) {\r\n      return res.status(400).json({ error: 'Service identifier is required' });\r\n    }\r\n\r\n    const complianceCheck = {\r\n      checkId: `comp_${Date.now()}`,\r\n      service,\r\n      standards: standards || ['GDPR', 'SOC2'],\r\n      compliant: true,\r\n      violations: [],\r\n      score: 95,\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    res.json(complianceCheck);\r\n  });\r\n\r\n  app.get('/api/security/compliance-status', (req, res) => {\r\n    res.json({\r\n      overallCompliance: 'compliant',\r\n      services: [],\r\n      lastAudit: new Date().toISOString()\r\n    });\r\n  });\r\n\r\n  return app;\r\n}\r\n\r\ndescribe('Azora Aegis - Compliance Checking Tests', () => {\r\n  let app;\r\n\r\n  beforeEach(() => {\r\n    app = createTestApp();\r\n  });\r\n\r\n  describe('POST /api/security/check-compliance', () => {\r\n    it('should check service compliance', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/check-compliance')\r\n        .send({\r\n          service: 'payment-service',\r\n          standards: ['PCI-DSS', 'GDPR']\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('checkId');\r\n      expect(response.body.service).toBe('payment-service');\r\n      expect(response.body.standards).toEqual(['PCI-DSS', 'GDPR']);\r\n    });\r\n\r\n    it('should return error when service is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/check-compliance')\r\n        .send({ standards: ['GDPR'] });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Service identifier is required');\r\n    });\r\n\r\n    it('should default to standard compliance checks', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/check-compliance')\r\n        .send({ service: 'auth-service' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.standards).toEqual(['GDPR', 'SOC2']);\r\n    });\r\n\r\n    it('should include compliance score', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/check-compliance')\r\n        .send({ service: 'api-gateway' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('score');\r\n      expect(typeof response.body.score).toBe('number');\r\n      expect(response.body.score).toBeGreaterThanOrEqual(0);\r\n      expect(response.body.score).toBeLessThanOrEqual(100);\r\n    });\r\n\r\n    it('should report violations if any', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/check-compliance')\r\n        .send({ service: 'test-service' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('violations');\r\n      expect(Array.isArray(response.body.violations)).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/security/compliance-status', () => {\r\n    it('should return overall compliance status', async () => {\r\n      const response = await request(app)\r\n        .get('/api/security/compliance-status');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('overallCompliance');\r\n      expect(response.body).toHaveProperty('services');\r\n      expect(response.body).toHaveProperty('lastAudit');\r\n    });\r\n  });\r\n});\r\n"],"mappings":";;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;AACpC,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAS,CAAC;AAElC,SAASE,aAAaA,CAAA,EAAG;EACvB,MAAMC,GAAG,GAAGF,OAAO,CAAC,CAAC;EACrBE,GAAG,CAACC,GAAG,CAACH,OAAO,CAACI,IAAI,CAAC,CAAC,CAAC;EAEvBF,GAAG,CAACG,IAAI,CAAC,gCAAgC,EAAE,CAACC,GAAG,EAAEC,GAAG,KAAK;IACvD,MAAM;MAAEC,OAAO;MAAEC;IAAU,CAAC,GAAGH,GAAG,CAACI,IAAI;IAEvC,IAAI,CAACF,OAAO,EAAE;MACZ,OAAOD,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACP,IAAI,CAAC;QAAEQ,KAAK,EAAE;MAAiC,CAAC,CAAC;IAC1E;IAEA,MAAMC,eAAe,GAAG;MACtBC,OAAO,EAAE,QAAQC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;MAC7BR,OAAO;MACPC,SAAS,EAAEA,SAAS,IAAI,CAAC,MAAM,EAAE,MAAM,CAAC;MACxCQ,SAAS,EAAE,IAAI;MACfC,UAAU,EAAE,EAAE;MACdC,KAAK,EAAE,EAAE;MACTC,SAAS,EAAE,IAAIL,IAAI,CAAC,CAAC,CAACM,WAAW,CAAC;IACpC,CAAC;IAEDd,GAAG,CAACH,IAAI,CAACS,eAAe,CAAC;EAC3B,CAAC,CAAC;EAEFX,GAAG,CAACoB,GAAG,CAAC,iCAAiC,EAAE,CAAChB,GAAG,EAAEC,GAAG,KAAK;IACvDA,GAAG,CAACH,IAAI,CAAC;MACPmB,iBAAiB,EAAE,WAAW;MAC9BC,QAAQ,EAAE,EAAE;MACZC,SAAS,EAAE,IAAIV,IAAI,CAAC,CAAC,CAACM,WAAW,CAAC;IACpC,CAAC,CAAC;EACJ,CAAC,CAAC;EAEF,OAAOnB,GAAG;AACZ;AAEAwB,QAAQ,CAAC,yCAAyC,EAAE,MAAM;EACxD,IAAIxB,GAAG;EAEPyB,UAAU,CAAC,MAAM;IACfzB,GAAG,GAAGD,aAAa,CAAC,CAAC;EACvB,CAAC,CAAC;EAEFyB,QAAQ,CAAC,qCAAqC,EAAE,MAAM;IACpDE,EAAE,CAAC,iCAAiC,EAAE,YAAY;MAChD,MAAMC,QAAQ,GAAG,MAAM/B,OAAO,CAACI,GAAG,CAAC,CAChCG,IAAI,CAAC,gCAAgC,CAAC,CACtCyB,IAAI,CAAC;QACJtB,OAAO,EAAE,iBAAiB;QAC1BC,SAAS,EAAE,CAAC,SAAS,EAAE,MAAM;MAC/B,CAAC,CAAC;MAEJsB,MAAM,CAACF,QAAQ,CAAClB,MAAM,CAAC,CAACqB,IAAI,CAAC,GAAG,CAAC;MACjCD,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAAC,CAACuB,cAAc,CAAC,SAAS,CAAC;MAC/CF,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAACF,OAAO,CAAC,CAACwB,IAAI,CAAC,iBAAiB,CAAC;MACrDD,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAACD,SAAS,CAAC,CAACyB,OAAO,CAAC,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;IAC9D,CAAC,CAAC;IAEFN,EAAE,CAAC,6CAA6C,EAAE,YAAY;MAC5D,MAAMC,QAAQ,GAAG,MAAM/B,OAAO,CAACI,GAAG,CAAC,CAChCG,IAAI,CAAC,gCAAgC,CAAC,CACtCyB,IAAI,CAAC;QAAErB,SAAS,EAAE,CAAC,MAAM;MAAE,CAAC,CAAC;MAEhCsB,MAAM,CAACF,QAAQ,CAAClB,MAAM,CAAC,CAACqB,IAAI,CAAC,GAAG,CAAC;MACjCD,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAACE,KAAK,CAAC,CAACoB,IAAI,CAAC,gCAAgC,CAAC;IACpE,CAAC,CAAC;IAEFJ,EAAE,CAAC,8CAA8C,EAAE,YAAY;MAC7D,MAAMC,QAAQ,GAAG,MAAM/B,OAAO,CAACI,GAAG,CAAC,CAChCG,IAAI,CAAC,gCAAgC,CAAC,CACtCyB,IAAI,CAAC;QAAEtB,OAAO,EAAE;MAAe,CAAC,CAAC;MAEpCuB,MAAM,CAACF,QAAQ,CAAClB,MAAM,CAAC,CAACqB,IAAI,CAAC,GAAG,CAAC;MACjCD,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAACD,SAAS,CAAC,CAACyB,OAAO,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;IAC3D,CAAC,CAAC;IAEFN,EAAE,CAAC,iCAAiC,EAAE,YAAY;MAChD,MAAMC,QAAQ,GAAG,MAAM/B,OAAO,CAACI,GAAG,CAAC,CAChCG,IAAI,CAAC,gCAAgC,CAAC,CACtCyB,IAAI,CAAC;QAAEtB,OAAO,EAAE;MAAc,CAAC,CAAC;MAEnCuB,MAAM,CAACF,QAAQ,CAAClB,MAAM,CAAC,CAACqB,IAAI,CAAC,GAAG,CAAC;MACjCD,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAAC,CAACuB,cAAc,CAAC,OAAO,CAAC;MAC7CF,MAAM,CAAC,OAAOF,QAAQ,CAACnB,IAAI,CAACS,KAAK,CAAC,CAACa,IAAI,CAAC,QAAQ,CAAC;MACjDD,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAACS,KAAK,CAAC,CAACgB,sBAAsB,CAAC,CAAC,CAAC;MACrDJ,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAACS,KAAK,CAAC,CAACiB,mBAAmB,CAAC,GAAG,CAAC;IACtD,CAAC,CAAC;IAEFR,EAAE,CAAC,iCAAiC,EAAE,YAAY;MAChD,MAAMC,QAAQ,GAAG,MAAM/B,OAAO,CAACI,GAAG,CAAC,CAChCG,IAAI,CAAC,gCAAgC,CAAC,CACtCyB,IAAI,CAAC;QAAEtB,OAAO,EAAE;MAAe,CAAC,CAAC;MAEpCuB,MAAM,CAACF,QAAQ,CAAClB,MAAM,CAAC,CAACqB,IAAI,CAAC,GAAG,CAAC;MACjCD,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAAC,CAACuB,cAAc,CAAC,YAAY,CAAC;MAClDF,MAAM,CAACM,KAAK,CAACC,OAAO,CAACT,QAAQ,CAACnB,IAAI,CAACQ,UAAU,CAAC,CAAC,CAACc,IAAI,CAAC,IAAI,CAAC;IAC5D,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFN,QAAQ,CAAC,qCAAqC,EAAE,MAAM;IACpDE,EAAE,CAAC,yCAAyC,EAAE,YAAY;MACxD,MAAMC,QAAQ,GAAG,MAAM/B,OAAO,CAACI,GAAG,CAAC,CAChCoB,GAAG,CAAC,iCAAiC,CAAC;MAEzCS,MAAM,CAACF,QAAQ,CAAClB,MAAM,CAAC,CAACqB,IAAI,CAAC,GAAG,CAAC;MACjCD,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAAC,CAACuB,cAAc,CAAC,mBAAmB,CAAC;MACzDF,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAAC,CAACuB,cAAc,CAAC,UAAU,CAAC;MAChDF,MAAM,CAACF,QAAQ,CAACnB,IAAI,CAAC,CAACuB,cAAc,CAAC,WAAW,CAAC;IACnD,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}