0591f0debf2520c7a36142a9d6e6da7a
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.AIOrchestrator = void 0;
var _openai = _interopRequireDefault(require("openai"));
var _sdk = _interopRequireDefault(require("@anthropic-ai/sdk"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
class AIOrchestrator {
  openai = null;
  anthropic = null;
  cache = new Map();
  CACHE_TTL = 3600000; // 1 hour
  totalTokensUsed = 0;
  totalCost = 0;
  constructor() {
    // Initialize clients if API keys are available
    if (process.env.OPENAI_API_KEY) {
      this.openai = new _openai.default({
        apiKey: process.env.OPENAI_API_KEY
      });
    }
    if (process.env.ANTHROPIC_API_KEY) {
      this.anthropic = new _sdk.default({
        apiKey: process.env.ANTHROPIC_API_KEY
      });
    }
  }
  async generateCode(prompt, context, model) {
    // Check cache first
    const cacheKey = this.getCacheKey(prompt, context);
    const cached = this.getCachedResponse(cacheKey);
    if (cached) {
      console.log('Using cached AI response');
      return {
        content: cached.response,
        model: cached.model,
        tokensUsed: 0,
        cost: 0
      };
    }

    // Select model
    const selectedModel = model || this.selectModel('code-generation');

    // Build full prompt with context
    const fullPrompt = this.buildPrompt(prompt, context);

    // Generate response
    let response;
    if (selectedModel.provider === 'openai') {
      response = await this.generateWithOpenAI(fullPrompt, selectedModel);
    } else {
      response = await this.generateWithClaude(fullPrompt, selectedModel);
    }

    // Cache response
    this.cacheResponse(cacheKey, response.content, response.model);

    // Track usage
    this.totalTokensUsed += response.tokensUsed;
    this.totalCost += response.cost;
    return response;
  }
  async generateWithOpenAI(prompt, model) {
    if (!this.openai) {
      throw new Error('OpenAI client not initialized. Please set OPENAI_API_KEY.');
    }
    const completion = await this.openai.chat.completions.create({
      model: model.model,
      messages: [{
        role: 'system',
        content: 'You are an expert software developer assistant. Generate clean, production-ready code following best practices.'
      }, {
        role: 'user',
        content: prompt
      }],
      max_tokens: model.maxTokens,
      temperature: model.temperature
    });
    const content = completion.choices[0]?.message?.content || '';
    const tokensUsed = completion.usage?.total_tokens || 0;
    const cost = this.calculateCost('openai', model.model, tokensUsed);
    return {
      content,
      model: model.model,
      tokensUsed,
      cost
    };
  }
  async generateWithClaude(prompt, model) {
    if (!this.anthropic) {
      throw new Error('Anthropic client not initialized. Please set ANTHROPIC_API_KEY.');
    }
    const message = await this.anthropic.messages.create({
      model: model.model,
      max_tokens: model.maxTokens,
      temperature: model.temperature,
      messages: [{
        role: 'user',
        content: prompt
      }]
    });
    const content = message.content[0]?.type === 'text' ? message.content[0].text : '';
    const tokensUsed = message.usage.input_tokens + message.usage.output_tokens;
    const cost = this.calculateCost('anthropic', model.model, tokensUsed);
    return {
      content,
      model: model.model,
      tokensUsed,
      cost
    };
  }
  selectModel(taskType) {
    // Select appropriate model based on task type
    switch (taskType) {
      case 'code-generation':
        return {
          provider: 'openai',
          model: 'gpt-4-turbo-preview',
          maxTokens: 4096,
          temperature: 0.2
        };
      case 'refactoring':
        return {
          provider: 'anthropic',
          model: 'claude-3-opus-20240229',
          maxTokens: 4096,
          temperature: 0.1
        };
      case 'explanation':
        return {
          provider: 'openai',
          model: 'gpt-4-turbo-preview',
          maxTokens: 2048,
          temperature: 0.7
        };
      default:
        return {
          provider: 'openai',
          model: 'gpt-4-turbo-preview',
          maxTokens: 4096,
          temperature: 0.3
        };
    }
  }
  buildPrompt(userPrompt, context) {
    let prompt = `# Task\n${userPrompt}\n\n`;

    // Add project context
    if (context.projectInfo.frameworks.length > 0) {
      prompt += `# Project Frameworks\n${context.projectInfo.frameworks.join(', ')}\n\n`;
    }

    // Add relevant files
    if (context.files.length > 0) {
      prompt += `# Relevant Files\n\n`;
      for (const file of context.files) {
        prompt += `## ${file.path}\n\`\`\`\n${file.content}\n\`\`\`\n\n`;
      }
    }

    // Add conventions
    if (context.projectInfo.conventions) {
      prompt += `# Project Conventions\n`;
      prompt += `- Package Manager: ${context.projectInfo.conventions.packageManager}\n`;
      prompt += `- TypeScript: ${context.projectInfo.conventions.typescript ? 'Yes' : 'No'}\n`;
      if (context.projectInfo.conventions.testing.length > 0) {
        prompt += `- Testing: ${context.projectInfo.conventions.testing.join(', ')}\n`;
      }
      prompt += `\n`;
    }
    prompt += `# Instructions\n`;
    prompt += `- Generate clean, production-ready code\n`;
    prompt += `- Follow the project's existing patterns and conventions\n`;
    prompt += `- Include proper error handling\n`;
    prompt += `- Add TypeScript types where applicable\n`;
    prompt += `- Write self-documenting code with clear variable names\n`;
    return prompt;
  }
  async estimateCost(prompt, context) {
    const fullPrompt = this.buildPrompt(prompt, context);
    const estimatedTokens = Math.ceil(fullPrompt.length / 4); // Rough estimate: 1 token â‰ˆ 4 chars
    const model = this.selectModel('code-generation');
    return this.calculateCost(model.provider, model.model, estimatedTokens);
  }
  calculateCost(provider, model, tokens) {
    // Pricing per 1M tokens (as of 2024)
    const pricing = {
      'gpt-4-turbo-preview': {
        input: 10,
        output: 30
      },
      'gpt-4': {
        input: 30,
        output: 60
      },
      'gpt-3.5-turbo': {
        input: 0.5,
        output: 1.5
      },
      'claude-3-opus-20240229': {
        input: 15,
        output: 75
      },
      'claude-3-sonnet-20240229': {
        input: 3,
        output: 15
      }
    };
    const modelPricing = pricing[model] || {
      input: 10,
      output: 30
    };
    // Assume 50/50 split between input and output tokens
    const inputTokens = tokens * 0.5;
    const outputTokens = tokens * 0.5;
    return (inputTokens * modelPricing.input + outputTokens * modelPricing.output) / 1000000;
  }
  getCacheKey(prompt, context) {
    const contextStr = JSON.stringify({
      prompt,
      files: context.files.map(f => f.path),
      frameworks: context.projectInfo.frameworks
    });

    // Simple hash function
    let hash = 0;
    for (let i = 0; i < contextStr.length; i++) {
      const char = contextStr.charCodeAt(i);
      hash = (hash << 5) - hash + char;
      hash = hash & hash;
    }
    return hash.toString(36);
  }
  getCachedResponse(key) {
    const cached = this.cache.get(key);
    if (!cached) return null;

    // Check if cache is still valid
    if (Date.now() - cached.timestamp > this.CACHE_TTL) {
      this.cache.delete(key);
      return null;
    }
    return cached;
  }
  cacheResponse(key, response, model) {
    this.cache.set(key, {
      prompt: key,
      response,
      timestamp: Date.now(),
      model
    });

    // Limit cache size
    if (this.cache.size > 100) {
      const firstKey = this.cache.keys().next().value;
      if (firstKey) {
        this.cache.delete(firstKey);
      }
    }
  }
  getUsageStats() {
    return {
      totalTokens: this.totalTokensUsed,
      totalCost: this.totalCost,
      cacheSize: this.cache.size
    };
  }
  clearCache() {
    this.cache.clear();
  }
}
exports.AIOrchestrator = AIOrchestrator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfb3BlbmFpIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfc2RrIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiQUlPcmNoZXN0cmF0b3IiLCJvcGVuYWkiLCJhbnRocm9waWMiLCJjYWNoZSIsIk1hcCIsIkNBQ0hFX1RUTCIsInRvdGFsVG9rZW5zVXNlZCIsInRvdGFsQ29zdCIsImNvbnN0cnVjdG9yIiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwiT3BlbkFJIiwiYXBpS2V5IiwiQU5USFJPUElDX0FQSV9LRVkiLCJBbnRocm9waWMiLCJnZW5lcmF0ZUNvZGUiLCJwcm9tcHQiLCJjb250ZXh0IiwibW9kZWwiLCJjYWNoZUtleSIsImdldENhY2hlS2V5IiwiY2FjaGVkIiwiZ2V0Q2FjaGVkUmVzcG9uc2UiLCJjb25zb2xlIiwibG9nIiwiY29udGVudCIsInJlc3BvbnNlIiwidG9rZW5zVXNlZCIsImNvc3QiLCJzZWxlY3RlZE1vZGVsIiwic2VsZWN0TW9kZWwiLCJmdWxsUHJvbXB0IiwiYnVpbGRQcm9tcHQiLCJwcm92aWRlciIsImdlbmVyYXRlV2l0aE9wZW5BSSIsImdlbmVyYXRlV2l0aENsYXVkZSIsImNhY2hlUmVzcG9uc2UiLCJFcnJvciIsImNvbXBsZXRpb24iLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtZXNzYWdlcyIsInJvbGUiLCJtYXhfdG9rZW5zIiwibWF4VG9rZW5zIiwidGVtcGVyYXR1cmUiLCJjaG9pY2VzIiwibWVzc2FnZSIsInVzYWdlIiwidG90YWxfdG9rZW5zIiwiY2FsY3VsYXRlQ29zdCIsInR5cGUiLCJ0ZXh0IiwiaW5wdXRfdG9rZW5zIiwib3V0cHV0X3Rva2VucyIsInRhc2tUeXBlIiwidXNlclByb21wdCIsInByb2plY3RJbmZvIiwiZnJhbWV3b3JrcyIsImxlbmd0aCIsImpvaW4iLCJmaWxlcyIsImZpbGUiLCJwYXRoIiwiY29udmVudGlvbnMiLCJwYWNrYWdlTWFuYWdlciIsInR5cGVzY3JpcHQiLCJ0ZXN0aW5nIiwiZXN0aW1hdGVDb3N0IiwiZXN0aW1hdGVkVG9rZW5zIiwiTWF0aCIsImNlaWwiLCJ0b2tlbnMiLCJwcmljaW5nIiwiaW5wdXQiLCJvdXRwdXQiLCJtb2RlbFByaWNpbmciLCJpbnB1dFRva2VucyIsIm91dHB1dFRva2VucyIsImNvbnRleHRTdHIiLCJKU09OIiwic3RyaW5naWZ5IiwibWFwIiwiZiIsImhhc2giLCJpIiwiY2hhciIsImNoYXJDb2RlQXQiLCJ0b1N0cmluZyIsImtleSIsImdldCIsIkRhdGUiLCJub3ciLCJ0aW1lc3RhbXAiLCJkZWxldGUiLCJzZXQiLCJzaXplIiwiZmlyc3RLZXkiLCJrZXlzIiwibmV4dCIsInZhbHVlIiwiZ2V0VXNhZ2VTdGF0cyIsInRvdGFsVG9rZW5zIiwiY2FjaGVTaXplIiwiY2xlYXJDYWNoZSIsImNsZWFyIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkFJT3JjaGVzdHJhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcbmltcG9ydCBBbnRocm9waWMgZnJvbSAnQGFudGhyb3BpYy1haS9zZGsnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFJTW9kZWwge1xuICBwcm92aWRlcjogJ29wZW5haScgfCAnYW50aHJvcGljJztcbiAgbW9kZWw6IHN0cmluZztcbiAgbWF4VG9rZW5zOiBudW1iZXI7XG4gIHRlbXBlcmF0dXJlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQUlDb250ZXh0IHtcbiAgZmlsZXM6IEFycmF5PHsgcGF0aDogc3RyaW5nOyBjb250ZW50OiBzdHJpbmcgfT47XG4gIHByb2plY3RJbmZvOiB7XG4gICAgZnJhbWV3b3Jrczogc3RyaW5nW107XG4gICAgY29udmVudGlvbnM6IGFueTtcbiAgfTtcbiAgdXNlclByb21wdDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFJUmVzcG9uc2Uge1xuICBjb250ZW50OiBzdHJpbmc7XG4gIG1vZGVsOiBzdHJpbmc7XG4gIHRva2Vuc1VzZWQ6IG51bWJlcjtcbiAgY29zdDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhY2hlZFJlc3BvbnNlIHtcbiAgcHJvbXB0OiBzdHJpbmc7XG4gIHJlc3BvbnNlOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICBtb2RlbDogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQUlPcmNoZXN0cmF0b3Ige1xuICBwcml2YXRlIG9wZW5haTogT3BlbkFJIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgYW50aHJvcGljOiBBbnRocm9waWMgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBjYWNoZTogTWFwPHN0cmluZywgQ2FjaGVkUmVzcG9uc2U+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHJlYWRvbmx5IENBQ0hFX1RUTCA9IDM2MDAwMDA7IC8vIDEgaG91clxuICBwcml2YXRlIHRvdGFsVG9rZW5zVXNlZCA9IDA7XG4gIHByaXZhdGUgdG90YWxDb3N0ID0gMDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBJbml0aWFsaXplIGNsaWVudHMgaWYgQVBJIGtleXMgYXJlIGF2YWlsYWJsZVxuICAgIGlmIChwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSkge1xuICAgICAgdGhpcy5vcGVuYWkgPSBuZXcgT3BlbkFJKHtcbiAgICAgICAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChwcm9jZXNzLmVudi5BTlRIUk9QSUNfQVBJX0tFWSkge1xuICAgICAgdGhpcy5hbnRocm9waWMgPSBuZXcgQW50aHJvcGljKHtcbiAgICAgICAgYXBpS2V5OiBwcm9jZXNzLmVudi5BTlRIUk9QSUNfQVBJX0tFWSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlQ29kZShwcm9tcHQ6IHN0cmluZywgY29udGV4dDogQUlDb250ZXh0LCBtb2RlbD86IEFJTW9kZWwpOiBQcm9taXNlPEFJUmVzcG9uc2U+IHtcbiAgICAvLyBDaGVjayBjYWNoZSBmaXJzdFxuICAgIGNvbnN0IGNhY2hlS2V5ID0gdGhpcy5nZXRDYWNoZUtleShwcm9tcHQsIGNvbnRleHQpO1xuICAgIGNvbnN0IGNhY2hlZCA9IHRoaXMuZ2V0Q2FjaGVkUmVzcG9uc2UoY2FjaGVLZXkpO1xuICAgIGlmIChjYWNoZWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBjYWNoZWQgQUkgcmVzcG9uc2UnKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IGNhY2hlZC5yZXNwb25zZSxcbiAgICAgICAgbW9kZWw6IGNhY2hlZC5tb2RlbCxcbiAgICAgICAgdG9rZW5zVXNlZDogMCxcbiAgICAgICAgY29zdDogMCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gU2VsZWN0IG1vZGVsXG4gICAgY29uc3Qgc2VsZWN0ZWRNb2RlbCA9IG1vZGVsIHx8IHRoaXMuc2VsZWN0TW9kZWwoJ2NvZGUtZ2VuZXJhdGlvbicpO1xuXG4gICAgLy8gQnVpbGQgZnVsbCBwcm9tcHQgd2l0aCBjb250ZXh0XG4gICAgY29uc3QgZnVsbFByb21wdCA9IHRoaXMuYnVpbGRQcm9tcHQocHJvbXB0LCBjb250ZXh0KTtcblxuICAgIC8vIEdlbmVyYXRlIHJlc3BvbnNlXG4gICAgbGV0IHJlc3BvbnNlOiBBSVJlc3BvbnNlO1xuICAgIGlmIChzZWxlY3RlZE1vZGVsLnByb3ZpZGVyID09PSAnb3BlbmFpJykge1xuICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlV2l0aE9wZW5BSShmdWxsUHJvbXB0LCBzZWxlY3RlZE1vZGVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlV2l0aENsYXVkZShmdWxsUHJvbXB0LCBzZWxlY3RlZE1vZGVsKTtcbiAgICB9XG5cbiAgICAvLyBDYWNoZSByZXNwb25zZVxuICAgIHRoaXMuY2FjaGVSZXNwb25zZShjYWNoZUtleSwgcmVzcG9uc2UuY29udGVudCwgcmVzcG9uc2UubW9kZWwpO1xuXG4gICAgLy8gVHJhY2sgdXNhZ2VcbiAgICB0aGlzLnRvdGFsVG9rZW5zVXNlZCArPSByZXNwb25zZS50b2tlbnNVc2VkO1xuICAgIHRoaXMudG90YWxDb3N0ICs9IHJlc3BvbnNlLmNvc3Q7XG5cbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlV2l0aE9wZW5BSShwcm9tcHQ6IHN0cmluZywgbW9kZWw6IEFJTW9kZWwpOiBQcm9taXNlPEFJUmVzcG9uc2U+IHtcbiAgICBpZiAoIXRoaXMub3BlbmFpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBjbGllbnQgbm90IGluaXRpYWxpemVkLiBQbGVhc2Ugc2V0IE9QRU5BSV9BUElfS0VZLicpO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCB0aGlzLm9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogbW9kZWwubW9kZWwsXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgY29udGVudDogJ1lvdSBhcmUgYW4gZXhwZXJ0IHNvZnR3YXJlIGRldmVsb3BlciBhc3Npc3RhbnQuIEdlbmVyYXRlIGNsZWFuLCBwcm9kdWN0aW9uLXJlYWR5IGNvZGUgZm9sbG93aW5nIGJlc3QgcHJhY3RpY2VzLicsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgY29udGVudDogcHJvbXB0LFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIG1heF90b2tlbnM6IG1vZGVsLm1heFRva2VucyxcbiAgICAgIHRlbXBlcmF0dXJlOiBtb2RlbC50ZW1wZXJhdHVyZSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbnRlbnQgPSBjb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgJyc7XG4gICAgY29uc3QgdG9rZW5zVXNlZCA9IGNvbXBsZXRpb24udXNhZ2U/LnRvdGFsX3Rva2VucyB8fCAwO1xuICAgIGNvbnN0IGNvc3QgPSB0aGlzLmNhbGN1bGF0ZUNvc3QoJ29wZW5haScsIG1vZGVsLm1vZGVsLCB0b2tlbnNVc2VkKTtcblxuICAgIHJldHVybiB7XG4gICAgICBjb250ZW50LFxuICAgICAgbW9kZWw6IG1vZGVsLm1vZGVsLFxuICAgICAgdG9rZW5zVXNlZCxcbiAgICAgIGNvc3QsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVXaXRoQ2xhdWRlKHByb21wdDogc3RyaW5nLCBtb2RlbDogQUlNb2RlbCk6IFByb21pc2U8QUlSZXNwb25zZT4ge1xuICAgIGlmICghdGhpcy5hbnRocm9waWMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQW50aHJvcGljIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQuIFBsZWFzZSBzZXQgQU5USFJPUElDX0FQSV9LRVkuJyk7XG4gICAgfVxuXG4gICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IHRoaXMuYW50aHJvcGljLm1lc3NhZ2VzLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogbW9kZWwubW9kZWwsXG4gICAgICBtYXhfdG9rZW5zOiBtb2RlbC5tYXhUb2tlbnMsXG4gICAgICB0ZW1wZXJhdHVyZTogbW9kZWwudGVtcGVyYXR1cmUsXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIGNvbnRlbnQ6IHByb21wdCxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBjb250ZW50ID0gbWVzc2FnZS5jb250ZW50WzBdPy50eXBlID09PSAndGV4dCcgPyBtZXNzYWdlLmNvbnRlbnRbMF0udGV4dCA6ICcnO1xuICAgIGNvbnN0IHRva2Vuc1VzZWQgPSBtZXNzYWdlLnVzYWdlLmlucHV0X3Rva2VucyArIG1lc3NhZ2UudXNhZ2Uub3V0cHV0X3Rva2VucztcbiAgICBjb25zdCBjb3N0ID0gdGhpcy5jYWxjdWxhdGVDb3N0KCdhbnRocm9waWMnLCBtb2RlbC5tb2RlbCwgdG9rZW5zVXNlZCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY29udGVudCxcbiAgICAgIG1vZGVsOiBtb2RlbC5tb2RlbCxcbiAgICAgIHRva2Vuc1VzZWQsXG4gICAgICBjb3N0LFxuICAgIH07XG4gIH1cblxuICBzZWxlY3RNb2RlbCh0YXNrVHlwZTogc3RyaW5nKTogQUlNb2RlbCB7XG4gICAgLy8gU2VsZWN0IGFwcHJvcHJpYXRlIG1vZGVsIGJhc2VkIG9uIHRhc2sgdHlwZVxuICAgIHN3aXRjaCAodGFza1R5cGUpIHtcbiAgICAgIGNhc2UgJ2NvZGUtZ2VuZXJhdGlvbic6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcHJvdmlkZXI6ICdvcGVuYWknLFxuICAgICAgICAgIG1vZGVsOiAnZ3B0LTQtdHVyYm8tcHJldmlldycsXG4gICAgICAgICAgbWF4VG9rZW5zOiA0MDk2LFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjIsXG4gICAgICAgIH07XG4gICAgICBjYXNlICdyZWZhY3RvcmluZyc6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcHJvdmlkZXI6ICdhbnRocm9waWMnLFxuICAgICAgICAgIG1vZGVsOiAnY2xhdWRlLTMtb3B1cy0yMDI0MDIyOScsXG4gICAgICAgICAgbWF4VG9rZW5zOiA0MDk2LFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjEsXG4gICAgICAgIH07XG4gICAgICBjYXNlICdleHBsYW5hdGlvbic6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcHJvdmlkZXI6ICdvcGVuYWknLFxuICAgICAgICAgIG1vZGVsOiAnZ3B0LTQtdHVyYm8tcHJldmlldycsXG4gICAgICAgICAgbWF4VG9rZW5zOiAyMDQ4LFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgIH07XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHByb3ZpZGVyOiAnb3BlbmFpJyxcbiAgICAgICAgICBtb2RlbDogJ2dwdC00LXR1cmJvLXByZXZpZXcnLFxuICAgICAgICAgIG1heFRva2VuczogNDA5NixcbiAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRQcm9tcHQodXNlclByb21wdDogc3RyaW5nLCBjb250ZXh0OiBBSUNvbnRleHQpOiBzdHJpbmcge1xuICAgIGxldCBwcm9tcHQgPSBgIyBUYXNrXFxuJHt1c2VyUHJvbXB0fVxcblxcbmA7XG5cbiAgICAvLyBBZGQgcHJvamVjdCBjb250ZXh0XG4gICAgaWYgKGNvbnRleHQucHJvamVjdEluZm8uZnJhbWV3b3Jrcy5sZW5ndGggPiAwKSB7XG4gICAgICBwcm9tcHQgKz0gYCMgUHJvamVjdCBGcmFtZXdvcmtzXFxuJHtjb250ZXh0LnByb2plY3RJbmZvLmZyYW1ld29ya3Muam9pbignLCAnKX1cXG5cXG5gO1xuICAgIH1cblxuICAgIC8vIEFkZCByZWxldmFudCBmaWxlc1xuICAgIGlmIChjb250ZXh0LmZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHByb21wdCArPSBgIyBSZWxldmFudCBGaWxlc1xcblxcbmA7XG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgY29udGV4dC5maWxlcykge1xuICAgICAgICBwcm9tcHQgKz0gYCMjICR7ZmlsZS5wYXRofVxcblxcYFxcYFxcYFxcbiR7ZmlsZS5jb250ZW50fVxcblxcYFxcYFxcYFxcblxcbmA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWRkIGNvbnZlbnRpb25zXG4gICAgaWYgKGNvbnRleHQucHJvamVjdEluZm8uY29udmVudGlvbnMpIHtcbiAgICAgIHByb21wdCArPSBgIyBQcm9qZWN0IENvbnZlbnRpb25zXFxuYDtcbiAgICAgIHByb21wdCArPSBgLSBQYWNrYWdlIE1hbmFnZXI6ICR7Y29udGV4dC5wcm9qZWN0SW5mby5jb252ZW50aW9ucy5wYWNrYWdlTWFuYWdlcn1cXG5gO1xuICAgICAgcHJvbXB0ICs9IGAtIFR5cGVTY3JpcHQ6ICR7Y29udGV4dC5wcm9qZWN0SW5mby5jb252ZW50aW9ucy50eXBlc2NyaXB0ID8gJ1llcycgOiAnTm8nfVxcbmA7XG4gICAgICBpZiAoY29udGV4dC5wcm9qZWN0SW5mby5jb252ZW50aW9ucy50ZXN0aW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcHJvbXB0ICs9IGAtIFRlc3Rpbmc6ICR7Y29udGV4dC5wcm9qZWN0SW5mby5jb252ZW50aW9ucy50ZXN0aW5nLmpvaW4oJywgJyl9XFxuYDtcbiAgICAgIH1cbiAgICAgIHByb21wdCArPSBgXFxuYDtcbiAgICB9XG5cbiAgICBwcm9tcHQgKz0gYCMgSW5zdHJ1Y3Rpb25zXFxuYDtcbiAgICBwcm9tcHQgKz0gYC0gR2VuZXJhdGUgY2xlYW4sIHByb2R1Y3Rpb24tcmVhZHkgY29kZVxcbmA7XG4gICAgcHJvbXB0ICs9IGAtIEZvbGxvdyB0aGUgcHJvamVjdCdzIGV4aXN0aW5nIHBhdHRlcm5zIGFuZCBjb252ZW50aW9uc1xcbmA7XG4gICAgcHJvbXB0ICs9IGAtIEluY2x1ZGUgcHJvcGVyIGVycm9yIGhhbmRsaW5nXFxuYDtcbiAgICBwcm9tcHQgKz0gYC0gQWRkIFR5cGVTY3JpcHQgdHlwZXMgd2hlcmUgYXBwbGljYWJsZVxcbmA7XG4gICAgcHJvbXB0ICs9IGAtIFdyaXRlIHNlbGYtZG9jdW1lbnRpbmcgY29kZSB3aXRoIGNsZWFyIHZhcmlhYmxlIG5hbWVzXFxuYDtcblxuICAgIHJldHVybiBwcm9tcHQ7XG4gIH1cblxuICBhc3luYyBlc3RpbWF0ZUNvc3QocHJvbXB0OiBzdHJpbmcsIGNvbnRleHQ6IEFJQ29udGV4dCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgY29uc3QgZnVsbFByb21wdCA9IHRoaXMuYnVpbGRQcm9tcHQocHJvbXB0LCBjb250ZXh0KTtcbiAgICBjb25zdCBlc3RpbWF0ZWRUb2tlbnMgPSBNYXRoLmNlaWwoZnVsbFByb21wdC5sZW5ndGggLyA0KTsgLy8gUm91Z2ggZXN0aW1hdGU6IDEgdG9rZW4g4omIIDQgY2hhcnNcbiAgICBjb25zdCBtb2RlbCA9IHRoaXMuc2VsZWN0TW9kZWwoJ2NvZGUtZ2VuZXJhdGlvbicpO1xuICAgIHJldHVybiB0aGlzLmNhbGN1bGF0ZUNvc3QobW9kZWwucHJvdmlkZXIsIG1vZGVsLm1vZGVsLCBlc3RpbWF0ZWRUb2tlbnMpO1xuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVDb3N0KHByb3ZpZGVyOiBzdHJpbmcsIG1vZGVsOiBzdHJpbmcsIHRva2VuczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAvLyBQcmljaW5nIHBlciAxTSB0b2tlbnMgKGFzIG9mIDIwMjQpXG4gICAgY29uc3QgcHJpY2luZzogUmVjb3JkPHN0cmluZywgeyBpbnB1dDogbnVtYmVyOyBvdXRwdXQ6IG51bWJlciB9PiA9IHtcbiAgICAgICdncHQtNC10dXJiby1wcmV2aWV3JzogeyBpbnB1dDogMTAsIG91dHB1dDogMzAgfSxcbiAgICAgICdncHQtNCc6IHsgaW5wdXQ6IDMwLCBvdXRwdXQ6IDYwIH0sXG4gICAgICAnZ3B0LTMuNS10dXJibyc6IHsgaW5wdXQ6IDAuNSwgb3V0cHV0OiAxLjUgfSxcbiAgICAgICdjbGF1ZGUtMy1vcHVzLTIwMjQwMjI5JzogeyBpbnB1dDogMTUsIG91dHB1dDogNzUgfSxcbiAgICAgICdjbGF1ZGUtMy1zb25uZXQtMjAyNDAyMjknOiB7IGlucHV0OiAzLCBvdXRwdXQ6IDE1IH0sXG4gICAgfTtcblxuICAgIGNvbnN0IG1vZGVsUHJpY2luZyA9IHByaWNpbmdbbW9kZWxdIHx8IHsgaW5wdXQ6IDEwLCBvdXRwdXQ6IDMwIH07XG4gICAgLy8gQXNzdW1lIDUwLzUwIHNwbGl0IGJldHdlZW4gaW5wdXQgYW5kIG91dHB1dCB0b2tlbnNcbiAgICBjb25zdCBpbnB1dFRva2VucyA9IHRva2VucyAqIDAuNTtcbiAgICBjb25zdCBvdXRwdXRUb2tlbnMgPSB0b2tlbnMgKiAwLjU7XG4gICAgXG4gICAgcmV0dXJuIChpbnB1dFRva2VucyAqIG1vZGVsUHJpY2luZy5pbnB1dCArIG91dHB1dFRva2VucyAqIG1vZGVsUHJpY2luZy5vdXRwdXQpIC8gMTAwMDAwMDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q2FjaGVLZXkocHJvbXB0OiBzdHJpbmcsIGNvbnRleHQ6IEFJQ29udGV4dCk6IHN0cmluZyB7XG4gICAgY29uc3QgY29udGV4dFN0ciA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIHByb21wdCxcbiAgICAgIGZpbGVzOiBjb250ZXh0LmZpbGVzLm1hcChmID0+IGYucGF0aCksXG4gICAgICBmcmFtZXdvcmtzOiBjb250ZXh0LnByb2plY3RJbmZvLmZyYW1ld29ya3MsXG4gICAgfSk7XG4gICAgXG4gICAgLy8gU2ltcGxlIGhhc2ggZnVuY3Rpb25cbiAgICBsZXQgaGFzaCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250ZXh0U3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBjaGFyID0gY29udGV4dFN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgaGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpICsgY2hhcjtcbiAgICAgIGhhc2ggPSBoYXNoICYgaGFzaDtcbiAgICB9XG4gICAgcmV0dXJuIGhhc2gudG9TdHJpbmcoMzYpO1xuICB9XG5cbiAgZ2V0Q2FjaGVkUmVzcG9uc2Uoa2V5OiBzdHJpbmcpOiBDYWNoZWRSZXNwb25zZSB8IG51bGwge1xuICAgIGNvbnN0IGNhY2hlZCA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XG4gICAgaWYgKCFjYWNoZWQpIHJldHVybiBudWxsO1xuXG4gICAgLy8gQ2hlY2sgaWYgY2FjaGUgaXMgc3RpbGwgdmFsaWRcbiAgICBpZiAoRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAgPiB0aGlzLkNBQ0hFX1RUTCkge1xuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBjYWNoZWQ7XG4gIH1cblxuICBjYWNoZVJlc3BvbnNlKGtleTogc3RyaW5nLCByZXNwb25zZTogc3RyaW5nLCBtb2RlbDogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5jYWNoZS5zZXQoa2V5LCB7XG4gICAgICBwcm9tcHQ6IGtleSxcbiAgICAgIHJlc3BvbnNlLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgbW9kZWwsXG4gICAgfSk7XG5cbiAgICAvLyBMaW1pdCBjYWNoZSBzaXplXG4gICAgaWYgKHRoaXMuY2FjaGUuc2l6ZSA+IDEwMCkge1xuICAgICAgY29uc3QgZmlyc3RLZXkgPSB0aGlzLmNhY2hlLmtleXMoKS5uZXh0KCkudmFsdWUgYXMgc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgaWYgKGZpcnN0S2V5KSB7XG4gICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGZpcnN0S2V5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRVc2FnZVN0YXRzKCk6IHsgdG90YWxUb2tlbnM6IG51bWJlcjsgdG90YWxDb3N0OiBudW1iZXI7IGNhY2hlU2l6ZTogbnVtYmVyIH0ge1xuICAgIHJldHVybiB7XG4gICAgICB0b3RhbFRva2VuczogdGhpcy50b3RhbFRva2Vuc1VzZWQsXG4gICAgICB0b3RhbENvc3Q6IHRoaXMudG90YWxDb3N0LFxuICAgICAgY2FjaGVTaXplOiB0aGlzLmNhY2hlLnNpemUsXG4gICAgfTtcbiAgfVxuXG4gIGNsZWFyQ2FjaGUoKTogdm9pZCB7XG4gICAgdGhpcy5jYWNoZS5jbGVhcigpO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLElBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUEwQyxTQUFBRCx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FB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