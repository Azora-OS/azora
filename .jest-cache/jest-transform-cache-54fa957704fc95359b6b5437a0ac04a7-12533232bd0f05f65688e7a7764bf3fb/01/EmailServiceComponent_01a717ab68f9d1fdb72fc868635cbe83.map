{"version":3,"names":["path","_interopRequireWildcard","require","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","EmailServiceComponent","generateEmailService","config","outputDir","changes","serviceName","serviceDir","join","push","type","content","generateIndexFile","generateEmailController","generateEmailServiceFile","generateProviderService","enableTemplates","generateTemplateService","generateEmailRepository","generateTypes","generateValidationSchemas","generatePrismaSchema","generateWelcomeTemplate","generatePasswordResetTemplate","generateVerificationTemplate","generatePackageJson","generateEnvExample","generateReadme","port","enableVerification","provider","dependencies","express","cors","helmet","zod","JSON","stringify","name","version","description","main","scripts","dev","build","start","test","devDependencies","typescript","jest","prisma","env","toUpperCase","exports"],"sources":["EmailServiceComponent.ts"],"sourcesContent":["import * as path from 'path';\nimport { FileChange } from '../ChangesetManager';\n\nexport interface EmailServiceConfig {\n  name: string;\n  port?: number;\n  provider?: 'sendgrid' | 'ses' | 'smtp';\n  enableTemplates?: boolean;\n  enableVerification?: boolean;\n}\n\nexport class EmailServiceComponent {\n  /**\n   * Generate complete email service with templates\n   */\n  generateEmailService(config: EmailServiceConfig, outputDir: string): FileChange[] {\n    const changes: FileChange[] = [];\n    const serviceName = 'email-service';\n    const serviceDir = path.join(outputDir, 'services', serviceName);\n\n    // Main service file\n    changes.push({\n      path: path.join(serviceDir, 'src', 'index.ts'),\n      type: 'create',\n      content: this.generateIndexFile(config),\n    });\n\n    // Controllers\n    changes.push({\n      path: path.join(serviceDir, 'src', 'controllers', 'email.controller.ts'),\n      type: 'create',\n      content: this.generateEmailController(config),\n    });\n\n    // Services\n    changes.push({\n      path: path.join(serviceDir, 'src', 'services', 'email.service.ts'),\n      type: 'create',\n      content: this.generateEmailServiceFile(config),\n    });\n\n    changes.push({\n      path: path.join(serviceDir, 'src', 'services', 'provider.service.ts'),\n      type: 'create',\n      content: this.generateProviderService(config),\n    });\n\n    if (config.enableTemplates) {\n      changes.push({\n        path: path.join(serviceDir, 'src', 'services', 'template.service.ts'),\n        type: 'create',\n        content: this.generateTemplateService(),\n      });\n    }\n\n    // Repository\n    changes.push({\n      path: path.join(serviceDir, 'src', 'repositories', 'email.repository.ts'),\n      type: 'create',\n      content: this.generateEmailRepository(),\n    });\n\n    // Types\n    changes.push({\n      path: path.join(serviceDir, 'src', 'types', 'index.ts'),\n      type: 'create',\n      content: this.generateTypes(config),\n    });\n\n    // Validation schemas\n    changes.push({\n      path: path.join(serviceDir, 'src', 'validation', 'email.schemas.ts'),\n      type: 'create',\n      content: this.generateValidationSchemas(config),\n    });\n\n    // Prisma schema\n    changes.push({\n      path: path.join(serviceDir, 'prisma', 'schema.prisma'),\n      type: 'create',\n      content: this.generatePrismaSchema(config),\n    });\n\n    // Email templates\n    if (config.enableTemplates) {\n      changes.push({\n        path: path.join(serviceDir, 'templates', 'welcome.html'),\n        type: 'create',\n        content: this.generateWelcomeTemplate(),\n      });\n\n      changes.push({\n        path: path.join(serviceDir, 'templates', 'password-reset.html'),\n        type: 'create',\n        content: this.generatePasswordResetTemplate(),\n      });\n\n      changes.push({\n        path: path.join(serviceDir, 'templates', 'verification.html'),\n        type: 'create',\n        content: this.generateVerificationTemplate(),\n      });\n    }\n\n    // Configuration files\n    changes.push({\n      path: path.join(serviceDir, 'package.json'),\n      type: 'create',\n      content: this.generatePackageJson(config),\n    });\n\n    changes.push({\n      path: path.join(serviceDir, '.env.example'),\n      type: 'create',\n      content: this.generateEnvExample(config),\n    });\n\n    changes.push({\n      path: path.join(serviceDir, 'README.md'),\n      type: 'create',\n      content: this.generateReadme(config),\n    });\n\n    return changes;\n  }\n\n  private generateIndexFile(config: EmailServiceConfig): string {\n    const port = config.port || 3003;\n    return `import express, { Application } from 'express';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport { EmailController } from './controllers/email.controller';\nimport { errorHandler } from './middleware/error-handler';\n\nconst app: Application = express();\nconst PORT = process.env.PORT || ${port};\n\n// Middleware\napp.use(helmet());\napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\n\n// Health check\napp.get('/health', (req, res) => {\n  res.json({ status: 'healthy', service: 'email-service' });\n});\n\n// Routes\nconst emailController = new EmailController();\napp.use('/api/email', emailController.router);\n\n// Error handling\napp.use(errorHandler);\n\n// Start server\napp.listen(PORT, () => {\n  console.log(\\`Email service running on port \\${PORT}\\`);\n});\n\nexport default app;\n`;\n  }\n\n  private generateEmailController(config: EmailServiceConfig): string {\n    return `import { Router, Request, Response, NextFunction } from 'express';\nimport { EmailService } from '../services/email.service';\nimport { validate } from '../middleware/validation';\nimport { EmailSchemas } from '../validation/email.schemas';\nimport { authMiddleware } from '../middleware/auth.middleware';\n\nexport class EmailController {\n  public router: Router;\n  private emailService: EmailService;\n\n  constructor() {\n    this.router = Router();\n    this.emailService = new EmailService();\n    this.initializeRoutes();\n  }\n\n  private initializeRoutes(): void {\n    // Send email\n    this.router.post(\n      '/send',\n      authMiddleware,\n      validate(EmailSchemas.send),\n      this.sendEmail.bind(this)\n    );\n    \n    // Send template email\n    this.router.post(\n      '/send-template',\n      authMiddleware,\n      validate(EmailSchemas.sendTemplate),\n      this.sendTemplateEmail.bind(this)\n    );\n${config.enableVerification ? `\n    // Send verification email\n    this.router.post(\n      '/verify',\n      authMiddleware,\n      validate(EmailSchemas.verify),\n      this.sendVerificationEmail.bind(this)\n    );\n    \n    // Verify email token\n    this.router.get('/verify/:token', this.verifyEmailToken.bind(this));\n` : ''}\n    // Get email status\n    this.router.get('/:id', authMiddleware, this.getEmailStatus.bind(this));\n    \n    // List sent emails\n    this.router.get('/', authMiddleware, this.listEmails.bind(this));\n  }\n\n  private async sendEmail(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      const result = await this.emailService.sendEmail(req.body);\n      res.json({ success: true, data: result });\n    } catch (error) {\n      next(error);\n    }\n  }\n\n  private async sendTemplateEmail(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      const result = await this.emailService.sendTemplateEmail(\n        req.body.to,\n        req.body.template,\n        req.body.data\n      );\n      res.json({ success: true, data: result });\n    } catch (error) {\n      next(error);\n    }\n  }\n${config.enableVerification ? `\n  private async sendVerificationEmail(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      await this.emailService.sendVerificationEmail(req.body.email, req.body.userId);\n      res.json({ success: true, message: 'Verification email sent' });\n    } catch (error) {\n      next(error);\n    }\n  }\n\n  private async verifyEmailToken(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      await this.emailService.verifyEmailToken(req.params.token);\n      res.json({ success: true, message: 'Email verified successfully' });\n    } catch (error) {\n      next(error);\n    }\n  }\n` : ''}\n  private async getEmailStatus(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      const email = await this.emailService.getEmailById(req.params.id);\n      res.json({ success: true, data: email });\n    } catch (error) {\n      next(error);\n    }\n  }\n\n  private async listEmails(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      const emails = await this.emailService.listEmails();\n      res.json({ success: true, data: emails });\n    } catch (error) {\n      next(error);\n    }\n  }\n}\n`;\n  }\n\n  private generateEmailServiceFile(config: EmailServiceConfig): string {\n    return `import { ProviderService } from './provider.service';\n${config.enableTemplates ? \"import { TemplateService } from './template.service';\" : ''}\nimport { EmailRepository } from '../repositories/email.repository';\nimport { SendEmailInput, Email } from '../types';\n${config.enableVerification ? \"import * as crypto from 'crypto';\" : ''}\n\nexport class EmailService {\n  private providerService: ProviderService;\n${config.enableTemplates ? '  private templateService: TemplateService;' : ''}\n  private emailRepository: EmailRepository;\n\n  constructor() {\n    this.providerService = new ProviderService();\n${config.enableTemplates ? '    this.templateService = new TemplateService();' : ''}\n    this.emailRepository = new EmailRepository();\n  }\n\n  async sendEmail(input: SendEmailInput): Promise<Email> {\n    // Send via provider\n    const messageId = await this.providerService.send({\n      to: input.to,\n      from: input.from || process.env.EMAIL_FROM || 'noreply@example.com',\n      subject: input.subject,\n      html: input.html,\n      text: input.text,\n    });\n\n    // Save to database\n    const email = await this.emailRepository.create({\n      to: input.to,\n      from: input.from || process.env.EMAIL_FROM || 'noreply@example.com',\n      subject: input.subject,\n      html: input.html,\n      text: input.text,\n      messageId,\n      status: 'sent',\n    });\n\n    return email;\n  }\n${config.enableTemplates ? `\n  async sendTemplateEmail(to: string, templateName: string, data: Record<string, any>): Promise<Email> {\n    const { subject, html, text } = await this.templateService.render(templateName, data);\n\n    return this.sendEmail({\n      to,\n      subject,\n      html,\n      text,\n    });\n  }\n` : ''}${config.enableVerification ? `\n  async sendVerificationEmail(email: string, userId: string): Promise<void> {\n    const token = crypto.randomBytes(32).toString('hex');\n    const verificationUrl = \\`\\${process.env.APP_URL}/verify-email/\\${token}\\`;\n\n    await this.emailRepository.saveVerificationToken(userId, token);\n\n    await this.sendTemplateEmail(email, 'verification', {\n      verificationUrl,\n    });\n  }\n\n  async verifyEmailToken(token: string): Promise<void> {\n    const verification = await this.emailRepository.findVerificationToken(token);\n    \n    if (!verification) {\n      throw new Error('Invalid or expired verification token');\n    }\n\n    await this.emailRepository.markEmailVerified(verification.userId);\n    await this.emailRepository.deleteVerificationToken(token);\n  }\n` : ''}\n  async getEmailById(id: string): Promise<Email | null> {\n    return this.emailRepository.findById(id);\n  }\n\n  async listEmails(): Promise<Email[]> {\n    return this.emailRepository.findAll();\n  }\n}\n`;\n  }\n\n  private generateProviderService(config: EmailServiceConfig): string {\n    const provider = config.provider || 'sendgrid';\n    \n    return `${provider === 'sendgrid' ? \"import sgMail from '@sendgrid/mail';\" : ''}\n${provider === 'ses' ? \"import { SESClient, SendEmailCommand } from '@aws-sdk/client-ses';\" : ''}\n${provider === 'smtp' ? \"import nodemailer from 'nodemailer';\" : ''}\n\ninterface SendEmailParams {\n  to: string;\n  from: string;\n  subject: string;\n  html?: string;\n  text?: string;\n}\n\nexport class ProviderService {\n${provider === 'sendgrid' ? `  constructor() {\n    const apiKey = process.env.SENDGRID_API_KEY;\n    if (!apiKey) {\n      throw new Error('SENDGRID_API_KEY is required');\n    }\n    sgMail.setApiKey(apiKey);\n  }\n\n  async send(params: SendEmailParams): Promise<string> {\n    const msg = {\n      to: params.to,\n      from: params.from,\n      subject: params.subject,\n      html: params.html,\n      text: params.text,\n    };\n\n    const [response] = await sgMail.send(msg);\n    return response.headers['x-message-id'] || '';\n  }` : ''}${provider === 'ses' ? `  private sesClient: SESClient;\n\n  constructor() {\n    this.sesClient = new SESClient({\n      region: process.env.AWS_REGION || 'us-east-1',\n    });\n  }\n\n  async send(params: SendEmailParams): Promise<string> {\n    const command = new SendEmailCommand({\n      Source: params.from,\n      Destination: {\n        ToAddresses: [params.to],\n      },\n      Message: {\n        Subject: {\n          Data: params.subject,\n        },\n        Body: {\n          Html: params.html ? { Data: params.html } : undefined,\n          Text: params.text ? { Data: params.text } : undefined,\n        },\n      },\n    });\n\n    const response = await this.sesClient.send(command);\n    return response.MessageId || '';\n  }` : ''}${provider === 'smtp' ? `  private transporter: nodemailer.Transporter;\n\n  constructor() {\n    this.transporter = nodemailer.createTransport({\n      host: process.env.SMTP_HOST,\n      port: parseInt(process.env.SMTP_PORT || '587'),\n      secure: process.env.SMTP_SECURE === 'true',\n      auth: {\n        user: process.env.SMTP_USER,\n        pass: process.env.SMTP_PASS,\n      },\n    });\n  }\n\n  async send(params: SendEmailParams): Promise<string> {\n    const info = await this.transporter.sendMail({\n      from: params.from,\n      to: params.to,\n      subject: params.subject,\n      html: params.html,\n      text: params.text,\n    });\n\n    return info.messageId;\n  }` : ''}\n}\n`;\n  }\n\n  private generateTemplateService(): string {\n    return `import * as fs from 'fs/promises';\nimport * as path from 'path';\nimport Handlebars from 'handlebars';\n\ninterface RenderedTemplate {\n  subject: string;\n  html: string;\n  text: string;\n}\n\nexport class TemplateService {\n  private templatesDir: string;\n\n  constructor() {\n    this.templatesDir = path.join(__dirname, '../../templates');\n  }\n\n  async render(templateName: string, data: Record<string, any>): Promise<RenderedTemplate> {\n    const templatePath = path.join(this.templatesDir, \\`\\${templateName}.html\\`);\n    const templateContent = await fs.readFile(templatePath, 'utf-8');\n\n    const template = Handlebars.compile(templateContent);\n    const html = template(data);\n\n    // Extract subject from template (first line comment)\n    const subjectMatch = html.match(/<!--\\\\s*SUBJECT:\\\\s*(.+?)\\\\s*-->/);\n    const subject = subjectMatch ? subjectMatch[1] : 'No Subject';\n\n    // Generate plain text version\n    const text = this.htmlToText(html);\n\n    return { subject, html, text };\n  }\n\n  private htmlToText(html: string): string {\n    // Simple HTML to text conversion\n    return html\n      .replace(/<[^>]*>/g, '')\n      .replace(/\\\\s+/g, ' ')\n      .trim();\n  }\n}\n`;\n  }\n\n  private generateEmailRepository(): string {\n    return `import { PrismaClient } from '@prisma/client';\nimport { Email, CreateEmailInput } from '../types';\n\nconst prisma = new PrismaClient();\n\nexport class EmailRepository {\n  async create(data: CreateEmailInput): Promise<Email> {\n    return prisma.email.create({ data });\n  }\n\n  async findById(id: string): Promise<Email | null> {\n    return prisma.email.findUnique({ where: { id } });\n  }\n\n  async findAll(): Promise<Email[]> {\n    return prisma.email.findMany({\n      orderBy: { createdAt: 'desc' },\n      take: 100,\n    });\n  }\n\n  async updateStatus(id: string, status: string): Promise<Email> {\n    return prisma.email.update({\n      where: { id },\n      data: { status },\n    });\n  }\n\n  async saveVerificationToken(userId: string, token: string): Promise<void> {\n    await prisma.emailVerification.create({\n      data: {\n        userId,\n        token,\n        expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000), // 24 hours\n      },\n    });\n  }\n\n  async findVerificationToken(token: string): Promise<{ userId: string } | null> {\n    return prisma.emailVerification.findFirst({\n      where: {\n        token,\n        expiresAt: {\n          gt: new Date(),\n        },\n      },\n    });\n  }\n\n  async markEmailVerified(userId: string): Promise<void> {\n    await prisma.user.update({\n      where: { id: userId },\n      data: { emailVerified: true },\n    });\n  }\n\n  async deleteVerificationToken(token: string): Promise<void> {\n    await prisma.emailVerification.deleteMany({\n      where: { token },\n    });\n  }\n}\n`;\n  }\n\n  private generateTypes(config: EmailServiceConfig): string {\n    return `export interface Email {\n  id: string;\n  to: string;\n  from: string;\n  subject: string;\n  html?: string;\n  text?: string;\n  messageId: string;\n  status: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface CreateEmailInput {\n  to: string;\n  from: string;\n  subject: string;\n  html?: string;\n  text?: string;\n  messageId: string;\n  status: string;\n}\n\nexport interface SendEmailInput {\n  to: string;\n  from?: string;\n  subject: string;\n  html?: string;\n  text?: string;\n}\n`;\n  }\n\n  private generateValidationSchemas(config: EmailServiceConfig): string {\n    return `import { z } from 'zod';\n\nexport const EmailSchemas = {\n  send: z.object({\n    body: z.object({\n      to: z.string().email('Invalid email address'),\n      from: z.string().email('Invalid email address').optional(),\n      subject: z.string().min(1, 'Subject is required'),\n      html: z.string().optional(),\n      text: z.string().optional(),\n    }),\n  }),\n\n  sendTemplate: z.object({\n    body: z.object({\n      to: z.string().email('Invalid email address'),\n      template: z.string().min(1, 'Template name is required'),\n      data: z.record(z.any()),\n    }),\n  }),\n${config.enableVerification ? `\n  verify: z.object({\n    body: z.object({\n      email: z.string().email('Invalid email address'),\n      userId: z.string().min(1, 'User ID is required'),\n    }),\n  }),\n` : ''}\n};\n`;\n  }\n\n  private generatePrismaSchema(config: EmailServiceConfig): string {\n    return `generator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"postgresql\"\n  url      = env(\"DATABASE_URL\")\n}\n\nmodel Email {\n  id        String   @id @default(cuid())\n  to        String\n  from      String\n  subject   String\n  html      String?  @db.Text\n  text      String?  @db.Text\n  messageId String\n  status    String\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n  \n  @@index([status])\n  @@index([createdAt])\n  @@map(\"emails\")\n}\n${config.enableVerification ? `\nmodel EmailVerification {\n  id        String   @id @default(cuid())\n  userId    String\n  token     String   @unique\n  expiresAt DateTime\n  createdAt DateTime @default(now())\n  \n  @@index([token])\n  @@index([userId])\n  @@map(\"email_verifications\")\n}\n\nmodel User {\n  id            String  @id @default(cuid())\n  email         String  @unique\n  emailVerified Boolean @default(false)\n  \n  @@map(\"users\")\n}\n` : ''}\n`;\n  }\n\n  private generateWelcomeTemplate(): string {\n    return `<!-- SUBJECT: Welcome to {{appName}}! -->\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Welcome</title>\n</head>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px;\">\n    <h1 style=\"color: #4F46E5;\">Welcome to {{appName}}!</h1>\n    <p>Hi {{name}},</p>\n    <p>Thank you for signing up. We're excited to have you on board!</p>\n    <p>Get started by exploring our features and let us know if you need any help.</p>\n    <p>Best regards,<br>The {{appName}} Team</p>\n  </div>\n</body>\n</html>\n`;\n  }\n\n  private generatePasswordResetTemplate(): string {\n    return `<!-- SUBJECT: Reset Your Password -->\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Password Reset</title>\n</head>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px;\">\n    <h1 style=\"color: #4F46E5;\">Reset Your Password</h1>\n    <p>Hi {{name}},</p>\n    <p>We received a request to reset your password. Click the button below to create a new password:</p>\n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"{{resetUrl}}\" style=\"background-color: #4F46E5; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">Reset Password</a>\n    </div>\n    <p>If you didn't request this, you can safely ignore this email.</p>\n    <p>This link will expire in 1 hour.</p>\n    <p>Best regards,<br>The {{appName}} Team</p>\n  </div>\n</body>\n</html>\n`;\n  }\n\n  private generateVerificationTemplate(): string {\n    return `<!-- SUBJECT: Verify Your Email Address -->\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Email Verification</title>\n</head>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px;\">\n    <h1 style=\"color: #4F46E5;\">Verify Your Email</h1>\n    <p>Please verify your email address by clicking the button below:</p>\n    <div style=\"text-align: center; margin: 30px 0;\">\n      <a href=\"{{verificationUrl}}\" style=\"background-color: #4F46E5; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;\">Verify Email</a>\n    </div>\n    <p>If you didn't create an account, you can safely ignore this email.</p>\n    <p>Best regards,<br>The {{appName}} Team</p>\n  </div>\n</body>\n</html>\n`;\n  }\n\n  private generatePackageJson(config: EmailServiceConfig): string {\n    const provider = config.provider || 'sendgrid';\n    const dependencies: Record<string, string> = {\n      express: '^4.18.2',\n      cors: '^2.8.5',\n      helmet: '^7.1.0',\n      zod: '^3.22.4',\n      '@prisma/client': '^5.7.1',\n    };\n\n    if (provider === 'sendgrid') {\n      dependencies['@sendgrid/mail'] = '^7.7.0';\n    } else if (provider === 'ses') {\n      dependencies['@aws-sdk/client-ses'] = '^3.470.0';\n    } else if (provider === 'smtp') {\n      dependencies['nodemailer'] = '^6.9.7';\n    }\n\n    if (config.enableTemplates) {\n      dependencies['handlebars'] = '^4.7.8';\n    }\n\n    return JSON.stringify({\n      name: 'email-service',\n      version: '1.0.0',\n      description: 'Email Service with Templates',\n      main: 'dist/index.js',\n      scripts: {\n        dev: 'ts-node-dev --respawn --transpile-only src/index.ts',\n        build: 'tsc',\n        start: 'node dist/index.js',\n        test: 'jest',\n        'test:watch': 'jest --watch',\n        'prisma:generate': 'prisma generate',\n        'prisma:migrate': 'prisma migrate dev',\n      },\n      dependencies,\n      devDependencies: {\n        '@types/express': '^4.17.21',\n        '@types/cors': '^2.8.17',\n        '@types/node': '^20.10.5',\n        ...(provider === 'smtp' && { '@types/nodemailer': '^6.4.14' }),\n        ...(config.enableTemplates && { '@types/handlebars': '^4.1.0' }),\n        typescript: '^5.3.3',\n        'ts-node-dev': '^2.0.0',\n        jest: '^29.7.0',\n        '@types/jest': '^29.5.11',\n        'ts-jest': '^29.1.1',\n        prisma: '^5.7.1',\n      },\n    }, null, 2);\n  }\n\n  private generateEnvExample(config: EmailServiceConfig): string {\n    const provider = config.provider || 'sendgrid';\n    let env = `PORT=${config.port || 3003}\\nNODE_ENV=development\\n\\nDATABASE_URL=postgresql://user:password@localhost:5432/email_db\\n\\nEMAIL_FROM=noreply@example.com\\n`;\n\n    if (provider === 'sendgrid') {\n      env += '\\nSENDGRID_API_KEY=your_sendgrid_api_key\\n';\n    } else if (provider === 'ses') {\n      env += '\\nAWS_REGION=us-east-1\\nAWS_ACCESS_KEY_ID=your_access_key\\nAWS_SECRET_ACCESS_KEY=your_secret_key\\n';\n    } else if (provider === 'smtp') {\n      env += '\\nSMTP_HOST=smtp.example.com\\nSMTP_PORT=587\\nSMTP_SECURE=false\\nSMTP_USER=your_smtp_user\\nSMTP_PASS=your_smtp_password\\n';\n    }\n\n    if (config.enableVerification) {\n      env += '\\nAPP_URL=http://localhost:3000\\n';\n    }\n\n    return env;\n  }\n\n  private generateReadme(config: EmailServiceConfig): string {\n    const provider = config.provider || 'sendgrid';\n    return `# Email Service\n\nEmail service with ${provider.toUpperCase()} integration${config.enableTemplates ? ' and template support' : ''}.\n\n## Features\n\n- Email sending via ${provider.toUpperCase()}\n${config.enableTemplates ? '- HTML email templates with Handlebars\\n' : ''}- Transactional email tracking\n${config.enableVerification ? '- Email verification\\n' : ''}- Email status monitoring\n\n## Installation\n\n\\`\\`\\`bash\nnpm install\n\\`\\`\\`\n\n## Database Setup\n\n\\`\\`\\`bash\nnpx prisma migrate dev\nnpx prisma generate\n\\`\\`\\`\n\n## Configuration\n\nCopy \\`.env.example\\` to \\`.env\\` and configure your ${provider.toUpperCase()} credentials.\n\n## Development\n\n\\`\\`\\`bash\nnpm run dev\n\\`\\`\\`\n\n## Production\n\n\\`\\`\\`bash\nnpm run build\nnpm start\n\\`\\`\\`\n\n## API Endpoints\n\n- \\`POST /api/email/send\\` - Send email\n${config.enableTemplates ? '- `POST /api/email/send-template` - Send template email\\n' : ''}${config.enableVerification ? '- `POST /api/email/verify` - Send verification email\\n- `GET /api/email/verify/:token` - Verify email token\\n' : ''}- \\`GET /api/email/:id\\` - Get email status\n- \\`GET /api/email\\` - List sent emails\n\n## Testing\n\n\\`\\`\\`bash\nnpm test\n\\`\\`\\`\n${config.enableTemplates ? `\n## Email Templates\n\nTemplates are located in the \\`templates/\\` directory and use Handlebars syntax.\n\nAvailable templates:\n- \\`welcome.html\\` - Welcome email\n- \\`password-reset.html\\` - Password reset email\n- \\`verification.html\\` - Email verification\n\nTo create a new template, add an HTML file with a subject comment:\n\\`\\`\\`html\n<!-- SUBJECT: Your Subject Here -->\n<!DOCTYPE html>\n<html>\n  <!-- Your template content -->\n</html>\n\\`\\`\\`\n` : ''}\n`;\n  }\n}\n"],"mappings":"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I,IAAI,CAAC;MACX9B,IAAI,EAAEA,IAAI,CAAC6B,IAAI,CAACD,UAAU,EAAE,cAAc,CAAC;MAC3CG,IAAI,EAAE,QAAQ;MACdC,OAAO,EAAE,IAAI,CAACe,kBAAkB,CAACvB,MAAM;IACzC,CAAC,CAAC;IAEFE,OAAO,CAACI,IAAI,CAAC;MACX9B,IAAI,EAAEA,IAAI,CAAC6B,IAAI,CAACD,UAAU,EAAE,WAAW,CAAC;MACxCG,IAAI,EAAE,QAAQ;MACdC,OAAO,EAAE,IAAI,CAACgB,cAAc,CAACxB,MAAM;IACrC,CAAC,CAAC;IAEF,OAAOE,OAAO;EAChB;EAEQO,iBAAiBA,CAACT,MAA0B,EAAU;IAC5D,MAAMyB,IAAI,GAAGzB,MAAM,CAACyB,IAAI,IAAI,IAAI;IAChC,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmCA,IAAI;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQf,uBAAuBA,CAACV,MAA0B,EAAU;IAClE,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEA,MAAM,CAAC0B,kBAAkB,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,EAAE;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE1B,MAAM,CAAC0B,kBAAkB,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,EAAE;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQf,wBAAwBA,CAACX,MAA0B,EAAU;IACnE,OAAO;AACX,EAAEA,MAAM,CAACa,eAAe,GAAG,uDAAuD,GAAG,EAAE;AACvF;AACA;AACA,EAAEb,MAAM,CAAC0B,kBAAkB,GAAG,mCAAmC,GAAG,EAAE;AACtE;AACA;AACA;AACA,EAAE1B,MAAM,CAACa,eAAe,GAAG,6CAA6C,GAAG,EAAE;AAC7E;AACA;AACA;AACA;AACA,EAAEb,MAAM,CAACa,eAAe,GAAG,mDAAmD,GAAG,EAAE;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEb,MAAM,CAACa,eAAe,GAAG;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,EAAE,GAAGb,MAAM,CAAC0B,kBAAkB,GAAG;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,EAAE;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQd,uBAAuBA,CAACZ,MAA0B,EAAU;IAClE,MAAM2B,QAAQ,GAAG3B,MAAM,CAAC2B,QAAQ,IAAI,UAAU;IAE9C,OAAO,GAAGA,QAAQ,KAAK,UAAU,GAAG,sCAAsC,GAAG,EAAE;AACnF,EAAEA,QAAQ,KAAK,KAAK,GAAG,oEAAoE,GAAG,EAAE;AAChG,EAAEA,QAAQ,KAAK,MAAM,GAAG,sCAAsC,GAAG,EAAE;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEA,QAAQ,KAAK,UAAU,GAAG;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,GAAG,EAAE,GAAGA,QAAQ,KAAK,KAAK,GAAG;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,GAAG,EAAE,GAAGA,QAAQ,KAAK,MAAM,GAAG;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,GAAG,EAAE;AACT;AACA,CAAC;EACC;EAEQb,uBAAuBA,CAAA,EAAW;IACxC,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQC,uBAAuBA,CAAA,EAAW;IACxC,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQC,aAAaA,CAAChB,MAA0B,EAAU;IACxD,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQiB,yBAAyBA,CAACjB,MAA0B,EAAU;IACpE,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEA,MAAM,CAAC0B,kBAAkB,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,EAAE;AACN;AACA,CAAC;EACC;EAEQR,oBAAoBA,CAAClB,MAA0B,EAAU;IAC/D,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEA,MAAM,CAAC0B,kBAAkB,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,EAAE;AACN,CAAC;EACC;EAEQP,uBAAuBA,CAAA,EAAW;IACxC,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQC,6BAA6BA,CAAA,EAAW;IAC9C,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQC,4BAA4BA,CAAA,EAAW;IAC7C,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQC,mBAAmBA,CAACtB,MAA0B,EAAU;IAC9D,MAAM2B,QAAQ,GAAG3B,MAAM,CAAC2B,QAAQ,IAAI,UAAU;IAC9C,MAAMC,YAAoC,GAAG;MAC3CC,OAAO,EAAE,SAAS;MAClBC,IAAI,EAAE,QAAQ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","ignoreList":[]}