5f26b4d677f5f3497115c35042a65521
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.EmailServiceComponent = void 0;
var path = _interopRequireWildcard(require("path"));
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) "default" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }
class EmailServiceComponent {
  /**
   * Generate complete email service with templates
   */
  generateEmailService(config, outputDir) {
    const changes = [];
    const serviceName = 'email-service';
    const serviceDir = path.join(outputDir, 'services', serviceName);

    // Main service file
    changes.push({
      path: path.join(serviceDir, 'src', 'index.ts'),
      type: 'create',
      content: this.generateIndexFile(config)
    });

    // Controllers
    changes.push({
      path: path.join(serviceDir, 'src', 'controllers', 'email.controller.ts'),
      type: 'create',
      content: this.generateEmailController(config)
    });

    // Services
    changes.push({
      path: path.join(serviceDir, 'src', 'services', 'email.service.ts'),
      type: 'create',
      content: this.generateEmailServiceFile(config)
    });
    changes.push({
      path: path.join(serviceDir, 'src', 'services', 'provider.service.ts'),
      type: 'create',
      content: this.generateProviderService(config)
    });
    if (config.enableTemplates) {
      changes.push({
        path: path.join(serviceDir, 'src', 'services', 'template.service.ts'),
        type: 'create',
        content: this.generateTemplateService()
      });
    }

    // Repository
    changes.push({
      path: path.join(serviceDir, 'src', 'repositories', 'email.repository.ts'),
      type: 'create',
      content: this.generateEmailRepository()
    });

    // Types
    changes.push({
      path: path.join(serviceDir, 'src', 'types', 'index.ts'),
      type: 'create',
      content: this.generateTypes(config)
    });

    // Validation schemas
    changes.push({
      path: path.join(serviceDir, 'src', 'validation', 'email.schemas.ts'),
      type: 'create',
      content: this.generateValidationSchemas(config)
    });

    // Prisma schema
    changes.push({
      path: path.join(serviceDir, 'prisma', 'schema.prisma'),
      type: 'create',
      content: this.generatePrismaSchema(config)
    });

    // Email templates
    if (config.enableTemplates) {
      changes.push({
        path: path.join(serviceDir, 'templates', 'welcome.html'),
        type: 'create',
        content: this.generateWelcomeTemplate()
      });
      changes.push({
        path: path.join(serviceDir, 'templates', 'password-reset.html'),
        type: 'create',
        content: this.generatePasswordResetTemplate()
      });
      changes.push({
        path: path.join(serviceDir, 'templates', 'verification.html'),
        type: 'create',
        content: this.generateVerificationTemplate()
      });
    }

    // Configuration files
    changes.push({
      path: path.join(serviceDir, 'package.json'),
      type: 'create',
      content: this.generatePackageJson(config)
    });
    changes.push({
      path: path.join(serviceDir, '.env.example'),
      type: 'create',
      content: this.generateEnvExample(config)
    });
    changes.push({
      path: path.join(serviceDir, 'README.md'),
      type: 'create',
      content: this.generateReadme(config)
    });
    return changes;
  }
  generateIndexFile(config) {
    const port = config.port || 3003;
    return `import express, { Application } from 'express';
import cors from 'cors';
import helmet from 'helmet';
import { EmailController } from './controllers/email.controller';
import { errorHandler } from './middleware/error-handler';

const app: Application = express();
const PORT = process.env.PORT || ${port};

// Middleware
app.use(helmet());
app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Health check
app.get('/health', (req, res) => {
  res.json({ status: 'healthy', service: 'email-service' });
});

// Routes
const emailController = new EmailController();
app.use('/api/email', emailController.router);

// Error handling
app.use(errorHandler);

// Start server
app.listen(PORT, () => {
  console.log(\`Email service running on port \${PORT}\`);
});

export default app;
`;
  }
  generateEmailController(config) {
    return `import { Router, Request, Response, NextFunction } from 'express';
import { EmailService } from '../services/email.service';
import { validate } from '../middleware/validation';
import { EmailSchemas } from '../validation/email.schemas';
import { authMiddleware } from '../middleware/auth.middleware';

export class EmailController {
  public router: Router;
  private emailService: EmailService;

  constructor() {
    this.router = Router();
    this.emailService = new EmailService();
    this.initializeRoutes();
  }

  private initializeRoutes(): void {
    // Send email
    this.router.post(
      '/send',
      authMiddleware,
      validate(EmailSchemas.send),
      this.sendEmail.bind(this)
    );
    
    // Send template email
    this.router.post(
      '/send-template',
      authMiddleware,
      validate(EmailSchemas.sendTemplate),
      this.sendTemplateEmail.bind(this)
    );
${config.enableVerification ? `
    // Send verification email
    this.router.post(
      '/verify',
      authMiddleware,
      validate(EmailSchemas.verify),
      this.sendVerificationEmail.bind(this)
    );
    
    // Verify email token
    this.router.get('/verify/:token', this.verifyEmailToken.bind(this));
` : ''}
    // Get email status
    this.router.get('/:id', authMiddleware, this.getEmailStatus.bind(this));
    
    // List sent emails
    this.router.get('/', authMiddleware, this.listEmails.bind(this));
  }

  private async sendEmail(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const result = await this.emailService.sendEmail(req.body);
      res.json({ success: true, data: result });
    } catch (error) {
      next(error);
    }
  }

  private async sendTemplateEmail(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const result = await this.emailService.sendTemplateEmail(
        req.body.to,
        req.body.template,
        req.body.data
      );
      res.json({ success: true, data: result });
    } catch (error) {
      next(error);
    }
  }
${config.enableVerification ? `
  private async sendVerificationEmail(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      await this.emailService.sendVerificationEmail(req.body.email, req.body.userId);
      res.json({ success: true, message: 'Verification email sent' });
    } catch (error) {
      next(error);
    }
  }

  private async verifyEmailToken(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      await this.emailService.verifyEmailToken(req.params.token);
      res.json({ success: true, message: 'Email verified successfully' });
    } catch (error) {
      next(error);
    }
  }
` : ''}
  private async getEmailStatus(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const email = await this.emailService.getEmailById(req.params.id);
      res.json({ success: true, data: email });
    } catch (error) {
      next(error);
    }
  }

  private async listEmails(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const emails = await this.emailService.listEmails();
      res.json({ success: true, data: emails });
    } catch (error) {
      next(error);
    }
  }
}
`;
  }
  generateEmailServiceFile(config) {
    return `import { ProviderService } from './provider.service';
${config.enableTemplates ? "import { TemplateService } from './template.service';" : ''}
import { EmailRepository } from '../repositories/email.repository';
import { SendEmailInput, Email } from '../types';
${config.enableVerification ? "import * as crypto from 'crypto';" : ''}

export class EmailService {
  private providerService: ProviderService;
${config.enableTemplates ? '  private templateService: TemplateService;' : ''}
  private emailRepository: EmailRepository;

  constructor() {
    this.providerService = new ProviderService();
${config.enableTemplates ? '    this.templateService = new TemplateService();' : ''}
    this.emailRepository = new EmailRepository();
  }

  async sendEmail(input: SendEmailInput): Promise<Email> {
    // Send via provider
    const messageId = await this.providerService.send({
      to: input.to,
      from: input.from || process.env.EMAIL_FROM || 'noreply@example.com',
      subject: input.subject,
      html: input.html,
      text: input.text,
    });

    // Save to database
    const email = await this.emailRepository.create({
      to: input.to,
      from: input.from || process.env.EMAIL_FROM || 'noreply@example.com',
      subject: input.subject,
      html: input.html,
      text: input.text,
      messageId,
      status: 'sent',
    });

    return email;
  }
${config.enableTemplates ? `
  async sendTemplateEmail(to: string, templateName: string, data: Record<string, any>): Promise<Email> {
    const { subject, html, text } = await this.templateService.render(templateName, data);

    return this.sendEmail({
      to,
      subject,
      html,
      text,
    });
  }
` : ''}${config.enableVerification ? `
  async sendVerificationEmail(email: string, userId: string): Promise<void> {
    const token = crypto.randomBytes(32).toString('hex');
    const verificationUrl = \`\${process.env.APP_URL}/verify-email/\${token}\`;

    await this.emailRepository.saveVerificationToken(userId, token);

    await this.sendTemplateEmail(email, 'verification', {
      verificationUrl,
    });
  }

  async verifyEmailToken(token: string): Promise<void> {
    const verification = await this.emailRepository.findVerificationToken(token);
    
    if (!verification) {
      throw new Error('Invalid or expired verification token');
    }

    await this.emailRepository.markEmailVerified(verification.userId);
    await this.emailRepository.deleteVerificationToken(token);
  }
` : ''}
  async getEmailById(id: string): Promise<Email | null> {
    return this.emailRepository.findById(id);
  }

  async listEmails(): Promise<Email[]> {
    return this.emailRepository.findAll();
  }
}
`;
  }
  generateProviderService(config) {
    const provider = config.provider || 'sendgrid';
    return `${provider === 'sendgrid' ? "import sgMail from '@sendgrid/mail';" : ''}
${provider === 'ses' ? "import { SESClient, SendEmailCommand } from '@aws-sdk/client-ses';" : ''}
${provider === 'smtp' ? "import nodemailer from 'nodemailer';" : ''}

interface SendEmailParams {
  to: string;
  from: string;
  subject: string;
  html?: string;
  text?: string;
}

export class ProviderService {
${provider === 'sendgrid' ? `  constructor() {
    const apiKey = process.env.SENDGRID_API_KEY;
    if (!apiKey) {
      throw new Error('SENDGRID_API_KEY is required');
    }
    sgMail.setApiKey(apiKey);
  }

  async send(params: SendEmailParams): Promise<string> {
    const msg = {
      to: params.to,
      from: params.from,
      subject: params.subject,
      html: params.html,
      text: params.text,
    };

    const [response] = await sgMail.send(msg);
    return response.headers['x-message-id'] || '';
  }` : ''}${provider === 'ses' ? `  private sesClient: SESClient;

  constructor() {
    this.sesClient = new SESClient({
      region: process.env.AWS_REGION || 'us-east-1',
    });
  }

  async send(params: SendEmailParams): Promise<string> {
    const command = new SendEmailCommand({
      Source: params.from,
      Destination: {
        ToAddresses: [params.to],
      },
      Message: {
        Subject: {
          Data: params.subject,
        },
        Body: {
          Html: params.html ? { Data: params.html } : undefined,
          Text: params.text ? { Data: params.text } : undefined,
        },
      },
    });

    const response = await this.sesClient.send(command);
    return response.MessageId || '';
  }` : ''}${provider === 'smtp' ? `  private transporter: nodemailer.Transporter;

  constructor() {
    this.transporter = nodemailer.createTransport({
      host: process.env.SMTP_HOST,
      port: parseInt(process.env.SMTP_PORT || '587'),
      secure: process.env.SMTP_SECURE === 'true',
      auth: {
        user: process.env.SMTP_USER,
        pass: process.env.SMTP_PASS,
      },
    });
  }

  async send(params: SendEmailParams): Promise<string> {
    const info = await this.transporter.sendMail({
      from: params.from,
      to: params.to,
      subject: params.subject,
      html: params.html,
      text: params.text,
    });

    return info.messageId;
  }` : ''}
}
`;
  }
  generateTemplateService() {
    return `import * as fs from 'fs/promises';
import * as path from 'path';
import Handlebars from 'handlebars';

interface RenderedTemplate {
  subject: string;
  html: string;
  text: string;
}

export class TemplateService {
  private templatesDir: string;

  constructor() {
    this.templatesDir = path.join(__dirname, '../../templates');
  }

  async render(templateName: string, data: Record<string, any>): Promise<RenderedTemplate> {
    const templatePath = path.join(this.templatesDir, \`\${templateName}.html\`);
    const templateContent = await fs.readFile(templatePath, 'utf-8');

    const template = Handlebars.compile(templateContent);
    const html = template(data);

    // Extract subject from template (first line comment)
    const subjectMatch = html.match(/<!--\\s*SUBJECT:\\s*(.+?)\\s*-->/);
    const subject = subjectMatch ? subjectMatch[1] : 'No Subject';

    // Generate plain text version
    const text = this.htmlToText(html);

    return { subject, html, text };
  }

  private htmlToText(html: string): string {
    // Simple HTML to text conversion
    return html
      .replace(/<[^>]*>/g, '')
      .replace(/\\s+/g, ' ')
      .trim();
  }
}
`;
  }
  generateEmailRepository() {
    return `import { PrismaClient } from '@prisma/client';
import { Email, CreateEmailInput } from '../types';

const prisma = new PrismaClient();

export class EmailRepository {
  async create(data: CreateEmailInput): Promise<Email> {
    return prisma.email.create({ data });
  }

  async findById(id: string): Promise<Email | null> {
    return prisma.email.findUnique({ where: { id } });
  }

  async findAll(): Promise<Email[]> {
    return prisma.email.findMany({
      orderBy: { createdAt: 'desc' },
      take: 100,
    });
  }

  async updateStatus(id: string, status: string): Promise<Email> {
    return prisma.email.update({
      where: { id },
      data: { status },
    });
  }

  async saveVerificationToken(userId: string, token: string): Promise<void> {
    await prisma.emailVerification.create({
      data: {
        userId,
        token,
        expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000), // 24 hours
      },
    });
  }

  async findVerificationToken(token: string): Promise<{ userId: string } | null> {
    return prisma.emailVerification.findFirst({
      where: {
        token,
        expiresAt: {
          gt: new Date(),
        },
      },
    });
  }

  async markEmailVerified(userId: string): Promise<void> {
    await prisma.user.update({
      where: { id: userId },
      data: { emailVerified: true },
    });
  }

  async deleteVerificationToken(token: string): Promise<void> {
    await prisma.emailVerification.deleteMany({
      where: { token },
    });
  }
}
`;
  }
  generateTypes(config) {
    return `export interface Email {
  id: string;
  to: string;
  from: string;
  subject: string;
  html?: string;
  text?: string;
  messageId: string;
  status: string;
  createdAt: Date;
  updatedAt: Date;
}

export interface CreateEmailInput {
  to: string;
  from: string;
  subject: string;
  html?: string;
  text?: string;
  messageId: string;
  status: string;
}

export interface SendEmailInput {
  to: string;
  from?: string;
  subject: string;
  html?: string;
  text?: string;
}
`;
  }
  generateValidationSchemas(config) {
    return `import { z } from 'zod';

export const EmailSchemas = {
  send: z.object({
    body: z.object({
      to: z.string().email('Invalid email address'),
      from: z.string().email('Invalid email address').optional(),
      subject: z.string().min(1, 'Subject is required'),
      html: z.string().optional(),
      text: z.string().optional(),
    }),
  }),

  sendTemplate: z.object({
    body: z.object({
      to: z.string().email('Invalid email address'),
      template: z.string().min(1, 'Template name is required'),
      data: z.record(z.any()),
    }),
  }),
${config.enableVerification ? `
  verify: z.object({
    body: z.object({
      email: z.string().email('Invalid email address'),
      userId: z.string().min(1, 'User ID is required'),
    }),
  }),
` : ''}
};
`;
  }
  generatePrismaSchema(config) {
    return `generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Email {
  id        String   @id @default(cuid())
  to        String
  from      String
  subject   String
  html      String?  @db.Text
  text      String?  @db.Text
  messageId String
  status    String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@index([status])
  @@index([createdAt])
  @@map("emails")
}
${config.enableVerification ? `
model EmailVerification {
  id        String   @id @default(cuid())
  userId    String
  token     String   @unique
  expiresAt DateTime
  createdAt DateTime @default(now())
  
  @@index([token])
  @@index([userId])
  @@map("email_verifications")
}

model User {
  id            String  @id @default(cuid())
  email         String  @unique
  emailVerified Boolean @default(false)
  
  @@map("users")
}
` : ''}
`;
  }
  generateWelcomeTemplate() {
    return `<!-- SUBJECT: Welcome to {{appName}}! -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Welcome</title>
</head>
<body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333;">
  <div style="max-width: 600px; margin: 0 auto; padding: 20px;">
    <h1 style="color: #4F46E5;">Welcome to {{appName}}!</h1>
    <p>Hi {{name}},</p>
    <p>Thank you for signing up. We're excited to have you on board!</p>
    <p>Get started by exploring our features and let us know if you need any help.</p>
    <p>Best regards,<br>The {{appName}} Team</p>
  </div>
</body>
</html>
`;
  }
  generatePasswordResetTemplate() {
    return `<!-- SUBJECT: Reset Your Password -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Password Reset</title>
</head>
<body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333;">
  <div style="max-width: 600px; margin: 0 auto; padding: 20px;">
    <h1 style="color: #4F46E5;">Reset Your Password</h1>
    <p>Hi {{name}},</p>
    <p>We received a request to reset your password. Click the button below to create a new password:</p>
    <div style="text-align: center; margin: 30px 0;">
      <a href="{{resetUrl}}" style="background-color: #4F46E5; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;">Reset Password</a>
    </div>
    <p>If you didn't request this, you can safely ignore this email.</p>
    <p>This link will expire in 1 hour.</p>
    <p>Best regards,<br>The {{appName}} Team</p>
  </div>
</body>
</html>
`;
  }
  generateVerificationTemplate() {
    return `<!-- SUBJECT: Verify Your Email Address -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Email Verification</title>
</head>
<body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333;">
  <div style="max-width: 600px; margin: 0 auto; padding: 20px;">
    <h1 style="color: #4F46E5;">Verify Your Email</h1>
    <p>Please verify your email address by clicking the button below:</p>
    <div style="text-align: center; margin: 30px 0;">
      <a href="{{verificationUrl}}" style="background-color: #4F46E5; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;">Verify Email</a>
    </div>
    <p>If you didn't create an account, you can safely ignore this email.</p>
    <p>Best regards,<br>The {{appName}} Team</p>
  </div>
</body>
</html>
`;
  }
  generatePackageJson(config) {
    const provider = config.provider || 'sendgrid';
    const dependencies = {
      express: '^4.18.2',
      cors: '^2.8.5',
      helmet: '^7.1.0',
      zod: '^3.22.4',
      '@prisma/client': '^5.7.1'
    };
    if (provider === 'sendgrid') {
      dependencies['@sendgrid/mail'] = '^7.7.0';
    } else if (provider === 'ses') {
      dependencies['@aws-sdk/client-ses'] = '^3.470.0';
    } else if (provider === 'smtp') {
      dependencies['nodemailer'] = '^6.9.7';
    }
    if (config.enableTemplates) {
      dependencies['handlebars'] = '^4.7.8';
    }
    return JSON.stringify({
      name: 'email-service',
      version: '1.0.0',
      description: 'Email Service with Templates',
      main: 'dist/index.js',
      scripts: {
        dev: 'ts-node-dev --respawn --transpile-only src/index.ts',
        build: 'tsc',
        start: 'node dist/index.js',
        test: 'jest',
        'test:watch': 'jest --watch',
        'prisma:generate': 'prisma generate',
        'prisma:migrate': 'prisma migrate dev'
      },
      dependencies,
      devDependencies: {
        '@types/express': '^4.17.21',
        '@types/cors': '^2.8.17',
        '@types/node': '^20.10.5',
        ...(provider === 'smtp' && {
          '@types/nodemailer': '^6.4.14'
        }),
        ...(config.enableTemplates && {
          '@types/handlebars': '^4.1.0'
        }),
        typescript: '^5.3.3',
        'ts-node-dev': '^2.0.0',
        jest: '^29.7.0',
        '@types/jest': '^29.5.11',
        'ts-jest': '^29.1.1',
        prisma: '^5.7.1'
      }
    }, null, 2);
  }
  generateEnvExample(config) {
    const provider = config.provider || 'sendgrid';
    let env = `PORT=${config.port || 3003}\nNODE_ENV=development\n\nDATABASE_URL=postgresql://user:password@localhost:5432/email_db\n\nEMAIL_FROM=noreply@example.com\n`;
    if (provider === 'sendgrid') {
      env += '\nSENDGRID_API_KEY=your_sendgrid_api_key\n';
    } else if (provider === 'ses') {
      env += '\nAWS_REGION=us-east-1\nAWS_ACCESS_KEY_ID=your_access_key\nAWS_SECRET_ACCESS_KEY=your_secret_key\n';
    } else if (provider === 'smtp') {
      env += '\nSMTP_HOST=smtp.example.com\nSMTP_PORT=587\nSMTP_SECURE=false\nSMTP_USER=your_smtp_user\nSMTP_PASS=your_smtp_password\n';
    }
    if (config.enableVerification) {
      env += '\nAPP_URL=http://localhost:3000\n';
    }
    return env;
  }
  generateReadme(config) {
    const provider = config.provider || 'sendgrid';
    return `# Email Service

Email service with ${provider.toUpperCase()} integration${config.enableTemplates ? ' and template support' : ''}.

## Features

- Email sending via ${provider.toUpperCase()}
${config.enableTemplates ? '- HTML email templates with Handlebars\n' : ''}- Transactional email tracking
${config.enableVerification ? '- Email verification\n' : ''}- Email status monitoring

## Installation

\`\`\`bash
npm install
\`\`\`

## Database Setup

\`\`\`bash
npx prisma migrate dev
npx prisma generate
\`\`\`

## Configuration

Copy \`.env.example\` to \`.env\` and configure your ${provider.toUpperCase()} credentials.

## Development

\`\`\`bash
npm run dev
\`\`\`

## Production

\`\`\`bash
npm run build
npm start
\`\`\`

## API Endpoints

- \`POST /api/email/send\` - Send email
${config.enableTemplates ? '- `POST /api/email/send-template` - Send template email\n' : ''}${config.enableVerification ? '- `POST /api/email/verify` - Send verification email\n- `GET /api/email/verify/:token` - Verify email token\n' : ''}- \`GET /api/email/:id\` - Get email status
- \`GET /api/email\` - List sent emails

## Testing

\`\`\`bash
npm test
\`\`\`
${config.enableTemplates ? `
## Email Templates

Templates are located in the \`templates/\` directory and use Handlebars syntax.

Available templates:
- \`welcome.html\` - Welcome email
- \`password-reset.html\` - Password reset email
- \`verification.html\` - Email verification

To create a new template, add an HTML file with a subject comment:
\`\`\`html
<!-- SUBJECT: Your Subject Here -->
<!DOCTYPE html>
<html>
  <!-- Your template content -->
</html>
\`\`\`
` : ''}
`;
  }
}
exports.EmailServiceComponent = EmailServiceComponent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwYXRoIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiZSIsInQiLCJXZWFrTWFwIiwiciIsIm4iLCJfX2VzTW9kdWxlIiwibyIsImkiLCJmIiwiX19wcm90b19fIiwiZGVmYXVsdCIsImhhcyIsImdldCIsInNldCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiRW1haWxTZXJ2aWNlQ29tcG9uZW50IiwiZ2VuZXJhdGVFbWFpbFNlcnZpY2UiLCJjb25maWciLCJvdXRwdXREaXIiLCJjaGFuZ2VzIiwic2VydmljZU5hbWUiLCJzZXJ2aWNlRGlyIiwiam9pbiIsInB1c2giLCJ0eXBlIiwiY29udGVudCIsImdlbmVyYXRlSW5kZXhGaWxlIiwiZ2VuZXJhdGVFbWFpbENvbnRyb2xsZXIiLCJnZW5lcmF0ZUVtYWlsU2VydmljZUZpbGUiLCJnZW5lcmF0ZVByb3ZpZGVyU2VydmljZSIsImVuYWJsZVRlbXBsYXRlcyIsImdlbmVyYXRlVGVtcGxhdGVTZXJ2aWNlIiwiZ2VuZXJhdGVFbWFpbFJlcG9zaXRvcnkiLCJnZW5lcmF0ZVR5cGVzIiwiZ2VuZXJhdGVWYWxpZGF0aW9uU2NoZW1hcyIsImdlbmVyYXRlUHJpc21hU2NoZW1hIiwiZ2VuZXJhdGVXZWxjb21lVGVtcGxhdGUiLCJnZW5lcmF0ZVBhc3N3b3JkUmVzZXRUZW1wbGF0ZSIsImdlbmVyYXRlVmVyaWZpY2F0aW9uVGVtcGxhdGUiLCJnZW5lcmF0ZVBhY2thZ2VKc29uIiwiZ2VuZXJhdGVFbnZFeGFtcGxlIiwiZ2VuZXJhdGVSZWFkbWUiLCJwb3J0IiwiZW5hYmxlVmVyaWZpY2F0aW9uIiwicHJvdmlkZXIiLCJkZXBlbmRlbmNpZXMiLCJleHByZXNzIiwiY29ycyIsImhlbG1ldCIsInpvZCIsIkpTT04iLCJzdHJpbmdpZnkiLCJuYW1lIiwidmVyc2lvbiIsImRlc2NyaXB0aW9uIiwibWFpbiIsInNjcmlwdHMiLCJkZXYiLCJidWlsZCIsInN0YXJ0IiwidGVzdCIsImRldkRlcGVuZGVuY2llcyIsInR5cGVzY3JpcHQiLCJqZXN0IiwicHJpc21hIiwiZW52IiwidG9VcHBlckNhc2UiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiRW1haWxTZXJ2aWNlQ29tcG9uZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBGaWxlQ2hhbmdlIH0gZnJvbSAnLi4vQ2hhbmdlc2V0TWFuYWdlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlQ29uZmlnIHtcbiAgbmFtZTogc3RyaW5nO1xuICBwb3J0PzogbnVtYmVyO1xuICBwcm92aWRlcj86ICdzZW5kZ3JpZCcgfCAnc2VzJyB8ICdzbXRwJztcbiAgZW5hYmxlVGVtcGxhdGVzPzogYm9vbGVhbjtcbiAgZW5hYmxlVmVyaWZpY2F0aW9uPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIEVtYWlsU2VydmljZUNvbXBvbmVudCB7XG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBjb21wbGV0ZSBlbWFpbCBzZXJ2aWNlIHdpdGggdGVtcGxhdGVzXG4gICAqL1xuICBnZW5lcmF0ZUVtYWlsU2VydmljZShjb25maWc6IEVtYWlsU2VydmljZUNvbmZpZywgb3V0cHV0RGlyOiBzdHJpbmcpOiBGaWxlQ2hhbmdlW10ge1xuICAgIGNvbnN0IGNoYW5nZXM6IEZpbGVDaGFuZ2VbXSA9IFtdO1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gJ2VtYWlsLXNlcnZpY2UnO1xuICAgIGNvbnN0IHNlcnZpY2VEaXIgPSBwYXRoLmpvaW4ob3V0cHV0RGlyLCAnc2VydmljZXMnLCBzZXJ2aWNlTmFtZSk7XG5cbiAgICAvLyBNYWluIHNlcnZpY2UgZmlsZVxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ3NyYycsICdpbmRleC50cycpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlSW5kZXhGaWxlKGNvbmZpZyksXG4gICAgfSk7XG5cbiAgICAvLyBDb250cm9sbGVyc1xuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ3NyYycsICdjb250cm9sbGVycycsICdlbWFpbC5jb250cm9sbGVyLnRzJyksXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgIGNvbnRlbnQ6IHRoaXMuZ2VuZXJhdGVFbWFpbENvbnRyb2xsZXIoY29uZmlnKSxcbiAgICB9KTtcblxuICAgIC8vIFNlcnZpY2VzXG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHBhdGg6IHBhdGguam9pbihzZXJ2aWNlRGlyLCAnc3JjJywgJ3NlcnZpY2VzJywgJ2VtYWlsLnNlcnZpY2UudHMnKSxcbiAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZUVtYWlsU2VydmljZUZpbGUoY29uZmlnKSxcbiAgICB9KTtcblxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ3NyYycsICdzZXJ2aWNlcycsICdwcm92aWRlci5zZXJ2aWNlLnRzJyksXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgIGNvbnRlbnQ6IHRoaXMuZ2VuZXJhdGVQcm92aWRlclNlcnZpY2UoY29uZmlnKSxcbiAgICB9KTtcblxuICAgIGlmIChjb25maWcuZW5hYmxlVGVtcGxhdGVzKSB7XG4gICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ3NyYycsICdzZXJ2aWNlcycsICd0ZW1wbGF0ZS5zZXJ2aWNlLnRzJyksXG4gICAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlVGVtcGxhdGVTZXJ2aWNlKCksXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBSZXBvc2l0b3J5XG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHBhdGg6IHBhdGguam9pbihzZXJ2aWNlRGlyLCAnc3JjJywgJ3JlcG9zaXRvcmllcycsICdlbWFpbC5yZXBvc2l0b3J5LnRzJyksXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgIGNvbnRlbnQ6IHRoaXMuZ2VuZXJhdGVFbWFpbFJlcG9zaXRvcnkoKSxcbiAgICB9KTtcblxuICAgIC8vIFR5cGVzXG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHBhdGg6IHBhdGguam9pbihzZXJ2aWNlRGlyLCAnc3JjJywgJ3R5cGVzJywgJ2luZGV4LnRzJyksXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgIGNvbnRlbnQ6IHRoaXMuZ2VuZXJhdGVUeXBlcyhjb25maWcpLFxuICAgIH0pO1xuXG4gICAgLy8gVmFsaWRhdGlvbiBzY2hlbWFzXG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHBhdGg6IHBhdGguam9pbihzZXJ2aWNlRGlyLCAnc3JjJywgJ3ZhbGlkYXRpb24nLCAnZW1haWwuc2NoZW1hcy50cycpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlVmFsaWRhdGlvblNjaGVtYXMoY29uZmlnKSxcbiAgICB9KTtcblxuICAgIC8vIFByaXNtYSBzY2hlbWFcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICdwcmlzbWEnLCAnc2NoZW1hLnByaXNtYScpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlUHJpc21hU2NoZW1hKGNvbmZpZyksXG4gICAgfSk7XG5cbiAgICAvLyBFbWFpbCB0ZW1wbGF0ZXNcbiAgICBpZiAoY29uZmlnLmVuYWJsZVRlbXBsYXRlcykge1xuICAgICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICd0ZW1wbGF0ZXMnLCAnd2VsY29tZS5odG1sJyksXG4gICAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlV2VsY29tZVRlbXBsYXRlKCksXG4gICAgICB9KTtcblxuICAgICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICd0ZW1wbGF0ZXMnLCAncGFzc3dvcmQtcmVzZXQuaHRtbCcpLFxuICAgICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZVBhc3N3b3JkUmVzZXRUZW1wbGF0ZSgpLFxuICAgICAgfSk7XG5cbiAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgIHBhdGg6IHBhdGguam9pbihzZXJ2aWNlRGlyLCAndGVtcGxhdGVzJywgJ3ZlcmlmaWNhdGlvbi5odG1sJyksXG4gICAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlVmVyaWZpY2F0aW9uVGVtcGxhdGUoKSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIENvbmZpZ3VyYXRpb24gZmlsZXNcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICdwYWNrYWdlLmpzb24nKSxcbiAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZVBhY2thZ2VKc29uKGNvbmZpZyksXG4gICAgfSk7XG5cbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICcuZW52LmV4YW1wbGUnKSxcbiAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZUVudkV4YW1wbGUoY29uZmlnKSxcbiAgICB9KTtcblxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ1JFQURNRS5tZCcpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlUmVhZG1lKGNvbmZpZyksXG4gICAgfSk7XG5cbiAgICByZXR1cm4gY2hhbmdlcztcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVJbmRleEZpbGUoY29uZmlnOiBFbWFpbFNlcnZpY2VDb25maWcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBvcnQgPSBjb25maWcucG9ydCB8fCAzMDAzO1xuICAgIHJldHVybiBgaW1wb3J0IGV4cHJlc3MsIHsgQXBwbGljYXRpb24gfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBjb3JzIGZyb20gJ2NvcnMnO1xuaW1wb3J0IGhlbG1ldCBmcm9tICdoZWxtZXQnO1xuaW1wb3J0IHsgRW1haWxDb250cm9sbGVyIH0gZnJvbSAnLi9jb250cm9sbGVycy9lbWFpbC5jb250cm9sbGVyJztcbmltcG9ydCB7IGVycm9ySGFuZGxlciB9IGZyb20gJy4vbWlkZGxld2FyZS9lcnJvci1oYW5kbGVyJztcblxuY29uc3QgYXBwOiBBcHBsaWNhdGlvbiA9IGV4cHJlc3MoKTtcbmNvbnN0IFBPUlQgPSBwcm9jZXNzLmVudi5QT1JUIHx8ICR7cG9ydH07XG5cbi8vIE1pZGRsZXdhcmVcbmFwcC51c2UoaGVsbWV0KCkpO1xuYXBwLnVzZShjb3JzKCkpO1xuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTtcblxuLy8gSGVhbHRoIGNoZWNrXG5hcHAuZ2V0KCcvaGVhbHRoJywgKHJlcSwgcmVzKSA9PiB7XG4gIHJlcy5qc29uKHsgc3RhdHVzOiAnaGVhbHRoeScsIHNlcnZpY2U6ICdlbWFpbC1zZXJ2aWNlJyB9KTtcbn0pO1xuXG4vLyBSb3V0ZXNcbmNvbnN0IGVtYWlsQ29udHJvbGxlciA9IG5ldyBFbWFpbENvbnRyb2xsZXIoKTtcbmFwcC51c2UoJy9hcGkvZW1haWwnLCBlbWFpbENvbnRyb2xsZXIucm91dGVyKTtcblxuLy8gRXJyb3IgaGFuZGxpbmdcbmFwcC51c2UoZXJyb3JIYW5kbGVyKTtcblxuLy8gU3RhcnQgc2VydmVyXG5hcHAubGlzdGVuKFBPUlQsICgpID0+IHtcbiAgY29uc29sZS5sb2coXFxgRW1haWwgc2VydmljZSBydW5uaW5nIG9uIHBvcnQgXFwke1BPUlR9XFxgKTtcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBhcHA7XG5gO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUVtYWlsQ29udHJvbGxlcihjb25maWc6IEVtYWlsU2VydmljZUNvbmZpZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBpbXBvcnQgeyBSb3V0ZXIsIFJlcXVlc3QsIFJlc3BvbnNlLCBOZXh0RnVuY3Rpb24gfSBmcm9tICdleHByZXNzJztcbmltcG9ydCB7IEVtYWlsU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2VtYWlsLnNlcnZpY2UnO1xuaW1wb3J0IHsgdmFsaWRhdGUgfSBmcm9tICcuLi9taWRkbGV3YXJlL3ZhbGlkYXRpb24nO1xuaW1wb3J0IHsgRW1haWxTY2hlbWFzIH0gZnJvbSAnLi4vdmFsaWRhdGlvbi9lbWFpbC5zY2hlbWFzJztcbmltcG9ydCB7IGF1dGhNaWRkbGV3YXJlIH0gZnJvbSAnLi4vbWlkZGxld2FyZS9hdXRoLm1pZGRsZXdhcmUnO1xuXG5leHBvcnQgY2xhc3MgRW1haWxDb250cm9sbGVyIHtcbiAgcHVibGljIHJvdXRlcjogUm91dGVyO1xuICBwcml2YXRlIGVtYWlsU2VydmljZTogRW1haWxTZXJ2aWNlO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMucm91dGVyID0gUm91dGVyKCk7XG4gICAgdGhpcy5lbWFpbFNlcnZpY2UgPSBuZXcgRW1haWxTZXJ2aWNlKCk7XG4gICAgdGhpcy5pbml0aWFsaXplUm91dGVzKCk7XG4gIH1cblxuICBwcml2YXRlIGluaXRpYWxpemVSb3V0ZXMoKTogdm9pZCB7XG4gICAgLy8gU2VuZCBlbWFpbFxuICAgIHRoaXMucm91dGVyLnBvc3QoXG4gICAgICAnL3NlbmQnLFxuICAgICAgYXV0aE1pZGRsZXdhcmUsXG4gICAgICB2YWxpZGF0ZShFbWFpbFNjaGVtYXMuc2VuZCksXG4gICAgICB0aGlzLnNlbmRFbWFpbC5iaW5kKHRoaXMpXG4gICAgKTtcbiAgICBcbiAgICAvLyBTZW5kIHRlbXBsYXRlIGVtYWlsXG4gICAgdGhpcy5yb3V0ZXIucG9zdChcbiAgICAgICcvc2VuZC10ZW1wbGF0ZScsXG4gICAgICBhdXRoTWlkZGxld2FyZSxcbiAgICAgIHZhbGlkYXRlKEVtYWlsU2NoZW1hcy5zZW5kVGVtcGxhdGUpLFxuICAgICAgdGhpcy5zZW5kVGVtcGxhdGVFbWFpbC5iaW5kKHRoaXMpXG4gICAgKTtcbiR7Y29uZmlnLmVuYWJsZVZlcmlmaWNhdGlvbiA/IGBcbiAgICAvLyBTZW5kIHZlcmlmaWNhdGlvbiBlbWFpbFxuICAgIHRoaXMucm91dGVyLnBvc3QoXG4gICAgICAnL3ZlcmlmeScsXG4gICAgICBhdXRoTWlkZGxld2FyZSxcbiAgICAgIHZhbGlkYXRlKEVtYWlsU2NoZW1hcy52ZXJpZnkpLFxuICAgICAgdGhpcy5zZW5kVmVyaWZpY2F0aW9uRW1haWwuYmluZCh0aGlzKVxuICAgICk7XG4gICAgXG4gICAgLy8gVmVyaWZ5IGVtYWlsIHRva2VuXG4gICAgdGhpcy5yb3V0ZXIuZ2V0KCcvdmVyaWZ5Lzp0b2tlbicsIHRoaXMudmVyaWZ5RW1haWxUb2tlbi5iaW5kKHRoaXMpKTtcbmAgOiAnJ31cbiAgICAvLyBHZXQgZW1haWwgc3RhdHVzXG4gICAgdGhpcy5yb3V0ZXIuZ2V0KCcvOmlkJywgYXV0aE1pZGRsZXdhcmUsIHRoaXMuZ2V0RW1haWxTdGF0dXMuYmluZCh0aGlzKSk7XG4gICAgXG4gICAgLy8gTGlzdCBzZW50IGVtYWlsc1xuICAgIHRoaXMucm91dGVyLmdldCgnLycsIGF1dGhNaWRkbGV3YXJlLCB0aGlzLmxpc3RFbWFpbHMuYmluZCh0aGlzKSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHNlbmRFbWFpbChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmVtYWlsU2VydmljZS5zZW5kRW1haWwocmVxLmJvZHkpO1xuICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIG5leHQoZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2VuZFRlbXBsYXRlRW1haWwocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5lbWFpbFNlcnZpY2Uuc2VuZFRlbXBsYXRlRW1haWwoXG4gICAgICAgIHJlcS5ib2R5LnRvLFxuICAgICAgICByZXEuYm9keS50ZW1wbGF0ZSxcbiAgICAgICAgcmVxLmJvZHkuZGF0YVxuICAgICAgKTtcbiAgICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH1cbiR7Y29uZmlnLmVuYWJsZVZlcmlmaWNhdGlvbiA/IGBcbiAgcHJpdmF0ZSBhc3luYyBzZW5kVmVyaWZpY2F0aW9uRW1haWwocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5lbWFpbFNlcnZpY2Uuc2VuZFZlcmlmaWNhdGlvbkVtYWlsKHJlcS5ib2R5LmVtYWlsLCByZXEuYm9keS51c2VySWQpO1xuICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiAnVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnQnIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHZlcmlmeUVtYWlsVG9rZW4ocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5lbWFpbFNlcnZpY2UudmVyaWZ5RW1haWxUb2tlbihyZXEucGFyYW1zLnRva2VuKTtcbiAgICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ0VtYWlsIHZlcmlmaWVkIHN1Y2Nlc3NmdWxseScgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIG5leHQoZXJyb3IpO1xuICAgIH1cbiAgfVxuYCA6ICcnfVxuICBwcml2YXRlIGFzeW5jIGdldEVtYWlsU3RhdHVzKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGVtYWlsID0gYXdhaXQgdGhpcy5lbWFpbFNlcnZpY2UuZ2V0RW1haWxCeUlkKHJlcS5wYXJhbXMuaWQpO1xuICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBlbWFpbCB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbmV4dChlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBsaXN0RW1haWxzKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGVtYWlscyA9IGF3YWl0IHRoaXMuZW1haWxTZXJ2aWNlLmxpc3RFbWFpbHMoKTtcbiAgICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogZW1haWxzIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH1cbn1cbmA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRW1haWxTZXJ2aWNlRmlsZShjb25maWc6IEVtYWlsU2VydmljZUNvbmZpZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBpbXBvcnQgeyBQcm92aWRlclNlcnZpY2UgfSBmcm9tICcuL3Byb3ZpZGVyLnNlcnZpY2UnO1xuJHtjb25maWcuZW5hYmxlVGVtcGxhdGVzID8gXCJpbXBvcnQgeyBUZW1wbGF0ZVNlcnZpY2UgfSBmcm9tICcuL3RlbXBsYXRlLnNlcnZpY2UnO1wiIDogJyd9XG5pbXBvcnQgeyBFbWFpbFJlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMvZW1haWwucmVwb3NpdG9yeSc7XG5pbXBvcnQgeyBTZW5kRW1haWxJbnB1dCwgRW1haWwgfSBmcm9tICcuLi90eXBlcyc7XG4ke2NvbmZpZy5lbmFibGVWZXJpZmljYXRpb24gPyBcImltcG9ydCAqIGFzIGNyeXB0byBmcm9tICdjcnlwdG8nO1wiIDogJyd9XG5cbmV4cG9ydCBjbGFzcyBFbWFpbFNlcnZpY2Uge1xuICBwcml2YXRlIHByb3ZpZGVyU2VydmljZTogUHJvdmlkZXJTZXJ2aWNlO1xuJHtjb25maWcuZW5hYmxlVGVtcGxhdGVzID8gJyAgcHJpdmF0ZSB0ZW1wbGF0ZVNlcnZpY2U6IFRlbXBsYXRlU2VydmljZTsnIDogJyd9XG4gIHByaXZhdGUgZW1haWxSZXBvc2l0b3J5OiBFbWFpbFJlcG9zaXRvcnk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5wcm92aWRlclNlcnZpY2UgPSBuZXcgUHJvdmlkZXJTZXJ2aWNlKCk7XG4ke2NvbmZpZy5lbmFibGVUZW1wbGF0ZXMgPyAnICAgIHRoaXMudGVtcGxhdGVTZXJ2aWNlID0gbmV3IFRlbXBsYXRlU2VydmljZSgpOycgOiAnJ31cbiAgICB0aGlzLmVtYWlsUmVwb3NpdG9yeSA9IG5ldyBFbWFpbFJlcG9zaXRvcnkoKTtcbiAgfVxuXG4gIGFzeW5jIHNlbmRFbWFpbChpbnB1dDogU2VuZEVtYWlsSW5wdXQpOiBQcm9taXNlPEVtYWlsPiB7XG4gICAgLy8gU2VuZCB2aWEgcHJvdmlkZXJcbiAgICBjb25zdCBtZXNzYWdlSWQgPSBhd2FpdCB0aGlzLnByb3ZpZGVyU2VydmljZS5zZW5kKHtcbiAgICAgIHRvOiBpbnB1dC50byxcbiAgICAgIGZyb206IGlucHV0LmZyb20gfHwgcHJvY2Vzcy5lbnYuRU1BSUxfRlJPTSB8fCAnbm9yZXBseUBleGFtcGxlLmNvbScsXG4gICAgICBzdWJqZWN0OiBpbnB1dC5zdWJqZWN0LFxuICAgICAgaHRtbDogaW5wdXQuaHRtbCxcbiAgICAgIHRleHQ6IGlucHV0LnRleHQsXG4gICAgfSk7XG5cbiAgICAvLyBTYXZlIHRvIGRhdGFiYXNlXG4gICAgY29uc3QgZW1haWwgPSBhd2FpdCB0aGlzLmVtYWlsUmVwb3NpdG9yeS5jcmVhdGUoe1xuICAgICAgdG86IGlucHV0LnRvLFxuICAgICAgZnJvbTogaW5wdXQuZnJvbSB8fCBwcm9jZXNzLmVudi5FTUFJTF9GUk9NIHx8ICdub3JlcGx5QGV4YW1wbGUuY29tJyxcbiAgICAgIHN1YmplY3Q6IGlucHV0LnN1YmplY3QsXG4gICAgICBodG1sOiBpbnB1dC5odG1sLFxuICAgICAgdGV4dDogaW5wdXQudGV4dCxcbiAgICAgIG1lc3NhZ2VJZCxcbiAgICAgIHN0YXR1czogJ3NlbnQnLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGVtYWlsO1xuICB9XG4ke2NvbmZpZy5lbmFibGVUZW1wbGF0ZXMgPyBgXG4gIGFzeW5jIHNlbmRUZW1wbGF0ZUVtYWlsKHRvOiBzdHJpbmcsIHRlbXBsYXRlTmFtZTogc3RyaW5nLCBkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogUHJvbWlzZTxFbWFpbD4ge1xuICAgIGNvbnN0IHsgc3ViamVjdCwgaHRtbCwgdGV4dCB9ID0gYXdhaXQgdGhpcy50ZW1wbGF0ZVNlcnZpY2UucmVuZGVyKHRlbXBsYXRlTmFtZSwgZGF0YSk7XG5cbiAgICByZXR1cm4gdGhpcy5zZW5kRW1haWwoe1xuICAgICAgdG8sXG4gICAgICBzdWJqZWN0LFxuICAgICAgaHRtbCxcbiAgICAgIHRleHQsXG4gICAgfSk7XG4gIH1cbmAgOiAnJ30ke2NvbmZpZy5lbmFibGVWZXJpZmljYXRpb24gPyBgXG4gIGFzeW5jIHNlbmRWZXJpZmljYXRpb25FbWFpbChlbWFpbDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRva2VuID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDMyKS50b1N0cmluZygnaGV4Jyk7XG4gICAgY29uc3QgdmVyaWZpY2F0aW9uVXJsID0gXFxgXFwke3Byb2Nlc3MuZW52LkFQUF9VUkx9L3ZlcmlmeS1lbWFpbC9cXCR7dG9rZW59XFxgO1xuXG4gICAgYXdhaXQgdGhpcy5lbWFpbFJlcG9zaXRvcnkuc2F2ZVZlcmlmaWNhdGlvblRva2VuKHVzZXJJZCwgdG9rZW4pO1xuXG4gICAgYXdhaXQgdGhpcy5zZW5kVGVtcGxhdGVFbWFpbChlbWFpbCwgJ3ZlcmlmaWNhdGlvbicsIHtcbiAgICAgIHZlcmlmaWNhdGlvblVybCxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHZlcmlmeUVtYWlsVG9rZW4odG9rZW46IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IHRoaXMuZW1haWxSZXBvc2l0b3J5LmZpbmRWZXJpZmljYXRpb25Ub2tlbih0b2tlbik7XG4gICAgXG4gICAgaWYgKCF2ZXJpZmljYXRpb24pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBvciBleHBpcmVkIHZlcmlmaWNhdGlvbiB0b2tlbicpO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuZW1haWxSZXBvc2l0b3J5Lm1hcmtFbWFpbFZlcmlmaWVkKHZlcmlmaWNhdGlvbi51c2VySWQpO1xuICAgIGF3YWl0IHRoaXMuZW1haWxSZXBvc2l0b3J5LmRlbGV0ZVZlcmlmaWNhdGlvblRva2VuKHRva2VuKTtcbiAgfVxuYCA6ICcnfVxuICBhc3luYyBnZXRFbWFpbEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8RW1haWwgfCBudWxsPiB7XG4gICAgcmV0dXJuIHRoaXMuZW1haWxSZXBvc2l0b3J5LmZpbmRCeUlkKGlkKTtcbiAgfVxuXG4gIGFzeW5jIGxpc3RFbWFpbHMoKTogUHJvbWlzZTxFbWFpbFtdPiB7XG4gICAgcmV0dXJuIHRoaXMuZW1haWxSZXBvc2l0b3J5LmZpbmRBbGwoKTtcbiAgfVxufVxuYDtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVQcm92aWRlclNlcnZpY2UoY29uZmlnOiBFbWFpbFNlcnZpY2VDb25maWcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gY29uZmlnLnByb3ZpZGVyIHx8ICdzZW5kZ3JpZCc7XG4gICAgXG4gICAgcmV0dXJuIGAke3Byb3ZpZGVyID09PSAnc2VuZGdyaWQnID8gXCJpbXBvcnQgc2dNYWlsIGZyb20gJ0BzZW5kZ3JpZC9tYWlsJztcIiA6ICcnfVxuJHtwcm92aWRlciA9PT0gJ3NlcycgPyBcImltcG9ydCB7IFNFU0NsaWVudCwgU2VuZEVtYWlsQ29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1zZXMnO1wiIDogJyd9XG4ke3Byb3ZpZGVyID09PSAnc210cCcgPyBcImltcG9ydCBub2RlbWFpbGVyIGZyb20gJ25vZGVtYWlsZXInO1wiIDogJyd9XG5cbmludGVyZmFjZSBTZW5kRW1haWxQYXJhbXMge1xuICB0bzogc3RyaW5nO1xuICBmcm9tOiBzdHJpbmc7XG4gIHN1YmplY3Q6IHN0cmluZztcbiAgaHRtbD86IHN0cmluZztcbiAgdGV4dD86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFByb3ZpZGVyU2VydmljZSB7XG4ke3Byb3ZpZGVyID09PSAnc2VuZGdyaWQnID8gYCAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuU0VOREdSSURfQVBJX0tFWTtcbiAgICBpZiAoIWFwaUtleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTRU5ER1JJRF9BUElfS0VZIGlzIHJlcXVpcmVkJyk7XG4gICAgfVxuICAgIHNnTWFpbC5zZXRBcGlLZXkoYXBpS2V5KTtcbiAgfVxuXG4gIGFzeW5jIHNlbmQocGFyYW1zOiBTZW5kRW1haWxQYXJhbXMpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IG1zZyA9IHtcbiAgICAgIHRvOiBwYXJhbXMudG8sXG4gICAgICBmcm9tOiBwYXJhbXMuZnJvbSxcbiAgICAgIHN1YmplY3Q6IHBhcmFtcy5zdWJqZWN0LFxuICAgICAgaHRtbDogcGFyYW1zLmh0bWwsXG4gICAgICB0ZXh0OiBwYXJhbXMudGV4dCxcbiAgICB9O1xuXG4gICAgY29uc3QgW3Jlc3BvbnNlXSA9IGF3YWl0IHNnTWFpbC5zZW5kKG1zZyk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmhlYWRlcnNbJ3gtbWVzc2FnZS1pZCddIHx8ICcnO1xuICB9YCA6ICcnfSR7cHJvdmlkZXIgPT09ICdzZXMnID8gYCAgcHJpdmF0ZSBzZXNDbGllbnQ6IFNFU0NsaWVudDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNlc0NsaWVudCA9IG5ldyBTRVNDbGllbnQoe1xuICAgICAgcmVnaW9uOiBwcm9jZXNzLmVudi5BV1NfUkVHSU9OIHx8ICd1cy1lYXN0LTEnLFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgc2VuZChwYXJhbXM6IFNlbmRFbWFpbFBhcmFtcyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBTZW5kRW1haWxDb21tYW5kKHtcbiAgICAgIFNvdXJjZTogcGFyYW1zLmZyb20sXG4gICAgICBEZXN0aW5hdGlvbjoge1xuICAgICAgICBUb0FkZHJlc3NlczogW3BhcmFtcy50b10sXG4gICAgICB9LFxuICAgICAgTWVzc2FnZToge1xuICAgICAgICBTdWJqZWN0OiB7XG4gICAgICAgICAgRGF0YTogcGFyYW1zLnN1YmplY3QsXG4gICAgICAgIH0sXG4gICAgICAgIEJvZHk6IHtcbiAgICAgICAgICBIdG1sOiBwYXJhbXMuaHRtbCA/IHsgRGF0YTogcGFyYW1zLmh0bWwgfSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBUZXh0OiBwYXJhbXMudGV4dCA/IHsgRGF0YTogcGFyYW1zLnRleHQgfSA6IHVuZGVmaW5lZCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuc2VzQ2xpZW50LnNlbmQoY29tbWFuZCk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLk1lc3NhZ2VJZCB8fCAnJztcbiAgfWAgOiAnJ30ke3Byb3ZpZGVyID09PSAnc210cCcgPyBgICBwcml2YXRlIHRyYW5zcG9ydGVyOiBub2RlbWFpbGVyLlRyYW5zcG9ydGVyO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMudHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgICBob3N0OiBwcm9jZXNzLmVudi5TTVRQX0hPU1QsXG4gICAgICBwb3J0OiBwYXJzZUludChwcm9jZXNzLmVudi5TTVRQX1BPUlQgfHwgJzU4NycpLFxuICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5TTVRQX1NFQ1VSRSA9PT0gJ3RydWUnLFxuICAgICAgYXV0aDoge1xuICAgICAgICB1c2VyOiBwcm9jZXNzLmVudi5TTVRQX1VTRVIsXG4gICAgICAgIHBhc3M6IHByb2Nlc3MuZW52LlNNVFBfUEFTUyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzZW5kKHBhcmFtczogU2VuZEVtYWlsUGFyYW1zKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBpbmZvID0gYXdhaXQgdGhpcy50cmFuc3BvcnRlci5zZW5kTWFpbCh7XG4gICAgICBmcm9tOiBwYXJhbXMuZnJvbSxcbiAgICAgIHRvOiBwYXJhbXMudG8sXG4gICAgICBzdWJqZWN0OiBwYXJhbXMuc3ViamVjdCxcbiAgICAgIGh0bWw6IHBhcmFtcy5odG1sLFxuICAgICAgdGV4dDogcGFyYW1zLnRleHQsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gaW5mby5tZXNzYWdlSWQ7XG4gIH1gIDogJyd9XG59XG5gO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVRlbXBsYXRlU2VydmljZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMvcHJvbWlzZXMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBIYW5kbGViYXJzIGZyb20gJ2hhbmRsZWJhcnMnO1xuXG5pbnRlcmZhY2UgUmVuZGVyZWRUZW1wbGF0ZSB7XG4gIHN1YmplY3Q6IHN0cmluZztcbiAgaHRtbDogc3RyaW5nO1xuICB0ZXh0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZVNlcnZpY2Uge1xuICBwcml2YXRlIHRlbXBsYXRlc0Rpcjogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMudGVtcGxhdGVzRGlyID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLy4uL3RlbXBsYXRlcycpO1xuICB9XG5cbiAgYXN5bmMgcmVuZGVyKHRlbXBsYXRlTmFtZTogc3RyaW5nLCBkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogUHJvbWlzZTxSZW5kZXJlZFRlbXBsYXRlPiB7XG4gICAgY29uc3QgdGVtcGxhdGVQYXRoID0gcGF0aC5qb2luKHRoaXMudGVtcGxhdGVzRGlyLCBcXGBcXCR7dGVtcGxhdGVOYW1lfS5odG1sXFxgKTtcbiAgICBjb25zdCB0ZW1wbGF0ZUNvbnRlbnQgPSBhd2FpdCBmcy5yZWFkRmlsZSh0ZW1wbGF0ZVBhdGgsICd1dGYtOCcpO1xuXG4gICAgY29uc3QgdGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUodGVtcGxhdGVDb250ZW50KTtcbiAgICBjb25zdCBodG1sID0gdGVtcGxhdGUoZGF0YSk7XG5cbiAgICAvLyBFeHRyYWN0IHN1YmplY3QgZnJvbSB0ZW1wbGF0ZSAoZmlyc3QgbGluZSBjb21tZW50KVxuICAgIGNvbnN0IHN1YmplY3RNYXRjaCA9IGh0bWwubWF0Y2goLzwhLS1cXFxccypTVUJKRUNUOlxcXFxzKiguKz8pXFxcXHMqLS0+Lyk7XG4gICAgY29uc3Qgc3ViamVjdCA9IHN1YmplY3RNYXRjaCA/IHN1YmplY3RNYXRjaFsxXSA6ICdObyBTdWJqZWN0JztcblxuICAgIC8vIEdlbmVyYXRlIHBsYWluIHRleHQgdmVyc2lvblxuICAgIGNvbnN0IHRleHQgPSB0aGlzLmh0bWxUb1RleHQoaHRtbCk7XG5cbiAgICByZXR1cm4geyBzdWJqZWN0LCBodG1sLCB0ZXh0IH07XG4gIH1cblxuICBwcml2YXRlIGh0bWxUb1RleHQoaHRtbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBTaW1wbGUgSFRNTCB0byB0ZXh0IGNvbnZlcnNpb25cbiAgICByZXR1cm4gaHRtbFxuICAgICAgLnJlcGxhY2UoLzxbXj5dKj4vZywgJycpXG4gICAgICAucmVwbGFjZSgvXFxcXHMrL2csICcgJylcbiAgICAgIC50cmltKCk7XG4gIH1cbn1cbmA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRW1haWxSZXBvc2l0b3J5KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5pbXBvcnQgeyBFbWFpbCwgQ3JlYXRlRW1haWxJbnB1dCB9IGZyb20gJy4uL3R5cGVzJztcblxuY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpO1xuXG5leHBvcnQgY2xhc3MgRW1haWxSZXBvc2l0b3J5IHtcbiAgYXN5bmMgY3JlYXRlKGRhdGE6IENyZWF0ZUVtYWlsSW5wdXQpOiBQcm9taXNlPEVtYWlsPiB7XG4gICAgcmV0dXJuIHByaXNtYS5lbWFpbC5jcmVhdGUoeyBkYXRhIH0pO1xuICB9XG5cbiAgYXN5bmMgZmluZEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8RW1haWwgfCBudWxsPiB7XG4gICAgcmV0dXJuIHByaXNtYS5lbWFpbC5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQgfSB9KTtcbiAgfVxuXG4gIGFzeW5jIGZpbmRBbGwoKTogUHJvbWlzZTxFbWFpbFtdPiB7XG4gICAgcmV0dXJuIHByaXNtYS5lbWFpbC5maW5kTWFueSh7XG4gICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB0YWtlOiAxMDAsXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVTdGF0dXMoaWQ6IHN0cmluZywgc3RhdHVzOiBzdHJpbmcpOiBQcm9taXNlPEVtYWlsPiB7XG4gICAgcmV0dXJuIHByaXNtYS5lbWFpbC51cGRhdGUoe1xuICAgICAgd2hlcmU6IHsgaWQgfSxcbiAgICAgIGRhdGE6IHsgc3RhdHVzIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzYXZlVmVyaWZpY2F0aW9uVG9rZW4odXNlcklkOiBzdHJpbmcsIHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBwcmlzbWEuZW1haWxWZXJpZmljYXRpb24uY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdXNlcklkLFxuICAgICAgICB0b2tlbixcbiAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMjQgKiA2MCAqIDYwICogMTAwMCksIC8vIDI0IGhvdXJzXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZmluZFZlcmlmaWNhdGlvblRva2VuKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHsgdXNlcklkOiBzdHJpbmcgfSB8IG51bGw+IHtcbiAgICByZXR1cm4gcHJpc21hLmVtYWlsVmVyaWZpY2F0aW9uLmZpbmRGaXJzdCh7XG4gICAgICB3aGVyZToge1xuICAgICAgICB0b2tlbixcbiAgICAgICAgZXhwaXJlc0F0OiB7XG4gICAgICAgICAgZ3Q6IG5ldyBEYXRlKCksXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgbWFya0VtYWlsVmVyaWZpZWQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBwcmlzbWEudXNlci51cGRhdGUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgICAgZGF0YTogeyBlbWFpbFZlcmlmaWVkOiB0cnVlIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBkZWxldGVWZXJpZmljYXRpb25Ub2tlbih0b2tlbjogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgcHJpc21hLmVtYWlsVmVyaWZpY2F0aW9uLmRlbGV0ZU1hbnkoe1xuICAgICAgd2hlcmU6IHsgdG9rZW4gfSxcbiAgICB9KTtcbiAgfVxufVxuYDtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVUeXBlcyhjb25maWc6IEVtYWlsU2VydmljZUNvbmZpZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBleHBvcnQgaW50ZXJmYWNlIEVtYWlsIHtcbiAgaWQ6IHN0cmluZztcbiAgdG86IHN0cmluZztcbiAgZnJvbTogc3RyaW5nO1xuICBzdWJqZWN0OiBzdHJpbmc7XG4gIGh0bWw/OiBzdHJpbmc7XG4gIHRleHQ/OiBzdHJpbmc7XG4gIG1lc3NhZ2VJZDogc3RyaW5nO1xuICBzdGF0dXM6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBEYXRlO1xuICB1cGRhdGVkQXQ6IERhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlRW1haWxJbnB1dCB7XG4gIHRvOiBzdHJpbmc7XG4gIGZyb206IHN0cmluZztcbiAgc3ViamVjdDogc3RyaW5nO1xuICBodG1sPzogc3RyaW5nO1xuICB0ZXh0Pzogc3RyaW5nO1xuICBtZXNzYWdlSWQ6IHN0cmluZztcbiAgc3RhdHVzOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VuZEVtYWlsSW5wdXQge1xuICB0bzogc3RyaW5nO1xuICBmcm9tPzogc3RyaW5nO1xuICBzdWJqZWN0OiBzdHJpbmc7XG4gIGh0bWw/OiBzdHJpbmc7XG4gIHRleHQ/OiBzdHJpbmc7XG59XG5gO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVZhbGlkYXRpb25TY2hlbWFzKGNvbmZpZzogRW1haWxTZXJ2aWNlQ29uZmlnKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG5leHBvcnQgY29uc3QgRW1haWxTY2hlbWFzID0ge1xuICBzZW5kOiB6Lm9iamVjdCh7XG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgdG86IHouc3RyaW5nKCkuZW1haWwoJ0ludmFsaWQgZW1haWwgYWRkcmVzcycpLFxuICAgICAgZnJvbTogei5zdHJpbmcoKS5lbWFpbCgnSW52YWxpZCBlbWFpbCBhZGRyZXNzJykub3B0aW9uYWwoKSxcbiAgICAgIHN1YmplY3Q6IHouc3RyaW5nKCkubWluKDEsICdTdWJqZWN0IGlzIHJlcXVpcmVkJyksXG4gICAgICBodG1sOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICB0ZXh0OiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgfSksXG4gIH0pLFxuXG4gIHNlbmRUZW1wbGF0ZTogei5vYmplY3Qoe1xuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIHRvOiB6LnN0cmluZygpLmVtYWlsKCdJbnZhbGlkIGVtYWlsIGFkZHJlc3MnKSxcbiAgICAgIHRlbXBsYXRlOiB6LnN0cmluZygpLm1pbigxLCAnVGVtcGxhdGUgbmFtZSBpcyByZXF1aXJlZCcpLFxuICAgICAgZGF0YTogei5yZWNvcmQoei5hbnkoKSksXG4gICAgfSksXG4gIH0pLFxuJHtjb25maWcuZW5hYmxlVmVyaWZpY2F0aW9uID8gYFxuICB2ZXJpZnk6IHoub2JqZWN0KHtcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBlbWFpbDogei5zdHJpbmcoKS5lbWFpbCgnSW52YWxpZCBlbWFpbCBhZGRyZXNzJyksXG4gICAgICB1c2VySWQ6IHouc3RyaW5nKCkubWluKDEsICdVc2VyIElEIGlzIHJlcXVpcmVkJyksXG4gICAgfSksXG4gIH0pLFxuYCA6ICcnfVxufTtcbmA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUHJpc21hU2NoZW1hKGNvbmZpZzogRW1haWxTZXJ2aWNlQ29uZmlnKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGdlbmVyYXRvciBjbGllbnQge1xuICBwcm92aWRlciA9IFwicHJpc21hLWNsaWVudC1qc1wiXG59XG5cbmRhdGFzb3VyY2UgZGIge1xuICBwcm92aWRlciA9IFwicG9zdGdyZXNxbFwiXG4gIHVybCAgICAgID0gZW52KFwiREFUQUJBU0VfVVJMXCIpXG59XG5cbm1vZGVsIEVtYWlsIHtcbiAgaWQgICAgICAgIFN0cmluZyAgIEBpZCBAZGVmYXVsdChjdWlkKCkpXG4gIHRvICAgICAgICBTdHJpbmdcbiAgZnJvbSAgICAgIFN0cmluZ1xuICBzdWJqZWN0ICAgU3RyaW5nXG4gIGh0bWwgICAgICBTdHJpbmc/ICBAZGIuVGV4dFxuICB0ZXh0ICAgICAgU3RyaW5nPyAgQGRiLlRleHRcbiAgbWVzc2FnZUlkIFN0cmluZ1xuICBzdGF0dXMgICAgU3RyaW5nXG4gIGNyZWF0ZWRBdCBEYXRlVGltZSBAZGVmYXVsdChub3coKSlcbiAgdXBkYXRlZEF0IERhdGVUaW1lIEB1cGRhdGVkQXRcbiAgXG4gIEBAaW5kZXgoW3N0YXR1c10pXG4gIEBAaW5kZXgoW2NyZWF0ZWRBdF0pXG4gIEBAbWFwKFwiZW1haWxzXCIpXG59XG4ke2NvbmZpZy5lbmFibGVWZXJpZmljYXRpb24gPyBgXG5tb2RlbCBFbWFpbFZlcmlmaWNhdGlvbiB7XG4gIGlkICAgICAgICBTdHJpbmcgICBAaWQgQGRlZmF1bHQoY3VpZCgpKVxuICB1c2VySWQgICAgU3RyaW5nXG4gIHRva2VuICAgICBTdHJpbmcgICBAdW5pcXVlXG4gIGV4cGlyZXNBdCBEYXRlVGltZVxuICBjcmVhdGVkQXQgRGF0ZVRpbWUgQGRlZmF1bHQobm93KCkpXG4gIFxuICBAQGluZGV4KFt0b2tlbl0pXG4gIEBAaW5kZXgoW3VzZXJJZF0pXG4gIEBAbWFwKFwiZW1haWxfdmVyaWZpY2F0aW9uc1wiKVxufVxuXG5tb2RlbCBVc2VyIHtcbiAgaWQgICAgICAgICAgICBTdHJpbmcgIEBpZCBAZGVmYXVsdChjdWlkKCkpXG4gIGVtYWlsICAgICAgICAgU3RyaW5nICBAdW5pcXVlXG4gIGVtYWlsVmVyaWZpZWQgQm9vbGVhbiBAZGVmYXVsdChmYWxzZSlcbiAgXG4gIEBAbWFwKFwidXNlcnNcIilcbn1cbmAgOiAnJ31cbmA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlV2VsY29tZVRlbXBsYXRlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGA8IS0tIFNVQkpFQ1Q6IFdlbGNvbWUgdG8ge3thcHBOYW1lfX0hIC0tPlxuPCFET0NUWVBFIGh0bWw+XG48aHRtbD5cbjxoZWFkPlxuICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cbiAgPHRpdGxlPldlbGNvbWU8L3RpdGxlPlxuPC9oZWFkPlxuPGJvZHkgc3R5bGU9XCJmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IGxpbmUtaGVpZ2h0OiAxLjY7IGNvbG9yOiAjMzMzO1wiPlxuICA8ZGl2IHN0eWxlPVwibWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7XCI+XG4gICAgPGgxIHN0eWxlPVwiY29sb3I6ICM0RjQ2RTU7XCI+V2VsY29tZSB0byB7e2FwcE5hbWV9fSE8L2gxPlxuICAgIDxwPkhpIHt7bmFtZX19LDwvcD5cbiAgICA8cD5UaGFuayB5b3UgZm9yIHNpZ25pbmcgdXAuIFdlJ3JlIGV4Y2l0ZWQgdG8gaGF2ZSB5b3Ugb24gYm9hcmQhPC9wPlxuICAgIDxwPkdldCBzdGFydGVkIGJ5IGV4cGxvcmluZyBvdXIgZmVhdHVyZXMgYW5kIGxldCB1cyBrbm93IGlmIHlvdSBuZWVkIGFueSBoZWxwLjwvcD5cbiAgICA8cD5CZXN0IHJlZ2FyZHMsPGJyPlRoZSB7e2FwcE5hbWV9fSBUZWFtPC9wPlxuICA8L2Rpdj5cbjwvYm9keT5cbjwvaHRtbD5cbmA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUGFzc3dvcmRSZXNldFRlbXBsYXRlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGA8IS0tIFNVQkpFQ1Q6IFJlc2V0IFlvdXIgUGFzc3dvcmQgLS0+XG48IURPQ1RZUEUgaHRtbD5cbjxodG1sPlxuPGhlYWQ+XG4gIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiPlxuICA8dGl0bGU+UGFzc3dvcmQgUmVzZXQ8L3RpdGxlPlxuPC9oZWFkPlxuPGJvZHkgc3R5bGU9XCJmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IGxpbmUtaGVpZ2h0OiAxLjY7IGNvbG9yOiAjMzMzO1wiPlxuICA8ZGl2IHN0eWxlPVwibWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7XCI+XG4gICAgPGgxIHN0eWxlPVwiY29sb3I6ICM0RjQ2RTU7XCI+UmVzZXQgWW91ciBQYXNzd29yZDwvaDE+XG4gICAgPHA+SGkge3tuYW1lfX0sPC9wPlxuICAgIDxwPldlIHJlY2VpdmVkIGEgcmVxdWVzdCB0byByZXNldCB5b3VyIHBhc3N3b3JkLiBDbGljayB0aGUgYnV0dG9uIGJlbG93IHRvIGNyZWF0ZSBhIG5ldyBwYXNzd29yZDo8L3A+XG4gICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAzMHB4IDA7XCI+XG4gICAgICA8YSBocmVmPVwie3tyZXNldFVybH19XCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjNEY0NkU1OyBjb2xvcjogd2hpdGU7IHBhZGRpbmc6IDEycHggMjRweDsgdGV4dC1kZWNvcmF0aW9uOiBub25lOyBib3JkZXItcmFkaXVzOiA0cHg7IGRpc3BsYXk6IGlubGluZS1ibG9jaztcIj5SZXNldCBQYXNzd29yZDwvYT5cbiAgICA8L2Rpdj5cbiAgICA8cD5JZiB5b3UgZGlkbid0IHJlcXVlc3QgdGhpcywgeW91IGNhbiBzYWZlbHkgaWdub3JlIHRoaXMgZW1haWwuPC9wPlxuICAgIDxwPlRoaXMgbGluayB3aWxsIGV4cGlyZSBpbiAxIGhvdXIuPC9wPlxuICAgIDxwPkJlc3QgcmVnYXJkcyw8YnI+VGhlIHt7YXBwTmFtZX19IFRlYW08L3A+XG4gIDwvZGl2PlxuPC9ib2R5PlxuPC9odG1sPlxuYDtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVWZXJpZmljYXRpb25UZW1wbGF0ZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgPCEtLSBTVUJKRUNUOiBWZXJpZnkgWW91ciBFbWFpbCBBZGRyZXNzIC0tPlxuPCFET0NUWVBFIGh0bWw+XG48aHRtbD5cbjxoZWFkPlxuICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cbiAgPHRpdGxlPkVtYWlsIFZlcmlmaWNhdGlvbjwvdGl0bGU+XG48L2hlYWQ+XG48Ym9keSBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbGluZS1oZWlnaHQ6IDEuNjsgY29sb3I6ICMzMzM7XCI+XG4gIDxkaXYgc3R5bGU9XCJtYXgtd2lkdGg6IDYwMHB4OyBtYXJnaW46IDAgYXV0bzsgcGFkZGluZzogMjBweDtcIj5cbiAgICA8aDEgc3R5bGU9XCJjb2xvcjogIzRGNDZFNTtcIj5WZXJpZnkgWW91ciBFbWFpbDwvaDE+XG4gICAgPHA+UGxlYXNlIHZlcmlmeSB5b3VyIGVtYWlsIGFkZHJlc3MgYnkgY2xpY2tpbmcgdGhlIGJ1dHRvbiBiZWxvdzo8L3A+XG4gICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAzMHB4IDA7XCI+XG4gICAgICA8YSBocmVmPVwie3t2ZXJpZmljYXRpb25Vcmx9fVwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogIzRGNDZFNTsgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiAxMnB4IDI0cHg7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgYm9yZGVyLXJhZGl1czogNHB4OyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XCI+VmVyaWZ5IEVtYWlsPC9hPlxuICAgIDwvZGl2PlxuICAgIDxwPklmIHlvdSBkaWRuJ3QgY3JlYXRlIGFuIGFjY291bnQsIHlvdSBjYW4gc2FmZWx5IGlnbm9yZSB0aGlzIGVtYWlsLjwvcD5cbiAgICA8cD5CZXN0IHJlZ2FyZHMsPGJyPlRoZSB7e2FwcE5hbWV9fSBUZWFtPC9wPlxuICA8L2Rpdj5cbjwvYm9keT5cbjwvaHRtbD5cbmA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUGFja2FnZUpzb24oY29uZmlnOiBFbWFpbFNlcnZpY2VDb25maWcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gY29uZmlnLnByb3ZpZGVyIHx8ICdzZW5kZ3JpZCc7XG4gICAgY29uc3QgZGVwZW5kZW5jaWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgZXhwcmVzczogJ140LjE4LjInLFxuICAgICAgY29yczogJ14yLjguNScsXG4gICAgICBoZWxtZXQ6ICdeNy4xLjAnLFxuICAgICAgem9kOiAnXjMuMjIuNCcsXG4gICAgICAnQHByaXNtYS9jbGllbnQnOiAnXjUuNy4xJyxcbiAgICB9O1xuXG4gICAgaWYgKHByb3ZpZGVyID09PSAnc2VuZGdyaWQnKSB7XG4gICAgICBkZXBlbmRlbmNpZXNbJ0BzZW5kZ3JpZC9tYWlsJ10gPSAnXjcuNy4wJztcbiAgICB9IGVsc2UgaWYgKHByb3ZpZGVyID09PSAnc2VzJykge1xuICAgICAgZGVwZW5kZW5jaWVzWydAYXdzLXNkay9jbGllbnQtc2VzJ10gPSAnXjMuNDcwLjAnO1xuICAgIH0gZWxzZSBpZiAocHJvdmlkZXIgPT09ICdzbXRwJykge1xuICAgICAgZGVwZW5kZW5jaWVzWydub2RlbWFpbGVyJ10gPSAnXjYuOS43JztcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmVuYWJsZVRlbXBsYXRlcykge1xuICAgICAgZGVwZW5kZW5jaWVzWydoYW5kbGViYXJzJ10gPSAnXjQuNy44JztcbiAgICB9XG5cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgbmFtZTogJ2VtYWlsLXNlcnZpY2UnLFxuICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnRW1haWwgU2VydmljZSB3aXRoIFRlbXBsYXRlcycsXG4gICAgICBtYWluOiAnZGlzdC9pbmRleC5qcycsXG4gICAgICBzY3JpcHRzOiB7XG4gICAgICAgIGRldjogJ3RzLW5vZGUtZGV2IC0tcmVzcGF3biAtLXRyYW5zcGlsZS1vbmx5IHNyYy9pbmRleC50cycsXG4gICAgICAgIGJ1aWxkOiAndHNjJyxcbiAgICAgICAgc3RhcnQ6ICdub2RlIGRpc3QvaW5kZXguanMnLFxuICAgICAgICB0ZXN0OiAnamVzdCcsXG4gICAgICAgICd0ZXN0OndhdGNoJzogJ2plc3QgLS13YXRjaCcsXG4gICAgICAgICdwcmlzbWE6Z2VuZXJhdGUnOiAncHJpc21hIGdlbmVyYXRlJyxcbiAgICAgICAgJ3ByaXNtYTptaWdyYXRlJzogJ3ByaXNtYSBtaWdyYXRlIGRldicsXG4gICAgICB9LFxuICAgICAgZGVwZW5kZW5jaWVzLFxuICAgICAgZGV2RGVwZW5kZW5jaWVzOiB7XG4gICAgICAgICdAdHlwZXMvZXhwcmVzcyc6ICdeNC4xNy4yMScsXG4gICAgICAgICdAdHlwZXMvY29ycyc6ICdeMi44LjE3JyxcbiAgICAgICAgJ0B0eXBlcy9ub2RlJzogJ14yMC4xMC41JyxcbiAgICAgICAgLi4uKHByb3ZpZGVyID09PSAnc210cCcgJiYgeyAnQHR5cGVzL25vZGVtYWlsZXInOiAnXjYuNC4xNCcgfSksXG4gICAgICAgIC4uLihjb25maWcuZW5hYmxlVGVtcGxhdGVzICYmIHsgJ0B0eXBlcy9oYW5kbGViYXJzJzogJ140LjEuMCcgfSksXG4gICAgICAgIHR5cGVzY3JpcHQ6ICdeNS4zLjMnLFxuICAgICAgICAndHMtbm9kZS1kZXYnOiAnXjIuMC4wJyxcbiAgICAgICAgamVzdDogJ14yOS43LjAnLFxuICAgICAgICAnQHR5cGVzL2plc3QnOiAnXjI5LjUuMTEnLFxuICAgICAgICAndHMtamVzdCc6ICdeMjkuMS4xJyxcbiAgICAgICAgcHJpc21hOiAnXjUuNy4xJyxcbiAgICAgIH0sXG4gICAgfSwgbnVsbCwgMik7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRW52RXhhbXBsZShjb25maWc6IEVtYWlsU2VydmljZUNvbmZpZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjb25maWcucHJvdmlkZXIgfHwgJ3NlbmRncmlkJztcbiAgICBsZXQgZW52ID0gYFBPUlQ9JHtjb25maWcucG9ydCB8fCAzMDAzfVxcbk5PREVfRU5WPWRldmVsb3BtZW50XFxuXFxuREFUQUJBU0VfVVJMPXBvc3RncmVzcWw6Ly91c2VyOnBhc3N3b3JkQGxvY2FsaG9zdDo1NDMyL2VtYWlsX2RiXFxuXFxuRU1BSUxfRlJPTT1ub3JlcGx5QGV4YW1wbGUuY29tXFxuYDtcblxuICAgIGlmIChwcm92aWRlciA9PT0gJ3NlbmRncmlkJykge1xuICAgICAgZW52ICs9ICdcXG5TRU5ER1JJRF9BUElfS0VZPXlvdXJfc2VuZGdyaWRfYXBpX2tleVxcbic7XG4gICAgfSBlbHNlIGlmIChwcm92aWRlciA9PT0gJ3NlcycpIHtcbiAgICAgIGVudiArPSAnXFxuQVdTX1JFR0lPTj11cy1lYXN0LTFcXG5BV1NfQUNDRVNTX0tFWV9JRD15b3VyX2FjY2Vzc19rZXlcXG5BV1NfU0VDUkVUX0FDQ0VTU19LRVk9eW91cl9zZWNyZXRfa2V5XFxuJztcbiAgICB9IGVsc2UgaWYgKHByb3ZpZGVyID09PSAnc210cCcpIHtcbiAgICAgIGVudiArPSAnXFxuU01UUF9IT1NUPXNtdHAuZXhhbXBsZS5jb21cXG5TTVRQX1BPUlQ9NTg3XFxuU01UUF9TRUNVUkU9ZmFsc2VcXG5TTVRQX1VTRVI9eW91cl9zbXRwX3VzZXJcXG5TTVRQX1BBU1M9eW91cl9zbXRwX3Bhc3N3b3JkXFxuJztcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmVuYWJsZVZlcmlmaWNhdGlvbikge1xuICAgICAgZW52ICs9ICdcXG5BUFBfVVJMPWh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFxcbic7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVudjtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVSZWFkbWUoY29uZmlnOiBFbWFpbFNlcnZpY2VDb25maWcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gY29uZmlnLnByb3ZpZGVyIHx8ICdzZW5kZ3JpZCc7XG4gICAgcmV0dXJuIGAjIEVtYWlsIFNlcnZpY2VcblxuRW1haWwgc2VydmljZSB3aXRoICR7cHJvdmlkZXIudG9VcHBlckNhc2UoKX0gaW50ZWdyYXRpb24ke2NvbmZpZy5lbmFibGVUZW1wbGF0ZXMgPyAnIGFuZCB0ZW1wbGF0ZSBzdXBwb3J0JyA6ICcnfS5cblxuIyMgRmVhdHVyZXNcblxuLSBFbWFpbCBzZW5kaW5nIHZpYSAke3Byb3ZpZGVyLnRvVXBwZXJDYXNlKCl9XG4ke2NvbmZpZy5lbmFibGVUZW1wbGF0ZXMgPyAnLSBIVE1MIGVtYWlsIHRlbXBsYXRlcyB3aXRoIEhhbmRsZWJhcnNcXG4nIDogJyd9LSBUcmFuc2FjdGlvbmFsIGVtYWlsIHRyYWNraW5nXG4ke2NvbmZpZy5lbmFibGVWZXJpZmljYXRpb24gPyAnLSBFbWFpbCB2ZXJpZmljYXRpb25cXG4nIDogJyd9LSBFbWFpbCBzdGF0dXMgbW9uaXRvcmluZ1xuXG4jIyBJbnN0YWxsYXRpb25cblxuXFxgXFxgXFxgYmFzaFxubnBtIGluc3RhbGxcblxcYFxcYFxcYFxuXG4jIyBEYXRhYmFzZSBTZXR1cFxuXG5cXGBcXGBcXGBiYXNoXG5ucHggcHJpc21hIG1pZ3JhdGUgZGV2XG5ucHggcHJpc21hIGdlbmVyYXRlXG5cXGBcXGBcXGBcblxuIyMgQ29uZmlndXJhdGlvblxuXG5Db3B5IFxcYC5lbnYuZXhhbXBsZVxcYCB0byBcXGAuZW52XFxgIGFuZCBjb25maWd1cmUgeW91ciAke3Byb3ZpZGVyLnRvVXBwZXJDYXNlKCl9IGNyZWRlbnRpYWxzLlxuXG4jIyBEZXZlbG9wbWVudFxuXG5cXGBcXGBcXGBiYXNoXG5ucG0gcnVuIGRldlxuXFxgXFxgXFxgXG5cbiMjIFByb2R1Y3Rpb25cblxuXFxgXFxgXFxgYmFzaFxubnBtIHJ1biBidWlsZFxubnBtIHN0YXJ0XG5cXGBcXGBcXGBcblxuIyMgQVBJIEVuZHBvaW50c1xuXG4tIFxcYFBPU1QgL2FwaS9lbWFpbC9zZW5kXFxgIC0gU2VuZCBlbWFpbFxuJHtjb25maWcuZW5hYmxlVGVtcGxhdGVzID8gJy0gYFBPU1QgL2FwaS9lbWFpbC9zZW5kLXRlbXBsYXRlYCAtIFNlbmQgdGVtcGxhdGUgZW1haWxcXG4nIDogJyd9JHtjb25maWcuZW5hYmxlVmVyaWZpY2F0aW9uID8gJy0gYFBPU1QgL2FwaS9lbWFpbC92ZXJpZnlgIC0gU2VuZCB2ZXJpZmljYXRpb24gZW1haWxcXG4tIGBHRVQgL2FwaS9lbWFpbC92ZXJpZnkvOnRva2VuYCAtIFZlcmlmeSBlbWFpbCB0b2tlblxcbicgOiAnJ30tIFxcYEdFVCAvYXBpL2VtYWlsLzppZFxcYCAtIEdldCBlbWFpbCBzdGF0dXNcbi0gXFxgR0VUIC9hcGkvZW1haWxcXGAgLSBMaXN0IHNlbnQgZW1haWxzXG5cbiMjIFRlc3RpbmdcblxuXFxgXFxgXFxgYmFzaFxubnBtIHRlc3RcblxcYFxcYFxcYFxuJHtjb25maWcuZW5hYmxlVGVtcGxhdGVzID8gYFxuIyMgRW1haWwgVGVtcGxhdGVzXG5cblRlbXBsYXRlcyBhcmUgbG9jYXRlZCBpbiB0aGUgXFxgdGVtcGxhdGVzL1xcYCBkaXJlY3RvcnkgYW5kIHVzZSBIYW5kbGViYXJzIHN5bnRheC5cblxuQXZhaWxhYmxlIHRlbXBsYXRlczpcbi0gXFxgd2VsY29tZS5odG1sXFxgIC0gV2VsY29tZSBlbWFpbFxuLSBcXGBwYXNzd29yZC1yZXNldC5odG1sXFxgIC0gUGFzc3dvcmQgcmVzZXQgZW1haWxcbi0gXFxgdmVyaWZpY2F0aW9uLmh0bWxcXGAgLSBFbWFpbCB2ZXJpZmljYXRpb25cblxuVG8gY3JlYXRlIGEgbmV3IHRlbXBsYXRlLCBhZGQgYW4gSFRNTCBmaWxlIHdpdGggYSBzdWJqZWN0IGNvbW1lbnQ6XG5cXGBcXGBcXGBodG1sXG48IS0tIFNVQkpFQ1Q6IFlvdXIgU3ViamVjdCBIZXJlIC0tPlxuPCFET0NUWVBFIGh0bWw+XG48aHRtbD5cbiAgPCEtLSBZb3VyIHRlbXBsYXRlIGNvbnRlbnQgLS0+XG48L2h0bWw+XG5cXGBcXGBcXGBcbmAgOiAnJ31cbmA7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsSUFBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQTZCLFNBQUFELHdCQUFBRSxDQUFBLEVBQUFDLENBQUEsNkJBQUFDLE9BQUEsTUFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBSix1QkFBQSxZQUFBQSxDQUFBRSxDQUFBLEVBQUFDLENBQUEsU0FBQUEsQ0FBQSxJQUFBRCxDQUFBLElBQUFBLENBQUEsQ0FBQUssVUFBQSxTQUFBTCxDQUFBLE1BQUFNLENBQUEsRUFBQUMsQ0FBQSxFQUFBQyxDQUFBLEtBQUFDLFNBQUEsUUFBQUMsT0FBQSxFQUFBVixDQUFBLGlCQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFNBQUFRLENBQUEsTUFBQUYsQ0FBQSxHQUFBTCxDQUFBLEdBQUFHLENBQUEsR0FBQUQsQ0FBQSxRQUFBRyxDQUFBLENBQUFLLEdBQUEsQ0FBQVgsQ0FBQSxVQUFBTSxDQUFBLENBQUFNLEdBQUEsQ0FBQVosQ0FBQSxHQUFBTSxDQUFBLENBQUFPLEdBQUEsQ0FBQWIsQ0FBQSxFQUFBUSxDQUFBLGdCQUFBUCxDQUFBLElBQUFELENBQUEsZ0JBQUFDLENBQUEsT0FBQWEsY0FBQSxDQUFBQyxJQUFBLENBQUFmLENBQUEsRUFBQUMsQ0FBQSxPQUFBTSxDQUFBLElBQUFELENBQUEsR0FBQVUsTUFBQSxDQUFBQyxjQUFBLEtBQUFELE1BQUEsQ0FBQUUsd0JBQUEsQ0FBQWxCLENBQUEsRUFBQUMsQ0FBQSxPQUFBTSxDQUFBLENBQUFLLEdBQUEsSUFBQUwsQ0FBQSxDQUFBTSxHQUFBLElBQUFQLENBQUEsQ0FBQUUsQ0FBQSxFQUFBUCxDQUFBLEVBQUFNLENBQUEsSUFBQUMsQ0FBQSxDQUFBUCxD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxHQUFHLEVBQUUsR0FBR0EsUUFBUSxLQUFLLE1BQU0sR0FBRztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxHQUFHLEVBQUU7QUFDVDtBQUNBLENBQUM7RUFDQztFQUVRYix1QkFBdUJBLENBQUEsRUFBVztJQUN4QyxPQUFPO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7RUFDQztFQUVRQyx1QkFBdUJBLENBQUEsRUFBVztJQUN4QyxPQUFPO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0VBQ0M7RUFFUUMsYUFBYUEsQ0FBQ2hC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