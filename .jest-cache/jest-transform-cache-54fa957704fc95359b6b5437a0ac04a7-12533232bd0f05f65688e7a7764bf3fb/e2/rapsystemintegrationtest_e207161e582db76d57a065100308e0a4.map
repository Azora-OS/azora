{"version":3,"names":["_rapSystem","require","_types","describe","rapSystem","mockConfig","beforeEach","internalSourceWeight","externalSourceWeight","maxContextTokens","maxRetrievalResults","externalLLMProvider","externalLLMModel","externalLLMApiKey","process","env","OPENAI_API_KEY","embeddingApiKey","vectorDbApiKey","PINECONE_API_KEY","vectorDbIndexName","RAPSystem","it","query","userId","context","courseId","difficulty","jest","spyOn","mockResolvedValue","Array","fill","id","score","metadata","date","source","category","verified","relevance","tags","title","url","chat","completions","choices","message","content","response","processQuery","expect","toBeDefined","routingTier","toBe","RoutingTier","RAP_SYSTEM","toContain","responseTime","toBeGreaterThan","cost","cached","internalSourcesCount","userLevel","language","contextLength","queryEmbedding","mockInternalSources","map","_","i","mockExternalSources","mockResolvedValueOnce","internalSources","toHaveLength","externalSources","internalWeight","externalWeight","formatted","indexOf","toBeLessThan","response1","time1","response2","time2","clearCache","query1","query2","stats","getCacheStats","size","entries","toBeTruthy","mockRejectedValueOnce","Error","rejects","toThrow"],"sources":["rap-system-integration.test.ts"],"sourcesContent":["/**\n * RAP System Integration Tests\n * Tests for Retrieval-Augmented Prompt system integration with AI routing\n */\n\nimport { RAPSystem, RAPSystemConfig } from '../../services/ai-routing/rap-system';\nimport { AIQuery, RoutingTier } from '../../services/ai-routing/types';\n\ndescribe('RAP System Integration', () => {\n  let rapSystem: RAPSystem;\n  let mockConfig: RAPSystemConfig;\n\n  beforeEach(() => {\n    mockConfig = {\n      internalSourceWeight: 0.7,\n      externalSourceWeight: 0.3,\n      maxContextTokens: 2000,\n      maxRetrievalResults: 10,\n      externalLLMProvider: 'openai',\n      externalLLMModel: 'gpt-4',\n      externalLLMApiKey: process.env.OPENAI_API_KEY || 'test-key',\n      embeddingApiKey: process.env.OPENAI_API_KEY || 'test-embedding-key',\n      vectorDbApiKey: process.env.PINECONE_API_KEY || 'test-vector-key',\n      vectorDbIndexName: 'azora-knowledge'\n    };\n\n    rapSystem = new RAPSystem(mockConfig);\n  });\n\n  describe('Complete RAP Flow', () => {\n    it('should process query through complete RAP pipeline', async () => {\n      const query: AIQuery = {\n        query: 'What are the key principles of machine learning?',\n        userId: 'test-user-123',\n        context: {\n          courseId: 'ml-101',\n          difficulty: 'intermediate'\n        }\n      };\n\n      // Mock the services\n      jest.spyOn(rapSystem['embeddingService'], 'generateEmbedding').mockResolvedValue(\n        new Array(1536).fill(0.1)\n      );\n\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch').mockResolvedValue([\n        {\n          id: 'source-1',\n          score: 0.95,\n          metadata: {\n            date: '2024-01-01',\n            source: 'internal',\n            category: 'ML',\n            verified: true,\n            relevance: 0.95,\n            tags: ['machine-learning', 'principles'],\n            title: 'ML Fundamentals',\n            url: 'https://azora.example.com/ml-fundamentals'\n          }\n        },\n        {\n          id: 'source-2',\n          score: 0.88,\n          metadata: {\n            date: '2024-01-02',\n            source: 'external',\n            category: 'Research',\n            verified: false,\n            relevance: 0.88,\n            tags: ['ml', 'research'],\n            title: 'Recent ML Research',\n            url: 'https://research.example.com/ml-2024'\n          }\n        }\n      ]);\n\n      jest.spyOn(rapSystem['externalLLMClient'].chat.completions, 'create').mockResolvedValue({\n        choices: [\n          {\n            message: {\n              content: `The key principles of machine learning include:\n\n1. **Supervised Learning**: Learning from labeled data to make predictions\n2. **Unsupervised Learning**: Finding patterns in unlabeled data\n3. **Reinforcement Learning**: Learning through interaction and rewards\n4. **Generalization**: Models should perform well on unseen data\n5. **Regularization**: Preventing overfitting through constraints\n6. **Feature Engineering**: Selecting and transforming relevant features\n7. **Cross-validation**: Evaluating model performance reliably\n\nThese principles are fundamental to building effective ML systems.`\n            }\n          }\n        ]\n      });\n\n      const response = await rapSystem.processQuery(query);\n\n      expect(response).toBeDefined();\n      expect(response.routingTier).toBe(RoutingTier.RAP_SYSTEM);\n      expect(response.content).toContain('machine learning');\n      expect(response.responseTime).toBeGreaterThan(0);\n      expect(response.cost).toBeGreaterThan(0);\n      expect(response.cached).toBe(false);\n      expect(response.metadata?.internalSourcesCount).toBeGreaterThan(0);\n    });\n\n    it('should handle context injection correctly', async () => {\n      const query: AIQuery = {\n        query: 'Explain neural networks',\n        userId: 'test-user-456',\n        context: {\n          userLevel: 'beginner',\n          language: 'en'\n        }\n      };\n\n      jest.spyOn(rapSystem['embeddingService'], 'generateEmbedding').mockResolvedValue(\n        new Array(1536).fill(0.1)\n      );\n\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch').mockResolvedValue([\n        {\n          id: 'nn-guide',\n          score: 0.92,\n          metadata: {\n            date: '2024-01-01',\n            source: 'internal',\n            category: 'AI',\n            verified: true,\n            relevance: 0.92,\n            tags: ['neural-networks', 'beginner'],\n            title: 'Neural Networks for Beginners',\n            url: 'https://azora.example.com/nn-beginner'\n          }\n        }\n      ]);\n\n      jest.spyOn(rapSystem['externalLLMClient'].chat.completions, 'create').mockResolvedValue({\n        choices: [\n          {\n            message: {\n              content: 'Neural networks are computational models inspired by biological neurons...'\n            }\n          }\n        ]\n      });\n\n      const response = await rapSystem.processQuery(query);\n\n      expect(response).toBeDefined();\n      expect(response.metadata?.contextLength).toBeGreaterThan(0);\n    });\n  });\n\n  describe('70/30 Rule Enforcement', () => {\n    it('should weight internal sources at 70%', async () => {\n      const queryEmbedding = new Array(1536).fill(0.1);\n      const query = 'Test query';\n\n      const mockInternalSources = Array(7).fill(null).map((_, i) => ({\n        id: `internal-${i}`,\n        score: 0.9 - (i * 0.01),\n        metadata: {\n          date: '2024-01-01',\n          source: 'internal',\n          category: 'Education',\n          verified: true,\n          relevance: 0.9 - (i * 0.01),\n          tags: ['education'],\n          title: `Internal Source ${i}`,\n          url: `https://internal.example.com/${i}`\n        }\n      }));\n\n      const mockExternalSources = Array(3).fill(null).map((_, i) => ({\n        id: `external-${i}`,\n        score: 0.85 - (i * 0.01),\n        metadata: {\n          date: '2024-01-02',\n          source: 'external',\n          category: 'Research',\n          verified: false,\n          relevance: 0.85 - (i * 0.01),\n          tags: ['research'],\n          title: `External Source ${i}`,\n          url: `https://external.example.com/${i}`\n        }\n      }));\n\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch')\n        .mockResolvedValueOnce(mockInternalSources)\n        .mockResolvedValueOnce(mockExternalSources);\n\n      const context = await rapSystem['retrieveContext'](queryEmbedding);\n\n      expect(context.internalSources).toHaveLength(7);\n      expect(context.externalSources).toHaveLength(3);\n      expect(context.internalWeight).toBe(0.7);\n      expect(context.externalWeight).toBe(0.3);\n    });\n\n    it('should format context with proper weighting labels', () => {\n      const internalSources = [\n        {\n          id: 'internal-1',\n          score: 0.95,\n          metadata: {\n            date: '2024-01-01',\n            source: 'internal',\n            category: 'ML',\n            verified: true,\n            relevance: 0.95,\n            tags: ['ml'],\n            title: 'Internal ML Guide',\n            url: 'https://example.com/ml'\n          }\n        }\n      ];\n\n      const externalSources = [\n        {\n          id: 'external-1',\n          score: 0.85,\n          metadata: {\n            date: '2024-01-02',\n            source: 'external',\n            category: 'Research',\n            verified: false,\n            relevance: 0.85,\n            tags: ['research'],\n            title: 'External Research',\n            url: 'https://example.com/research'\n          }\n        }\n      ];\n\n      const formatted = rapSystem['formatContext'](internalSources, externalSources);\n\n      // Verify 70% label\n      expect(formatted).toContain('70% weight');\n      // Verify 30% label\n      expect(formatted).toContain('30% weight');\n      // Verify internal sources come first\n      expect(formatted.indexOf('70% weight')).toBeLessThan(formatted.indexOf('30% weight'));\n    });\n  });\n\n  describe('Response Synthesis', () => {\n    it('should synthesize response from multiple sources', async () => {\n      const query: AIQuery = {\n        query: 'Compare supervised and unsupervised learning'\n      };\n\n      jest.spyOn(rapSystem['embeddingService'], 'generateEmbedding').mockResolvedValue(\n        new Array(1536).fill(0.1)\n      );\n\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch').mockResolvedValue([\n        {\n          id: 'supervised-guide',\n          score: 0.93,\n          metadata: {\n            date: '2024-01-01',\n            source: 'internal',\n            category: 'ML',\n            verified: true,\n            relevance: 0.93,\n            tags: ['supervised-learning'],\n            title: 'Supervised Learning Guide',\n            url: 'https://azora.example.com/supervised'\n          }\n        },\n        {\n          id: 'unsupervised-guide',\n          score: 0.91,\n          metadata: {\n            date: '2024-01-01',\n            source: 'internal',\n            category: 'ML',\n            verified: true,\n            relevance: 0.91,\n            tags: ['unsupervised-learning'],\n            title: 'Unsupervised Learning Guide',\n            url: 'https://azora.example.com/unsupervised'\n          }\n        }\n      ]);\n\n      jest.spyOn(rapSystem['externalLLMClient'].chat.completions, 'create').mockResolvedValue({\n        choices: [\n          {\n            message: {\n              content: `Supervised vs Unsupervised Learning:\n\n**Supervised Learning:**\n- Uses labeled training data\n- Goal: Predict output for new inputs\n- Examples: Classification, Regression\n\n**Unsupervised Learning:**\n- Uses unlabeled data\n- Goal: Discover hidden patterns\n- Examples: Clustering, Dimensionality Reduction\n\n**Key Differences:**\n- Data labeling requirement\n- Problem formulation\n- Evaluation metrics`\n            }\n          }\n        ]\n      });\n\n      const response = await rapSystem.processQuery(query);\n\n      expect(response.content).toContain('Supervised');\n      expect(response.content).toContain('Unsupervised');\n      expect(response.metadata?.internalSourcesCount).toBeGreaterThan(0);\n    });\n  });\n\n  describe('Caching and Performance', () => {\n    it('should cache responses for identical queries', async () => {\n      const query: AIQuery = {\n        query: 'What is deep learning?'\n      };\n\n      jest.spyOn(rapSystem['embeddingService'], 'generateEmbedding').mockResolvedValue(\n        new Array(1536).fill(0.1)\n      );\n\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch').mockResolvedValue([]);\n\n      jest.spyOn(rapSystem['externalLLMClient'].chat.completions, 'create').mockResolvedValue({\n        choices: [\n          {\n            message: {\n              content: 'Deep learning is a subset of machine learning...'\n            }\n          }\n        ]\n      });\n\n      // First call\n      const response1 = await rapSystem.processQuery(query);\n      const time1 = response1.responseTime;\n\n      // Second call (should be cached)\n      const response2 = await rapSystem.processQuery(query);\n      const time2 = response2.responseTime;\n\n      expect(response2.cached).toBe(true);\n      expect(time2).toBeLessThan(time1);\n      expect(response2.cost).toBe(0);\n    });\n\n    it('should track cache statistics', async () => {\n      rapSystem.clearCache();\n\n      const query1: AIQuery = { query: 'Query 1' };\n      const query2: AIQuery = { query: 'Query 2' };\n\n      jest.spyOn(rapSystem['embeddingService'], 'generateEmbedding').mockResolvedValue(\n        new Array(1536).fill(0.1)\n      );\n\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch').mockResolvedValue([]);\n\n      jest.spyOn(rapSystem['externalLLMClient'].chat.completions, 'create').mockResolvedValue({\n        choices: [\n          {\n            message: {\n              content: 'Response'\n            }\n          }\n        ]\n      });\n\n      await rapSystem.processQuery(query1);\n      await rapSystem.processQuery(query2);\n\n      const stats = rapSystem.getCacheStats();\n\n      expect(stats.size).toBe(2);\n      expect(stats.entries).toBe(2);\n    });\n  });\n\n  describe('Cost Tracking', () => {\n    it('should calculate and track costs', async () => {\n      const query: AIQuery = {\n        query: 'Explain the transformer architecture in detail with examples'\n      };\n\n      jest.spyOn(rapSystem['embeddingService'], 'generateEmbedding').mockResolvedValue(\n        new Array(1536).fill(0.1)\n      );\n\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch').mockResolvedValue([\n        {\n          id: 'transformer-guide',\n          score: 0.94,\n          metadata: {\n            date: '2024-01-01',\n            source: 'internal',\n            category: 'AI',\n            verified: true,\n            relevance: 0.94,\n            tags: ['transformers', 'architecture'],\n            title: 'Transformer Architecture Guide',\n            url: 'https://azora.example.com/transformers'\n          }\n        }\n      ]);\n\n      jest.spyOn(rapSystem['externalLLMClient'].chat.completions, 'create').mockResolvedValue({\n        choices: [\n          {\n            message: {\n              content: 'The transformer architecture is a deep learning model that uses self-attention mechanisms...'\n            }\n          }\n        ]\n      });\n\n      const response = await rapSystem.processQuery(query);\n\n      expect(response.cost).toBeGreaterThan(0);\n      expect(typeof response.cost).toBe('number');\n    });\n  });\n\n  describe('Error Handling and Resilience', () => {\n    it('should handle missing context gracefully', async () => {\n      const query: AIQuery = {\n        query: 'Test query'\n      };\n\n      jest.spyOn(rapSystem['embeddingService'], 'generateEmbedding').mockResolvedValue(\n        new Array(1536).fill(0.1)\n      );\n\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch').mockResolvedValue([]);\n\n      jest.spyOn(rapSystem['externalLLMClient'].chat.completions, 'create').mockResolvedValue({\n        choices: [\n          {\n            message: {\n              content: 'Response without context'\n            }\n          }\n        ]\n      });\n\n      const response = await rapSystem.processQuery(query);\n\n      expect(response).toBeDefined();\n      expect(response.content).toBeTruthy();\n      expect(response.metadata?.internalSourcesCount).toBe(0);\n    });\n\n    it('should handle partial retrieval failures', async () => {\n      const query: AIQuery = {\n        query: 'Test query'\n      };\n\n      jest.spyOn(rapSystem['embeddingService'], 'generateEmbedding').mockResolvedValue(\n        new Array(1536).fill(0.1)\n      );\n\n      // First call succeeds, second fails\n      jest.spyOn(rapSystem['vectorStorage'], 'semanticSearch')\n        .mockResolvedValueOnce([\n          {\n            id: 'source-1',\n            score: 0.9,\n            metadata: {\n              date: '2024-01-01',\n              source: 'internal',\n              category: 'Test',\n              verified: true,\n              relevance: 0.9,\n              tags: ['test'],\n              title: 'Test Source',\n              url: 'https://example.com'\n            }\n          }\n        ])\n        .mockRejectedValueOnce(new Error('Retrieval failed'));\n\n      jest.spyOn(rapSystem['externalLLMClient'].chat.completions, 'create').mockResolvedValue({\n        choices: [\n          {\n            message: {\n              content: 'Response'\n            }\n          }\n        ]\n      });\n\n      await expect(rapSystem.processQuery(query)).rejects.toThrow();\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}