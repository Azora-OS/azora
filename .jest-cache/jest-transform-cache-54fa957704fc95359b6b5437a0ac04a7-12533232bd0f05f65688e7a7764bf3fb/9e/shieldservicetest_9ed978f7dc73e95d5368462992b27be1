71717990d6570ac73c11cc6903bbc315
"use strict";

const shieldService = require('../index');
describe('Shield Service', () => {
  beforeEach(() => {
    // Clear data before each test
    shieldService.threats = [];
    shieldService.securityEvents = [];
    shieldService.blockedIPs.clear();
    shieldService.rateLimits.clear();
  });
  test('should detect SQL injection threats', () => {
    const req = {
      ip: '192.168.1.100',
      method: 'GET',
      url: '/api/users',
      query: {
        id: "1'; DROP TABLE users;"
      },
      body: {},
      headers: {},
      get: () => null
    };
    const analysis = shieldService.analyzeRequest(req);
    expect(analysis.threats.length).toBeGreaterThan(0);
    expect(analysis.threats.some(t => t.type === 'SQL_INJECTION')).toBe(true);
    expect(analysis.riskScore).toBeGreaterThan(0);
  });
  test('should detect XSS threats', () => {
    const req = {
      ip: '192.168.1.100',
      method: 'POST',
      url: '/api/comments',
      query: {},
      body: {
        comment: '<script>alert("xss")</script>'
      },
      headers: {},
      get: () => null
    };
    const analysis = shieldService.analyzeRequest(req);
    expect(analysis.threats.length).toBeGreaterThan(0);
    expect(analysis.threats.some(t => t.type === 'XSS')).toBe(true);
    expect(analysis.riskScore).toBeGreaterThan(0);
  });
  test('should detect path traversal threats', () => {
    const req = {
      ip: '192.168.1.100',
      method: 'GET',
      url: '/api/files/../../../etc/passwd',
      query: {},
      body: {},
      headers: {},
      get: () => null
    };
    const analysis = shieldService.analyzeRequest(req);
    expect(analysis.threats.length).toBeGreaterThan(0);
    expect(analysis.threats.some(t => t.type === 'PATH_TRAVERSAL')).toBe(true);
  });
  test('should enforce rate limiting', () => {
    const req = {
      ip: '192.168.1.200',
      method: 'GET',
      url: '/api/data',
      query: {},
      body: {},
      headers: {},
      get: () => null
    };

    // Make many requests to trigger rate limiting
    for (let i = 0; i < 150; i++) {
      shieldService.analyzeRequest(req);
    }

    // Check if IP is blocked
    const isBlocked = shieldService.isIPBlocked('192.168.1.200');
    expect(isBlocked).toBe(true);
  });
  test('should block and unblock IP addresses', () => {
    const ip = '192.168.1.150';

    // Initially not blocked
    expect(shieldService.isIPBlocked(ip)).toBe(false);

    // Block IP
    shieldService.blockIP(ip);
    expect(shieldService.isIPBlocked(ip)).toBe(true);

    // Unblock IP
    shieldService.unblockIP(ip);
    expect(shieldService.isIPBlocked(ip)).toBe(false);
  });
  test('should calculate risk scores correctly', () => {
    const lowRiskReq = {
      ip: '192.168.1.100',
      method: 'GET',
      url: '/api/users',
      query: {
        id: 'normal-user-id'
      },
      body: {},
      headers: {},
      get: () => null
    };
    const highRiskReq = {
      ip: '192.168.1.101',
      method: 'GET',
      url: '/api/users',
      query: {
        id: "1'; DROP TABLE users;"
      },
      body: {},
      headers: {},
      get: () => null
    };
    const lowRiskAnalysis = shieldService.analyzeRequest(lowRiskReq);
    const highRiskAnalysis = shieldService.analyzeRequest(highRiskReq);
    expect(lowRiskAnalysis.riskScore).toBeLessThan(highRiskAnalysis.riskScore);
  });
  test('should filter security events', () => {
    // Generate some test events
    const req1 = {
      ip: '192.168.1.100',
      method: 'GET',
      url: '/api/users',
      query: {
        id: "1'; DROP TABLE users;"
      },
      body: {},
      headers: {},
      get: () => null
    };
    const req2 = {
      ip: '192.168.1.101',
      method: 'POST',
      url: '/api/comments',
      query: {},
      body: {
        comment: '<script>alert("xss")</script>'
      },
      headers: {},
      get: () => null
    };
    shieldService.analyzeRequest(req1);
    shieldService.analyzeRequest(req2);

    // Filter by IP
    const eventsByIP = shieldService.getSecurityEvents({
      ip: '192.168.1.100'
    });
    expect(eventsByIP.events.length).toBe(1);
    expect(eventsByIP.events[0].ip).toBe('192.168.1.100');

    // Filter by minimum risk score
    const highRiskEvents = shieldService.getSecurityEvents({
      minRiskScore: 5
    });
    expect(highRiskEvents.events.length).toBe(2);
  });
  test('should generate threat statistics', () => {
    // Generate some test events
    const req1 = {
      ip: '192.168.1.100',
      method: 'GET',
      url: '/api/users',
      query: {
        id: "1'; DROP TABLE users;"
      },
      body: {},
      headers: {},
      get: () => null
    };
    const req2 = {
      ip: '192.168.1.101',
      method: 'POST',
      url: '/api/comments',
      query: {},
      body: {
        comment: '<script>alert("xss")</script>'
      },
      headers: {},
      get: () => null
    };
    shieldService.analyzeRequest(req1);
    shieldService.analyzeRequest(req2);
    const stats = shieldService.getThreatStats();
    expect(stats.totalEvents).toBe(2);
    expect(stats.totalThreats).toBe(2);
    expect(Object.keys(stats.threatTypes).length).toBeGreaterThan(0);
  });
  test('should clear old events', () => {
    // Generate some test events
    const req = {
      ip: '192.168.1.100',
      method: 'GET',
      url: '/api/users',
      query: {
        id: 'normal-id'
      },
      body: {},
      headers: {},
      get: () => null
    };
    shieldService.analyzeRequest(req);
    expect(shieldService.securityEvents.length).toBe(1);

    // Clear old events
    const removedCount = shieldService.clearOldEvents(0); // Clear all events

    expect(removedCount).toBe(1);
    expect(shieldService.securityEvents.length).toBe(0);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzaGllbGRTZXJ2aWNlIiwicmVxdWlyZSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsInRocmVhdHMiLCJzZWN1cml0eUV2ZW50cyIsImJsb2NrZWRJUHMiLCJjbGVhciIsInJhdGVMaW1pdHMiLCJ0ZXN0IiwicmVxIiwiaXAiLCJtZXRob2QiLCJ1cmwiLCJxdWVyeSIsImlkIiwiYm9keSIsImhlYWRlcnMiLCJnZXQiLCJhbmFseXNpcyIsImFuYWx5emVSZXF1ZXN0IiwiZXhwZWN0IiwibGVuZ3RoIiwidG9CZUdyZWF0ZXJUaGFuIiwic29tZSIsInQiLCJ0eXBlIiwidG9CZSIsInJpc2tTY29yZSIsImNvbW1lbnQiLCJpIiwiaXNCbG9ja2VkIiwiaXNJUEJsb2NrZWQiLCJibG9ja0lQIiwidW5ibG9ja0lQIiwibG93Umlza1JlcSIsImhpZ2hSaXNrUmVxIiwibG93Umlza0FuYWx5c2lzIiwiaGlnaFJpc2tBbmFseXNpcyIsInRvQmVMZXNzVGhhbiIsInJlcTEiLCJyZXEyIiwiZXZlbnRzQnlJUCIsImdldFNlY3VyaXR5RXZlbnRzIiwiZXZlbnRzIiwiaGlnaFJpc2tFdmVudHMiLCJtaW5SaXNrU2NvcmUiLCJzdGF0cyIsImdldFRocmVhdFN0YXRzIiwidG90YWxFdmVudHMiLCJ0b3RhbFRocmVhdHMiLCJPYmplY3QiLCJrZXlzIiwidGhyZWF0VHlwZXMiLCJyZW1vdmVkQ291bnQiLCJjbGVhck9sZEV2ZW50cyJdLCJzb3VyY2VzIjpbInNoaWVsZC1zZXJ2aWNlLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2hpZWxkU2VydmljZSA9IHJlcXVpcmUoJy4uL2luZGV4Jyk7XG5cbmRlc2NyaWJlKCdTaGllbGQgU2VydmljZScsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgLy8gQ2xlYXIgZGF0YSBiZWZvcmUgZWFjaCB0ZXN0XG4gICAgc2hpZWxkU2VydmljZS50aHJlYXRzID0gW107XG4gICAgc2hpZWxkU2VydmljZS5zZWN1cml0eUV2ZW50cyA9IFtdO1xuICAgIHNoaWVsZFNlcnZpY2UuYmxvY2tlZElQcy5jbGVhcigpO1xuICAgIHNoaWVsZFNlcnZpY2UucmF0ZUxpbWl0cy5jbGVhcigpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgZGV0ZWN0IFNRTCBpbmplY3Rpb24gdGhyZWF0cycsICgpID0+IHtcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBpcDogJzE5Mi4xNjguMS4xMDAnLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHVybDogJy9hcGkvdXNlcnMnLFxuICAgICAgcXVlcnk6IHsgaWQ6IFwiMSc7IERST1AgVEFCTEUgdXNlcnM7XCIgfSxcbiAgICAgIGJvZHk6IHt9LFxuICAgICAgaGVhZGVyczoge30sXG4gICAgICBnZXQ6ICgpID0+IG51bGxcbiAgICB9O1xuXG4gICAgY29uc3QgYW5hbHlzaXMgPSBzaGllbGRTZXJ2aWNlLmFuYWx5emVSZXF1ZXN0KHJlcSk7XG5cbiAgICBleHBlY3QoYW5hbHlzaXMudGhyZWF0cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICBleHBlY3QoYW5hbHlzaXMudGhyZWF0cy5zb21lKHQgPT4gdC50eXBlID09PSAnU1FMX0lOSkVDVElPTicpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChhbmFseXNpcy5yaXNrU2NvcmUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGRldGVjdCBYU1MgdGhyZWF0cycsICgpID0+IHtcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBpcDogJzE5Mi4xNjguMS4xMDAnLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICB1cmw6ICcvYXBpL2NvbW1lbnRzJyxcbiAgICAgIHF1ZXJ5OiB7fSxcbiAgICAgIGJvZHk6IHsgY29tbWVudDogJzxzY3JpcHQ+YWxlcnQoXCJ4c3NcIik8L3NjcmlwdD4nIH0sXG4gICAgICBoZWFkZXJzOiB7fSxcbiAgICAgIGdldDogKCkgPT4gbnVsbFxuICAgIH07XG5cbiAgICBjb25zdCBhbmFseXNpcyA9IHNoaWVsZFNlcnZpY2UuYW5hbHl6ZVJlcXVlc3QocmVxKTtcblxuICAgIGV4cGVjdChhbmFseXNpcy50aHJlYXRzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIGV4cGVjdChhbmFseXNpcy50aHJlYXRzLnNvbWUodCA9PiB0LnR5cGUgPT09ICdYU1MnKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoYW5hbHlzaXMucmlza1Njb3JlKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBkZXRlY3QgcGF0aCB0cmF2ZXJzYWwgdGhyZWF0cycsICgpID0+IHtcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBpcDogJzE5Mi4xNjguMS4xMDAnLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHVybDogJy9hcGkvZmlsZXMvLi4vLi4vLi4vZXRjL3Bhc3N3ZCcsXG4gICAgICBxdWVyeToge30sXG4gICAgICBib2R5OiB7fSxcbiAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgZ2V0OiAoKSA9PiBudWxsXG4gICAgfTtcblxuICAgIGNvbnN0IGFuYWx5c2lzID0gc2hpZWxkU2VydmljZS5hbmFseXplUmVxdWVzdChyZXEpO1xuXG4gICAgZXhwZWN0KGFuYWx5c2lzLnRocmVhdHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgZXhwZWN0KGFuYWx5c2lzLnRocmVhdHMuc29tZSh0ID0+IHQudHlwZSA9PT0gJ1BBVEhfVFJBVkVSU0FMJykpLnRvQmUodHJ1ZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBlbmZvcmNlIHJhdGUgbGltaXRpbmcnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgaXA6ICcxOTIuMTY4LjEuMjAwJyxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB1cmw6ICcvYXBpL2RhdGEnLFxuICAgICAgcXVlcnk6IHt9LFxuICAgICAgYm9keToge30sXG4gICAgICBoZWFkZXJzOiB7fSxcbiAgICAgIGdldDogKCkgPT4gbnVsbFxuICAgIH07XG5cbiAgICAvLyBNYWtlIG1hbnkgcmVxdWVzdHMgdG8gdHJpZ2dlciByYXRlIGxpbWl0aW5nXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNTA7IGkrKykge1xuICAgICAgc2hpZWxkU2VydmljZS5hbmFseXplUmVxdWVzdChyZXEpO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIElQIGlzIGJsb2NrZWRcbiAgICBjb25zdCBpc0Jsb2NrZWQgPSBzaGllbGRTZXJ2aWNlLmlzSVBCbG9ja2VkKCcxOTIuMTY4LjEuMjAwJyk7XG4gICAgZXhwZWN0KGlzQmxvY2tlZCkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGJsb2NrIGFuZCB1bmJsb2NrIElQIGFkZHJlc3NlcycsICgpID0+IHtcbiAgICBjb25zdCBpcCA9ICcxOTIuMTY4LjEuMTUwJztcblxuICAgIC8vIEluaXRpYWxseSBub3QgYmxvY2tlZFxuICAgIGV4cGVjdChzaGllbGRTZXJ2aWNlLmlzSVBCbG9ja2VkKGlwKSkudG9CZShmYWxzZSk7XG5cbiAgICAvLyBCbG9jayBJUFxuICAgIHNoaWVsZFNlcnZpY2UuYmxvY2tJUChpcCk7XG4gICAgZXhwZWN0KHNoaWVsZFNlcnZpY2UuaXNJUEJsb2NrZWQoaXApKS50b0JlKHRydWUpO1xuXG4gICAgLy8gVW5ibG9jayBJUFxuICAgIHNoaWVsZFNlcnZpY2UudW5ibG9ja0lQKGlwKTtcbiAgICBleHBlY3Qoc2hpZWxkU2VydmljZS5pc0lQQmxvY2tlZChpcCkpLnRvQmUoZmFsc2UpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgY2FsY3VsYXRlIHJpc2sgc2NvcmVzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCBsb3dSaXNrUmVxID0ge1xuICAgICAgaXA6ICcxOTIuMTY4LjEuMTAwJyxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB1cmw6ICcvYXBpL3VzZXJzJyxcbiAgICAgIHF1ZXJ5OiB7IGlkOiAnbm9ybWFsLXVzZXItaWQnIH0sXG4gICAgICBib2R5OiB7fSxcbiAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgZ2V0OiAoKSA9PiBudWxsXG4gICAgfTtcblxuICAgIGNvbnN0IGhpZ2hSaXNrUmVxID0ge1xuICAgICAgaXA6ICcxOTIuMTY4LjEuMTAxJyxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB1cmw6ICcvYXBpL3VzZXJzJyxcbiAgICAgIHF1ZXJ5OiB7IGlkOiBcIjEnOyBEUk9QIFRBQkxFIHVzZXJzO1wiIH0sXG4gICAgICBib2R5OiB7fSxcbiAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgZ2V0OiAoKSA9PiBudWxsXG4gICAgfTtcblxuICAgIGNvbnN0IGxvd1Jpc2tBbmFseXNpcyA9IHNoaWVsZFNlcnZpY2UuYW5hbHl6ZVJlcXVlc3QobG93Umlza1JlcSk7XG4gICAgY29uc3QgaGlnaFJpc2tBbmFseXNpcyA9IHNoaWVsZFNlcnZpY2UuYW5hbHl6ZVJlcXVlc3QoaGlnaFJpc2tSZXEpO1xuXG4gICAgZXhwZWN0KGxvd1Jpc2tBbmFseXNpcy5yaXNrU2NvcmUpLnRvQmVMZXNzVGhhbihoaWdoUmlza0FuYWx5c2lzLnJpc2tTY29yZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBmaWx0ZXIgc2VjdXJpdHkgZXZlbnRzJywgKCkgPT4ge1xuICAgIC8vIEdlbmVyYXRlIHNvbWUgdGVzdCBldmVudHNcbiAgICBjb25zdCByZXExID0ge1xuICAgICAgaXA6ICcxOTIuMTY4LjEuMTAwJyxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB1cmw6ICcvYXBpL3VzZXJzJyxcbiAgICAgIHF1ZXJ5OiB7IGlkOiBcIjEnOyBEUk9QIFRBQkxFIHVzZXJzO1wiIH0sXG4gICAgICBib2R5OiB7fSxcbiAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgZ2V0OiAoKSA9PiBudWxsXG4gICAgfTtcblxuICAgIGNvbnN0IHJlcTIgPSB7XG4gICAgICBpcDogJzE5Mi4xNjguMS4xMDEnLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICB1cmw6ICcvYXBpL2NvbW1lbnRzJyxcbiAgICAgIHF1ZXJ5OiB7fSxcbiAgICAgIGJvZHk6IHsgY29tbWVudDogJzxzY3JpcHQ+YWxlcnQoXCJ4c3NcIik8L3NjcmlwdD4nIH0sXG4gICAgICBoZWFkZXJzOiB7fSxcbiAgICAgIGdldDogKCkgPT4gbnVsbFxuICAgIH07XG5cbiAgICBzaGllbGRTZXJ2aWNlLmFuYWx5emVSZXF1ZXN0KHJlcTEpO1xuICAgIHNoaWVsZFNlcnZpY2UuYW5hbHl6ZVJlcXVlc3QocmVxMik7XG5cbiAgICAvLyBGaWx0ZXIgYnkgSVBcbiAgICBjb25zdCBldmVudHNCeUlQID0gc2hpZWxkU2VydmljZS5nZXRTZWN1cml0eUV2ZW50cyh7IGlwOiAnMTkyLjE2OC4xLjEwMCcgfSk7XG4gICAgZXhwZWN0KGV2ZW50c0J5SVAuZXZlbnRzLmxlbmd0aCkudG9CZSgxKTtcbiAgICBleHBlY3QoZXZlbnRzQnlJUC5ldmVudHNbMF0uaXApLnRvQmUoJzE5Mi4xNjguMS4xMDAnKTtcblxuICAgIC8vIEZpbHRlciBieSBtaW5pbXVtIHJpc2sgc2NvcmVcbiAgICBjb25zdCBoaWdoUmlza0V2ZW50cyA9IHNoaWVsZFNlcnZpY2UuZ2V0U2VjdXJpdHlFdmVudHMoeyBtaW5SaXNrU2NvcmU6IDUgfSk7XG4gICAgZXhwZWN0KGhpZ2hSaXNrRXZlbnRzLmV2ZW50cy5sZW5ndGgpLnRvQmUoMik7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBnZW5lcmF0ZSB0aHJlYXQgc3RhdGlzdGljcycsICgpID0+IHtcbiAgICAvLyBHZW5lcmF0ZSBzb21lIHRlc3QgZXZlbnRzXG4gICAgY29uc3QgcmVxMSA9IHtcbiAgICAgIGlwOiAnMTkyLjE2OC4xLjEwMCcsXG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgdXJsOiAnL2FwaS91c2VycycsXG4gICAgICBxdWVyeTogeyBpZDogXCIxJzsgRFJPUCBUQUJMRSB1c2VycztcIiB9LFxuICAgICAgYm9keToge30sXG4gICAgICBoZWFkZXJzOiB7fSxcbiAgICAgIGdldDogKCkgPT4gbnVsbFxuICAgIH07XG5cbiAgICBjb25zdCByZXEyID0ge1xuICAgICAgaXA6ICcxOTIuMTY4LjEuMTAxJyxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgdXJsOiAnL2FwaS9jb21tZW50cycsXG4gICAgICBxdWVyeToge30sXG4gICAgICBib2R5OiB7IGNvbW1lbnQ6ICc8c2NyaXB0PmFsZXJ0KFwieHNzXCIpPC9zY3JpcHQ+JyB9LFxuICAgICAgaGVhZGVyczoge30sXG4gICAgICBnZXQ6ICgpID0+IG51bGxcbiAgICB9O1xuXG4gICAgc2hpZWxkU2VydmljZS5hbmFseXplUmVxdWVzdChyZXExKTtcbiAgICBzaGllbGRTZXJ2aWNlLmFuYWx5emVSZXF1ZXN0KHJlcTIpO1xuXG4gICAgY29uc3Qgc3RhdHMgPSBzaGllbGRTZXJ2aWNlLmdldFRocmVhdFN0YXRzKCk7XG5cbiAgICBleHBlY3Qoc3RhdHMudG90YWxFdmVudHMpLnRvQmUoMik7XG4gICAgZXhwZWN0KHN0YXRzLnRvdGFsVGhyZWF0cykudG9CZSgyKTtcbiAgICBleHBlY3QoT2JqZWN0LmtleXMoc3RhdHMudGhyZWF0VHlwZXMpLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgY2xlYXIgb2xkIGV2ZW50cycsICgpID0+IHtcbiAgICAvLyBHZW5lcmF0ZSBzb21lIHRlc3QgZXZlbnRzXG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgaXA6ICcxOTIuMTY4LjEuMTAwJyxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB1cmw6ICcvYXBpL3VzZXJzJyxcbiAgICAgIHF1ZXJ5OiB7IGlkOiAnbm9ybWFsLWlkJyB9LFxuICAgICAgYm9keToge30sXG4gICAgICBoZWFkZXJzOiB7fSxcbiAgICAgIGdldDogKCkgPT4gbnVsbFxuICAgIH07XG5cbiAgICBzaGllbGRTZXJ2aWNlLmFuYWx5emVSZXF1ZXN0KHJlcSk7XG5cbiAgICBleHBlY3Qoc2hpZWxkU2VydmljZS5zZWN1cml0eUV2ZW50cy5sZW5ndGgpLnRvQmUoMSk7XG5cbiAgICAvLyBDbGVhciBvbGQgZXZlbnRzXG4gICAgY29uc3QgcmVtb3ZlZENvdW50ID0gc2hpZWxkU2VydmljZS5jbGVhck9sZEV2ZW50cygwKTsgLy8gQ2xlYXIgYWxsIGV2ZW50c1xuXG4gICAgZXhwZWN0KHJlbW92ZWRDb3VudCkudG9CZSgxKTtcbiAgICBleHBlY3Qoc2hpZWxkU2VydmljZS5zZWN1cml0eUV2ZW50cy5sZW5ndGgpLnRvQmUoMCk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsYUFBYSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBRXpDQyxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsTUFBTTtFQUMvQkMsVUFBVSxDQUFDLE1BQU07SUFDZjtJQUNBSCxhQUFhLENBQUNJLE9BQU8sR0FBRyxFQUFFO0lBQzFCSixhQUFhLENBQUNLLGNBQWMsR0FBRyxFQUFFO0lBQ2pDTCxhQUFhLENBQUNNLFVBQVUsQ0FBQ0MsS0FBSyxDQUFDLENBQUM7SUFDaENQLGFBQWEsQ0FBQ1EsVUFBVSxDQUFDRCxLQUFLLENBQUMsQ0FBQztFQUNsQyxDQUFDLENBQUM7RUFFRkUsSUFBSSxDQUFDLHFDQUFxQyxFQUFFLE1BQU07SUFDaEQsTUFBTUMsR0FBRyxHQUFHO01BQ1ZDLEVBQUUsRUFBRSxlQUFlO01BQ25CQyxNQUFNLEVBQUUsS0FBSztNQUNiQyxHQUFHLEVBQUUsWUFBWTtNQUNqQkMsS0FBSyxFQUFFO1FBQUVDLEVBQUUsRUFBRTtNQUF3QixDQUFDO01BQ3RDQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO01BQ1JDLE9BQU8sRUFBRSxDQUFDLENBQUM7TUFDWEMsR0FBRyxFQUFFQSxDQUFBLEtBQU07SUFDYixDQUFDO0lBRUQsTUFBTUMsUUFBUSxHQUFHbkIsYUFBYSxDQUFDb0IsY0FBYyxDQUFDVixHQUFHLENBQUM7SUFFbERXLE1BQU0s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