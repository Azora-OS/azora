{"version":3,"names":["cov_1050mx1q0b","actualCoverage","HealthMonitor","constructor","checkInterval","b","f","s","services","Map","monitoringActive","registerService","name","url","set","status","lastCheck","Date","toISOString","responseTime","errorRate","uptime","console","log","start","monitorLoop","stop","checkAllServices","sleep","checks","Array","from","keys","map","serviceName","checkService","Promise","all","service","get","Error","startTime","now","response","fetch","method","signal","AbortSignal","timeout","healthy","ok","Math","min","max","timestamp","error","message","getAllHealth","values","getServiceHealth","getUnhealthyServices","filter","ms","resolve","setTimeout","exports","_default","default"],"sources":["health-monitor.ts"],"sourcesContent":["export interface ServiceHealth {\n    name: string;\n    url: string;\n    status: 'healthy' | 'degraded' | 'down';\n    lastCheck: string;\n    responseTime: number;\n    errorRate: number;\n    uptime: number;\n}\n\nexport interface HealthCheckResult {\n    service: string;\n    healthy: boolean;\n    responseTime: number;\n    error?: string;\n    timestamp: string;\n}\n\nexport class HealthMonitor {\n    private services: Map<string, ServiceHealth>;\n    private checkInterval: number;\n    private monitoringActive: boolean;\n\n    constructor(checkInterval: number = 30000) { // 30 seconds\n        this.services = new Map();\n        this.checkInterval = checkInterval;\n        this.monitoringActive = false;\n    }\n\n    /**\n     * Register a service for monitoring\n     */\n    registerService(name: string, url: string): void {\n        this.services.set(name, {\n            name,\n            url,\n            status: 'healthy',\n            lastCheck: new Date().toISOString(),\n            responseTime: 0,\n            errorRate: 0,\n            uptime: 100\n        });\n        console.log(`üîç Registered ${name} for health monitoring`);\n    }\n\n    /**\n     * Start continuous health monitoring\n     */\n    start(): void {\n        if (this.monitoringActive) {\n            console.log('Health monitoring already active');\n            return;\n        }\n\n        this.monitoringActive = true;\n        console.log(`üîç Health monitoring started (checking every ${this.checkInterval}ms)`);\n\n        this.monitorLoop();\n    }\n\n    /**\n     * Stop health monitoring\n     */\n    stop(): void {\n        this.monitoringActive = false;\n        console.log('üîç Health monitoring stopped');\n    }\n\n    /**\n     * Continuous monitoring loop\n     */\n    private async monitorLoop(): Promise<void> {\n        while (this.monitoringActive) {\n            await this.checkAllServices();\n            await this.sleep(this.checkInterval);\n        }\n    }\n\n    /**\n     * Check health of all registered services\n     */\n    private async checkAllServices(): Promise<void> {\n        const checks = Array.from(this.services.keys()).map(serviceName =>\n            this.checkService(serviceName)\n        );\n\n        await Promise.all(checks);\n    }\n\n    /**\n     * Check health of a specific service\n     */\n    async checkService(serviceName: string): Promise<HealthCheckResult> {\n        const service = this.services.get(serviceName);\n        if (!service) {\n            throw new Error(`Service ${serviceName} not registered`);\n        }\n\n        const startTime = Date.now();\n\n        try {\n            const response = await fetch(`${service.url}/health`, {\n                method: 'GET',\n                signal: AbortSignal.timeout(5000) // 5 second timeout\n            });\n\n            const responseTime = Date.now() - startTime;\n            const healthy = response.ok;\n\n            // Update service health\n            service.status = healthy ? 'healthy' : 'degraded';\n            service.lastCheck = new Date().toISOString();\n            service.responseTime = responseTime;\n\n            // Calculate uptime\n            if (healthy) {\n                service.uptime = Math.min(100, service.uptime + 0.1);\n            } else {\n                service.uptime = Math.max(0, service.uptime - 1);\n            }\n\n            return {\n                service: serviceName,\n                healthy,\n                responseTime,\n                timestamp: new Date().toISOString()\n            };\n        } catch (error) {\n            // Service is down\n            service.status = 'down';\n            service.lastCheck = new Date().toISOString();\n            service.uptime = Math.max(0, service.uptime - 2);\n            service.errorRate = Math.min(100, service.errorRate + 5);\n\n            return {\n                service: serviceName,\n                healthy: false,\n                responseTime: Date.now() - startTime,\n                error: error.message,\n                timestamp: new Date().toISOString()\n            };\n        }\n    }\n\n    /**\n     * Get health status of all services\n     */\n    getAllHealth(): ServiceHealth[] {\n        return Array.from(this.services.values());\n    }\n\n    /**\n     * Get health status of a specific service\n     */\n    getServiceHealth(serviceName: string): ServiceHealth | undefined {\n        return this.services.get(serviceName);\n    }\n\n    /**\n     * Get list of unhealthy services\n     */\n    getUnhealthyServices(): ServiceHealth[] {\n        return Array.from(this.services.values()).filter(\n            service => service.status !== 'healthy'\n        );\n    }\n\n    private sleep(ms: number): Promise<void> {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }\n}\n\nexport default HealthMonitor;\n"],"mappings":"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","ignoreList":[]}