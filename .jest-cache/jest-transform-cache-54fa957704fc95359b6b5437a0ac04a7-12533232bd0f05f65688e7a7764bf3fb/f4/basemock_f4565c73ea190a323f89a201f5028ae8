0f0f6869c34ff06fe057843c47112795
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.mockRegistry = exports.MockServiceRegistry = exports.BaseMock = void 0;
/**
 * Base class for mock services
 */
class BaseMock {
  calls = new Map();
  responses = new Map();

  /**
   * Track a method call
   */
  trackCall(method, args) {
    if (!this.calls.has(method)) {
      this.calls.set(method, []);
    }
    this.calls.get(method).push(args);
  }

  /**
   * Get all calls for a method
   */
  getCalls(method) {
    return this.calls.get(method) || [];
  }

  /**
   * Get call count for a method
   */
  getCallCount(method) {
    return this.getCalls(method).length;
  }

  /**
   * Check if method was called
   */
  wasCalled(method) {
    return this.getCallCount(method) > 0;
  }

  /**
   * Check if method was called with specific arguments
   */
  wasCalledWith(method, ...args) {
    const calls = this.getCalls(method);
    return calls.some(call => JSON.stringify(call) === JSON.stringify(args));
  }

  /**
   * Set response for a method
   */
  setResponse(method, response) {
    this.responses.set(method, response);
  }

  /**
   * Get response for a method
   */
  getResponse(method, defaultResponse) {
    return this.responses.get(method) ?? defaultResponse;
  }

  /**
   * Reset all calls and responses
   */
  reset() {
    this.calls.clear();
    this.responses.clear();
  }

  /**
   * Verify method was called exactly n times
   */
  verifyCallCount(method, expectedCount) {
    const actualCount = this.getCallCount(method);
    if (actualCount !== expectedCount) {
      throw new Error(`Expected ${method} to be called ${expectedCount} times, but was called ${actualCount} times`);
    }
  }

  /**
   * Verify method was called at least once
   */
  verifyWasCalled(method) {
    if (!this.wasCalled(method)) {
      throw new Error(`Expected ${method} to be called at least once`);
    }
  }

  /**
   * Verify method was never called
   */
  verifyWasNotCalled(method) {
    if (this.wasCalled(method)) {
      const count = this.getCallCount(method);
      throw new Error(`Expected ${method} to not be called, but was called ${count} times`);
    }
  }
}

/**
 * Mock service registry for managing all mocks
 */
exports.BaseMock = BaseMock;
class MockServiceRegistry {
  mocks = new Map();

  /**
   * Register a mock service
   */
  register(name, mock) {
    this.mocks.set(name, mock);
  }

  /**
   * Get a mock service
   */
  get(name) {
    return this.mocks.get(name);
  }

  /**
   * Reset all registered mocks
   */
  resetAll() {
    this.mocks.forEach(mock => mock.reset());
  }

  /**
   * Clear all registered mocks
   */
  clear() {
    this.mocks.clear();
  }
}

// Global mock registry
exports.MockServiceRegistry = MockServiceRegistry;
const mockRegistry = exports.mockRegistry = new MockServiceRegistry();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCYXNlTW9jayIsImNhbGxzIiwiTWFwIiwicmVzcG9uc2VzIiwidHJhY2tDYWxsIiwibWV0aG9kIiwiYXJncyIsImhhcyIsInNldCIsImdldCIsInB1c2giLCJnZXRDYWxscyIsImdldENhbGxDb3VudCIsImxlbmd0aCIsIndhc0NhbGxlZCIsIndhc0NhbGxlZFdpdGgiLCJzb21lIiwiY2FsbCIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRSZXNwb25zZSIsInJlc3BvbnNlIiwiZ2V0UmVzcG9uc2UiLCJkZWZhdWx0UmVzcG9uc2UiLCJyZXNldCIsImNsZWFyIiwidmVyaWZ5Q2FsbENvdW50IiwiZXhwZWN0ZWRDb3VudCIsImFjdHVhbENvdW50IiwiRXJyb3IiLCJ2ZXJpZnlXYXNDYWxsZWQiLCJ2ZXJpZnlXYXNOb3RDYWxsZWQiLCJjb3VudCIsImV4cG9ydHMiLCJNb2NrU2VydmljZVJlZ2lzdHJ5IiwibW9ja3MiLCJyZWdpc3RlciIsIm5hbWUiLCJtb2NrIiwicmVzZXRBbGwiLCJmb3JFYWNoIiwibW9ja1JlZ2lzdHJ5Il0sInNvdXJjZXMiOlsiYmFzZS5tb2NrLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBCYXNlIGNsYXNzIGZvciBtb2NrIHNlcnZpY2VzXHJcbiAqL1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZU1vY2sge1xyXG4gIHByb3RlY3RlZCBjYWxsczogTWFwPHN0cmluZywgYW55W10+ID0gbmV3IE1hcCgpO1xyXG4gIHByb3RlY3RlZCByZXNwb25zZXM6IE1hcDxzdHJpbmcsIGFueT4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRyYWNrIGEgbWV0aG9kIGNhbGxcclxuICAgKi9cclxuICBwcm90ZWN0ZWQgdHJhY2tDYWxsKG1ldGhvZDogc3RyaW5nLCBhcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLmNhbGxzLmhhcyhtZXRob2QpKSB7XHJcbiAgICAgIHRoaXMuY2FsbHMuc2V0KG1ldGhvZCwgW10pO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jYWxscy5nZXQobWV0aG9kKSEucHVzaChhcmdzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhbGwgY2FsbHMgZm9yIGEgbWV0aG9kXHJcbiAgICovXHJcbiAgZ2V0Q2FsbHMobWV0aG9kOiBzdHJpbmcpOiBhbnlbXVtdIHtcclxuICAgIHJldHVybiB0aGlzLmNhbGxzLmdldChtZXRob2QpIHx8IFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGNhbGwgY291bnQgZm9yIGEgbWV0aG9kXHJcbiAgICovXHJcbiAgZ2V0Q2FsbENvdW50KG1ldGhvZDogc3RyaW5nKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmdldENhbGxzKG1ldGhvZCkubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgbWV0aG9kIHdhcyBjYWxsZWRcclxuICAgKi9cclxuICB3YXNDYWxsZWQobWV0aG9kOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmdldENhbGxDb3VudChtZXRob2QpID4gMDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGlmIG1ldGhvZCB3YXMgY2FsbGVkIHdpdGggc3BlY2lmaWMgYXJndW1lbnRzXHJcbiAgICovXHJcbiAgd2FzQ2FsbGVkV2l0aChtZXRob2Q6IHN0cmluZywgLi4uYXJnczogYW55W10pOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGNhbGxzID0gdGhpcy5nZXRDYWxscyhtZXRob2QpO1xyXG4gICAgcmV0dXJuIGNhbGxzLnNvbWUoY2FsbCA9PiBcclxuICAgICAgSlNPTi5zdHJpbmdpZnkoY2FsbCkgPT09IEpTT04uc3RyaW5naWZ5KGFyZ3MpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHJlc3BvbnNlIGZvciBhIG1ldGhvZFxyXG4gICAqL1xyXG4gIHNldFJlc3BvbnNlKG1ldGhvZDogc3RyaW5nLCByZXNwb25zZTogYW55KTogdm9pZCB7XHJcbiAgICB0aGlzLnJlc3BvbnNlcy5zZXQobWV0aG9kLCByZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgcmVzcG9uc2UgZm9yIGEgbWV0aG9kXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIGdldFJlc3BvbnNlKG1ldGhvZDogc3RyaW5nLCBkZWZhdWx0UmVzcG9uc2U/OiBhbnkpOiBhbnkge1xyXG4gICAgcmV0dXJuIHRoaXMucmVzcG9uc2VzLmdldChtZXRob2QpID8/IGRlZmF1bHRSZXNwb25zZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc2V0IGFsbCBjYWxscyBhbmQgcmVzcG9uc2VzXHJcbiAgICovXHJcbiAgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmNhbGxzLmNsZWFyKCk7XHJcbiAgICB0aGlzLnJlc3BvbnNlcy5jbGVhcigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmVyaWZ5IG1ldGhvZCB3YXMgY2FsbGVkIGV4YWN0bHkgbiB0aW1lc1xyXG4gICAqL1xyXG4gIHZlcmlmeUNhbGxDb3VudChtZXRob2Q6IHN0cmluZywgZXhwZWN0ZWRDb3VudDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBjb25zdCBhY3R1YWxDb3VudCA9IHRoaXMuZ2V0Q2FsbENvdW50KG1ldGhvZCk7XHJcbiAgICBpZiAoYWN0dWFsQ291bnQgIT09IGV4cGVjdGVkQ291bnQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgIGBFeHBlY3RlZCAke21ldGhvZH0gdG8gYmUgY2FsbGVkICR7ZXhwZWN0ZWRDb3VudH0gdGltZXMsIGJ1dCB3YXMgY2FsbGVkICR7YWN0dWFsQ291bnR9IHRpbWVzYFxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmVyaWZ5IG1ldGhvZCB3YXMgY2FsbGVkIGF0IGxlYXN0IG9uY2VcclxuICAgKi9cclxuICB2ZXJpZnlXYXNDYWxsZWQobWV0aG9kOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGlmICghdGhpcy53YXNDYWxsZWQobWV0aG9kKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkICR7bWV0aG9kfSB0byBiZSBjYWxsZWQgYXQgbGVhc3Qgb25jZWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVmVyaWZ5IG1ldGhvZCB3YXMgbmV2ZXIgY2FsbGVkXHJcbiAgICovXHJcbiAgdmVyaWZ5V2FzTm90Q2FsbGVkKG1ldGhvZDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy53YXNDYWxsZWQobWV0aG9kKSkge1xyXG4gICAgICBjb25zdCBjb3VudCA9IHRoaXMuZ2V0Q2FsbENvdW50KG1ldGhvZCk7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgJHttZXRob2R9IHRvIG5vdCBiZSBjYWxsZWQsIGJ1dCB3YXMgY2FsbGVkICR7Y291bnR9IHRpbWVzYCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogTW9jayBzZXJ2aWNlIHJlZ2lzdHJ5IGZvciBtYW5hZ2luZyBhbGwgbW9ja3NcclxuICovXHJcbmV4cG9ydCBjbGFzcyBNb2NrU2VydmljZVJlZ2lzdHJ5IHtcclxuICBwcml2YXRlIG1vY2tzOiBNYXA8c3RyaW5nLCBCYXNlTW9jaz4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlZ2lzdGVyIGEgbW9jayBzZXJ2aWNlXHJcbiAgICovXHJcbiAgcmVnaXN0ZXIobmFtZTogc3RyaW5nLCBtb2NrOiBCYXNlTW9jayk6IHZvaWQge1xyXG4gICAgdGhpcy5tb2Nrcy5zZXQobmFtZSwgbW9jayk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYSBtb2NrIHNlcnZpY2VcclxuICAgKi9cclxuICBnZXQ8VCBleHRlbmRzIEJhc2VNb2NrPihuYW1lOiBzdHJpbmcpOiBUIHwgdW5kZWZpbmVkIHtcclxuICAgIHJldHVybiB0aGlzLm1vY2tzLmdldChuYW1lKSBhcyBUO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzZXQgYWxsIHJlZ2lzdGVyZWQgbW9ja3NcclxuICAgKi9cclxuICByZXNldEFsbCgpOiB2b2lkIHtcclxuICAgIHRoaXMubW9ja3MuZm9yRWFjaChtb2NrID0+IG1vY2sucmVzZXQoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGVhciBhbGwgcmVnaXN0ZXJlZCBtb2Nrc1xyXG4gICAqL1xyXG4gIGNsZWFyKCk6IHZvaWQge1xyXG4gICAgdGhpcy5tb2Nrcy5jbGVhcigpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gR2xvYmFsIG1vY2sgcmVnaXN0cnlcclxuZXhwb3J0IGNvbnN0IG1vY2tSZWdpc3RyeSA9IG5ldyBNb2NrU2VydmljZVJlZ2lzdHJ5KCk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ08sTUFBZUEsUUFBUSxDQUFDO0VBQ25CQyxLQUFLLEdBQXVCLElBQUlDLEdBQUcsQ0FBQyxDQUFDO0VBQ3JDQyxTQUFTLEdBQXFCLElBQUlELEdBQUcsQ0FBQyxDQUFDOztFQUVqRDtBQUNGO0FBQ0E7RUFDWUUsU0FBU0EsQ0FBQ0MsTUFBYyxFQUFFQyxJQUFXLEVBQVE7SUFDckQsSUFBSSxDQUFDLElBQUksQ0FBQ0wsS0FBSyxDQUFDTSxHQUFHLENBQUNGLE1BQU0sQ0FBQyxFQUFFO01BQzNCLElBQUksQ0FBQ0osS0FBSyxDQUFDTyxHQUFHLENBQUNILE1BQU0sRUFBRSxFQUFFLENBQUM7SUFDNUI7SUFDQSxJQUFJLENBQUNKLEtBQUssQ0FBQ1EsR0FBRyxDQUFDSixNQUFNLENBQUMsQ0FBRUssSUFBSSxDQUFDSixJQUFJLENBQUM7RUFDcEM7O0VBRUE7QUFDRjtBQUNBO0VBQ0VLLFFBQVFBLENBQUNOLE1BQWMsRUFBVztJQUNoQyxPQUFPLElBQUksQ0FBQ0osS0FBSyxDQUFDUSxHQUFHLENBQUNKLE1BQU0sQ0FBQyxJQUFJLEVBQUU7RUFD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