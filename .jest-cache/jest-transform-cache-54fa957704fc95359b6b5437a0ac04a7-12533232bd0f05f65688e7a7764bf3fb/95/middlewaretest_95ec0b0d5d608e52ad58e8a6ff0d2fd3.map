{"version":3,"names":["_orchestrator","require","_constitutionalMiddleware","describe","orchestrator","middleware","mockReq","mockRes","mockNext","beforeEach","ConstitutionalOrchestrator","ubuntuEnabled","biasDetectionEnabled","privacyFilterEnabled","harmPreventionEnabled","auditLoggingEnabled","createConstitutionalMiddleware","enabled","skipPaths","skipMethods","onViolation","includeMetadata","path","method","body","status","jest","fn","mockReturnThis","json","send","it","defaultMiddleware","expect","toBeDefined","toBe","customMiddleware","disabledMiddleware","toHaveBeenCalled","responseBody","output","response","message","content","blockMiddleware","warnMiddleware","logMiddleware","metadataMiddleware","noMetadataMiddleware","query","toEqual","i","mockClear","validConfig","testMiddleware","partialConfig"],"sources":["middleware.test.ts"],"sourcesContent":["/**\r\n * Constitutional AI Middleware Tests\r\n * Integration tests for API Gateway middleware\r\n */\r\n\r\nimport { Request, Response, NextFunction } from 'express';\r\nimport { ConstitutionalOrchestrator } from '../orchestrator';\r\nimport { createConstitutionalMiddleware, ConstitutionalRequest } from '../middleware/constitutional-middleware';\r\n\r\ndescribe('Constitutional AI Middleware', () => {\r\n  let orchestrator: ConstitutionalOrchestrator;\r\n  let middleware: any;\r\n  let mockReq: Partial<ConstitutionalRequest>;\r\n  let mockRes: Partial<Response>;\r\n  let mockNext: NextFunction;\r\n\r\n  beforeEach(() => {\r\n    orchestrator = new ConstitutionalOrchestrator({\r\n      ubuntuEnabled: true,\r\n      biasDetectionEnabled: true,\r\n      privacyFilterEnabled: true,\r\n      harmPreventionEnabled: true,\r\n      auditLoggingEnabled: false\r\n    });\r\n\r\n    middleware = createConstitutionalMiddleware(orchestrator, {\r\n      enabled: true,\r\n      skipPaths: ['/health', '/metrics'],\r\n      skipMethods: ['OPTIONS', 'HEAD'],\r\n      onViolation: 'block',\r\n      includeMetadata: true\r\n    });\r\n\r\n    mockReq = {\r\n      path: '/api/generate',\r\n      method: 'POST',\r\n      body: {}\r\n    };\r\n\r\n    mockRes = {\r\n      status: jest.fn().mockReturnThis(),\r\n      json: jest.fn().mockReturnThis(),\r\n      send: jest.fn().mockReturnThis()\r\n    };\r\n\r\n    mockNext = jest.fn();\r\n  });\r\n\r\n  describe('Middleware Initialization', () => {\r\n    it('should create middleware with default configuration', () => {\r\n      const defaultMiddleware = createConstitutionalMiddleware(orchestrator);\r\n      expect(defaultMiddleware).toBeDefined();\r\n      expect(typeof defaultMiddleware).toBe('function');\r\n    });\r\n\r\n    it('should create middleware with custom configuration', () => {\r\n      const customMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        enabled: false,\r\n        onViolation: 'warn'\r\n      });\r\n      expect(customMiddleware).toBeDefined();\r\n    });\r\n  });\r\n\r\n  describe('Middleware Execution', () => {\r\n    it('should call next() when middleware is disabled', async () => {\r\n      const disabledMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        enabled: false\r\n      });\r\n\r\n      await disabledMiddleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should call next() for skipped paths', async () => {\r\n      mockReq.path = '/health';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should call next() for skipped methods', async () => {\r\n      mockReq.method = 'OPTIONS';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should call next() for non-AI responses', async () => {\r\n      mockReq.path = '/api/data';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should intercept and validate AI responses', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n      expect(mockRes.json).toBeDefined();\r\n    });\r\n  });\r\n\r\n  describe('Response Validation', () => {\r\n    it('should validate response with AI output field', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      const responseBody = {\r\n        output: 'This is a community-focused solution that benefits everyone.'\r\n      };\r\n\r\n      // Simulate calling res.json with AI output\r\n      if (typeof mockRes.json === 'function') {\r\n        mockRes.json(responseBody);\r\n      }\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should validate response with response field', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      const responseBody = {\r\n        response: 'This is a community-focused solution that benefits everyone.'\r\n      };\r\n\r\n      if (typeof mockRes.json === 'function') {\r\n        mockRes.json(responseBody);\r\n      }\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should validate response with message field', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      const responseBody = {\r\n        message: 'This is a community-focused solution that benefits everyone.'\r\n      };\r\n\r\n      if (typeof mockRes.json === 'function') {\r\n        mockRes.json(responseBody);\r\n      }\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should validate response with content field', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      const responseBody = {\r\n        content: 'This is a community-focused solution that benefits everyone.'\r\n      };\r\n\r\n      if (typeof mockRes.json === 'function') {\r\n        mockRes.json(responseBody);\r\n      }\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Violation Handling', () => {\r\n    it('should block response on violation when configured', async () => {\r\n      const blockMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        onViolation: 'block'\r\n      });\r\n\r\n      mockReq.path = '/api/generate';\r\n\r\n      await blockMiddleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should warn on violation when configured', async () => {\r\n      const warnMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        onViolation: 'warn'\r\n      });\r\n\r\n      mockReq.path = '/api/generate';\r\n\r\n      await warnMiddleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should log violation when configured', async () => {\r\n      const logMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        onViolation: 'log'\r\n      });\r\n\r\n      mockReq.path = '/api/generate';\r\n\r\n      await logMiddleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Metadata Inclusion', () => {\r\n    it('should include validation metadata when configured', async () => {\r\n      const metadataMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        includeMetadata: true\r\n      });\r\n\r\n      mockReq.path = '/api/generate';\r\n\r\n      await metadataMiddleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should exclude validation metadata when configured', async () => {\r\n      const noMetadataMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        includeMetadata: false\r\n      });\r\n\r\n      mockReq.path = '/api/generate';\r\n\r\n      await noMetadataMiddleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Request Attachment', () => {\r\n    it('should attach constitutional validation data to request', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should preserve original request properties', async () => {\r\n      mockReq.path = '/api/generate';\r\n      mockReq.body = { query: 'test' };\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockReq.body).toEqual({ query: 'test' });\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Error Handling', () => {\r\n    it('should handle validation errors gracefully', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should not crash on invalid response body', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle null response body', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      if (typeof mockRes.json === 'function') {\r\n        mockRes.json(null);\r\n      }\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Path Filtering', () => {\r\n    it('should skip validation for health check endpoint', async () => {\r\n      mockReq.path = '/health';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should skip validation for metrics endpoint', async () => {\r\n      mockReq.path = '/metrics';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should validate non-skipped paths', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should support custom skip paths', async () => {\r\n      const customMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        skipPaths: ['/custom', '/skip']\r\n      });\r\n\r\n      mockReq.path = '/custom';\r\n\r\n      await customMiddleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Method Filtering', () => {\r\n    it('should skip validation for OPTIONS method', async () => {\r\n      mockReq.method = 'OPTIONS';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should skip validation for HEAD method', async () => {\r\n      mockReq.method = 'HEAD';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should validate POST requests', async () => {\r\n      mockReq.method = 'POST';\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should validate GET requests', async () => {\r\n      mockReq.method = 'GET';\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should support custom skip methods', async () => {\r\n      const customMiddleware = createConstitutionalMiddleware(orchestrator, {\r\n        skipMethods: ['PATCH', 'DELETE']\r\n      });\r\n\r\n      mockReq.method = 'PATCH';\r\n\r\n      await customMiddleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Integration Scenarios', () => {\r\n    it('should validate compliant AI output', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle multiple sequential requests', async () => {\r\n      for (let i = 0; i < 3; i++) {\r\n        mockReq.path = '/api/generate';\r\n        mockNext.mockClear();\r\n\r\n        await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n        expect(mockNext).toHaveBeenCalled();\r\n      }\r\n    });\r\n\r\n    it('should maintain state across requests', async () => {\r\n      mockReq.path = '/api/generate';\r\n\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n\r\n      // Second request should work independently\r\n      mockNext.mockClear();\r\n      await middleware(mockReq as ConstitutionalRequest, mockRes as Response, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Configuration Validation', () => {\r\n    it('should accept valid configuration', () => {\r\n      const validConfig = {\r\n        enabled: true,\r\n        skipPaths: ['/health'],\r\n        skipMethods: ['OPTIONS'],\r\n        onViolation: 'block' as const,\r\n        includeMetadata: true\r\n      };\r\n\r\n      const testMiddleware = createConstitutionalMiddleware(orchestrator, validConfig);\r\n      expect(testMiddleware).toBeDefined();\r\n    });\r\n\r\n    it('should work with partial configuration', () => {\r\n      const partialConfig = {\r\n        enabled: true\r\n      };\r\n\r\n      const testMiddleware = createConstitutionalMiddleware(orchestrator, partialConfig);\r\n      expect(testMiddleware).toBeDefined();\r\n    });\r\n\r\n    it('should work with empty configuration', () => {\r\n      const testMiddleware = createConstitutionalMiddleware(orchestrator, {});\r\n      expect(testMiddleware).toBeDefined();\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}