{"version":3,"names":["request","require","app","describe","it","response","post","send","action","context","domain","impact","expect","status","toBe","body","success","data","toHaveProperty","error","dataType","compliant","transparency","Array","isArray","violations","accountability","recommendations","length","toBeGreaterThan","get","createResponse","reportId","id"],"sources":["compliance-checking.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst app = require('../index');\r\n\r\ndescribe('AI Ethics Monitor - Compliance Checking Tests', () => {\r\n  describe('POST /api/compliance', () => {\r\n    it('should check constitutional compliance', async () => {\r\n      const response = await request(app)\r\n        .post('/api/compliance')\r\n        .send({\r\n          action: 'Deploy AI model',\r\n          context: { domain: 'healthcare', impact: 'high' }\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data).toHaveProperty('id');\r\n      expect(response.body.data).toHaveProperty('compliant');\r\n      expect(response.body.data).toHaveProperty('violations');\r\n      expect(response.body.data).toHaveProperty('recommendations');\r\n    });\r\n\r\n    it('should return error when action is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/compliance')\r\n        .send({ context: {} });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Action is required');\r\n    });\r\n\r\n    it('should report compliance status', async () => {\r\n      const response = await request(app)\r\n        .post('/api/compliance')\r\n        .send({\r\n          action: 'Process user data',\r\n          context: { dataType: 'personal' }\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(typeof response.body.data.compliant).toBe('boolean');\r\n    });\r\n\r\n    it('should detect constitutional violations', async () => {\r\n      const response = await request(app)\r\n        .post('/api/compliance')\r\n        .send({\r\n          action: 'Automated decision without transparency',\r\n          context: { transparency: 'low' }\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(Array.isArray(response.body.data.violations)).toBe(true);\r\n    });\r\n\r\n    it('should provide compliance recommendations', async () => {\r\n      const response = await request(app)\r\n        .post('/api/compliance')\r\n        .send({\r\n          action: 'Deploy AI system',\r\n          context: { accountability: 'unclear' }\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(Array.isArray(response.body.data.recommendations)).toBe(true);\r\n      expect(response.body.data.recommendations.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/compliance-reports', () => {\r\n    it('should retrieve all compliance reports', async () => {\r\n      const response = await request(app)\r\n        .get('/api/compliance-reports');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(Array.isArray(response.body.data)).toBe(true);\r\n      expect(response.body).toHaveProperty('count');\r\n    });\r\n  });\r\n\r\n  describe('GET /api/compliance-reports/:reportId', () => {\r\n    it('should retrieve specific compliance report', async () => {\r\n      // First create a report\r\n      const createResponse = await request(app)\r\n        .post('/api/compliance')\r\n        .send({ action: 'Test action' });\r\n\r\n      const reportId = createResponse.body.data.id;\r\n\r\n      // Then retrieve it\r\n      const response = await request(app)\r\n        .get(`/api/compliance-reports/${reportId}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.id).toBe(reportId);\r\n    });\r\n\r\n    it('should return 404 for non-existent report', async () => {\r\n      const response = await request(app)\r\n        .get('/api/compliance-reports/non-existent-id');\r\n\r\n      expect(response.status).toBe(404);\r\n      expect(response.body.error).toBe('Compliance report not found');\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}