7bdba55d93d83d11c4197669c7daba36
"use strict";

const request = require('supertest');
const app = require('../server');
describe('subscription Performance Tests', () => {
  it('should respond within 100ms', async () => {
    const start = Date.now();
    await request(app).get('/health').expect(200);
    const duration = Date.now() - start;
    expect(duration).toBeLessThan(100);
  });
  it('should handle 1000 requests per second', async () => {
    const start = Date.now();
    const promises = Array(1000).fill().map(() => request(app).get('/health'));
    await Promise.all(promises);
    const duration = Date.now() - start;
    expect(duration).toBeLessThan(1000);
  });
  it('should have low memory usage', () => {
    const memBefore = process.memoryUsage().heapUsed;
    // Simulate workload
    for (let i = 0; i < 10000; i++) {
      const obj = {
        data: 'test'.repeat(100)
      };
    }
    const memAfter = process.memoryUsage().heapUsed;
    const memIncrease = memAfter - memBefore;
    expect(memIncrease).toBeLessThan(50 * 1024 * 1024); // 50MB
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1ZXN0IiwicmVxdWlyZSIsImFwcCIsImRlc2NyaWJlIiwiaXQiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJnZXQiLCJleHBlY3QiLCJkdXJhdGlvbiIsInRvQmVMZXNzVGhhbiIsInByb21pc2VzIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiUHJvbWlzZSIsImFsbCIsIm1lbUJlZm9yZSIsInByb2Nlc3MiLCJtZW1vcnlVc2FnZSIsImhlYXBVc2VkIiwiaSIsIm9iaiIsImRhdGEiLCJyZXBlYXQiLCJtZW1BZnRlciIsIm1lbUluY3JlYXNlIl0sInNvdXJjZXMiOlsic3Vic2NyaXB0aW9uLnBlcmZvcm1hbmNlLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3N1cGVydGVzdCcpO1xuY29uc3QgYXBwID0gcmVxdWlyZSgnLi4vc2VydmVyJyk7XG5cbmRlc2NyaWJlKCdzdWJzY3JpcHRpb24gUGVyZm9ybWFuY2UgVGVzdHMnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgcmVzcG9uZCB3aXRoaW4gMTAwbXMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIGF3YWl0IHJlcXVlc3QoYXBwKS5nZXQoJy9oZWFsdGgnKS5leHBlY3QoMjAwKTtcbiAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydDtcbiAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbigxMDApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhbmRsZSAxMDAwIHJlcXVlc3RzIHBlciBzZWNvbmQnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHByb21pc2VzID0gQXJyYXkoMTAwMCkuZmlsbCgpLm1hcCgoKSA9PiBcbiAgICAgIHJlcXVlc3QoYXBwKS5nZXQoJy9oZWFsdGgnKVxuICAgICk7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0O1xuICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDEwMDApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhdmUgbG93IG1lbW9yeSB1c2FnZScsICgpID0+IHtcbiAgICBjb25zdCBtZW1CZWZvcmUgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCkuaGVhcFVzZWQ7XG4gICAgLy8gU2ltdWxhdGUgd29ya2xvYWRcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDAwOyBpKyspIHtcbiAgICAgIGNvbnN0IG9iaiA9IHsgZGF0YTogJ3Rlc3QnLnJlcGVhdCgxMDApIH07XG4gICAgfVxuICAgIGNvbnN0IG1lbUFmdGVyID0gcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLmhlYXBVc2VkO1xuICAgIGNvbnN0IG1lbUluY3JlYXNlID0gbWVtQWZ0ZXIgLSBtZW1CZWZvcmU7XG4gICAgZXhwZWN0KG1lbUluY3JlYXNlKS50b0JlTGVzc1RoYW4oNTAgKiAxMDI0ICogMTAyNCk7IC8vIDUwTUJcbiAgfSk7XG59KTsiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQ3BDLE1BQU1DLEdBQUcsR0FBR0QsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUVoQ0UsUUFBUSxDQUFDLGdDQUFnQyxFQUFFLE1BQU07RUFDL0NDLEVBQUUsQ0FBQyw2QkFBNkIsRUFBRSxZQUFZO0lBQzVDLE1BQU1DLEtBQUssR0FBR0MsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQztJQUN4QixNQUFNUCxPQUFPLENBQUNFLEdBQUcsQ0FBQyxDQUFDTSxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FBQyxHQUFHLENBQUM7SUFDN0MsTUFBTUMsUUFBUSxHQUFHSixJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEdBQUdGLEtBQUs7SUFDbkNJLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDLENBQUNDLFlBQVksQ0FBQyxHQUFHLENBQUM7RUFDcEMsQ0FBQyxDQUFDO0VBRUZQLEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxZQUFZO0lBQ3ZELE1BQU1DLEtBQUssR0FBR0MsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQztJQUN4QixNQUFNSyxRQUFRLEdBQUdDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLE1BQ3RDZixPQUFPLENBQUNFLEdBQUcsQ0FBQyxDQUFDTSxHQUFHLENBQUMsU0FBUyxDQUM1QixDQUFDO0lBQ0QsTUFBTVEsT0FBTyxDQUFDQyxHQUFHLENBQUNMLFFBQVEsQ0FBQztJQUMzQixNQUFNRixRQUFRLEdBQUdKLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUMsR0FBR0YsS0FBSztJQUNuQ0ksTUFBTSxDQUFDQyxRQUFRLENBQUMsQ0FBQ0MsWUFBWSxDQUFDLElBQUksQ0FBQztFQUNyQyxDQUFDLENBQUM7RUFFRlAsRUFBRSxDQUFDLDhCQUE4QixFQUFFLE1BQU07SUFDdkMsTUFBTWMsU0FBUyxHQUFHQyxPQUFPLENBQUNDLFdBQVcsQ0FBQyxDQUFDLENBQUNDLFFBQVE7SUFDaEQ7SUFDQSxLQUFLLElBQUlDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBRyxLQUFLLEVBQUVBLENBQUMsRUFBRSxFQUFFO01BQzlCLE1BQU1DLEdBQUcsR0FBRztRQUFFQyxJQUFJLEVBQUUsTUFBTSxDQUFDQyxNQUFNLENBQUMsR0FBRztNQUFFLENBQUM7SUFDMUM7SUFDQSxNQUFNQyxRQUFRLEdBQUdQLE9BQU8sQ0FBQ0MsV0FBVyxDQUFDLENBQUMsQ0FBQ0MsUUFBUTtJQUMvQyxNQUFNTSxXQUFXLEdBQUdELFFBQVEsR0FBR1IsU0FBUztJQUN4Q1QsTUFBTSxDQUFDa0IsV0FBVyxDQUFDLENBQUNoQixZQUFZLENBQUMsRUFBRSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3RELENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==