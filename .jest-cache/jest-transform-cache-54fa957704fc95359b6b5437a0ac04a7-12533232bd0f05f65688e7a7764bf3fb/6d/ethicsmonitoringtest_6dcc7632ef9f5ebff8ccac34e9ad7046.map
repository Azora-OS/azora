{"version":3,"names":["request","require","app","describe","it","response","post","send","aiDecision","context","sensitivity","amount","user","expect","status","toBe","body","success","data","toHaveProperty","error","ethicalScore","toBeGreaterThanOrEqual","toBeLessThanOrEqual","biasRisk","Array","isArray","violations","recommendations","length","toBeGreaterThan","get","createResponse","reportId","id"],"sources":["ethics-monitoring.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst app = require('../index');\r\n\r\ndescribe('AI Ethics Monitor - Ethics Monitoring Tests', () => {\r\n  describe('POST /api/monitor', () => {\r\n    it('should generate ethics report for AI decision', async () => {\r\n      const response = await request(app)\r\n        .post('/api/monitor')\r\n        .send({\r\n          aiDecision: 'Approve loan application',\r\n          context: { sensitivity: 'high', amount: 50000 },\r\n          user: 'user123'\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data).toHaveProperty('id');\r\n      expect(response.body.data).toHaveProperty('ethicalScore');\r\n      expect(response.body.data).toHaveProperty('violations');\r\n      expect(response.body.data).toHaveProperty('recommendations');\r\n    });\r\n\r\n    it('should return error when AI decision is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/monitor')\r\n        .send({ context: {}, user: 'user123' });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('AI decision is required');\r\n    });\r\n\r\n    it('should calculate ethical score', async () => {\r\n      const response = await request(app)\r\n        .post('/api/monitor')\r\n        .send({\r\n          aiDecision: 'Recommend content',\r\n          context: { sensitivity: 'low' }\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(response.body.data.ethicalScore).toBeGreaterThanOrEqual(0);\r\n      expect(response.body.data.ethicalScore).toBeLessThanOrEqual(100);\r\n    });\r\n\r\n    it('should detect ethical violations', async () => {\r\n      const response = await request(app)\r\n        .post('/api/monitor')\r\n        .send({\r\n          aiDecision: 'Process sensitive data',\r\n          context: { sensitivity: 'high', biasRisk: true }\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(Array.isArray(response.body.data.violations)).toBe(true);\r\n    });\r\n\r\n    it('should provide recommendations', async () => {\r\n      const response = await request(app)\r\n        .post('/api/monitor')\r\n        .send({\r\n          aiDecision: 'Automated hiring decision',\r\n          context: { sensitivity: 'high' }\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(Array.isArray(response.body.data.recommendations)).toBe(true);\r\n      expect(response.body.data.recommendations.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/reports', () => {\r\n    it('should retrieve all ethics reports', async () => {\r\n      const response = await request(app)\r\n        .get('/api/reports');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(Array.isArray(response.body.data)).toBe(true);\r\n      expect(response.body).toHaveProperty('count');\r\n    });\r\n  });\r\n\r\n  describe('GET /api/reports/:reportId', () => {\r\n    it('should retrieve specific ethics report', async () => {\r\n      // First create a report\r\n      const createResponse = await request(app)\r\n        .post('/api/monitor')\r\n        .send({ aiDecision: 'Test decision' });\r\n\r\n      const reportId = createResponse.body.data.id;\r\n\r\n      // Then retrieve it\r\n      const response = await request(app)\r\n        .get(`/api/reports/${reportId}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.data.id).toBe(reportId);\r\n    });\r\n\r\n    it('should return 404 for non-existent report', async () => {\r\n      const response = await request(app)\r\n        .get('/api/reports/non-existent-id');\r\n\r\n      expect(response.status).toBe(404);\r\n      expect(response.body.error).toBe('Ethics report not found');\r\n    });\r\n  });\r\n\r\n  describe('GET /api/violations', () => {\r\n    it('should retrieve all violations', async () => {\r\n      const response = await request(app)\r\n        .get('/api/violations');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(Array.isArray(response.body.data)).toBe(true);\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}