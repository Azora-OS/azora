523bae4a479329b1dd565130948394b0
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.AIOrchestrator = void 0;
var _openai = _interopRequireDefault(require("openai"));
var _sdk = _interopRequireDefault(require("@anthropic-ai/sdk"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
class AIOrchestrator {
  openai = null;
  anthropic = null;
  cache = new Map();
  CACHE_TTL = 3600000; // 1 hour
  totalTokensUsed = 0;
  totalCost = 0;
  constructor() {
    // Initialize clients if API keys are available
    if (process.env.OPENAI_API_KEY) {
      this.openai = new _openai.default({
        apiKey: process.env.OPENAI_API_KEY
      });
    }
    if (process.env.ANTHROPIC_API_KEY) {
      this.anthropic = new _sdk.default({
        apiKey: process.env.ANTHROPIC_API_KEY
      });
    }
  }
  async generateCode(prompt, context, model) {
    // Check cache first
    const cacheKey = this.getCacheKey(prompt, context);
    const cached = this.getCachedResponse(cacheKey);
    if (cached) {
      console.log('Using cached AI response');
      return {
        content: cached.response,
        model: cached.model,
        tokensUsed: 0,
        cost: 0
      };
    }

    // Select model
    const selectedModel = model || this.selectModel('code-generation');

    // Build full prompt with context
    const fullPrompt = this.buildPrompt(prompt, context);

    // Generate response
    let response;
    if (selectedModel.provider === 'openai') {
      response = await this.generateWithOpenAI(fullPrompt, selectedModel);
    } else {
      response = await this.generateWithClaude(fullPrompt, selectedModel);
    }

    // Cache response
    this.cacheResponse(cacheKey, response.content, response.model);

    // Track usage
    this.totalTokensUsed += response.tokensUsed;
    this.totalCost += response.cost;
    return response;
  }
  async generateWithOpenAI(prompt, model) {
    if (!this.openai) {
      throw new Error('OpenAI client not initialized. Please set OPENAI_API_KEY.');
    }
    const completion = await this.openai.chat.completions.create({
      model: model.model,
      messages: [{
        role: 'system',
        content: 'You are an expert software developer assistant. Generate clean, production-ready code following best practices.'
      }, {
        role: 'user',
        content: prompt
      }],
      max_tokens: model.maxTokens,
      temperature: model.temperature
    });
    const content = completion.choices[0]?.message?.content || '';
    const tokensUsed = completion.usage?.total_tokens || 0;
    const cost = this.calculateCost('openai', model.model, tokensUsed);
    return {
      content,
      model: model.model,
      tokensUsed,
      cost
    };
  }
  async generateWithClaude(prompt, model) {
    if (!this.anthropic) {
      throw new Error('Anthropic client not initialized. Please set ANTHROPIC_API_KEY.');
    }
    const message = await this.anthropic.messages.create({
      model: model.model,
      max_tokens: model.maxTokens,
      temperature: model.temperature,
      messages: [{
        role: 'user',
        content: prompt
      }]
    });
    const content = message.content[0]?.type === 'text' ? message.content[0].text : '';
    const tokensUsed = message.usage.input_tokens + message.usage.output_tokens;
    const cost = this.calculateCost('anthropic', model.model, tokensUsed);
    return {
      content,
      model: model.model,
      tokensUsed,
      cost
    };
  }
  selectModel(taskType) {
    // Select appropriate model based on task type
    switch (taskType) {
      case 'code-generation':
        return {
          provider: 'openai',
          model: 'gpt-4-turbo-preview',
          maxTokens: 4096,
          temperature: 0.2
        };
      case 'refactoring':
        return {
          provider: 'anthropic',
          model: 'claude-3-opus-20240229',
          maxTokens: 4096,
          temperature: 0.1
        };
      case 'explanation':
        return {
          provider: 'openai',
          model: 'gpt-4-turbo-preview',
          maxTokens: 2048,
          temperature: 0.7
        };
      default:
        return {
          provider: 'openai',
          model: 'gpt-4-turbo-preview',
          maxTokens: 4096,
          temperature: 0.3
        };
    }
  }
  buildPrompt(userPrompt, context) {
    let prompt = `# Task\n${userPrompt}\n\n`;

    // Add project context
    if (context.projectInfo.frameworks.length > 0) {
      prompt += `# Project Frameworks\n${context.projectInfo.frameworks.join(', ')}\n\n`;
    }

    // Add relevant files
    if (context.files.length > 0) {
      prompt += `# Relevant Files\n\n`;
      for (const file of context.files) {
        prompt += `## ${file.path}\n\`\`\`\n${file.content}\n\`\`\`\n\n`;
      }
    }

    // Add conventions
    if (context.projectInfo.conventions) {
      prompt += `# Project Conventions\n`;
      prompt += `- Package Manager: ${context.projectInfo.conventions.packageManager}\n`;
      prompt += `- TypeScript: ${context.projectInfo.conventions.typescript ? 'Yes' : 'No'}\n`;
      if (context.projectInfo.conventions.testing.length > 0) {
        prompt += `- Testing: ${context.projectInfo.conventions.testing.join(', ')}\n`;
      }
      prompt += `\n`;
    }
    prompt += `# Instructions\n`;
    prompt += `- Generate clean, production-ready code\n`;
    prompt += `- Follow the project's existing patterns and conventions\n`;
    prompt += `- Include proper error handling\n`;
    prompt += `- Add TypeScript types where applicable\n`;
    prompt += `- Write self-documenting code with clear variable names\n`;
    return prompt;
  }
  async estimateCost(prompt, context) {
    const fullPrompt = this.buildPrompt(prompt, context);
    const estimatedTokens = Math.ceil(fullPrompt.length / 4); // Rough estimate: 1 token â‰ˆ 4 chars
    const model = this.selectModel('code-generation');
    return this.calculateCost(model.provider, model.model, estimatedTokens);
  }
  calculateCost(provider, model, tokens) {
    // Pricing per 1M tokens (as of 2024)
    const pricing = {
      'gpt-4-turbo-preview': {
        input: 10,
        output: 30
      },
      'gpt-4': {
        input: 30,
        output: 60
      },
      'gpt-3.5-turbo': {
        input: 0.5,
        output: 1.5
      },
      'claude-3-opus-20240229': {
        input: 15,
        output: 75
      },
      'claude-3-sonnet-20240229': {
        input: 3,
        output: 15
      }
    };
    const modelPricing = pricing[model] || {
      input: 10,
      output: 30
    };
    // Assume 50/50 split between input and output tokens
    const inputTokens = tokens * 0.5;
    const outputTokens = tokens * 0.5;
    return (inputTokens * modelPricing.input + outputTokens * modelPricing.output) / 1000000;
  }
  getCacheKey(prompt, context) {
    const contextStr = JSON.stringify({
      prompt,
      files: context.files.map(f => f.path),
      frameworks: context.projectInfo.frameworks
    });

    // Simple hash function
    let hash = 0;
    for (let i = 0; i < contextStr.length; i++) {
      const char = contextStr.charCodeAt(i);
      hash = (hash << 5) - hash + char;
      hash = hash & hash;
    }
    return hash.toString(36);
  }
  getCachedResponse(key) {
    const cached = this.cache.get(key);
    if (!cached) return null;

    // Check if cache is still valid
    if (Date.now() - cached.timestamp > this.CACHE_TTL) {
      this.cache.delete(key);
      return null;
    }
    return cached;
  }
  cacheResponse(key, response, model) {
    this.cache.set(key, {
      prompt: key,
      response,
      timestamp: Date.now(),
      model
    });

    // Limit cache size
    if (this.cache.size > 100) {
      const firstKey = this.cache.keys().next().value;
      this.cache.delete(firstKey);
    }
  }
  getUsageStats() {
    return {
      totalTokens: this.totalTokensUsed,
      totalCost: this.totalCost,
      cacheSize: this.cache.size
    };
  }
  clearCache() {
    this.cache.clear();
  }
}
exports.AIOrchestrator = AIOrchestrator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfb3BlbmFpIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfc2RrIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiQUlPcmNoZXN0cmF0b3IiLCJvcGVuYWkiLCJhbnRocm9waWMiLCJjYWNoZSIsIk1hcCIsIkNBQ0hFX1RUTCIsInRvdGFsVG9rZW5zVXNlZCIsInRvdGFsQ29zdCIsImNvbnN0cnVjdG9yIiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwiT3BlbkFJIiwiYXBpS2V5IiwiQU5USFJPUElDX0FQSV9LRVkiLCJBbnRocm9waWMiLCJnZW5lcmF0ZUNvZGUiLCJwcm9tcHQiLCJjb250ZXh0IiwibW9kZWwiLCJjYWNoZUtleSIsImdldENhY2hlS2V5IiwiY2FjaGVkIiwiZ2V0Q2FjaGVkUmVzcG9uc2UiLCJjb25zb2xlIiwibG9nIiwiY29udGVudCIsInJlc3BvbnNlIiwidG9rZW5zVXNlZCIsImNvc3QiLCJzZWxlY3RlZE1vZGVsIiwic2VsZWN0TW9kZWwiLCJmdWxsUHJvbXB0IiwiYnVpbGRQcm9tcHQiLCJwcm92aWRlciIsImdlbmVyYXRlV2l0aE9wZW5BSSIsImdlbmVyYXRlV2l0aENsYXVkZSIsImNhY2hlUmVzcG9uc2UiLCJFcnJvciIsImNvbXBsZXRpb24iLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtZXNzYWdlcyIsInJvbGUiLCJtYXhfdG9rZW5zIiwibWF4VG9rZW5zIiwidGVtcGVyYXR1cmUiLCJjaG9pY2VzIiwibWVzc2FnZSIsInVzYWdlIiwidG90YWxfdG9rZW5zIiwiY2FsY3VsYXRlQ29zdCIsInR5cGUiLCJ0ZXh0IiwiaW5wdXRfdG9rZW5zIiwib3V0cHV0X3Rva2VucyIsInRhc2tUeXBlIiwidXNlclByb21wdCIsInByb2plY3RJbmZvIiwiZnJhbWV3b3JrcyIsImxlbmd0aCIsImpvaW4iLCJmaWxlcyIsImZpbGUiLCJwYXRoIiwiY29udmVudGlvbnMiLCJwYWNrYWdlTWFuYWdlciIsInR5cGVzY3JpcHQiLCJ0ZXN0aW5nIiwiZXN0aW1hdGVDb3N0IiwiZXN0aW1hdGVkVG9rZW5zIiwiTWF0aCIsImNlaWwiLCJ0b2tlbnMiLCJwcmljaW5nIiwiaW5wdXQiLCJvdXRwdXQiLCJtb2RlbFByaWNpbmciLCJpbnB1dFRva2VucyIsIm91dHB1dFRva2VucyIsImNvbnRleHRTdHIiLCJKU09OIiwic3RyaW5naWZ5IiwibWFwIiwiZiIsImhhc2giLCJpIiwiY2hhciIsImNoYXJDb2RlQXQiLCJ0b1N0cmluZyIsImtleSIsImdldCIsIkRhdGUiLCJub3ciLCJ0aW1lc3RhbXAiLCJkZWxldGUiLCJzZXQiLCJzaXplIiwiZmlyc3RLZXkiLCJrZXlzIiwibmV4dCIsInZhbHVlIiwiZ2V0VXNhZ2VTdGF0cyIsInRvdGFsVG9rZW5zIiwiY2FjaGVTaXplIiwiY2xlYXJDYWNoZSIsImNsZWFyIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkFJT3JjaGVzdHJhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcbmltcG9ydCBBbnRocm9waWMgZnJvbSAnQGFudGhyb3BpYy1haS9zZGsnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFJTW9kZWwge1xuICBwcm92aWRlcjogJ29wZW5haScgfCAnYW50aHJvcGljJztcbiAgbW9kZWw6IHN0cmluZztcbiAgbWF4VG9rZW5zOiBudW1iZXI7XG4gIHRlbXBlcmF0dXJlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQUlDb250ZXh0IHtcbiAgZmlsZXM6IEFycmF5PHsgcGF0aDogc3RyaW5nOyBjb250ZW50OiBzdHJpbmcgfT47XG4gIHByb2plY3RJbmZvOiB7XG4gICAgZnJhbWV3b3Jrczogc3RyaW5nW107XG4gICAgY29udmVudGlvbnM6IGFueTtcbiAgfTtcbiAgdXNlclByb21wdDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFJUmVzcG9uc2Uge1xuICBjb250ZW50OiBzdHJpbmc7XG4gIG1vZGVsOiBzdHJpbmc7XG4gIHRva2Vuc1VzZWQ6IG51bWJlcjtcbiAgY29zdDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhY2hlZFJlc3BvbnNlIHtcbiAgcHJvbXB0OiBzdHJpbmc7XG4gIHJlc3BvbnNlOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICBtb2RlbDogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQUlPcmNoZXN0cmF0b3Ige1xuICBwcml2YXRlIG9wZW5haTogT3BlbkFJIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgYW50aHJvcGljOiBBbnRocm9waWMgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBjYWNoZTogTWFwPHN0cmluZywgQ2FjaGVkUmVzcG9uc2U+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHJlYWRvbmx5IENBQ0hFX1RUTCA9IDM2MDAwMDA7IC8vIDEgaG91clxuICBwcml2YXRlIHRvdGFsVG9rZW5zVXNlZCA9IDA7XG4gIHByaXZhdGUgdG90YWxDb3N0ID0gMDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBJbml0aWFsaXplIGNsaWVudHMgaWYgQVBJIGtleXMgYXJlIGF2YWlsYWJsZVxuICAgIGlmIChwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSkge1xuICAgICAgdGhpcy5vcGVuYWkgPSBuZXcgT3BlbkFJKHtcbiAgICAgICAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChwcm9jZXNzLmVudi5BTlRIUk9QSUNfQVBJX0tFWSkge1xuICAgICAgdGhpcy5hbnRocm9waWMgPSBuZXcgQW50aHJvcGljKHtcbiAgICAgICAgYXBpS2V5OiBwcm9jZXNzLmVudi5BTlRIUk9QSUNfQVBJX0tFWSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlQ29kZShwcm9tcHQ6IHN0cmluZywgY29udGV4dDogQUlDb250ZXh0LCBtb2RlbD86IEFJTW9kZWwpOiBQcm9taXNlPEFJUmVzcG9uc2U+IHtcbiAgICAvLyBDaGVjayBjYWNoZSBmaXJzdFxuICAgIGNvbnN0IGNhY2hlS2V5ID0gdGhpcy5nZXRDYWNoZUtleShwcm9tcHQsIGNvbnRleHQpO1xuICAgIGNvbnN0IGNhY2hlZCA9IHRoaXMuZ2V0Q2FjaGVkUmVzcG9uc2UoY2FjaGVLZXkpO1xuICAgIGlmIChjYWNoZWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBjYWNoZWQgQUkgcmVzcG9uc2UnKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IGNhY2hlZC5yZXNwb25zZSxcbiAgICAgICAgbW9kZWw6IGNhY2hlZC5tb2RlbCxcbiAgICAgICAgdG9rZW5zVXNlZDogMCxcbiAgICAgICAgY29zdDogMCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gU2VsZWN0IG1vZGVsXG4gICAgY29uc3Qgc2VsZWN0ZWRNb2RlbCA9IG1vZGVsIHx8IHRoaXMuc2VsZWN0TW9kZWwoJ2NvZGUtZ2VuZXJhdGlvbicpO1xuXG4gICAgLy8gQnVpbGQgZnVsbCBwcm9tcHQgd2l0aCBjb250ZXh0XG4gICAgY29uc3QgZnVsbFByb21wdCA9IHRoaXMuYnVpbGRQcm9tcHQocHJvbXB0LCBjb250ZXh0KTtcblxuICAgIC8vIEdlbmVyYXRlIHJlc3BvbnNlXG4gICAgbGV0IHJlc3BvbnNlOiBBSVJlc3BvbnNlO1xuICAgIGlmIChzZWxlY3RlZE1vZGVsLnByb3ZpZGVyID09PSAnb3BlbmFpJykge1xuICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlV2l0aE9wZW5BSShmdWxsUHJvbXB0LCBzZWxlY3RlZE1vZGVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlV2l0aENsYXVkZShmdWxsUHJvbXB0LCBzZWxlY3RlZE1vZGVsKTtcbiAgICB9XG5cbiAgICAvLyBDYWNoZSByZXNwb25zZVxuICAgIHRoaXMuY2FjaGVSZXNwb25zZShjYWNoZUtleSwgcmVzcG9uc2UuY29udGVudCwgcmVzcG9uc2UubW9kZWwpO1xuXG4gICAgLy8gVHJhY2sgdXNhZ2VcbiAgICB0aGlzLnRvdGFsVG9rZW5zVXNlZCArPSByZXNwb25zZS50b2tlbnNVc2VkO1xuICAgIHRoaXMudG90YWxDb3N0ICs9IHJlc3BvbnNlLmNvc3Q7XG5cbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlV2l0aE9wZW5BSShwcm9tcHQ6IHN0cmluZywgbW9kZWw6IEFJTW9kZWwpOiBQcm9taXNlPEFJUmVzcG9uc2U+IHtcbiAgICBpZiAoIXRoaXMub3BlbmFpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBjbGllbnQgbm90IGluaXRpYWxpemVkLiBQbGVhc2Ugc2V0IE9QRU5BSV9BUElfS0VZLicpO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCB0aGlzLm9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogbW9kZWwubW9kZWwsXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgY29udGVudDogJ1lvdSBhcmUgYW4gZXhwZXJ0IHNvZnR3YXJlIGRldmVsb3BlciBhc3Npc3RhbnQuIEdlbmVyYXRlIGNsZWFuLCBwcm9kdWN0aW9uLXJlYWR5IGNvZGUgZm9sbG93aW5nIGJlc3QgcHJhY3RpY2VzLicsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgY29udGVudDogcHJvbXB0LFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIG1heF90b2tlbnM6IG1vZGVsLm1heFRva2VucyxcbiAgICAgIHRlbXBlcmF0dXJlOiBtb2RlbC50ZW1wZXJhdHVyZSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbnRlbnQgPSBjb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgJyc7XG4gICAgY29uc3QgdG9rZW5zVXNlZCA9IGNvbXBsZXRpb24udXNhZ2U/LnRvdGFsX3Rva2VucyB8fCAwO1xuICAgIGNvbnN0IGNvc3QgPSB0aGlzLmNhbGN1bGF0ZUNvc3QoJ29wZW5haScsIG1vZGVsLm1vZGVsLCB0b2tlbnNVc2VkKTtcblxuICAgIHJldHVybiB7XG4gICAgICBjb250ZW50LFxuICAgICAgbW9kZWw6IG1vZGVsLm1vZGVsLFxuICAgICAgdG9rZW5zVXNlZCxcbiAgICAgIGNvc3QsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVXaXRoQ2xhdWRlKHByb21wdDogc3RyaW5nLCBtb2RlbDogQUlNb2RlbCk6IFByb21pc2U8QUlSZXNwb25zZT4ge1xuICAgIGlmICghdGhpcy5hbnRocm9waWMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQW50aHJvcGljIGNsaWVudCBub3QgaW5pdGlhbGl6ZWQuIFBsZWFzZSBzZXQgQU5USFJPUElDX0FQSV9LRVkuJyk7XG4gICAgfVxuXG4gICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IHRoaXMuYW50aHJvcGljLm1lc3NhZ2VzLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogbW9kZWwubW9kZWwsXG4gICAgICBtYXhfdG9rZW5zOiBtb2RlbC5tYXhUb2tlbnMsXG4gICAgICB0ZW1wZXJhdHVyZTogbW9kZWwudGVtcGVyYXR1cmUsXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIGNvbnRlbnQ6IHByb21wdCxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBjb250ZW50ID0gbWVzc2FnZS5jb250ZW50WzBdPy50eXBlID09PSAndGV4dCcgPyBtZXNzYWdlLmNvbnRlbnRbMF0udGV4dCA6ICcnO1xuICAgIGNvbnN0IHRva2Vuc1VzZWQgPSBtZXNzYWdlLnVzYWdlLmlucHV0X3Rva2VucyArIG1lc3NhZ2UudXNhZ2Uub3V0cHV0X3Rva2VucztcbiAgICBjb25zdCBjb3N0ID0gdGhpcy5jYWxjdWxhdGVDb3N0KCdhbnRocm9waWMnLCBtb2RlbC5tb2RlbCwgdG9rZW5zVXNlZCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY29udGVudCxcbiAgICAgIG1vZGVsOiBtb2RlbC5tb2RlbCxcbiAgICAgIHRva2Vuc1VzZWQsXG4gICAgICBjb3N0LFxuICAgIH07XG4gIH1cblxuICBzZWxlY3RNb2RlbCh0YXNrVHlwZTogc3RyaW5nKTogQUlNb2RlbCB7XG4gICAgLy8gU2VsZWN0IGFwcHJvcHJpYXRlIG1vZGVsIGJhc2VkIG9uIHRhc2sgdHlwZVxuICAgIHN3aXRjaCAodGFza1R5cGUpIHtcbiAgICAgIGNhc2UgJ2NvZGUtZ2VuZXJhdGlvbic6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcHJvdmlkZXI6ICdvcGVuYWknLFxuICAgICAgICAgIG1vZGVsOiAnZ3B0LTQtdHVyYm8tcHJldmlldycsXG4gICAgICAgICAgbWF4VG9rZW5zOiA0MDk2LFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjIsXG4gICAgICAgIH07XG4gICAgICBjYXNlICdyZWZhY3RvcmluZyc6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcHJvdmlkZXI6ICdhbnRocm9waWMnLFxuICAgICAgICAgIG1vZGVsOiAnY2xhdWRlLTMtb3B1cy0yMDI0MDIyOScsXG4gICAgICAgICAgbWF4VG9rZW5zOiA0MDk2LFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjEsXG4gICAgICAgIH07XG4gICAgICBjYXNlICdleHBsYW5hdGlvbic6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcHJvdmlkZXI6ICdvcGVuYWknLFxuICAgICAgICAgIG1vZGVsOiAnZ3B0LTQtdHVyYm8tcHJldmlldycsXG4gICAgICAgICAgbWF4VG9rZW5zOiAyMDQ4LFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgIH07XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHByb3ZpZGVyOiAnb3BlbmFpJyxcbiAgICAgICAgICBtb2RlbDogJ2dwdC00LXR1cmJvLXByZXZpZXcnLFxuICAgICAgICAgIG1heFRva2VuczogNDA5NixcbiAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRQcm9tcHQodXNlclByb21wdDogc3RyaW5nLCBjb250ZXh0OiBBSUNvbnRleHQpOiBzdHJpbmcge1xuICAgIGxldCBwcm9tcHQgPSBgIyBUYXNrXFxuJHt1c2VyUHJvbXB0fVxcblxcbmA7XG5cbiAgICAvLyBBZGQgcHJvamVjdCBjb250ZXh0XG4gICAgaWYgKGNvbnRleHQucHJvamVjdEluZm8uZnJhbWV3b3Jrcy5sZW5ndGggPiAwKSB7XG4gICAgICBwcm9tcHQgKz0gYCMgUHJvamVjdCBGcmFtZXdvcmtzXFxuJHtjb250ZXh0LnByb2plY3RJbmZvLmZyYW1ld29ya3Muam9pbignLCAnKX1cXG5cXG5gO1xuICAgIH1cblxuICAgIC8vIEFkZCByZWxldmFudCBmaWxlc1xuICAgIGlmIChjb250ZXh0LmZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHByb21wdCArPSBgIyBSZWxldmFudCBGaWxlc1xcblxcbmA7XG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgY29udGV4dC5maWxlcykge1xuICAgICAgICBwcm9tcHQgKz0gYCMjICR7ZmlsZS5wYXRofVxcblxcYFxcYFxcYFxcbiR7ZmlsZS5jb250ZW50fVxcblxcYFxcYFxcYFxcblxcbmA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWRkIGNvbnZlbnRpb25zXG4gICAgaWYgKGNvbnRleHQucHJvamVjdEluZm8uY29udmVudGlvbnMpIHtcbiAgICAgIHByb21wdCArPSBgIyBQcm9qZWN0IENvbnZlbnRpb25zXFxuYDtcbiAgICAgIHByb21wdCArPSBgLSBQYWNrYWdlIE1hbmFnZXI6ICR7Y29udGV4dC5wcm9qZWN0SW5mby5jb252ZW50aW9ucy5wYWNrYWdlTWFuYWdlcn1cXG5gO1xuICAgICAgcHJvbXB0ICs9IGAtIFR5cGVTY3JpcHQ6ICR7Y29udGV4dC5wcm9qZWN0SW5mby5jb252ZW50aW9ucy50eXBlc2NyaXB0ID8gJ1llcycgOiAnTm8nfVxcbmA7XG4gICAgICBpZiAoY29udGV4dC5wcm9qZWN0SW5mby5jb252ZW50aW9ucy50ZXN0aW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcHJvbXB0ICs9IGAtIFRlc3Rpbmc6ICR7Y29udGV4dC5wcm9qZWN0SW5mby5jb252ZW50aW9ucy50ZXN0aW5nLmpvaW4oJywgJyl9XFxuYDtcbiAgICAgIH1cbiAgICAgIHByb21wdCArPSBgXFxuYDtcbiAgICB9XG5cbiAgICBwcm9tcHQgKz0gYCMgSW5zdHJ1Y3Rpb25zXFxuYDtcbiAgICBwcm9tcHQgKz0gYC0gR2VuZXJhdGUgY2xlYW4sIHByb2R1Y3Rpb24tcmVhZHkgY29kZVxcbmA7XG4gICAgcHJvbXB0ICs9IGAtIEZvbGxvdyB0aGUgcHJvamVjdCdzIGV4aXN0aW5nIHBhdHRlcm5zIGFuZCBjb252ZW50aW9uc1xcbmA7XG4gICAgcHJvbXB0ICs9IGAtIEluY2x1ZGUgcHJvcGVyIGVycm9yIGhhbmRsaW5nXFxuYDtcbiAgICBwcm9tcHQgKz0gYC0gQWRkIFR5cGVTY3JpcHQgdHlwZXMgd2hlcmUgYXBwbGljYWJsZVxcbmA7XG4gICAgcHJvbXB0ICs9IGAtIFdyaXRlIHNlbGYtZG9jdW1lbnRpbmcgY29kZSB3aXRoIGNsZWFyIHZhcmlhYmxlIG5hbWVzXFxuYDtcblxuICAgIHJldHVybiBwcm9tcHQ7XG4gIH1cblxuICBhc3luYyBlc3RpbWF0ZUNvc3QocHJvbXB0OiBzdHJpbmcsIGNvbnRleHQ6IEFJQ29udGV4dCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgY29uc3QgZnVsbFByb21wdCA9IHRoaXMuYnVpbGRQcm9tcHQocHJvbXB0LCBjb250ZXh0KTtcbiAgICBjb25zdCBlc3RpbWF0ZWRUb2tlbnMgPSBNYXRoLmNlaWwoZnVsbFByb21wdC5sZW5ndGggLyA0KTsgLy8gUm91Z2ggZXN0aW1hdGU6IDEgdG9rZW4g4omIIDQgY2hhcnNcbiAgICBjb25zdCBtb2RlbCA9IHRoaXMuc2VsZWN0TW9kZWwoJ2NvZGUtZ2VuZXJhdGlvbicpO1xuICAgIHJldHVybiB0aGlzLmNhbGN1bGF0ZUNvc3QobW9kZWwucHJvdmlkZXIsIG1vZGVsLm1vZGVsLCBlc3RpbWF0ZWRUb2tlbnMpO1xuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVDb3N0KHByb3ZpZGVyOiBzdHJpbmcsIG1vZGVsOiBzdHJpbmcsIHRva2VuczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAvLyBQcmljaW5nIHBlciAxTSB0b2tlbnMgKGFzIG9mIDIwMjQpXG4gICAgY29uc3QgcHJpY2luZzogUmVjb3JkPHN0cmluZywgeyBpbnB1dDogbnVtYmVyOyBvdXRwdXQ6IG51bWJlciB9PiA9IHtcbiAgICAgICdncHQtNC10dXJiby1wcmV2aWV3JzogeyBpbnB1dDogMTAsIG91dHB1dDogMzAgfSxcbiAgICAgICdncHQtNCc6IHsgaW5wdXQ6IDMwLCBvdXRwdXQ6IDYwIH0sXG4gICAgICAnZ3B0LTMuNS10dXJibyc6IHsgaW5wdXQ6IDAuNSwgb3V0cHV0OiAxLjUgfSxcbiAgICAgICdjbGF1ZGUtMy1vcHVzLTIwMjQwMjI5JzogeyBpbnB1dDogMTUsIG91dHB1dDogNzUgfSxcbiAgICAgICdjbGF1ZGUtMy1zb25uZXQtMjAyNDAyMjknOiB7IGlucHV0OiAzLCBvdXRwdXQ6IDE1IH0sXG4gICAgfTtcblxuICAgIGNvbnN0IG1vZGVsUHJpY2luZyA9IHByaWNpbmdbbW9kZWxdIHx8IHsgaW5wdXQ6IDEwLCBvdXRwdXQ6IDMwIH07XG4gICAgLy8gQXNzdW1lIDUwLzUwIHNwbGl0IGJldHdlZW4gaW5wdXQgYW5kIG91dHB1dCB0b2tlbnNcbiAgICBjb25zdCBpbnB1dFRva2VucyA9IHRva2VucyAqIDAuNTtcbiAgICBjb25zdCBvdXRwdXRUb2tlbnMgPSB0b2tlbnMgKiAwLjU7XG4gICAgXG4gICAgcmV0dXJuIChpbnB1dFRva2VucyAqIG1vZGVsUHJpY2luZy5pbnB1dCArIG91dHB1dFRva2VucyAqIG1vZGVsUHJpY2luZy5vdXRwdXQpIC8gMTAwMDAwMDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q2FjaGVLZXkocHJvbXB0OiBzdHJpbmcsIGNvbnRleHQ6IEFJQ29udGV4dCk6IHN0cmluZyB7XG4gICAgY29uc3QgY29udGV4dFN0ciA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIHByb21wdCxcbiAgICAgIGZpbGVzOiBjb250ZXh0LmZpbGVzLm1hcChmID0+IGYucGF0aCksXG4gICAgICBmcmFtZXdvcmtzOiBjb250ZXh0LnByb2plY3RJbmZvLmZyYW1ld29ya3MsXG4gICAgfSk7XG4gICAgXG4gICAgLy8gU2ltcGxlIGhhc2ggZnVuY3Rpb25cbiAgICBsZXQgaGFzaCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250ZXh0U3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBjaGFyID0gY29udGV4dFN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgaGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpICsgY2hhcjtcbiAgICAgIGhhc2ggPSBoYXNoICYgaGFzaDtcbiAgICB9XG4gICAgcmV0dXJuIGhhc2gudG9TdHJpbmcoMzYpO1xuICB9XG5cbiAgZ2V0Q2FjaGVkUmVzcG9uc2Uoa2V5OiBzdHJpbmcpOiBDYWNoZWRSZXNwb25zZSB8IG51bGwge1xuICAgIGNvbnN0IGNhY2hlZCA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XG4gICAgaWYgKCFjYWNoZWQpIHJldHVybiBudWxsO1xuXG4gICAgLy8gQ2hlY2sgaWYgY2FjaGUgaXMgc3RpbGwgdmFsaWRcbiAgICBpZiAoRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAgPiB0aGlzLkNBQ0hFX1RUTCkge1xuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBjYWNoZWQ7XG4gIH1cblxuICBjYWNoZVJlc3BvbnNlKGtleTogc3RyaW5nLCByZXNwb25zZTogc3RyaW5nLCBtb2RlbDogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5jYWNoZS5zZXQoa2V5LCB7XG4gICAgICBwcm9tcHQ6IGtleSxcbiAgICAgIHJlc3BvbnNlLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgbW9kZWwsXG4gICAgfSk7XG5cbiAgICAvLyBMaW1pdCBjYWNoZSBzaXplXG4gICAgaWYgKHRoaXMuY2FjaGUuc2l6ZSA+IDEwMCkge1xuICAgICAgY29uc3QgZmlyc3RLZXkgPSB0aGlzLmNhY2hlLmtleXMoKS5uZXh0KCkudmFsdWU7XG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShmaXJzdEtleSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0VXNhZ2VTdGF0cygpOiB7IHRvdGFsVG9rZW5zOiBudW1iZXI7IHRvdGFsQ29zdDogbnVtYmVyOyBjYWNoZVNpemU6IG51bWJlciB9IHtcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxUb2tlbnM6IHRoaXMudG90YWxUb2tlbnNVc2VkLFxuICAgICAgdG90YWxDb3N0OiB0aGlzLnRvdGFsQ29zdCxcbiAgICAgIGNhY2hlU2l6ZTogdGhpcy5jYWNoZS5zaXplLFxuICAgIH07XG4gIH1cblxuICBjbGVhckNhY2hlKCk6IHZvaWQge1xuICAgIHRoaXMuY2FjaGUuY2xlYXIoKTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxJQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFBMEMsU0FBQUQsdUJBQUFHLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFnQ25DLE1BQU1HLGNB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