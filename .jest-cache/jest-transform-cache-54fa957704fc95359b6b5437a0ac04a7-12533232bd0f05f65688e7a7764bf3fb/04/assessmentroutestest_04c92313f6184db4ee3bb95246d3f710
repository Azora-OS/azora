ebfe0a92e17e3fc33aff643d6a68e1c3
"use strict";

_getJestObj().mock('../../services/assessment.service');
var _supertest = _interopRequireDefault(require("supertest"));
var _express = _interopRequireDefault(require("express"));
var _assessment = _interopRequireDefault(require("../assessment.routes"));
var _assessment2 = require("../../services/assessment.service");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
const app = (0, _express.default)();
app.use(_express.default.json());
app.use('/api/v1/assessments', _assessment.default);
describe('Assessment Routes', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });
  describe('POST /api/v1/assessments/:id/submit', () => {
    it('should submit an assessment and return score', async () => {
      const submissionData = {
        enrollmentId: 'enrollment-1',
        answers: ['answer1', 'answer2', 'answer3'],
        timeSpent: 1200
      };
      const mockResult = {
        score: 100,
        passed: true,
        feedback: 'Congratulations! You passed with a score of 100%.',
        outcome: {
          id: 'outcome-1',
          enrollmentId: 'enrollment-1',
          courseId: 'course-1',
          moduleId: 'module-1',
          assessmentScore: 100,
          timeSpent: 1200,
          conceptMastery: 100,
          completedAt: new Date()
        }
      };
      _assessment2.assessmentService.submitAssessment.mockResolvedValue(mockResult);
      const response = await (0, _supertest.default)(app).post('/api/v1/assessments/assessment-1/submit').send(submissionData);
      expect(response.status).toBe(201);
      expect(response.body.success).toBe(true);
      expect(response.body.data.score).toBe(100);
      expect(response.body.data.passed).toBe(true);
    });
    it('should handle failed assessment submission', async () => {
      const submissionData = {
        enrollmentId: 'enrollment-1',
        answers: ['answer1'],
        timeSpent: 600
      };
      const mockResult = {
        score: 50,
        passed: false,
        feedback: 'You scored 50%. You need 70% to pass. Try again!',
        outcome: {
          id: 'outcome-1',
          enrollmentId: 'enrollment-1',
          courseId: 'course-1',
          moduleId: 'module-1',
          assessmentScore: 50,
          timeSpent: 600,
          conceptMastery: 50,
          completedAt: new Date()
        }
      };
      _assessment2.assessmentService.submitAssessment.mockResolvedValue(mockResult);
      const response = await (0, _supertest.default)(app).post('/api/v1/assessments/assessment-1/submit').send(submissionData);
      expect(response.status).toBe(201);
      expect(response.body.success).toBe(true);
      expect(response.body.data.score).toBe(50);
      expect(response.body.data.passed).toBe(false);
    });
    it('should handle validation errors', async () => {
      _assessment2.assessmentService.submitAssessment.mockRejectedValue(new Error('Validation error: enrollmentId is required'));
      const response = await (0, _supertest.default)(app).post('/api/v1/assessments/assessment-1/submit').send({
        answers: ['answer1']
      });
      expect(response.status).toBe(500);
    });
  });
  describe('GET /api/v1/assessments/:id/results', () => {
    it('should get assessment results', async () => {
      const mockResults = {
        assessment: {
          id: 'assessment-1',
          courseId: 'course-1',
          moduleId: 'module-1',
          title: 'Quiz 1',
          questions: ['Q1', 'Q2', 'Q3'],
          passingScore: 70
        },
        submissions: [{
          id: 'outcome-1',
          assessmentScore: 100,
          timeSpent: 1200
        }, {
          id: 'outcome-2',
          assessmentScore: 85,
          timeSpent: 1500
        }],
        averageScore: 92.5,
        passRate: 100
      };
      _assessment2.assessmentService.getAssessmentResults.mockResolvedValue(mockResults);
      const response = await (0, _supertest.default)(app).get('/api/v1/assessments/assessment-1/results');
      expect(response.status).toBe(200);
      expect(response.body.success).toBe(true);
      expect(response.body.data.averageScore).toBe(92.5);
      expect(response.body.data.passRate).toBe(100);
    });
    it('should handle assessment not found', async () => {
      _assessment2.assessmentService.getAssessmentResults.mockRejectedValue(new Error('Assessment not found'));
      const response = await (0, _supertest.default)(app).get('/api/v1/assessments/non-existent/results');
      expect(response.status).toBe(500);
    });
  });
  describe('GET /api/v1/assessments/student/:studentId/history', () => {
    it('should get student assessment history', async () => {
      const mockHistory = {
        assessments: [{
          id: 'outcome-1',
          enrollmentId: 'enrollment-1',
          courseId: 'course-1',
          moduleId: 'module-1',
          assessmentScore: 100,
          timeSpent: 1200,
          conceptMastery: 100,
          completedAt: new Date()
        }, {
          id: 'outcome-2',
          enrollmentId: 'enrollment-2',
          courseId: 'course-2',
          moduleId: 'module-2',
          assessmentScore: 85,
          timeSpent: 1500,
          conceptMastery: 85,
          completedAt: new Date()
        }],
        totalAttempts: 2,
        averageScore: 92.5,
        passedCount: 2
      };
      _assessment2.assessmentService.getStudentAssessmentHistory.mockResolvedValue(mockHistory);
      const response = await (0, _supertest.default)(app).get('/api/v1/assessments/student/student-1/history');
      expect(response.status).toBe(200);
      expect(response.body.success).toBe(true);
      expect(response.body.data.totalAttempts).toBe(2);
      expect(response.body.data.averageScore).toBe(92.5);
      expect(response.body.data.passedCount).toBe(2);
    });
    it('should return empty history for new student', async () => {
      const mockHistory = {
        assessments: [],
        totalAttempts: 0,
        averageScore: 0,
        passedCount: 0
      };
      _assessment2.assessmentService.getStudentAssessmentHistory.mockResolvedValue(mockHistory);
      const response = await (0, _supertest.default)(app).get('/api/v1/assessments/student/new-student/history');
      expect(response.status).toBe(200);
      expect(response.body.success).toBe(true);
      expect(response.body.data.totalAttempts).toBe(0);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJfc3VwZXJ0ZXN0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfZXhwcmVzcyIsIl9hc3Nlc3NtZW50IiwiX2Fzc2Vzc21lbnQyIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiamVzdCIsImFwcCIsImV4cHJlc3MiLCJ1c2UiLCJqc29uIiwiYXNzZXNzbWVudFJvdXRlcyIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsInN1Ym1pc3Npb25EYXRhIiwiZW5yb2xsbWVudElkIiwiYW5zd2VycyIsInRpbWVTcGVudCIsIm1vY2tSZXN1bHQiLCJzY29yZSIsInBhc3NlZCIsImZlZWRiYWNrIiwib3V0Y29tZSIsImlkIiwiY291cnNlSWQiLCJtb2R1bGVJZCIsImFzc2Vzc21lbnRTY29yZSIsImNvbmNlcHRNYXN0ZXJ5IiwiY29tcGxldGVkQXQiLCJEYXRlIiwiYXNzZXNzbWVudFNlcnZpY2UiLCJzdWJtaXRBc3Nlc3NtZW50IiwibW9ja1Jlc29sdmVkVmFsdWUiLCJyZXNwb25zZSIsInJlcXVlc3QiLCJwb3N0Iiwic2VuZCIsImV4cGVjdCIsInN0YXR1cyIsInRvQmUiLCJib2R5Iiwic3VjY2VzcyIsImRhdGEiLCJtb2NrUmVqZWN0ZWRWYWx1ZSIsIkVycm9yIiwibW9ja1Jlc3VsdHMiLCJhc3Nlc3NtZW50IiwidGl0bGUiLCJxdWVzdGlvbnMiLCJwYXNzaW5nU2NvcmUiLCJzdWJtaXNzaW9ucyIsImF2ZXJhZ2VTY29yZSIsInBhc3NSYXRlIiwiZ2V0QXNzZXNzbWVudFJlc3VsdHMiLCJnZXQiLCJtb2NrSGlzdG9yeSIsImFzc2Vzc21lbnRzIiwidG90YWxBdHRlbXB0cyIsInBhc3NlZENvdW50IiwiZ2V0U3R1ZGVudEFzc2Vzc21lbnRIaXN0b3J5Il0sInNvdXJjZXMiOlsiYXNzZXNzbWVudC5yb3V0ZXMudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcmVxdWVzdCBmcm9tICdzdXBlcnRlc3QnO1xyXG5pbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcclxuaW1wb3J0IGFzc2Vzc21lbnRSb3V0ZXMgZnJvbSAnLi4vYXNzZXNzbWVudC5yb3V0ZXMnO1xyXG5pbXBvcnQgeyBhc3Nlc3NtZW50U2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2Fzc2Vzc21lbnQuc2VydmljZSc7XHJcblxyXG5qZXN0Lm1vY2soJy4uLy4uL3NlcnZpY2VzL2Fzc2Vzc21lbnQuc2VydmljZScpO1xyXG5cclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5hcHAudXNlKGV4cHJlc3MuanNvbigpKTtcclxuYXBwLnVzZSgnL2FwaS92MS9hc3Nlc3NtZW50cycsIGFzc2Vzc21lbnRSb3V0ZXMpO1xyXG5cclxuZGVzY3JpYmUoJ0Fzc2Vzc21lbnQgUm91dGVzJywgKCkgPT4ge1xyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdQT1NUIC9hcGkvdjEvYXNzZXNzbWVudHMvOmlkL3N1Ym1pdCcsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgc3VibWl0IGFuIGFzc2Vzc21lbnQgYW5kIHJldHVybiBzY29yZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3Qgc3VibWlzc2lvbkRhdGEgPSB7XHJcbiAgICAgICAgZW5yb2xsbWVudElkOiAnZW5yb2xsbWVudC0xJyxcclxuICAgICAgICBhbnN3ZXJzOiBbJ2Fuc3dlcjEnLCAnYW5zd2VyMicsICdhbnN3ZXIzJ10sXHJcbiAgICAgICAgdGltZVNwZW50OiAxMjAwLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgbW9ja1Jlc3VsdCA9IHtcclxuICAgICAgICBzY29yZTogMTAwLFxyXG4gICAgICAgIHBhc3NlZDogdHJ1ZSxcclxuICAgICAgICBmZWVkYmFjazogJ0NvbmdyYXR1bGF0aW9ucyEgWW91IHBhc3NlZCB3aXRoIGEgc2NvcmUgb2YgMTAwJS4nLFxyXG4gICAgICAgIG91dGNvbWU6IHtcclxuICAgICAgICAgIGlkOiAnb3V0Y29tZS0xJyxcclxuICAgICAgICAgIGVucm9sbG1lbnRJZDogJ2Vucm9sbG1lbnQtMScsXHJcbiAgICAgICAgICBjb3Vyc2VJZDogJ2NvdXJzZS0xJyxcclxuICAgICAgICAgIG1vZHVsZUlkOiAnbW9kdWxlLTEnLFxyXG4gICAgICAgICAgYXNzZXNzbWVudFNjb3JlOiAxMDAsXHJcbiAgICAgICAgICB0aW1lU3BlbnQ6IDEyMDAsXHJcbiAgICAgICAgICBjb25jZXB0TWFzdGVyeTogMTAwLFxyXG4gICAgICAgICAgY29tcGxldGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgfSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIChhc3Nlc3NtZW50U2VydmljZS5zdWJtaXRBc3Nlc3NtZW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jlc3VsdCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxyXG4gICAgICAgIC5wb3N0KCcvYXBpL3YxL2Fzc2Vzc21lbnRzL2Fzc2Vzc21lbnQtMS9zdWJtaXQnKVxyXG4gICAgICAgIC5zZW5kKHN1Ym1pc3Npb25EYXRhKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAxKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YS5zY29yZSkudG9CZSgxMDApO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLnBhc3NlZCkudG9CZSh0cnVlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGZhaWxlZCBhc3Nlc3NtZW50IHN1Ym1pc3Npb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHN1Ym1pc3Npb25EYXRhID0ge1xyXG4gICAgICAgIGVucm9sbG1lbnRJZDogJ2Vucm9sbG1lbnQtMScsXHJcbiAgICAgICAgYW5zd2VyczogWydhbnN3ZXIxJ10sXHJcbiAgICAgICAgdGltZVNwZW50OiA2MDAsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBtb2NrUmVzdWx0ID0ge1xyXG4gICAgICAgIHNjb3JlOiA1MCxcclxuICAgICAgICBwYXNzZWQ6IGZhbHNlLFxyXG4gICAgICAgIGZlZWRiYWNrOiAnWW91IHNjb3JlZCA1MCUuIFlvdSBuZWVkIDcwJSB0byBwYXNzLiBUcnkgYWdhaW4hJyxcclxuICAgICAgICBvdXRjb21lOiB7XHJcbiAgICAgICAgICBpZDogJ291dGNvbWUtMScsXHJcbiAgICAgICAgICBlbnJvbGxtZW50SWQ6ICdlbnJvbGxtZW50LTEnLFxyXG4gICAgICAgICAgY291cnNlSWQ6ICdjb3Vyc2UtMScsXHJcbiAgICAgICAgICBtb2R1bGVJZDogJ21vZHVsZS0xJyxcclxuICAgICAgICAgIGFzc2Vzc21lbnRTY29yZTogNTAsXHJcbiAgICAgICAgICB0aW1lU3BlbnQ6IDYwMCxcclxuICAgICAgICAgIGNvbmNlcHRNYXN0ZXJ5OiA1MCxcclxuICAgICAgICAgIGNvbXBsZXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAoYXNzZXNzbWVudFNlcnZpY2Uuc3VibWl0QXNzZXNzbWVudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcclxuICAgICAgICAucG9zdCgnL2FwaS92MS9hc3Nlc3NtZW50cy9hc3Nlc3NtZW50LTEvc3VibWl0JylcclxuICAgICAgICAuc2VuZChzdWJtaXNzaW9uRGF0YSk7XHJcblxyXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMSk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEuc2NvcmUpLnRvQmUoNTApO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLnBhc3NlZCkudG9CZShmYWxzZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB2YWxpZGF0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcclxuICAgICAgKGFzc2Vzc21lbnRTZXJ2aWNlLnN1Ym1pdEFzc2Vzc21lbnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShcclxuICAgICAgICBuZXcgRXJyb3IoJ1ZhbGlkYXRpb24gZXJyb3I6IGVucm9sbG1lbnRJZCBpcyByZXF1aXJlZCcpXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxyXG4gICAgICAgIC5wb3N0KCcvYXBpL3YxL2Fzc2Vzc21lbnRzL2Fzc2Vzc21lbnQtMS9zdWJtaXQnKVxyXG4gICAgICAgIC5zZW5kKHsgYW5zd2VyczogWydhbnN3ZXIxJ10gfSk7XHJcblxyXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDUwMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0dFVCAvYXBpL3YxL2Fzc2Vzc21lbnRzLzppZC9yZXN1bHRzJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBnZXQgYXNzZXNzbWVudCByZXN1bHRzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrUmVzdWx0cyA9IHtcclxuICAgICAgICBhc3Nlc3NtZW50OiB7XHJcbiAgICAgICAgICBpZDogJ2Fzc2Vzc21lbnQtMScsXHJcbiAgICAgICAgICBjb3Vyc2VJZDogJ2NvdXJzZS0xJyxcclxuICAgICAgICAgIG1vZHVsZUlkOiAnbW9kdWxlLTEnLFxyXG4gICAgICAgICAgdGl0bGU6ICdRdWl6IDEnLFxyXG4gICAgICAgICAgcXVlc3Rpb25zOiBbJ1ExJywgJ1EyJywgJ1EzJ10sXHJcbiAgICAgICAgICBwYXNzaW5nU2NvcmU6IDcwLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3VibWlzc2lvbnM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaWQ6ICdvdXRjb21lLTEnLFxyXG4gICAgICAgICAgICBhc3Nlc3NtZW50U2NvcmU6IDEwMCxcclxuICAgICAgICAgICAgdGltZVNwZW50OiAxMjAwLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaWQ6ICdvdXRjb21lLTInLFxyXG4gICAgICAgICAgICBhc3Nlc3NtZW50U2NvcmU6IDg1LFxyXG4gICAgICAgICAgICB0aW1lU3BlbnQ6IDE1MDAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgYXZlcmFnZVNjb3JlOiA5Mi41LFxyXG4gICAgICAgIHBhc3NSYXRlOiAxMDAsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAoYXNzZXNzbWVudFNlcnZpY2UuZ2V0QXNzZXNzbWVudFJlc3VsdHMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0cyk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKS5nZXQoJy9hcGkvdjEvYXNzZXNzbWVudHMvYXNzZXNzbWVudC0xL3Jlc3VsdHMnKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YS5hdmVyYWdlU2NvcmUpLnRvQmUoOTIuNSk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEucGFzc1JhdGUpLnRvQmUoMTAwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGFzc2Vzc21lbnQgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAoYXNzZXNzbWVudFNlcnZpY2UuZ2V0QXNzZXNzbWVudFJlc3VsdHMgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShcclxuICAgICAgICBuZXcgRXJyb3IoJ0Fzc2Vzc21lbnQgbm90IGZvdW5kJylcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApLmdldCgnL2FwaS92MS9hc3Nlc3NtZW50cy9ub24tZXhpc3RlbnQvcmVzdWx0cycpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg1MDApO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdHRVQgL2FwaS92MS9hc3Nlc3NtZW50cy9zdHVkZW50LzpzdHVkZW50SWQvaGlzdG9yeScsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgZ2V0IHN0dWRlbnQgYXNzZXNzbWVudCBoaXN0b3J5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrSGlzdG9yeSA9IHtcclxuICAgICAgICBhc3Nlc3NtZW50czogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBpZDogJ291dGNvbWUtMScsXHJcbiAgICAgICAgICAgIGVucm9sbG1lbnRJZDogJ2Vucm9sbG1lbnQtMScsXHJcbiAgICAgICAgICAgIGNvdXJzZUlkOiAnY291cnNlLTEnLFxyXG4gICAgICAgICAgICBtb2R1bGVJZDogJ21vZHVsZS0xJyxcclxuICAgICAgICAgICAgYXNzZXNzbWVudFNjb3JlOiAxMDAsXHJcbiAgICAgICAgICAgIHRpbWVTcGVudDogMTIwMCxcclxuICAgICAgICAgICAgY29uY2VwdE1hc3Rlcnk6IDEwMCxcclxuICAgICAgICAgICAgY29tcGxldGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBpZDogJ291dGNvbWUtMicsXHJcbiAgICAgICAgICAgIGVucm9sbG1lbnRJZDogJ2Vucm9sbG1lbnQtMicsXHJcbiAgICAgICAgICAgIGNvdXJzZUlkOiAnY291cnNlLTInLFxyXG4gICAgICAgICAgICBtb2R1bGVJZDogJ21vZHVsZS0yJyxcclxuICAgICAgICAgICAgYXNzZXNzbWVudFNjb3JlOiA4NSxcclxuICAgICAgICAgICAgdGltZVNwZW50OiAxNTAwLFxyXG4gICAgICAgICAgICBjb25jZXB0TWFzdGVyeTogODUsXHJcbiAgICAgICAgICAgIGNvbXBsZXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICBdLFxyXG4gICAgICAgIHRvdGFsQXR0ZW1wdHM6IDIsXHJcbiAgICAgICAgYXZlcmFnZVNjb3JlOiA5Mi41LFxyXG4gICAgICAgIHBhc3NlZENvdW50OiAyLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgKGFzc2Vzc21lbnRTZXJ2aWNlLmdldFN0dWRlbnRBc3Nlc3NtZW50SGlzdG9yeSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tIaXN0b3J5KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApLmdldCgnL2FwaS92MS9hc3Nlc3NtZW50cy9zdHVkZW50L3N0dWRlbnQtMS9oaXN0b3J5Jyk7XHJcblxyXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEudG90YWxBdHRlbXB0cykudG9CZSgyKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YS5hdmVyYWdlU2NvcmUpLnRvQmUoOTIuNSk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEucGFzc2VkQ291bnQpLnRvQmUoMik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBoaXN0b3J5IGZvciBuZXcgc3R1ZGVudCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgbW9ja0hpc3RvcnkgPSB7XHJcbiAgICAgICAgYXNzZXNzbWVudHM6IFtdLFxyXG4gICAgICAgIHRvdGFsQXR0ZW1wdHM6IDAsXHJcbiAgICAgICAgYXZlcmFnZVNjb3JlOiAwLFxyXG4gICAgICAgIHBhc3NlZENvdW50OiAwLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgKGFzc2Vzc21lbnRTZXJ2aWNlLmdldFN0dWRlbnRBc3Nlc3NtZW50SGlzdG9yeSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tIaXN0b3J5KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApLmdldCgnL2FwaS92MS9hc3Nlc3NtZW50cy9zdHVkZW50L25ldy1zdHVkZW50L2hpc3RvcnknKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YS50b3RhbEF0dGVtcHRzKS50b0JlKDApO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwibWFwcGluZ3MiOiI7O0FBS0FBLFdBQUEsR0FBS0MsSUFBSSxDQUFDLG1DQUFtQyxDQUFDO0FBTDlDLElBQUFDLFVBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFdBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLFlBQUEsR0FBQUgsT0FBQTtBQUFzRSxTQUFBRCx1QkFBQUssQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUFBLFNBQUFSLFlBQUE7RUFBQTtJQUFBVztFQUFBLElBQUFQLE9BQUE7RUFBQUosV0FBQSxHQUFBQSxDQUFBLEtBQUFXLElBQUE7RUFBQSxPQUFBQSxJQUFBO0FBQUE7QUFJdEUsTUFBTUMsR0FBRyxHQUFHLElBQUFDLGdCQUFPLEVBQUMsQ0FBQztBQUNyQkQsR0FBRyxDQUFDRSxHQUFHLENBQUNELGdCQUFPLENBQUNFLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDdkJILEdBQUcsQ0FBQ0UsR0FBRyxDQUFDLHFCQUFxQixFQUFFRSxtQkFBZ0IsQ0FBQztBQUVoREMsUUFBUSxDQUFDLG1CQUFtQixFQUFFLE1BQU07RUFDbENDLFVBQVUsQ0FBQyxNQUFNO0lBQ2ZQLElBQUksQ0FBQ1EsYUFBYSxDQUFDLENBQUM7RUFDdEIsQ0FBQyxDQUFDO0VBRUZGLFFBQVEsQ0FBQyxxQ0FBcUMsRUFBRSxNQUFNO0lBQ3BERyxFQUFFLENBQUMsOENBQThDLEVBQUUsWUFBWTtNQUM3RCxNQUFNQyxjQUFjLEdBQUc7UUFDckJDLFlBQVksRUFBRSxjQUFjO1FBQzVCQyxPQUFPLEVBQUUsQ0FBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsQ0FBQztRQUMxQ0MsU0FBUyxFQUFFO01BQ2IsQ0FBQztNQUVELE1BQU1DLFVBQVUsR0FBRztRQUNqQkMsS0FBSyxFQUFFLEdBQUc7UUFDVkMsTUFBTSxFQUFFLElBQUk7UUFDWkMsUUFBUSxFQUFFLG1EQUFtRDtRQUM3REMsT0FBTyxFQUFFO1VBQ1BDLEVBQUUsRUFBRSxXQUFXO1VBQ2ZSLFlBQVksRUFBRSxjQUFjO1VBQzVCUyxRQUFRLEVBQUUsVUFBVTtVQUNwQkMsUUFBUSxFQUFFLFVBQVU7VUFDcEJDLGVBQWUsRUFBRSxHQUFHO1VBQ3BCVCxTQUFTLEVBQUUsSUFBSTtVQUNmVSxjQUFjLEVBQUUsR0FBRztVQUNuQkMsV0FBVyxFQUFFLElBQUlDLElBQUksQ0FBQztRQUN4QjtNQUNGLENBQUM7TUFFQUMsOEJBQWlCLENBQUNDLGdCQUFnQixDQUFlQyxpQkFBaUIsQ0FBQ2QsVUFBVSxDQUFDO01BRS9FLE1BQU1lLFFBQVEsR0FBRyxNQUFNLElBQUFDLGtCQUFPLEVBQUM3QixHQUFHLENBQUMsQ0FDaEM4QixJQUFJLENBQUMseUNBQXlDLENBQUMsQ0FDL0NDLElBQUksQ0FBQ3RCLGNBQWMsQ0FBQztNQUV2QnVCLE1BQU0sQ0FBQ0osUUFBUSxDQUFDSyxNQUFNLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEdBQUcsQ0FBQztNQUNqQ0YsTUFBTSxDQUFDSixRQUFRLENBQUNPLElBQUksQ0FBQ0MsT0FBTyxDQUFDLENBQUNGLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDeENGLE1BQU0sQ0FBQ0osUUFBUSxDQUFDTyxJQUFJLENBQUNFLElBQUksQ0FBQ3ZCLEtBQUssQ0FBQyxDQUFDb0IsSUFBSSxDQUFDLEdBQUcsQ0FBQztNQUMxQ0YsTUFBTSxDQUFDSixRQUFRLENBQUNPLElBQUksQ0FBQ0UsSUFBSSxDQUFDdEIsTUFBTSxDQUFDLENBQUNtQixJQUFJLENBQUMsSUFBSSxDQUFDO0lBQzlDLENBQUMsQ0FBQztJQUVGMUIsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLFlBQVk7TUFDM0QsTUFBTUMsY0FBYyxHQUFHO1FBQ3JCQyxZQUFZLEVBQUUsY0FBYztRQUM1QkMsT0FBTyxFQUFFLENBQUMsU0FBUyxDQUFDO1FBQ3BCQyxTQUFTLEVBQUU7TUFDYixDQUFDO01BRUQsTUFBTUMsVUFBVSxHQUFHO1FBQ2pCQyxLQUFLLEVBQUUsRUFBRTtRQUNUQyxNQUFNLEVBQUUsS0FBSztRQUNiQyxRQUFRLEVBQUUsa0RBQWtEO1FBQzVEQyxPQUFPLEVBQUU7VUFDUEMsRUFBRSxFQUFFLFdBQVc7VUFDZlIsWUFBWSxFQUFFLGNBQWM7VUFDNUJTLFFBQVEsRUFBRSxVQUFVO1VBQ3BCQyxRQUFRLEVBQUUsVUFBVTtVQUNwQkMsZUFBZSxFQUFFLEVBQUU7VUFDbkJULFNBQVMsRUFBRSxHQUFHO1VBQ2RVLGNBQWMsRUFBRSxFQUFFO1VBQ2xCQyxXQUFXLEVBQUUsSUFBSUMsSUFBSSxDQUFDO1FBQ3hCO01BQ0YsQ0FBQztNQUVBQyw4QkFBaUIsQ0FBQ0MsZ0JBQWdCLENBQWVDLGlCQUFpQixDQUFDZCxVQUFVLENBQUM7TUFFL0UsTUFBTWUsUUFBUSxHQUFHLE1BQU0sSUFBQUMsa0JBQU8sRUFBQzdCLEdBQUcsQ0FBQyxDQUNoQzhCLElBQUksQ0FBQyx5Q0FBeUMsQ0FBQyxDQUMvQ0MsSUFBSSxDQUFDdEIsY0FBYyxDQUFDO01BRXZCdUIsTUFBTSxDQUFDSixRQUFRLENBQUNLLE1BQU0sQ0FBQyxDQUFDQyxJQUFJLENBQUMsR0FBRyxDQUFDO01BQ2pDRixNQUFNLENBQUNKLFFBQVEsQ0FBQ08sSUFBSSxDQUFDQyxPQUFPLENBQUMsQ0FBQ0YsSUFBSSxDQUFDLElBQUksQ0FBQztNQUN4Q0YsTUFBTSxDQUFDSixRQUFRLENBQUNPLElBQUksQ0FBQ0UsSUFBSSxDQUFDdkIsS0FBSyxDQUFDLENBQUNvQixJQUFJLENBQUMsRUFBRSxDQUFDO01BQ3pDRixNQUFNLENBQUNKLFFBQVEsQ0FBQ08sSUFBSSxDQUFDRSxJQUFJLENBQUN0QixNQUFNLENBQUMsQ0FBQ21CLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDL0MsQ0FBQyxDQUFDO0lBRUYxQixFQUFFLENBQUMsaUNBQWlDLEVBQUUsWUFBWTtNQUMvQ2lCLDhCQUFpQixDQUFDQyxnQkFBZ0IsQ0FBZVksaUJBQWlCLENBQ2pFLElBQUlDLEtBQUssQ0FBQyw0Q0FBNEMsQ0FDeEQsQ0FBQztNQUVELE1BQU1YLFFBQVEsR0FBRyxNQUFNLElBQUFDLGtCQUFPLEVBQUM3QixHQUFHLENBQUMsQ0FDaEM4QixJQUFJLENBQUMseUNBQXlDLENBQUMsQ0FDL0NDLElBQUksQ0FBQztRQUFFcEIsT0FBTyxFQUFFLENBQUMsU0FBUztNQUFFLENBQUMsQ0FBQztNQUVqQ3FCLE1BQU0sQ0FBQ0osUUFBUSxDQUFDSyxNQUFNLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEdBQUcsQ0FBQztJQUNuQyxDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7RUFFRjdCLFFBQVEsQ0FBQyxxQ0FBcUMsRUFBRSxNQUFNO0lBQ3BERyxFQUFFLENBQUMsK0JBQStCLEVBQUUsWUFBWTtNQUM5QyxNQUFNZ0MsV0FBVyxHQUFHO1FBQ2xCQyxVQUFVLEVBQUU7VUFDVnZCLEVBQUUsRUFBRSxjQUFjO1VBQ2xCQyxRQUFRLEVBQUUsVUFBVTtVQUNwQkMsUUFBUSxFQUFFLFVBQVU7VUFDcEJzQixLQUFLLEVBQUUsUUFBUTtVQUNmQyxTQUFTLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztVQUM3QkMsWUFBWSxFQUFFO1FBQ2hCLENBQUM7UUFDREMsV0FBVyxFQUFFLENBQ1g7VUFDRTNCLEVBQUUsRUFBRSxXQUFXO1VBQ2ZHLGVBQWUsRUFBRSxHQUFHO1VBQ3BCVCxTQUFTLEVBQUU7UUFDYixDQUFDLEVBQ0Q7VUFDRU0sRUFBRSxFQUFFLFdBQVc7VUFDZkcsZUFBZSxFQUFFLEVBQUU7VUFDbkJULFNBQVMsRUFBRTtRQUNiLENBQUMsQ0FDRjtRQUNEa0MsWUFBWSxFQUFFLElBQUk7UUFDbEJDLFFBQVEsRUFBRTtNQUNaLENBQUM7TUFFQXRCLDhCQUFpQixDQUFDdUIsb0JBQW9CLENBQWVyQixpQkFBaUIsQ0FBQ2EsV0FBVyxDQUFDO01BRXBGLE1BQU1aLFFBQVEsR0FBRyxNQUFNLElBQUFDLGtCQUFPLEVBQUM3QixHQUFHLENBQUMsQ0FBQ2lELEdBQUcsQ0FBQywwQ0FBMEMsQ0FBQztNQUVuRmpCLE1BQU0sQ0FBQ0osUUFBUSxDQUFDSyxNQUFNLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEdBQUcsQ0FBQztNQUNqQ0YsTUFBTSxDQUFDSixRQUFRLENBQUNPLElBQUksQ0FBQ0MsT0FBTyxDQUFDLENBQUNGLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDeENGLE1BQU0sQ0FBQ0osUUFBUSxDQUFDTyxJQUFJLENBQUNFLElBQUksQ0FBQ1MsWUFBWSxDQUFDLENBQUNaLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDbERGLE1BQU0sQ0FBQ0osUUFBUSxDQUFDTyxJQUFJLENBQUNFLElBQUksQ0FBQ1UsUUFBUSxDQUFDLENBQUNiLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDL0MsQ0FBQyxDQUFDO0lBRUYxQixFQUFFLENBQUMsb0NBQW9DLEVBQUUsWUFBWTtNQUNsRGlCLDhCQUFpQixDQUFDdUIsb0JBQW9CLENBQWVWLGlCQUFpQixDQUNyRSxJQUFJQyxLQUFLLENBQUMsc0JBQXNCLENBQ2xDLENBQUM7TUFFRCxNQUFNWCxRQUFRLEdBQUcsTUFBTSxJQUFBQyxrQkFBTyxFQUFDN0IsR0FBRyxDQUFDLENBQUNpRCxHQUFHLENBQUMsMENBQTBDLENBQUM7TUFFbkZqQixNQUFNLENBQUNKLFFBQVEsQ0FBQ0ssTUFBTSxDQUFDLENBQUNDLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDbkMsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0VBRUY3QixRQUFRLENBQUMsb0RBQW9ELEVBQUUsTUFBTTtJQUNuRUcsRUFBRSxDQUFDLHVDQUF1QyxFQUFFLFlBQVk7TUFDdEQsTUFBTTBDLFdBQVcsR0FBRztRQUNsQkMsV0FBVyxFQUFFLENBQ1g7VUFDRWpDLEVBQUUsRUFBRSxXQUFXO1VBQ2ZSLFlBQVksRUFBRSxjQUFjO1VBQzVCUyxRQUFRLEVBQUUsVUFBVTtVQUNwQkMsUUFBUSxFQUFFLFVBQVU7VUFDcEJDLGVBQWUsRUFBRSxHQUFHO1VBQ3BCVCxTQUFTLEVBQUUsSUFBSTtVQUNmVSxjQUFjLEVBQUUsR0FBRztVQUNuQkMsV0FBVyxFQUFFLElBQUlDLElBQUksQ0FBQztRQUN4QixDQUFDLEVBQ0Q7VUFDRU4sRUFBRSxFQUFFLFdBQVc7VUFDZlIsWUFBWSxFQUFFLGNBQWM7VUFDNUJTLFFBQVEsRUFBRSxVQUFVO1VBQ3BCQyxRQUFRLEVBQUUsVUFBVTtVQUNwQkMsZUFBZSxFQUFFLEVBQUU7VUFDbkJULFNBQVMsRUFBRSxJQUFJO1VBQ2ZVLGNBQWMsRUFBRSxFQUFFO1VBQ2xCQyxXQUFXLEVBQUUsSUFBSUMsSUFBSSxDQUFDO1FBQ3hCLENBQUMsQ0FDRjtRQUNENEIsYUFBYSxFQUFFLENBQUM7UUFDaEJOLFlBQVksRUFBRSxJQUFJO1FBQ2xCTyxXQUFXLEVBQUU7TUFDZixDQUFDO01BRUE1Qiw4QkFBaUIsQ0FBQzZCLDJCQUEyQixDQUFlM0IsaUJBQWlCLENBQUN1QixXQUFXLENBQUM7TUFFM0YsTUFBTXRCLFFBQVEsR0FBRyxNQUFNLElBQUFDLGtCQUFPLEVBQUM3QixHQUFHLENBQUMsQ0FBQ2lELEdBQUcsQ0FBQywrQ0FBK0MsQ0FBQztNQUV4RmpCLE1BQU0sQ0FBQ0osUUFBUSxDQUFDSyxNQUFNLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEdBQUcsQ0FBQztNQUNqQ0YsTUFBTSxDQUFDSixRQUFRLENBQUNPLElBQUksQ0FBQ0MsT0FBTyxDQUFDLENBQUNGLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDeENGLE1BQU0sQ0FBQ0osUUFBUSxDQUFDTyxJQUFJLENBQUNFLElBQUksQ0FBQ2UsYUFBYSxDQUFDLENBQUNsQixJQUFJLENBQUMsQ0FBQyxDQUFDO01BQ2hERixNQUFNLENBQUNKLFFBQVEsQ0FBQ08sSUFBSSxDQUFDRSxJQUFJLENBQUNTLFlBQVksQ0FBQyxDQUFDWixJQUFJLENBQUMsSUFBSSxDQUFDO01BQ2xERixNQUFNLENBQUNKLFFBQVEsQ0FBQ08sSUFBSSxDQUFDRSxJQUFJLENBQUNnQixXQUFXLENBQUMsQ0FBQ25CLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDaEQsQ0FBQyxDQUFDO0lBRUYxQixFQUFFLENBQUMsNkNBQTZDLEVBQUUsWUFBWTtNQUM1RCxNQUFNMEMsV0FBVyxHQUFHO1FBQ2xCQyxXQUFXLEVBQUUsRUFBRTtRQUNmQyxhQUFhLEVBQUUsQ0FBQztRQUNoQk4sWUFBWSxFQUFFLENBQUM7UUFDZk8sV0FBVyxFQUFFO01BQ2YsQ0FBQztNQUVBNUIsOEJBQWlCLENBQUM2QiwyQkFBMkIsQ0FBZTNCLGlCQUFpQixDQUFDdUIsV0FBVyxDQUFDO01BRTNGLE1BQU10QixRQUFRLEdBQUcsTUFBTSxJQUFBQyxrQkFBTyxFQUFDN0IsR0FBRyxDQUFDLENBQUNpRCxHQUFHLENBQUMsaURBQWlELENBQUM7TUFFMUZqQixNQUFNLENBQUNKLFFBQVEsQ0FBQ0ssTUFBTSxDQUFDLENBQUNDLElBQUksQ0FBQyxHQUFHLENBQUM7TUFDakNGLE1BQU0sQ0FBQ0osUUFBUSxDQUFDTyxJQUFJLENBQUNDLE9BQU8sQ0FBQyxDQUFDRixJQUFJLENBQUMsSUFBSSxDQUFDO01BQ3hDRixNQUFNLENBQUNKLFFBQVEsQ0FBQ08sSUFBSSxDQUFDRSxJQUFJLENBQUNlLGFBQWEsQ0FBQyxDQUFDbEIsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUNsRCxDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=