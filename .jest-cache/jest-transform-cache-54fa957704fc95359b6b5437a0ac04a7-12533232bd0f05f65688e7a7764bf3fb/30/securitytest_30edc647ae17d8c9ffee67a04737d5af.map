{"version":3,"names":["request","require","rateLimiters","validateInput","sanitizeInput","schemas","describe","test","expect","standard","toBeDefined","auth","financial","valid","email","password","name","user","create","parse","not","toThrow","invalid","req","body","query","params","res","next","jest","fn","toContain","toHaveBeenCalled","allowedOrigins"],"sources":["security.test.js"],"sourcesContent":["const request = require('supertest');\nconst { rateLimiters, validateInput, sanitizeInput } = require('../../packages/security-middleware');\nconst { schemas } = require('../../packages/input-validation');\n\ndescribe('Security Tests', () => {\n  describe('Rate Limiting', () => {\n    test('should enforce rate limits', () => {\n      expect(rateLimiters.standard).toBeDefined();\n      expect(rateLimiters.auth).toBeDefined();\n      expect(rateLimiters.financial).toBeDefined();\n    });\n  });\n\n  describe('Input Validation', () => {\n    test('should validate user creation', () => {\n      const valid = { email: 'test@test.com', password: 'password123', name: 'Test' };\n      expect(() => schemas.user.create.parse(valid)).not.toThrow();\n    });\n\n    test('should reject invalid email', () => {\n      const invalid = { email: 'invalid', password: 'password123', name: 'Test' };\n      expect(() => schemas.user.create.parse(invalid)).toThrow();\n    });\n\n    test('should reject short password', () => {\n      const invalid = { email: 'test@test.com', password: '123', name: 'Test' };\n      expect(() => schemas.user.create.parse(invalid)).toThrow();\n    });\n  });\n\n  describe('Input Sanitization', () => {\n    test('should sanitize XSS attempts', () => {\n      const req = { body: { name: '<script>alert(\"xss\")</script>' }, query: {}, params: {} };\n      const res = {};\n      const next = jest.fn();\n      \n      sanitizeInput(req, res, next);\n      \n      expect(req.body.name).not.toContain('<script>');\n      expect(next).toHaveBeenCalled();\n    });\n  });\n\n  describe('CORS', () => {\n    test('should allow localhost origins', () => {\n      const allowedOrigins = ['http://localhost:3000', 'http://localhost:3001'];\n      expect(allowedOrigins).toContain('http://localhost:3000');\n    });\n  });\n});\n"],"mappings":";;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;AACpC,MAAM;EAAEC,YAAY;EAAEC,aAAa;EAAEC;AAAc,CAAC,GAAGH,OAAO,CAAC,oCAAoC,CAAC;AACpG,MAAM;EAAEI;AAAQ,CAAC,GAAGJ,OAAO,CAAC,iCAAiC,CAAC;AAE9DK,QAAQ,CAAC,gBAAgB,EAAE,MAAM;EAC/BA,QAAQ,CAAC,eAAe,EAAE,MAAM;IAC9BC,IAAI,CAAC,4BAA4B,EAAE,MAAM;MACvCC,MAAM,CAACN,YAAY,CAACO,QAAQ,CAAC,CAACC,WAAW,CAAC,CAAC;MAC3CF,MAAM,CAACN,YAAY,CAACS,IAAI,CAAC,CAACD,WAAW,CAAC,CAAC;MACvCF,MAAM,CAACN,YAAY,CAACU,SAAS,CAAC,CAACF,WAAW,CAAC,CAAC;IAC9C,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFJ,QAAQ,CAAC,kBAAkB,EAAE,MAAM;IACjCC,IAAI,CAAC,+BAA+B,EAAE,MAAM;MAC1C,MAAMM,KAAK,GAAG;QAAEC,KAAK,EAAE,eAAe;QAAEC,QAAQ,EAAE,aAAa;QAAEC,IAAI,EAAE;MAAO,CAAC;MAC/ER,MAAM,CAAC,MAAMH,OAAO,CAACY,IAAI,CAACC,MAAM,CAACC,KAAK,CAACN,KAAK,CAAC,CAAC,CAACO,GAAG,CAACC,OAAO,CAAC,CAAC;IAC9D,CAAC,CAAC;IAEFd,IAAI,CAAC,6BAA6B,EAAE,MAAM;MACxC,MAAMe,OAAO,GAAG;QAAER,KAAK,EAAE,SAAS;QAAEC,QAAQ,EAAE,aAAa;QAAEC,IAAI,EAAE;MAAO,CAAC;MAC3ER,MAAM,CAAC,MAAMH,OAAO,CAACY,IAAI,CAACC,MAAM,CAACC,KAAK,CAACG,OAAO,CAAC,CAAC,CAACD,OAAO,CAAC,CAAC;IAC5D,CAAC,CAAC;IAEFd,IAAI,CAAC,8BAA8B,EAAE,MAAM;MACzC,MAAMe,OAAO,GAAG;QAAER,KAAK,EAAE,eAAe;QAAEC,QAAQ,EAAE,KAAK;QAAEC,IAAI,EAAE;MAAO,CAAC;MACzER,MAAM,CAAC,MAAMH,OAAO,CAACY,IAAI,CAACC,MAAM,CAACC,KAAK,CAACG,OAAO,CAAC,CAAC,CAACD,OAAO,CAAC,CAAC;IAC5D,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFf,QAAQ,CAAC,oBAAoB,EAAE,MAAM;IACnCC,IAAI,CAAC,8BAA8B,EAAE,MAAM;MACzC,MAAMgB,GAAG,GAAG;QAAEC,IAAI,EAAE;UAAER,IAAI,EAAE;QAAgC,CAAC;QAAES,KAAK,EAAE,CAAC,CAAC;QAAEC,MAAM,EAAE,CAAC;MAAE,CAAC;MACtF,MAAMC,GAAG,GAAG,CAAC,CAAC;MACd,MAAMC,IAAI,GAAGC,IAAI,CAACC,EAAE,CAAC,CAAC;MAEtB1B,aAAa,CAACmB,GAAG,EAAEI,GAAG,EAAEC,IAAI,CAAC;MAE7BpB,MAAM,CAACe,GAAG,CAACC,IAAI,CAACR,IAAI,CAAC,CAACI,GAAG,CAACW,SAAS,CAAC,UAAU,CAAC;MAC/CvB,MAAM,CAACoB,IAAI,CAAC,CAACI,gBAAgB,CAAC,CAAC;IACjC,CAAC,CAAC;EACJ,CAAC,CAAC;EAEF1B,QAAQ,CAAC,MAAM,EAAE,MAAM;IACrBC,IAAI,CAAC,gCAAgC,EAAE,MAAM;MAC3C,MAAM0B,cAAc,GAAG,CAAC,uBAAuB,EAAE,uBAAuB,CAAC;MACzEzB,MAAM,CAACyB,cAAc,CAAC,CAACF,SAAS,CAAC,uBAAuB,CAAC;IAC3D,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}