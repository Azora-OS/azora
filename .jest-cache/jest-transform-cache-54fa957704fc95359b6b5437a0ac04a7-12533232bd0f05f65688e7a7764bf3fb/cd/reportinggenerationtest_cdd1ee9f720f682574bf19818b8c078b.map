{"version":3,"names":["request","require","express","createTestApp","app","use","json","post","req","res","reportType","parameters","format","body","status","error","report","reportId","Date","now","generatedAt","toISOString","data","summary","details","get","params","downloadUrl","types","count","describe","beforeEach","it","response","send","timeRange","expect","toBe","toHaveProperty","Array","isArray","length","toBeGreaterThan"],"sources":["reporting-generation.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\n\r\nfunction createTestApp() {\r\n  const app = express();\r\n  app.use(express.json());\r\n\r\n  app.post('/api/analytics/generate-report', (req, res) => {\r\n    const { reportType, parameters, format } = req.body;\r\n\r\n    if (!reportType) {\r\n      return res.status(400).json({ error: 'Report type is required' });\r\n    }\r\n\r\n    const report = {\r\n      reportId: `report_${Date.now()}`,\r\n      reportType,\r\n      format: format || 'json',\r\n      status: 'completed',\r\n      generatedAt: new Date().toISOString(),\r\n      data: {\r\n        summary: {},\r\n        details: []\r\n      }\r\n    };\r\n\r\n    res.json(report);\r\n  });\r\n\r\n  app.get('/api/analytics/reports/:reportId', (req, res) => {\r\n    const { reportId } = req.params;\r\n\r\n    res.json({\r\n      reportId,\r\n      status: 'completed',\r\n      downloadUrl: `/api/analytics/download/${reportId}`\r\n    });\r\n  });\r\n\r\n  app.get('/api/analytics/report-types', (req, res) => {\r\n    res.json({\r\n      types: ['user_activity', 'revenue', 'course_performance', 'system_health'],\r\n      count: 4\r\n    });\r\n  });\r\n\r\n  return app;\r\n}\r\n\r\ndescribe('Azora Analytics - Reporting Generation Tests', () => {\r\n  let app;\r\n\r\n  beforeEach(() => {\r\n    app = createTestApp();\r\n  });\r\n\r\n  describe('POST /api/analytics/generate-report', () => {\r\n    it('should generate report of specified type', async () => {\r\n      const response = await request(app)\r\n        .post('/api/analytics/generate-report')\r\n        .send({\r\n          reportType: 'user_activity',\r\n          parameters: { timeRange: 'last_30d' },\r\n          format: 'pdf'\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('reportId');\r\n      expect(response.body.reportType).toBe('user_activity');\r\n      expect(response.body.format).toBe('pdf');\r\n    });\r\n\r\n    it('should return error when report type is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/analytics/generate-report')\r\n        .send({ format: 'json' });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Report type is required');\r\n    });\r\n\r\n    it('should default to JSON format when not specified', async () => {\r\n      const response = await request(app)\r\n        .post('/api/analytics/generate-report')\r\n        .send({ reportType: 'revenue' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.format).toBe('json');\r\n    });\r\n\r\n    it('should include report data structure', async () => {\r\n      const response = await request(app)\r\n        .post('/api/analytics/generate-report')\r\n        .send({ reportType: 'course_performance' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('data');\r\n      expect(response.body.data).toHaveProperty('summary');\r\n      expect(response.body.data).toHaveProperty('details');\r\n    });\r\n\r\n    it('should mark report as completed', async () => {\r\n      const response = await request(app)\r\n        .post('/api/analytics/generate-report')\r\n        .send({ reportType: 'system_health' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.status).toBe('completed');\r\n    });\r\n  });\r\n\r\n  describe('GET /api/analytics/reports/:reportId', () => {\r\n    it('should retrieve report by ID', async () => {\r\n      const reportId = 'report_123456';\r\n      const response = await request(app)\r\n        .get(`/api/analytics/reports/${reportId}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.reportId).toBe(reportId);\r\n      expect(response.body).toHaveProperty('status');\r\n    });\r\n\r\n    it('should include download URL', async () => {\r\n      const response = await request(app)\r\n        .get('/api/analytics/reports/report_123');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('downloadUrl');\r\n    });\r\n  });\r\n\r\n  describe('GET /api/analytics/report-types', () => {\r\n    it('should return available report types', async () => {\r\n      const response = await request(app)\r\n        .get('/api/analytics/report-types');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('types');\r\n      expect(Array.isArray(response.body.types)).toBe(true);\r\n      expect(response.body.types.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}