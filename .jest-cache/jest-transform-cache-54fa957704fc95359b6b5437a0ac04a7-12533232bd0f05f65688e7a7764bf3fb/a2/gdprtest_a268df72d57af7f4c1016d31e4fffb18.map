{"version":3,"names":["request","require","express","gdprRoutes","generateAccessToken","app","use","json","describe","token","beforeAll","userId","email","role","test","res","get","set","expect","status","toBe","body","success","data","toHaveProperty","post","retentionPeriod","send","marketing","analytics","consent"],"sources":["gdpr.test.js"],"sourcesContent":["const request = require('supertest');\nconst express = require('express');\nconst gdprRoutes = require('../src/routes/gdpr');\nconst { generateAccessToken } = require('../src/middleware/jwt');\n\nconst app = express();\napp.use(express.json());\napp.use('/api/gdpr', gdprRoutes);\n\ndescribe('GDPR Compliance', () => {\n  let token;\n\n  beforeAll(() => {\n    token = generateAccessToken({ userId: 1, email: 'test@azora.world', role: 'student' });\n  });\n\n  test('should export user data', async () => {\n    const res = await request(app)\n      .get('/api/gdpr/export')\n      .set('Authorization', `Bearer ${token}`);\n    \n    expect(res.status).toBe(200);\n    expect(res.body.success).toBe(true);\n    expect(res.body.data).toHaveProperty('profile');\n  });\n\n  test('should schedule data deletion', async () => {\n    const res = await request(app)\n      .post('/api/gdpr/delete')\n      .set('Authorization', `Bearer ${token}`);\n    \n    expect(res.status).toBe(200);\n    expect(res.body.retentionPeriod).toBe('30 days');\n  });\n\n  test('should update consent preferences', async () => {\n    const res = await request(app)\n      .post('/api/gdpr/consent')\n      .set('Authorization', `Bearer ${token}`)\n      .send({ marketing: true, analytics: true });\n    \n    expect(res.status).toBe(200);\n    expect(res.body.consent.marketing).toBe(true);\n  });\n});\n"],"mappings":";;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;AACpC,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAS,CAAC;AAClC,MAAME,UAAU,GAAGF,OAAO,CAAC,oBAAoB,CAAC;AAChD,MAAM;EAAEG;AAAoB,CAAC,GAAGH,OAAO,CAAC,uBAAuB,CAAC;AAEhE,MAAMI,GAAG,GAAGH,OAAO,CAAC,CAAC;AACrBG,GAAG,CAACC,GAAG,CAACJ,OAAO,CAACK,IAAI,CAAC,CAAC,CAAC;AACvBF,GAAG,CAACC,GAAG,CAAC,WAAW,EAAEH,UAAU,CAAC;AAEhCK,QAAQ,CAAC,iBAAiB,EAAE,MAAM;EAChC,IAAIC,KAAK;EAETC,SAAS,CAAC,MAAM;IACdD,KAAK,GAAGL,mBAAmB,CAAC;MAAEO,MAAM,EAAE,CAAC;MAAEC,KAAK,EAAE,kBAAkB;MAAEC,IAAI,EAAE;IAAU,CAAC,CAAC;EACxF,CAAC,CAAC;EAEFC,IAAI,CAAC,yBAAyB,EAAE,YAAY;IAC1C,MAAMC,GAAG,GAAG,MAAMf,OAAO,CAACK,GAAG,CAAC,CAC3BW,GAAG,CAAC,kBAAkB,CAAC,CACvBC,GAAG,CAAC,eAAe,EAAE,UAAUR,KAAK,EAAE,CAAC;IAE1CS,MAAM,CAACH,GAAG,CAACI,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IAC5BF,MAAM,CAACH,GAAG,CAACM,IAAI,CAACC,OAAO,CAAC,CAACF,IAAI,CAAC,IAAI,CAAC;IACnCF,MAAM,CAACH,GAAG,CAACM,IAAI,CAACE,IAAI,CAAC,CAACC,cAAc,CAAC,SAAS,CAAC;EACjD,CAAC,CAAC;EAEFV,IAAI,CAAC,+BAA+B,EAAE,YAAY;IAChD,MAAMC,GAAG,GAAG,MAAMf,OAAO,CAACK,GAAG,CAAC,CAC3BoB,IAAI,CAAC,kBAAkB,CAAC,CACxBR,GAAG,CAAC,eAAe,EAAE,UAAUR,KAAK,EAAE,CAAC;IAE1CS,MAAM,CAACH,GAAG,CAACI,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IAC5BF,MAAM,CAACH,GAAG,CAACM,IAAI,CAACK,eAAe,CAAC,CAACN,IAAI,CAAC,SAAS,CAAC;EAClD,CAAC,CAAC;EAEFN,IAAI,CAAC,mCAAmC,EAAE,YAAY;IACpD,MAAMC,GAAG,GAAG,MAAMf,OAAO,CAACK,GAAG,CAAC,CAC3BoB,IAAI,CAAC,mBAAmB,CAAC,CACzBR,GAAG,CAAC,eAAe,EAAE,UAAUR,KAAK,EAAE,CAAC,CACvCkB,IAAI,CAAC;MAAEC,SAAS,EAAE,IAAI;MAAEC,SAAS,EAAE;IAAK,CAAC,CAAC;IAE7CX,MAAM,CAACH,GAAG,CAACI,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IAC5BF,MAAM,CAACH,GAAG,CAACM,IAAI,CAACS,OAAO,CAACF,SAAS,CAAC,CAACR,IAAI,CAAC,IAAI,CAAC;EAC/C,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}