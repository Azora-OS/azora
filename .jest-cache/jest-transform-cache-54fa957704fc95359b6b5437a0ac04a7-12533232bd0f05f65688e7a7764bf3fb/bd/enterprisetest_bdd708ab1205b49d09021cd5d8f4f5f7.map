{"version":3,"names":["request","require","app","describe","it","response","get","expect","body","status","toBe","service","ubuntu","timestamp","toBeDefined","enterpriseData","name","domain","features","tier","post","send","success","data","error","licenseData","enterpriseId","type","maxUsers","whitelabelData","branding","logo","colors","primary","customDomain","maliciousData","JSON","stringify","not","toContain","headers"],"sources":["enterprise.test.js"],"sourcesContent":["const request = require('supertest');\nconst app = require('../services/enterprise/server');\n\ndescribe('Enterprise Service - Comprehensive Tests', () => {\n  describe('Health & Status', () => {\n    it('should return healthy status with ubuntu message', async () => {\n      const response = await request(app)\n        .get('/api/health')\n        .expect(200);\n      \n      expect(response.body.status).toBe('healthy');\n      expect(response.body.service).toBe('azora-enterprise');\n      expect(response.body.ubuntu).toBe('I serve because we prosper together');\n      expect(response.body.timestamp).toBeDefined();\n    });\n  });\n\n  describe('Enterprise Management', () => {\n    it('should create new enterprise', async () => {\n      const enterpriseData = {\n        name: 'Test Enterprise',\n        domain: 'test.azora.world',\n        features: ['basic', 'advanced'],\n        tier: 'PREMIUM'\n      };\n\n      const response = await request(app)\n        .post('/api/enterprises')\n        .send(enterpriseData)\n        .expect(201);\n      \n      expect(response.body.success).toBe(true);\n      expect(response.body.data.name).toBe(enterpriseData.name);\n      expect(response.body.data.tier).toBe('PREMIUM');\n    });\n\n    it('should handle missing required fields', async () => {\n      const response = await request(app)\n        .post('/api/enterprises')\n        .send({})\n        .expect(500);\n      \n      expect(response.body.error).toBeDefined();\n    });\n  });\n\n  describe('License Management', () => {\n    it('should create enterprise license', async () => {\n      const licenseData = {\n        enterpriseId: 'ent_123',\n        type: 'PREMIUM',\n        features: ['white-label', 'analytics'],\n        maxUsers: 500\n      };\n\n      const response = await request(app)\n        .post('/api/licenses')\n        .send(licenseData)\n        .expect(201);\n      \n      expect(response.body.success).toBe(true);\n      expect(response.body.data.type).toBe('PREMIUM');\n      expect(response.body.data.maxUsers).toBe(500);\n    });\n  });\n\n  describe('White-label Configuration', () => {\n    it('should create white-label config', async () => {\n      const whitelabelData = {\n        enterpriseId: 'ent_123',\n        branding: {\n          logo: 'https://example.com/logo.png',\n          colors: { primary: '#007bff' }\n        },\n        customDomain: 'custom.example.com',\n        features: ['custom-branding', 'analytics']\n      };\n\n      const response = await request(app)\n        .post('/api/white-label')\n        .send(whitelabelData)\n        .expect(201);\n      \n      expect(response.body.success).toBe(true);\n      expect(response.body.data.customDomain).toBe('custom.example.com');\n    });\n  });\n\n  describe('Security & Validation', () => {\n    it('should sanitize XSS in enterprise name', async () => {\n      const maliciousData = {\n        name: '<script>alert(\"xss\")</script>Test Enterprise',\n        domain: 'test.com'\n      };\n\n      const response = await request(app)\n        .post('/api/enterprises')\n        .send(maliciousData);\n      \n      // Should not contain script tags\n      expect(JSON.stringify(response.body)).not.toContain('<script>');\n    });\n\n    it('should have security headers', async () => {\n      const response = await request(app)\n        .get('/api/health');\n      \n      expect(response.headers['x-content-type-options']).toBeDefined();\n      expect(response.headers['x-frame-options']).toBeDefined();\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should return 404 for non-existent endpoints', async () => {\n      const response = await request(app)\n        .get('/api/non-existent')\n        .expect(404);\n      \n      expect(response.body.success).toBe(false);\n      expect(response.body.error).toBe('Endpoint not found');\n    });\n  });\n});"],"mappings":"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","ignoreList":[]}