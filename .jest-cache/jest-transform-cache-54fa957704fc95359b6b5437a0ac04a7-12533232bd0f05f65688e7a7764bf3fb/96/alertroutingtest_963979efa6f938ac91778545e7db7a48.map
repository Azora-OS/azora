{"version":3,"names":["AlertManager","require","describe","alertManager","beforeEach","it","metrics","cpu","memory","alerts","checkThresholds","expect","length","toBeGreaterThan","some","a","level","toBe","error_rate","disk","toHaveLength","toHaveProperty","thresholds","toBeDefined","updateThreshold","warning","toBeLessThan","critical","done","on","alert","receivedAlerts","push","slos","availability","response_time","criticalAlert","find","warningAlert","message","toContain"],"sources":["alert-routing.test.js"],"sourcesContent":["const AlertManager = require('../alert-manager');\r\n\r\ndescribe('Alert Routing', () => {\r\n  let alertManager;\r\n\r\n  beforeEach(() => {\r\n    alertManager = new AlertManager();\r\n  });\r\n\r\n  describe('Alert Generation', () => {\r\n    it('should generate warning alerts when threshold exceeded', () => {\r\n      const metrics = {\r\n        cpu: 75,\r\n        memory: 85\r\n      };\r\n\r\n      const alerts = alertManager.checkThresholds(metrics);\r\n\r\n      expect(alerts.length).toBeGreaterThan(0);\r\n      expect(alerts.some(a => a.level === 'warning')).toBe(true);\r\n    });\r\n\r\n    it('should generate critical alerts for high values', () => {\r\n      const metrics = {\r\n        cpu: 95,\r\n        error_rate: 15\r\n      };\r\n\r\n      const alerts = alertManager.checkThresholds(metrics);\r\n\r\n      expect(alerts.some(a => a.level === 'critical')).toBe(true);\r\n    });\r\n\r\n    it('should not generate alerts for normal metrics', () => {\r\n      const metrics = {\r\n        cpu: 50,\r\n        memory: 60,\r\n        disk: 70\r\n      };\r\n\r\n      const alerts = alertManager.checkThresholds(metrics);\r\n\r\n      expect(alerts).toHaveLength(0);\r\n    });\r\n\r\n    it('should include metric details in alerts', () => {\r\n      const metrics = {\r\n        cpu: 95\r\n      };\r\n\r\n      const alerts = alertManager.checkThresholds(metrics);\r\n\r\n      expect(alerts[0]).toHaveProperty('metric', 'cpu');\r\n      expect(alerts[0]).toHaveProperty('value', 95);\r\n      expect(alerts[0]).toHaveProperty('threshold');\r\n      expect(alerts[0]).toHaveProperty('message');\r\n    });\r\n  });\r\n\r\n  describe('Alert Thresholds', () => {\r\n    it('should have default thresholds configured', () => {\r\n      expect(alertManager.thresholds).toBeDefined();\r\n      expect(alertManager.thresholds.cpu).toBeDefined();\r\n      expect(alertManager.thresholds.memory).toBeDefined();\r\n      expect(alertManager.thresholds.disk).toBeDefined();\r\n    });\r\n\r\n    it('should update threshold values', () => {\r\n      alertManager.updateThreshold('cpu', 'warning', 80);\r\n\r\n      expect(alertManager.thresholds.cpu.warning).toBe(80);\r\n    });\r\n\r\n    it('should maintain separate warning and critical thresholds', () => {\r\n      expect(alertManager.thresholds.cpu.warning).toBeLessThan(\r\n        alertManager.thresholds.cpu.critical\r\n      );\r\n    });\r\n\r\n    it('should handle multiple metric types', () => {\r\n      expect(alertManager.thresholds).toHaveProperty('cpu');\r\n      expect(alertManager.thresholds).toHaveProperty('memory');\r\n      expect(alertManager.thresholds).toHaveProperty('response_time');\r\n      expect(alertManager.thresholds).toHaveProperty('error_rate');\r\n    });\r\n  });\r\n\r\n  describe('Alert Events', () => {\r\n    it('should emit alert events', (done) => {\r\n      alertManager.on('alert', (alert) => {\r\n        expect(alert).toBeDefined();\r\n        expect(alert).toHaveProperty('level');\r\n        expect(alert).toHaveProperty('message');\r\n        done();\r\n      });\r\n\r\n      const metrics = { cpu: 95 };\r\n      alertManager.checkThresholds(metrics);\r\n    });\r\n\r\n    it('should emit multiple alerts for multiple threshold breaches', (done) => {\r\n      const receivedAlerts = [];\r\n\r\n      alertManager.on('alert', (alert) => {\r\n        receivedAlerts.push(alert);\r\n        if (receivedAlerts.length === 2) {\r\n          expect(receivedAlerts).toHaveLength(2);\r\n          done();\r\n        }\r\n      });\r\n\r\n      const metrics = {\r\n        cpu: 95,\r\n        memory: 96\r\n      };\r\n      alertManager.checkThresholds(metrics);\r\n    });\r\n  });\r\n\r\n  describe('SLO Configuration', () => {\r\n    it('should have SLO targets defined', () => {\r\n      expect(alertManager.slos).toBeDefined();\r\n      expect(alertManager.slos.availability).toBeDefined();\r\n      expect(alertManager.slos.response_time).toBeDefined();\r\n      expect(alertManager.slos.error_rate).toBeDefined();\r\n    });\r\n\r\n    it('should have reasonable SLO values', () => {\r\n      expect(alertManager.slos.availability).toBeGreaterThan(99);\r\n      expect(alertManager.slos.response_time).toBeGreaterThan(0);\r\n      expect(alertManager.slos.error_rate).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('Alert Prioritization', () => {\r\n    it('should prioritize critical over warning', () => {\r\n      const metrics = {\r\n        cpu: 95,\r\n        memory: 75\r\n      };\r\n\r\n      const alerts = alertManager.checkThresholds(metrics);\r\n      const criticalAlert = alerts.find(a => a.level === 'critical');\r\n      const warningAlert = alerts.find(a => a.level === 'warning');\r\n\r\n      expect(criticalAlert).toBeDefined();\r\n      expect(warningAlert).toBeDefined();\r\n    });\r\n\r\n    it('should generate appropriate alert messages', () => {\r\n      const metrics = { cpu: 95 };\r\n\r\n      const alerts = alertManager.checkThresholds(metrics);\r\n\r\n      expect(alerts[0].message).toContain('cpu');\r\n      expect(alerts[0].message).toContain('critical');\r\n      expect(alerts[0].message).toContain('95');\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}