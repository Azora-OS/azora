{"version":3,"names":["encrypt","decrypt","hashPassword","require","describe","beforeAll","process","env","ENCRYPTION_KEY","Buffer","from","repeat","toString","slice","test","text","encrypted","iv","authTag","decrypted","expect","toBe","result1","result2","not","password","hash1","hash2"],"sources":["encryption.test.js"],"sourcesContent":["const { encrypt, decrypt, hashPassword } = require('../src/middleware/encryption');\n\ndescribe('Encryption', () => {\n  beforeAll(() => {\n    process.env.ENCRYPTION_KEY = Buffer.from('a'.repeat(64), 'utf8').toString('hex').slice(0, 64);\n  });\n\n  test('should encrypt and decrypt text', () => {\n    const text = 'sensitive data';\n    const { encrypted, iv, authTag } = encrypt(text);\n    const decrypted = decrypt(encrypted, iv, authTag);\n    \n    expect(decrypted).toBe(text);\n  });\n\n  test('should produce different ciphertext for same input', () => {\n    const text = 'test';\n    const result1 = encrypt(text);\n    const result2 = encrypt(text);\n    \n    expect(result1.encrypted).not.toBe(result2.encrypted);\n  });\n\n  test('should hash passwords consistently', () => {\n    const password = 'password123';\n    const hash1 = hashPassword(password);\n    const hash2 = hashPassword(password);\n    \n    expect(hash1).toBe(hash2);\n    expect(hash1).not.toBe(password);\n  });\n});\n"],"mappings":";;AAAA,MAAM;EAAEA,OAAO;EAAEC,OAAO;EAAEC;AAAa,CAAC,GAAGC,OAAO,CAAC,8BAA8B,CAAC;AAElFC,QAAQ,CAAC,YAAY,EAAE,MAAM;EAC3BC,SAAS,CAAC,MAAM;IACdC,OAAO,CAACC,GAAG,CAACC,cAAc,GAAGC,MAAM,CAACC,IAAI,CAAC,GAAG,CAACC,MAAM,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,CAACC,QAAQ,CAAC,KAAK,CAAC,CAACC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;EAC/F,CAAC,CAAC;EAEFC,IAAI,CAAC,iCAAiC,EAAE,MAAM;IAC5C,MAAMC,IAAI,GAAG,gBAAgB;IAC7B,MAAM;MAAEC,SAAS;MAAEC,EAAE;MAAEC;IAAQ,CAAC,GAAGlB,OAAO,CAACe,IAAI,CAAC;IAChD,MAAMI,SAAS,GAAGlB,OAAO,CAACe,SAAS,EAAEC,EAAE,EAAEC,OAAO,CAAC;IAEjDE,MAAM,CAACD,SAAS,CAAC,CAACE,IAAI,CAACN,IAAI,CAAC;EAC9B,CAAC,CAAC;EAEFD,IAAI,CAAC,oDAAoD,EAAE,MAAM;IAC/D,MAAMC,IAAI,GAAG,MAAM;IACnB,MAAMO,OAAO,GAAGtB,OAAO,CAACe,IAAI,CAAC;IAC7B,MAAMQ,OAAO,GAAGvB,OAAO,CAACe,IAAI,CAAC;IAE7BK,MAAM,CAACE,OAAO,CAACN,SAAS,CAAC,CAACQ,GAAG,CAACH,IAAI,CAACE,OAAO,CAACP,SAAS,CAAC;EACvD,CAAC,CAAC;EAEFF,IAAI,CAAC,oCAAoC,EAAE,MAAM;IAC/C,MAAMW,QAAQ,GAAG,aAAa;IAC9B,MAAMC,KAAK,GAAGxB,YAAY,CAACuB,QAAQ,CAAC;IACpC,MAAME,KAAK,GAAGzB,YAAY,CAACuB,QAAQ,CAAC;IAEpCL,MAAM,CAACM,KAAK,CAAC,CAACL,IAAI,CAACM,KAAK,CAAC;IACzBP,MAAM,CAACM,KAAK,CAAC,CAACF,GAAG,CAACH,IAAI,CAACI,QAAQ,CAAC;EAClC,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}