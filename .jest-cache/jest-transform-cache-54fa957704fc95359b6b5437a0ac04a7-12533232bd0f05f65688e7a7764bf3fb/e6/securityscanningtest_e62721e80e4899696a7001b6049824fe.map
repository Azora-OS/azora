{"version":3,"names":["request","require","express","createTestApp","app","helmet","cors","rateLimit","use","json","limiter","windowMs","max","get","req","res","service","status","timestamp","Date","toISOString","security","threats","alerts","post","target","scanType","body","error","scanResult","scanId","now","vulnerabilities","received","describe","beforeEach","it","response","send","expect","toBe","toHaveProperty","Array","isArray"],"sources":["security-scanning.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\n\r\n// Create a test app instance\r\nfunction createTestApp() {\r\n  const app = express();\r\n  const helmet = require('helmet');\r\n  const cors = require('cors');\r\n  const rateLimit = require('express-rate-limit');\r\n\r\n  app.use(helmet());\r\n  app.use(cors());\r\n  app.use(express.json());\r\n\r\n  const limiter = rateLimit({\r\n    windowMs: 15 * 60 * 1000,\r\n    max: 100\r\n  });\r\n  app.use(limiter);\r\n\r\n  // Health check\r\n  app.get('/health', (req, res) => {\r\n    res.json({\r\n      service: 'azora-aegis',\r\n      status: 'healthy',\r\n      timestamp: new Date().toISOString(),\r\n      security: 'active'\r\n    });\r\n  });\r\n\r\n  // Security monitoring endpoints\r\n  app.get('/api/security/status', (req, res) => {\r\n    res.json({\r\n      threats: 0,\r\n      alerts: 0,\r\n      status: 'secure'\r\n    });\r\n  });\r\n\r\n  app.post('/api/security/scan', (req, res) => {\r\n    const { target, scanType } = req.body;\r\n    \r\n    if (!target) {\r\n      return res.status(400).json({ error: 'Target is required' });\r\n    }\r\n\r\n    const scanResult = {\r\n      scanId: `scan_${Date.now()}`,\r\n      target,\r\n      scanType: scanType || 'full',\r\n      vulnerabilities: [],\r\n      status: 'completed',\r\n      timestamp: new Date().toISOString()\r\n    };\r\n\r\n    res.json(scanResult);\r\n  });\r\n\r\n  app.post('/api/security/alert', (req, res) => {\r\n    res.json({ received: true });\r\n  });\r\n\r\n  return app;\r\n}\r\n\r\ndescribe('Azora Aegis - Security Scanning Tests', () => {\r\n  let app;\r\n\r\n  beforeEach(() => {\r\n    app = createTestApp();\r\n  });\r\n\r\n  describe('POST /api/security/scan', () => {\r\n    it('should perform security scan on target', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/scan')\r\n        .send({\r\n          target: 'https://example.com',\r\n          scanType: 'vulnerability'\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('scanId');\r\n      expect(response.body.target).toBe('https://example.com');\r\n      expect(response.body.scanType).toBe('vulnerability');\r\n      expect(response.body.status).toBe('completed');\r\n    });\r\n\r\n    it('should return error when target is missing', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/scan')\r\n        .send({ scanType: 'full' });\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Target is required');\r\n    });\r\n\r\n    it('should default to full scan when scanType not specified', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/scan')\r\n        .send({ target: 'https://example.com' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.scanType).toBe('full');\r\n    });\r\n\r\n    it('should return vulnerabilities array', async () => {\r\n      const response = await request(app)\r\n        .post('/api/security/scan')\r\n        .send({ target: 'https://example.com' });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('vulnerabilities');\r\n      expect(Array.isArray(response.body.vulnerabilities)).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/security/status', () => {\r\n    it('should return security status', async () => {\r\n      const response = await request(app)\r\n        .get('/api/security/status');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('threats');\r\n      expect(response.body).toHaveProperty('alerts');\r\n      expect(response.body).toHaveProperty('status');\r\n      expect(response.body.status).toBe('secure');\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}