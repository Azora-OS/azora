{"version":3,"names":["_supertest","_interopRequireDefault","require","_client","e","__esModule","default","BASE_URL","process","env","API_URL","prisma","PrismaClient","describe","courseId","studentId","enrollmentId","beforeAll","courseResponse","request","post","send","title","description","tier","instructorId","language","body","data","id","studentResponse","email","name","enrollmentResponse","afterAll","$disconnect","it","put","moduleId","percentComplete","response","get","expect","status","toBe","offers","length","toBeGreaterThan","answers","questionId","answer","passed","conversionResponse","upgradeOffer","find","o","type","toBeDefined","discount","expiresAt","trialOffer","duration","bundleOffer","courses","offerId","offersResponse","basePrice","price","discountedPrice","toBeLessThan","paymentMethod","toHaveProperty","completedOffer","expiredOffers","filter","Date","offer","expiredOffer","error","toContain","conversionRate","toBeGreaterThanOrEqual","toBeLessThanOrEqual","offerAcceptanceRate","conversionRevenue","averageLifetimeValue","offerPerformance","churnStudentId","retentionOffers","multiTierStudentId","proOffers"],"sources":["student-conversion.e2e.test.ts"],"sourcesContent":["/**\r\n * End-to-End Student Conversion Tests\r\n * Tests conversion offer flow and tier upgrades\r\n */\r\n\r\nimport request from 'supertest';\r\nimport { PrismaClient } from '@prisma/client';\r\n\r\nconst BASE_URL = process.env.API_URL || 'http://localhost:3020';\r\nconst prisma = new PrismaClient();\r\n\r\ndescribe('E2E: Student Conversion Flow', () => {\r\n  let courseId: string;\r\n  let studentId: string;\r\n  let enrollmentId: string;\r\n\r\n  beforeAll(async () => {\r\n    // Create test course\r\n    const courseResponse = await request(BASE_URL)\r\n      .post('/api/v1/courses')\r\n      .send({\r\n        title: 'Conversion Test Course',\r\n        description: 'Course for conversion testing',\r\n        tier: 'free',\r\n        instructorId: 'test-instructor',\r\n        language: 'en',\r\n      });\r\n\r\n    courseId = courseResponse.body.data.id;\r\n\r\n    // Create free student\r\n    const studentResponse = await request(BASE_URL)\r\n      .post('/api/v1/enrollments')\r\n      .send({\r\n        email: 'conversion-test@example.com',\r\n        name: 'Conversion Test',\r\n        tier: 'free',\r\n      });\r\n\r\n    studentId = studentResponse.body.data.id;\r\n\r\n    // Enroll in course\r\n    const enrollmentResponse = await request(BASE_URL)\r\n      .post(`/api/v1/enrollments/${studentId}/courses`)\r\n      .send({\r\n        courseId,\r\n      });\r\n\r\n    enrollmentId = enrollmentResponse.body.data.id;\r\n  });\r\n\r\n  afterAll(async () => {\r\n    await prisma.$disconnect();\r\n  });\r\n\r\n  describe('Conversion Trigger Events', () => {\r\n    it('should trigger conversion at module completion (40%)', async () => {\r\n      await request(BASE_URL)\r\n        .put(`/api/v1/enrollments/${enrollmentId}/progress`)\r\n        .send({\r\n          moduleId: 'module-1',\r\n          percentComplete: 40,\r\n        });\r\n\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.data.offers.length).toBeGreaterThan(0);\r\n    });\r\n\r\n    it('should trigger conversion on assessment pass', async () => {\r\n      const response = await request(BASE_URL)\r\n        .post(`/api/v1/assessments/submit`)\r\n        .send({\r\n          enrollmentId,\r\n          courseId,\r\n          answers: [\r\n            { questionId: 'q1', answer: 'correct' },\r\n            { questionId: 'q2', answer: 'correct' },\r\n          ],\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(response.body.data.passed).toBe(true);\r\n\r\n      // Check for conversion offer\r\n      const conversionResponse = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      expect(conversionResponse.body.data.offers.length).toBeGreaterThan(0);\r\n    });\r\n\r\n    it('should trigger conversion on course completion', async () => {\r\n      await request(BASE_URL)\r\n        .put(`/api/v1/enrollments/${enrollmentId}`)\r\n        .send({\r\n          status: 'completed',\r\n        });\r\n\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.data.offers.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('Conversion Offer Types', () => {\r\n    it('should provide upgrade discount offer', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      const upgradeOffer = response.body.data.offers.find(\r\n        (o: any) => o.type === 'upgrade_discount'\r\n      );\r\n\r\n      expect(upgradeOffer).toBeDefined();\r\n      expect(upgradeOffer.discount).toBeGreaterThan(0);\r\n      expect(upgradeOffer.tier).toBe('premium');\r\n      expect(upgradeOffer.expiresAt).toBeDefined();\r\n    });\r\n\r\n    it('should provide premium trial offer', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      const trialOffer = response.body.data.offers.find(\r\n        (o: any) => o.type === 'premium_trial'\r\n      );\r\n\r\n      if (trialOffer) {\r\n        expect(trialOffer.duration).toBeGreaterThan(0);\r\n        expect(trialOffer.tier).toBe('premium');\r\n      }\r\n    });\r\n\r\n    it('should provide bundle deal offer', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      const bundleOffer = response.body.data.offers.find(\r\n        (o: any) => o.type === 'bundle_deal'\r\n      );\r\n\r\n      if (bundleOffer) {\r\n        expect(bundleOffer.courses).toBeDefined();\r\n        expect(bundleOffer.discount).toBeGreaterThan(0);\r\n      }\r\n    });\r\n  });\r\n\r\n  describe('Offer Acceptance and Payment', () => {\r\n    let offerId: string;\r\n\r\n    it('should accept conversion offer', async () => {\r\n      const offersResponse = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      offerId = offersResponse.body.data.offers[0].id;\r\n\r\n      const response = await request(BASE_URL)\r\n        .post(`/api/v1/conversions/accept`)\r\n        .send({\r\n          studentId,\r\n          offerId,\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.data.status).toBe('accepted');\r\n    });\r\n\r\n    it('should calculate discounted price', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/pricing/tiers/premium`);\r\n\r\n      const basePrice = response.body.data.price;\r\n      const discountedPrice = basePrice * 0.5; // 50% discount\r\n\r\n      expect(discountedPrice).toBeLessThan(basePrice);\r\n    });\r\n\r\n    it('should process payment with discount', async () => {\r\n      const response = await request(BASE_URL)\r\n        .post(`/api/v1/payments/process`)\r\n        .send({\r\n          studentId,\r\n          offerId,\r\n          paymentMethod: 'stripe',\r\n          tier: 'premium',\r\n        });\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(response.body.data.status).toBe('completed');\r\n      expect(response.body.data).toHaveProperty('transactionId');\r\n    });\r\n\r\n    it('should upgrade student tier after payment', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/enrollments/${studentId}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.data.tier).toBe('premium');\r\n    });\r\n\r\n    it('should mark offer as completed', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      const completedOffer = response.body.data.offers.find(\r\n        (o: any) => o.id === offerId\r\n      );\r\n\r\n      expect(completedOffer.status).toBe('completed');\r\n    });\r\n  });\r\n\r\n  describe('Offer Expiration', () => {\r\n    it('should expire offers after duration', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      const offers = response.body.data.offers;\r\n      const expiredOffers = offers.filter((o: any) => {\r\n        const expiresAt = new Date(o.expiresAt);\r\n        return expiresAt < new Date();\r\n      });\r\n\r\n      // Check that expired offers are marked as expired\r\n      for (const offer of expiredOffers) {\r\n        expect(offer.status).toBe('expired');\r\n      }\r\n    });\r\n\r\n    it('should prevent accepting expired offers', async () => {\r\n      const offersResponse = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${studentId}`);\r\n\r\n      const expiredOffer = offersResponse.body.data.offers.find(\r\n        (o: any) => o.status === 'expired'\r\n      );\r\n\r\n      if (expiredOffer) {\r\n        const response = await request(BASE_URL)\r\n          .post(`/api/v1/conversions/accept`)\r\n          .send({\r\n            studentId,\r\n            offerId: expiredOffer.id,\r\n          });\r\n\r\n        expect(response.status).toBe(400);\r\n        expect(response.body.error).toContain('expired');\r\n      }\r\n    });\r\n  });\r\n\r\n  describe('Conversion Metrics', () => {\r\n    it('should track conversion rate', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/analytics/conversion/metrics`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.data).toHaveProperty('conversionRate');\r\n      expect(response.body.data.conversionRate).toBeGreaterThanOrEqual(0);\r\n      expect(response.body.data.conversionRate).toBeLessThanOrEqual(100);\r\n    });\r\n\r\n    it('should track offer acceptance rate', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/analytics/conversion/metrics`);\r\n\r\n      expect(response.body.data).toHaveProperty('offerAcceptanceRate');\r\n      expect(response.body.data.offerAcceptanceRate).toBeGreaterThanOrEqual(0);\r\n    });\r\n\r\n    it('should track revenue from conversions', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/analytics/conversion/metrics`);\r\n\r\n      expect(response.body.data).toHaveProperty('conversionRevenue');\r\n      expect(response.body.data.conversionRevenue).toBeGreaterThanOrEqual(0);\r\n    });\r\n\r\n    it('should calculate customer lifetime value', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/analytics/conversion/metrics`);\r\n\r\n      expect(response.body.data).toHaveProperty('averageLifetimeValue');\r\n      expect(response.body.data.averageLifetimeValue).toBeGreaterThanOrEqual(0);\r\n    });\r\n\r\n    it('should track offer performance by type', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/analytics/conversion/metrics`);\r\n\r\n      expect(response.body.data).toHaveProperty('offerPerformance');\r\n      expect(response.body.data.offerPerformance).toHaveProperty('upgrade_discount');\r\n      expect(response.body.data.offerPerformance).toHaveProperty('premium_trial');\r\n    });\r\n  });\r\n\r\n  describe('Churn Prevention', () => {\r\n    let churnStudentId: string;\r\n\r\n    beforeAll(async () => {\r\n      const studentResponse = await request(BASE_URL)\r\n        .post('/api/v1/enrollments')\r\n        .send({\r\n          email: 'churn-test@example.com',\r\n          name: 'Churn Test',\r\n          tier: 'free',\r\n        });\r\n\r\n      churnStudentId = studentResponse.body.data.id;\r\n    });\r\n\r\n    it('should identify at-risk students', async () => {\r\n      // Simulate low engagement\r\n      const enrollmentResponse = await request(BASE_URL)\r\n        .post(`/api/v1/enrollments/${churnStudentId}/courses`)\r\n        .send({\r\n          courseId,\r\n        });\r\n\r\n      const enrollmentId = enrollmentResponse.body.data.id;\r\n\r\n      // Mark as dropped\r\n      await request(BASE_URL)\r\n        .put(`/api/v1/enrollments/${enrollmentId}`)\r\n        .send({\r\n          status: 'dropped',\r\n        });\r\n\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/analytics/cohort/${courseId}`);\r\n\r\n      expect(response.body.data).toHaveProperty('atRiskStudents');\r\n    });\r\n\r\n    it('should provide retention offers for at-risk students', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${churnStudentId}`);\r\n\r\n      const retentionOffers = response.body.data.offers.filter(\r\n        (o: any) => o.type === 'retention'\r\n      );\r\n\r\n      expect(retentionOffers.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('Multi-Tier Conversion Path', () => {\r\n    let multiTierStudentId: string;\r\n\r\n    beforeAll(async () => {\r\n      const studentResponse = await request(BASE_URL)\r\n        .post('/api/v1/enrollments')\r\n        .send({\r\n          email: 'multi-tier@example.com',\r\n          name: 'Multi Tier Test',\r\n          tier: 'free',\r\n        });\r\n\r\n      multiTierStudentId = studentResponse.body.data.id;\r\n    });\r\n\r\n    it('should upgrade from free to premium', async () => {\r\n      const enrollmentResponse = await request(BASE_URL)\r\n        .post(`/api/v1/enrollments/${multiTierStudentId}/courses`)\r\n        .send({\r\n          courseId,\r\n        });\r\n\r\n      const enrollmentId = enrollmentResponse.body.data.id;\r\n\r\n      // Trigger conversion\r\n      await request(BASE_URL)\r\n        .put(`/api/v1/enrollments/${enrollmentId}/progress`)\r\n        .send({\r\n          percentComplete: 40,\r\n        });\r\n\r\n      // Accept offer\r\n      const offersResponse = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${multiTierStudentId}`);\r\n\r\n      const offerId = offersResponse.body.data.offers[0].id;\r\n\r\n      await request(BASE_URL)\r\n        .post(`/api/v1/conversions/accept`)\r\n        .send({\r\n          studentId: multiTierStudentId,\r\n          offerId,\r\n        });\r\n\r\n      // Process payment\r\n      await request(BASE_URL)\r\n        .post(`/api/v1/payments/process`)\r\n        .send({\r\n          studentId: multiTierStudentId,\r\n          offerId,\r\n          paymentMethod: 'stripe',\r\n          tier: 'premium',\r\n        });\r\n\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/enrollments/${multiTierStudentId}`);\r\n\r\n      expect(response.body.data.tier).toBe('premium');\r\n    });\r\n\r\n    it('should offer pro tier upgrade to premium students', async () => {\r\n      const response = await request(BASE_URL)\r\n        .get(`/api/v1/conversions/${multiTierStudentId}`);\r\n\r\n      const proOffers = response.body.data.offers.filter(\r\n        (o: any) => o.tier === 'pro'\r\n      );\r\n\r\n      expect(proOffers.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}