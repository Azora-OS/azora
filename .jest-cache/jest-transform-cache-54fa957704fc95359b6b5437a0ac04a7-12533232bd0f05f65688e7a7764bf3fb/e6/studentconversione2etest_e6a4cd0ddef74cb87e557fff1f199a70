9d4a04a42f34609c3f20c58f2a5022ed
"use strict";

var _supertest = _interopRequireDefault(require("supertest"));
var _client = require("@prisma/client");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
/**
 * End-to-End Student Conversion Tests
 * Tests conversion offer flow and tier upgrades
 */

const BASE_URL = process.env.API_URL || 'http://localhost:3020';
const prisma = new _client.PrismaClient();
describe('E2E: Student Conversion Flow', () => {
  let courseId;
  let studentId;
  let enrollmentId;
  beforeAll(async () => {
    // Create test course
    const courseResponse = await (0, _supertest.default)(BASE_URL).post('/api/v1/courses').send({
      title: 'Conversion Test Course',
      description: 'Course for conversion testing',
      tier: 'free',
      instructorId: 'test-instructor',
      language: 'en'
    });
    courseId = courseResponse.body.data.id;

    // Create free student
    const studentResponse = await (0, _supertest.default)(BASE_URL).post('/api/v1/enrollments').send({
      email: 'conversion-test@example.com',
      name: 'Conversion Test',
      tier: 'free'
    });
    studentId = studentResponse.body.data.id;

    // Enroll in course
    const enrollmentResponse = await (0, _supertest.default)(BASE_URL).post(`/api/v1/enrollments/${studentId}/courses`).send({
      courseId
    });
    enrollmentId = enrollmentResponse.body.data.id;
  });
  afterAll(async () => {
    await prisma.$disconnect();
  });
  describe('Conversion Trigger Events', () => {
    it('should trigger conversion at module completion (40%)', async () => {
      await (0, _supertest.default)(BASE_URL).put(`/api/v1/enrollments/${enrollmentId}/progress`).send({
        moduleId: 'module-1',
        percentComplete: 40
      });
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      expect(response.status).toBe(200);
      expect(response.body.data.offers.length).toBeGreaterThan(0);
    });
    it('should trigger conversion on assessment pass', async () => {
      const response = await (0, _supertest.default)(BASE_URL).post(`/api/v1/assessments/submit`).send({
        enrollmentId,
        courseId,
        answers: [{
          questionId: 'q1',
          answer: 'correct'
        }, {
          questionId: 'q2',
          answer: 'correct'
        }]
      });
      expect(response.status).toBe(201);
      expect(response.body.data.passed).toBe(true);

      // Check for conversion offer
      const conversionResponse = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      expect(conversionResponse.body.data.offers.length).toBeGreaterThan(0);
    });
    it('should trigger conversion on course completion', async () => {
      await (0, _supertest.default)(BASE_URL).put(`/api/v1/enrollments/${enrollmentId}`).send({
        status: 'completed'
      });
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      expect(response.status).toBe(200);
      expect(response.body.data.offers.length).toBeGreaterThan(0);
    });
  });
  describe('Conversion Offer Types', () => {
    it('should provide upgrade discount offer', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      const upgradeOffer = response.body.data.offers.find(o => o.type === 'upgrade_discount');
      expect(upgradeOffer).toBeDefined();
      expect(upgradeOffer.discount).toBeGreaterThan(0);
      expect(upgradeOffer.tier).toBe('premium');
      expect(upgradeOffer.expiresAt).toBeDefined();
    });
    it('should provide premium trial offer', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      const trialOffer = response.body.data.offers.find(o => o.type === 'premium_trial');
      if (trialOffer) {
        expect(trialOffer.duration).toBeGreaterThan(0);
        expect(trialOffer.tier).toBe('premium');
      }
    });
    it('should provide bundle deal offer', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      const bundleOffer = response.body.data.offers.find(o => o.type === 'bundle_deal');
      if (bundleOffer) {
        expect(bundleOffer.courses).toBeDefined();
        expect(bundleOffer.discount).toBeGreaterThan(0);
      }
    });
  });
  describe('Offer Acceptance and Payment', () => {
    let offerId;
    it('should accept conversion offer', async () => {
      const offersResponse = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      offerId = offersResponse.body.data.offers[0].id;
      const response = await (0, _supertest.default)(BASE_URL).post(`/api/v1/conversions/accept`).send({
        studentId,
        offerId
      });
      expect(response.status).toBe(200);
      expect(response.body.data.status).toBe('accepted');
    });
    it('should calculate discounted price', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/pricing/tiers/premium`);
      const basePrice = response.body.data.price;
      const discountedPrice = basePrice * 0.5; // 50% discount

      expect(discountedPrice).toBeLessThan(basePrice);
    });
    it('should process payment with discount', async () => {
      const response = await (0, _supertest.default)(BASE_URL).post(`/api/v1/payments/process`).send({
        studentId,
        offerId,
        paymentMethod: 'stripe',
        tier: 'premium'
      });
      expect(response.status).toBe(201);
      expect(response.body.data.status).toBe('completed');
      expect(response.body.data).toHaveProperty('transactionId');
    });
    it('should upgrade student tier after payment', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/enrollments/${studentId}`);
      expect(response.status).toBe(200);
      expect(response.body.data.tier).toBe('premium');
    });
    it('should mark offer as completed', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      const completedOffer = response.body.data.offers.find(o => o.id === offerId);
      expect(completedOffer.status).toBe('completed');
    });
  });
  describe('Offer Expiration', () => {
    it('should expire offers after duration', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      const offers = response.body.data.offers;
      const expiredOffers = offers.filter(o => {
        const expiresAt = new Date(o.expiresAt);
        return expiresAt < new Date();
      });

      // Check that expired offers are marked as expired
      for (const offer of expiredOffers) {
        expect(offer.status).toBe('expired');
      }
    });
    it('should prevent accepting expired offers', async () => {
      const offersResponse = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${studentId}`);
      const expiredOffer = offersResponse.body.data.offers.find(o => o.status === 'expired');
      if (expiredOffer) {
        const response = await (0, _supertest.default)(BASE_URL).post(`/api/v1/conversions/accept`).send({
          studentId,
          offerId: expiredOffer.id
        });
        expect(response.status).toBe(400);
        expect(response.body.error).toContain('expired');
      }
    });
  });
  describe('Conversion Metrics', () => {
    it('should track conversion rate', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/analytics/conversion/metrics`);
      expect(response.status).toBe(200);
      expect(response.body.data).toHaveProperty('conversionRate');
      expect(response.body.data.conversionRate).toBeGreaterThanOrEqual(0);
      expect(response.body.data.conversionRate).toBeLessThanOrEqual(100);
    });
    it('should track offer acceptance rate', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/analytics/conversion/metrics`);
      expect(response.body.data).toHaveProperty('offerAcceptanceRate');
      expect(response.body.data.offerAcceptanceRate).toBeGreaterThanOrEqual(0);
    });
    it('should track revenue from conversions', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/analytics/conversion/metrics`);
      expect(response.body.data).toHaveProperty('conversionRevenue');
      expect(response.body.data.conversionRevenue).toBeGreaterThanOrEqual(0);
    });
    it('should calculate customer lifetime value', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/analytics/conversion/metrics`);
      expect(response.body.data).toHaveProperty('averageLifetimeValue');
      expect(response.body.data.averageLifetimeValue).toBeGreaterThanOrEqual(0);
    });
    it('should track offer performance by type', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/analytics/conversion/metrics`);
      expect(response.body.data).toHaveProperty('offerPerformance');
      expect(response.body.data.offerPerformance).toHaveProperty('upgrade_discount');
      expect(response.body.data.offerPerformance).toHaveProperty('premium_trial');
    });
  });
  describe('Churn Prevention', () => {
    let churnStudentId;
    beforeAll(async () => {
      const studentResponse = await (0, _supertest.default)(BASE_URL).post('/api/v1/enrollments').send({
        email: 'churn-test@example.com',
        name: 'Churn Test',
        tier: 'free'
      });
      churnStudentId = studentResponse.body.data.id;
    });
    it('should identify at-risk students', async () => {
      // Simulate low engagement
      const enrollmentResponse = await (0, _supertest.default)(BASE_URL).post(`/api/v1/enrollments/${churnStudentId}/courses`).send({
        courseId
      });
      const enrollmentId = enrollmentResponse.body.data.id;

      // Mark as dropped
      await (0, _supertest.default)(BASE_URL).put(`/api/v1/enrollments/${enrollmentId}`).send({
        status: 'dropped'
      });
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/analytics/cohort/${courseId}`);
      expect(response.body.data).toHaveProperty('atRiskStudents');
    });
    it('should provide retention offers for at-risk students', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${churnStudentId}`);
      const retentionOffers = response.body.data.offers.filter(o => o.type === 'retention');
      expect(retentionOffers.length).toBeGreaterThan(0);
    });
  });
  describe('Multi-Tier Conversion Path', () => {
    let multiTierStudentId;
    beforeAll(async () => {
      const studentResponse = await (0, _supertest.default)(BASE_URL).post('/api/v1/enrollments').send({
        email: 'multi-tier@example.com',
        name: 'Multi Tier Test',
        tier: 'free'
      });
      multiTierStudentId = studentResponse.body.data.id;
    });
    it('should upgrade from free to premium', async () => {
      const enrollmentResponse = await (0, _supertest.default)(BASE_URL).post(`/api/v1/enrollments/${multiTierStudentId}/courses`).send({
        courseId
      });
      const enrollmentId = enrollmentResponse.body.data.id;

      // Trigger conversion
      await (0, _supertest.default)(BASE_URL).put(`/api/v1/enrollments/${enrollmentId}/progress`).send({
        percentComplete: 40
      });

      // Accept offer
      const offersResponse = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${multiTierStudentId}`);
      const offerId = offersResponse.body.data.offers[0].id;
      await (0, _supertest.default)(BASE_URL).post(`/api/v1/conversions/accept`).send({
        studentId: multiTierStudentId,
        offerId
      });

      // Process payment
      await (0, _supertest.default)(BASE_URL).post(`/api/v1/payments/process`).send({
        studentId: multiTierStudentId,
        offerId,
        paymentMethod: 'stripe',
        tier: 'premium'
      });
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/enrollments/${multiTierStudentId}`);
      expect(response.body.data.tier).toBe('premium');
    });
    it('should offer pro tier upgrade to premium students', async () => {
      const response = await (0, _supertest.default)(BASE_URL).get(`/api/v1/conversions/${multiTierStudentId}`);
      const proOffers = response.body.data.offers.filter(o => o.tier === 'pro');
      expect(proOffers.length).toBeGreaterThan(0);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc3VwZXJ0ZXN0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfY2xpZW50IiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiQkFTRV9VUkwiLCJwcm9jZXNzIiwiZW52IiwiQVBJX1VSTCIsInByaXNtYSIsIlByaXNtYUNsaWVudCIsImRlc2NyaWJlIiwiY291cnNlSWQiLCJzdHVkZW50SWQiLCJlbnJvbGxtZW50SWQiLCJiZWZvcmVBbGwiLCJjb3Vyc2VSZXNwb25zZSIsInJlcXVlc3QiLCJwb3N0Iiwic2VuZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJ0aWVyIiwiaW5zdHJ1Y3RvcklkIiwibGFuZ3VhZ2UiLCJib2R5IiwiZGF0YSIsImlkIiwic3R1ZGVudFJlc3BvbnNlIiwiZW1haWwiLCJuYW1lIiwiZW5yb2xsbWVudFJlc3BvbnNlIiwiYWZ0ZXJBbGwiLCIkZGlzY29ubmVjdCIsIml0IiwicHV0IiwibW9kdWxlSWQiLCJwZXJjZW50Q29tcGxldGUiLCJyZXNwb25zZSIsImdldCIsImV4cGVjdCIsInN0YXR1cyIsInRvQmUiLCJvZmZlcnMiLCJsZW5ndGgiLCJ0b0JlR3JlYXRlclRoYW4iLCJhbnN3ZXJzIiwicXVlc3Rpb25JZCIsImFuc3dlciIsInBhc3NlZCIsImNvbnZlcnNpb25SZXNwb25zZSIsInVwZ3JhZGVPZmZlciIsImZpbmQiLCJvIiwidHlwZSIsInRvQmVEZWZpbmVkIiwiZGlzY291bnQiLCJleHBpcmVzQXQiLCJ0cmlhbE9mZmVyIiwiZHVyYXRpb24iLCJidW5kbGVPZmZlciIsImNvdXJzZXMiLCJvZmZlcklkIiwib2ZmZXJzUmVzcG9uc2UiLCJiYXNlUHJpY2UiLCJwcmljZSIsImRpc2NvdW50ZWRQcmljZSIsInRvQmVMZXNzVGhhbiIsInBheW1lbnRNZXRob2QiLCJ0b0hhdmVQcm9wZXJ0eSIsImNvbXBsZXRlZE9mZmVyIiwiZXhwaXJlZE9mZmVycyIsImZpbHRlciIsIkRhdGUiLCJvZmZlciIsImV4cGlyZWRPZmZlciIsImVycm9yIiwidG9Db250YWluIiwiY29udmVyc2lvblJhdGUiLCJ0b0JlR3JlYXRlclRoYW5PckVxdWFsIiwidG9CZUxlc3NUaGFuT3JFcXVhbCIsIm9mZmVyQWNjZXB0YW5jZVJhdGUiLCJjb252ZXJzaW9uUmV2ZW51ZSIsImF2ZXJhZ2VMaWZldGltZVZhbHVlIiwib2ZmZXJQZXJmb3JtYW5jZSIsImNodXJuU3R1ZGVudElkIiwicmV0ZW50aW9uT2ZmZXJzIiwibXVsdGlUaWVyU3R1ZGVudElkIiwicHJvT2ZmZXJzIl0sInNvdXJjZXMiOlsic3R1ZGVudC1jb252ZXJzaW9uLmUyZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBFbmQtdG8tRW5kIFN0dWRlbnQgQ29udmVyc2lvbiBUZXN0c1xyXG4gKiBUZXN0cyBjb252ZXJzaW9uIG9mZmVyIGZsb3cgYW5kIHRpZXIgdXBncmFkZXNcclxuICovXHJcblxyXG5pbXBvcnQgcmVxdWVzdCBmcm9tICdzdXBlcnRlc3QnO1xyXG5pbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XHJcblxyXG5jb25zdCBCQVNFX1VSTCA9IHByb2Nlc3MuZW52LkFQSV9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAyMCc7XHJcbmNvbnN0IHByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKTtcclxuXHJcbmRlc2NyaWJlKCdFMkU6IFN0dWRlbnQgQ29udmVyc2lvbiBGbG93JywgKCkgPT4ge1xyXG4gIGxldCBjb3Vyc2VJZDogc3RyaW5nO1xyXG4gIGxldCBzdHVkZW50SWQ6IHN0cmluZztcclxuICBsZXQgZW5yb2xsbWVudElkOiBzdHJpbmc7XHJcblxyXG4gIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XHJcbiAgICAvLyBDcmVhdGUgdGVzdCBjb3Vyc2VcclxuICAgIGNvbnN0IGNvdXJzZVJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgLnBvc3QoJy9hcGkvdjEvY291cnNlcycpXHJcbiAgICAgIC5zZW5kKHtcclxuICAgICAgICB0aXRsZTogJ0NvbnZlcnNpb24gVGVzdCBDb3Vyc2UnLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ291cnNlIGZvciBjb252ZXJzaW9uIHRlc3RpbmcnLFxyXG4gICAgICAgIHRpZXI6ICdmcmVlJyxcclxuICAgICAgICBpbnN0cnVjdG9ySWQ6ICd0ZXN0LWluc3RydWN0b3InLFxyXG4gICAgICAgIGxhbmd1YWdlOiAnZW4nLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICBjb3Vyc2VJZCA9IGNvdXJzZVJlc3BvbnNlLmJvZHkuZGF0YS5pZDtcclxuXHJcbiAgICAvLyBDcmVhdGUgZnJlZSBzdHVkZW50XHJcbiAgICBjb25zdCBzdHVkZW50UmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAucG9zdCgnL2FwaS92MS9lbnJvbGxtZW50cycpXHJcbiAgICAgIC5zZW5kKHtcclxuICAgICAgICBlbWFpbDogJ2NvbnZlcnNpb24tdGVzdEBleGFtcGxlLmNvbScsXHJcbiAgICAgICAgbmFtZTogJ0NvbnZlcnNpb24gVGVzdCcsXHJcbiAgICAgICAgdGllcjogJ2ZyZWUnLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICBzdHVkZW50SWQgPSBzdHVkZW50UmVzcG9uc2UuYm9keS5kYXRhLmlkO1xyXG5cclxuICAgIC8vIEVucm9sbCBpbiBjb3Vyc2VcclxuICAgIGNvbnN0IGVucm9sbG1lbnRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgIC5wb3N0KGAvYXBpL3YxL2Vucm9sbG1lbnRzLyR7c3R1ZGVudElkfS9jb3Vyc2VzYClcclxuICAgICAgLnNlbmQoe1xyXG4gICAgICAgIGNvdXJzZUlkLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICBlbnJvbGxtZW50SWQgPSBlbnJvbGxtZW50UmVzcG9uc2UuYm9keS5kYXRhLmlkO1xyXG4gIH0pO1xyXG5cclxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBwcmlzbWEuJGRpc2Nvbm5lY3QoKTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0NvbnZlcnNpb24gVHJpZ2dlciBFdmVudHMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHRyaWdnZXIgY29udmVyc2lvbiBhdCBtb2R1bGUgY29tcGxldGlvbiAoNDAlKScsIGFzeW5jICgpID0+IHtcclxuICAgICAgYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAucHV0KGAvYXBpL3YxL2Vucm9sbG1lbnRzLyR7ZW5yb2xsbWVudElkfS9wcm9ncmVzc2ApXHJcbiAgICAgICAgLnNlbmQoe1xyXG4gICAgICAgICAgbW9kdWxlSWQ6ICdtb2R1bGUtMScsXHJcbiAgICAgICAgICBwZXJjZW50Q29tcGxldGU6IDQwLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5nZXQoYC9hcGkvdjEvY29udmVyc2lvbnMvJHtzdHVkZW50SWR9YCk7XHJcblxyXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEub2ZmZXJzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB0cmlnZ2VyIGNvbnZlcnNpb24gb24gYXNzZXNzbWVudCBwYXNzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnBvc3QoYC9hcGkvdjEvYXNzZXNzbWVudHMvc3VibWl0YClcclxuICAgICAgICAuc2VuZCh7XHJcbiAgICAgICAgICBlbnJvbGxtZW50SWQsXHJcbiAgICAgICAgICBjb3Vyc2VJZCxcclxuICAgICAgICAgIGFuc3dlcnM6IFtcclxuICAgICAgICAgICAgeyBxdWVzdGlvbklkOiAncTEnLCBhbnN3ZXI6ICdjb3JyZWN0JyB9LFxyXG4gICAgICAgICAgICB7IHF1ZXN0aW9uSWQ6ICdxMicsIGFuc3dlcjogJ2NvcnJlY3QnIH0sXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDEpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLnBhc3NlZCkudG9CZSh0cnVlKTtcclxuXHJcbiAgICAgIC8vIENoZWNrIGZvciBjb252ZXJzaW9uIG9mZmVyXHJcbiAgICAgIGNvbnN0IGNvbnZlcnNpb25SZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLmdldChgL2FwaS92MS9jb252ZXJzaW9ucy8ke3N0dWRlbnRJZH1gKTtcclxuXHJcbiAgICAgIGV4cGVjdChjb252ZXJzaW9uUmVzcG9uc2UuYm9keS5kYXRhLm9mZmVycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdHJpZ2dlciBjb252ZXJzaW9uIG9uIGNvdXJzZSBjb21wbGV0aW9uJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5wdXQoYC9hcGkvdjEvZW5yb2xsbWVudHMvJHtlbnJvbGxtZW50SWR9YClcclxuICAgICAgICAuc2VuZCh7XHJcbiAgICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5nZXQoYC9hcGkvdjEvY29udmVyc2lvbnMvJHtzdHVkZW50SWR9YCk7XHJcblxyXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEub2ZmZXJzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdDb252ZXJzaW9uIE9mZmVyIFR5cGVzJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIHVwZ3JhZGUgZGlzY291bnQgb2ZmZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2NvbnZlcnNpb25zLyR7c3R1ZGVudElkfWApO1xyXG5cclxuICAgICAgY29uc3QgdXBncmFkZU9mZmVyID0gcmVzcG9uc2UuYm9keS5kYXRhLm9mZmVycy5maW5kKFxyXG4gICAgICAgIChvOiBhbnkpID0+IG8udHlwZSA9PT0gJ3VwZ3JhZGVfZGlzY291bnQnXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3QodXBncmFkZU9mZmVyKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QodXBncmFkZU9mZmVyLmRpc2NvdW50KS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIGV4cGVjdCh1cGdyYWRlT2ZmZXIudGllcikudG9CZSgncHJlbWl1bScpO1xyXG4gICAgICBleHBlY3QodXBncmFkZU9mZmVyLmV4cGlyZXNBdCkudG9CZURlZmluZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcHJvdmlkZSBwcmVtaXVtIHRyaWFsIG9mZmVyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLmdldChgL2FwaS92MS9jb252ZXJzaW9ucy8ke3N0dWRlbnRJZH1gKTtcclxuXHJcbiAgICAgIGNvbnN0IHRyaWFsT2ZmZXIgPSByZXNwb25zZS5ib2R5LmRhdGEub2ZmZXJzLmZpbmQoXHJcbiAgICAgICAgKG86IGFueSkgPT4gby50eXBlID09PSAncHJlbWl1bV90cmlhbCdcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmICh0cmlhbE9mZmVyKSB7XHJcbiAgICAgICAgZXhwZWN0KHRyaWFsT2ZmZXIuZHVyYXRpb24pLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgICAgICBleHBlY3QodHJpYWxPZmZlci50aWVyKS50b0JlKCdwcmVtaXVtJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcHJvdmlkZSBidW5kbGUgZGVhbCBvZmZlcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5nZXQoYC9hcGkvdjEvY29udmVyc2lvbnMvJHtzdHVkZW50SWR9YCk7XHJcblxyXG4gICAgICBjb25zdCBidW5kbGVPZmZlciA9IHJlc3BvbnNlLmJvZHkuZGF0YS5vZmZlcnMuZmluZChcclxuICAgICAgICAobzogYW55KSA9PiBvLnR5cGUgPT09ICdidW5kbGVfZGVhbCdcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmIChidW5kbGVPZmZlcikge1xyXG4gICAgICAgIGV4cGVjdChidW5kbGVPZmZlci5jb3Vyc2VzKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgIGV4cGVjdChidW5kbGVPZmZlci5kaXNjb3VudCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ09mZmVyIEFjY2VwdGFuY2UgYW5kIFBheW1lbnQnLCAoKSA9PiB7XHJcbiAgICBsZXQgb2ZmZXJJZDogc3RyaW5nO1xyXG5cclxuICAgIGl0KCdzaG91bGQgYWNjZXB0IGNvbnZlcnNpb24gb2ZmZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG9mZmVyc1Jlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2NvbnZlcnNpb25zLyR7c3R1ZGVudElkfWApO1xyXG5cclxuICAgICAgb2ZmZXJJZCA9IG9mZmVyc1Jlc3BvbnNlLmJvZHkuZGF0YS5vZmZlcnNbMF0uaWQ7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnBvc3QoYC9hcGkvdjEvY29udmVyc2lvbnMvYWNjZXB0YClcclxuICAgICAgICAuc2VuZCh7XHJcbiAgICAgICAgICBzdHVkZW50SWQsXHJcbiAgICAgICAgICBvZmZlcklkLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLnN0YXR1cykudG9CZSgnYWNjZXB0ZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIGRpc2NvdW50ZWQgcHJpY2UnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL3ByaWNpbmcvdGllcnMvcHJlbWl1bWApO1xyXG5cclxuICAgICAgY29uc3QgYmFzZVByaWNlID0gcmVzcG9uc2UuYm9keS5kYXRhLnByaWNlO1xyXG4gICAgICBjb25zdCBkaXNjb3VudGVkUHJpY2UgPSBiYXNlUHJpY2UgKiAwLjU7IC8vIDUwJSBkaXNjb3VudFxyXG5cclxuICAgICAgZXhwZWN0KGRpc2NvdW50ZWRQcmljZSkudG9CZUxlc3NUaGFuKGJhc2VQcmljZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHByb2Nlc3MgcGF5bWVudCB3aXRoIGRpc2NvdW50JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnBvc3QoYC9hcGkvdjEvcGF5bWVudHMvcHJvY2Vzc2ApXHJcbiAgICAgICAgLnNlbmQoe1xyXG4gICAgICAgICAgc3R1ZGVudElkLFxyXG4gICAgICAgICAgb2ZmZXJJZCxcclxuICAgICAgICAgIHBheW1lbnRNZXRob2Q6ICdzdHJpcGUnLFxyXG4gICAgICAgICAgdGllcjogJ3ByZW1pdW0nLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDEpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLnN0YXR1cykudG9CZSgnY29tcGxldGVkJyk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEpLnRvSGF2ZVByb3BlcnR5KCd0cmFuc2FjdGlvbklkJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHVwZ3JhZGUgc3R1ZGVudCB0aWVyIGFmdGVyIHBheW1lbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2Vucm9sbG1lbnRzLyR7c3R1ZGVudElkfWApO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLnRpZXIpLnRvQmUoJ3ByZW1pdW0nKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgbWFyayBvZmZlciBhcyBjb21wbGV0ZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2NvbnZlcnNpb25zLyR7c3R1ZGVudElkfWApO1xyXG5cclxuICAgICAgY29uc3QgY29tcGxldGVkT2ZmZXIgPSByZXNwb25zZS5ib2R5LmRhdGEub2ZmZXJzLmZpbmQoXHJcbiAgICAgICAgKG86IGFueSkgPT4gby5pZCA9PT0gb2ZmZXJJZFxyXG4gICAgICApO1xyXG5cclxuICAgICAgZXhwZWN0KGNvbXBsZXRlZE9mZmVyLnN0YXR1cykudG9CZSgnY29tcGxldGVkJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ09mZmVyIEV4cGlyYXRpb24nLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGV4cGlyZSBvZmZlcnMgYWZ0ZXIgZHVyYXRpb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2NvbnZlcnNpb25zLyR7c3R1ZGVudElkfWApO1xyXG5cclxuICAgICAgY29uc3Qgb2ZmZXJzID0gcmVzcG9uc2UuYm9keS5kYXRhLm9mZmVycztcclxuICAgICAgY29uc3QgZXhwaXJlZE9mZmVycyA9IG9mZmVycy5maWx0ZXIoKG86IGFueSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGV4cGlyZXNBdCA9IG5ldyBEYXRlKG8uZXhwaXJlc0F0KTtcclxuICAgICAgICByZXR1cm4gZXhwaXJlc0F0IDwgbmV3IERhdGUoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBDaGVjayB0aGF0IGV4cGlyZWQgb2ZmZXJzIGFyZSBtYXJrZWQgYXMgZXhwaXJlZFxyXG4gICAgICBmb3IgKGNvbnN0IG9mZmVyIG9mIGV4cGlyZWRPZmZlcnMpIHtcclxuICAgICAgICBleHBlY3Qob2ZmZXIuc3RhdHVzKS50b0JlKCdleHBpcmVkJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcHJldmVudCBhY2NlcHRpbmcgZXhwaXJlZCBvZmZlcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG9mZmVyc1Jlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2NvbnZlcnNpb25zLyR7c3R1ZGVudElkfWApO1xyXG5cclxuICAgICAgY29uc3QgZXhwaXJlZE9mZmVyID0gb2ZmZXJzUmVzcG9uc2UuYm9keS5kYXRhLm9mZmVycy5maW5kKFxyXG4gICAgICAgIChvOiBhbnkpID0+IG8uc3RhdHVzID09PSAnZXhwaXJlZCdcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmIChleHBpcmVkT2ZmZXIpIHtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgICAucG9zdChgL2FwaS92MS9jb252ZXJzaW9ucy9hY2NlcHRgKVxyXG4gICAgICAgICAgLnNlbmQoe1xyXG4gICAgICAgICAgICBzdHVkZW50SWQsXHJcbiAgICAgICAgICAgIG9mZmVySWQ6IGV4cGlyZWRPZmZlci5pZCxcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbignZXhwaXJlZCcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0NvbnZlcnNpb24gTWV0cmljcycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgdHJhY2sgY29udmVyc2lvbiByYXRlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLmdldChgL2FwaS92MS9hbmFseXRpY3MvY29udmVyc2lvbi9tZXRyaWNzYCk7XHJcblxyXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEpLnRvSGF2ZVByb3BlcnR5KCdjb252ZXJzaW9uUmF0ZScpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLmNvbnZlcnNpb25SYXRlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLmNvbnZlcnNpb25SYXRlKS50b0JlTGVzc1RoYW5PckVxdWFsKDEwMCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHRyYWNrIG9mZmVyIGFjY2VwdGFuY2UgcmF0ZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5nZXQoYC9hcGkvdjEvYW5hbHl0aWNzL2NvbnZlcnNpb24vbWV0cmljc2ApO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YSkudG9IYXZlUHJvcGVydHkoJ29mZmVyQWNjZXB0YW5jZVJhdGUnKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YS5vZmZlckFjY2VwdGFuY2VSYXRlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB0cmFjayByZXZlbnVlIGZyb20gY29udmVyc2lvbnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2FuYWx5dGljcy9jb252ZXJzaW9uL21ldHJpY3NgKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEpLnRvSGF2ZVByb3BlcnR5KCdjb252ZXJzaW9uUmV2ZW51ZScpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLmNvbnZlcnNpb25SZXZlbnVlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgY3VzdG9tZXIgbGlmZXRpbWUgdmFsdWUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2FuYWx5dGljcy9jb252ZXJzaW9uL21ldHJpY3NgKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEpLnRvSGF2ZVByb3BlcnR5KCdhdmVyYWdlTGlmZXRpbWVWYWx1ZScpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLmF2ZXJhZ2VMaWZldGltZVZhbHVlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB0cmFjayBvZmZlciBwZXJmb3JtYW5jZSBieSB0eXBlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLmdldChgL2FwaS92MS9hbmFseXRpY3MvY29udmVyc2lvbi9tZXRyaWNzYCk7XHJcblxyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhKS50b0hhdmVQcm9wZXJ0eSgnb2ZmZXJQZXJmb3JtYW5jZScpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLm9mZmVyUGVyZm9ybWFuY2UpLnRvSGF2ZVByb3BlcnR5KCd1cGdyYWRlX2Rpc2NvdW50Jyk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEub2ZmZXJQZXJmb3JtYW5jZSkudG9IYXZlUHJvcGVydHkoJ3ByZW1pdW1fdHJpYWwnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnQ2h1cm4gUHJldmVudGlvbicsICgpID0+IHtcclxuICAgIGxldCBjaHVyblN0dWRlbnRJZDogc3RyaW5nO1xyXG5cclxuICAgIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHN0dWRlbnRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnBvc3QoJy9hcGkvdjEvZW5yb2xsbWVudHMnKVxyXG4gICAgICAgIC5zZW5kKHtcclxuICAgICAgICAgIGVtYWlsOiAnY2h1cm4tdGVzdEBleGFtcGxlLmNvbScsXHJcbiAgICAgICAgICBuYW1lOiAnQ2h1cm4gVGVzdCcsXHJcbiAgICAgICAgICB0aWVyOiAnZnJlZScsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICBjaHVyblN0dWRlbnRJZCA9IHN0dWRlbnRSZXNwb25zZS5ib2R5LmRhdGEuaWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IGF0LXJpc2sgc3R1ZGVudHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIFNpbXVsYXRlIGxvdyBlbmdhZ2VtZW50XHJcbiAgICAgIGNvbnN0IGVucm9sbG1lbnRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnBvc3QoYC9hcGkvdjEvZW5yb2xsbWVudHMvJHtjaHVyblN0dWRlbnRJZH0vY291cnNlc2ApXHJcbiAgICAgICAgLnNlbmQoe1xyXG4gICAgICAgICAgY291cnNlSWQsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBlbnJvbGxtZW50SWQgPSBlbnJvbGxtZW50UmVzcG9uc2UuYm9keS5kYXRhLmlkO1xyXG5cclxuICAgICAgLy8gTWFyayBhcyBkcm9wcGVkXHJcbiAgICAgIGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnB1dChgL2FwaS92MS9lbnJvbGxtZW50cy8ke2Vucm9sbG1lbnRJZH1gKVxyXG4gICAgICAgIC5zZW5kKHtcclxuICAgICAgICAgIHN0YXR1czogJ2Ryb3BwZWQnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5nZXQoYC9hcGkvdjEvYW5hbHl0aWNzL2NvaG9ydC8ke2NvdXJzZUlkfWApO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YSkudG9IYXZlUHJvcGVydHkoJ2F0Umlza1N0dWRlbnRzJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgcmV0ZW50aW9uIG9mZmVycyBmb3IgYXQtcmlzayBzdHVkZW50cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5nZXQoYC9hcGkvdjEvY29udmVyc2lvbnMvJHtjaHVyblN0dWRlbnRJZH1gKTtcclxuXHJcbiAgICAgIGNvbnN0IHJldGVudGlvbk9mZmVycyA9IHJlc3BvbnNlLmJvZHkuZGF0YS5vZmZlcnMuZmlsdGVyKFxyXG4gICAgICAgIChvOiBhbnkpID0+IG8udHlwZSA9PT0gJ3JldGVudGlvbidcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXRlbnRpb25PZmZlcnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ011bHRpLVRpZXIgQ29udmVyc2lvbiBQYXRoJywgKCkgPT4ge1xyXG4gICAgbGV0IG11bHRpVGllclN0dWRlbnRJZDogc3RyaW5nO1xyXG5cclxuICAgIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHN0dWRlbnRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnBvc3QoJy9hcGkvdjEvZW5yb2xsbWVudHMnKVxyXG4gICAgICAgIC5zZW5kKHtcclxuICAgICAgICAgIGVtYWlsOiAnbXVsdGktdGllckBleGFtcGxlLmNvbScsXHJcbiAgICAgICAgICBuYW1lOiAnTXVsdGkgVGllciBUZXN0JyxcclxuICAgICAgICAgIHRpZXI6ICdmcmVlJyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIG11bHRpVGllclN0dWRlbnRJZCA9IHN0dWRlbnRSZXNwb25zZS5ib2R5LmRhdGEuaWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHVwZ3JhZGUgZnJvbSBmcmVlIHRvIHByZW1pdW0nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVucm9sbG1lbnRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnBvc3QoYC9hcGkvdjEvZW5yb2xsbWVudHMvJHttdWx0aVRpZXJTdHVkZW50SWR9L2NvdXJzZXNgKVxyXG4gICAgICAgIC5zZW5kKHtcclxuICAgICAgICAgIGNvdXJzZUlkLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgZW5yb2xsbWVudElkID0gZW5yb2xsbWVudFJlc3BvbnNlLmJvZHkuZGF0YS5pZDtcclxuXHJcbiAgICAgIC8vIFRyaWdnZXIgY29udmVyc2lvblxyXG4gICAgICBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5wdXQoYC9hcGkvdjEvZW5yb2xsbWVudHMvJHtlbnJvbGxtZW50SWR9L3Byb2dyZXNzYClcclxuICAgICAgICAuc2VuZCh7XHJcbiAgICAgICAgICBwZXJjZW50Q29tcGxldGU6IDQwLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gQWNjZXB0IG9mZmVyXHJcbiAgICAgIGNvbnN0IG9mZmVyc1Jlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2NvbnZlcnNpb25zLyR7bXVsdGlUaWVyU3R1ZGVudElkfWApO1xyXG5cclxuICAgICAgY29uc3Qgb2ZmZXJJZCA9IG9mZmVyc1Jlc3BvbnNlLmJvZHkuZGF0YS5vZmZlcnNbMF0uaWQ7XHJcblxyXG4gICAgICBhd2FpdCByZXF1ZXN0KEJBU0VfVVJMKVxyXG4gICAgICAgIC5wb3N0KGAvYXBpL3YxL2NvbnZlcnNpb25zL2FjY2VwdGApXHJcbiAgICAgICAgLnNlbmQoe1xyXG4gICAgICAgICAgc3R1ZGVudElkOiBtdWx0aVRpZXJTdHVkZW50SWQsXHJcbiAgICAgICAgICBvZmZlcklkLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gUHJvY2VzcyBwYXltZW50XHJcbiAgICAgIGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLnBvc3QoYC9hcGkvdjEvcGF5bWVudHMvcHJvY2Vzc2ApXHJcbiAgICAgICAgLnNlbmQoe1xyXG4gICAgICAgICAgc3R1ZGVudElkOiBtdWx0aVRpZXJTdHVkZW50SWQsXHJcbiAgICAgICAgICBvZmZlcklkLFxyXG4gICAgICAgICAgcGF5bWVudE1ldGhvZDogJ3N0cmlwZScsXHJcbiAgICAgICAgICB0aWVyOiAncHJlbWl1bScsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoQkFTRV9VUkwpXHJcbiAgICAgICAgLmdldChgL2FwaS92MS9lbnJvbGxtZW50cy8ke211bHRpVGllclN0dWRlbnRJZH1gKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEudGllcikudG9CZSgncHJlbWl1bScpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBvZmZlciBwcm8gdGllciB1cGdyYWRlIHRvIHByZW1pdW0gc3R1ZGVudHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChCQVNFX1VSTClcclxuICAgICAgICAuZ2V0KGAvYXBpL3YxL2NvbnZlcnNpb25zLyR7bXVsdGlUaWVyU3R1ZGVudElkfWApO1xyXG5cclxuICAgICAgY29uc3QgcHJvT2ZmZXJzID0gcmVzcG9uc2UuYm9keS5kYXRhLm9mZmVycy5maWx0ZXIoXHJcbiAgICAgICAgKG86IGFueSkgPT4gby50aWVyID09PSAncHJvJ1xyXG4gICAgICApO1xyXG5cclxuICAgICAgZXhwZWN0KHByb09mZmVycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sIm1hcHBp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