{"version":3,"names":["_child_process","require","_util","path","_interopRequireWildcard","fs","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","execAsync","promisify","exec","LighthouseRunner","constructor","projectRoot","historyPath","join","history","Map","initialize","cwd","console","log","loadHistory","runAudit","url","options","formFactor","throttling","onlyCategories","output","outputPath","outputFile","Date","now","mkdir","dirname","recursive","command","timeout","reportContent","readFile","rawReport","JSON","parse","report","parseReport","addToHistory","error","Error","message","categories","audits","scores","performance","Math","round","score","accessibility","bestPractices","seo","pwa","coreWebVitals","LCP","numericValue","FID","CLS","FCP","TTI","TBT","SI","recommendations","id","audit","entries","push","title","description","displayValue","numericUnit","details","sort","a","b","passed","timestamp","measureCoreWebVitals","getPerformanceScores","getRecommendations","runMultipleAudits","urls","reports","trend","length","slice","map","saveHistory","getHistory","getAllHistory","Array","from","values","getTrend","compareReports","baseline","current","scoreDiff","vitalsDiff","improved","generateHTMLReport","html","generateReportHTML","writeFile","getScoreColor","getVitalStatus","metric","value","thresholds","good","poor","threshold","toLocaleString","key","status","toFixed","replace","rec","content","data","h","stringify","clearHistory","delete","clearAllHistory","clear","exports"],"sources":["LighthouseRunner.ts"],"sourcesContent":["import { exec } from 'child_process';\nimport { promisify } from 'util';\nimport * as path from 'path';\nimport * as fs from 'fs/promises';\n\nconst execAsync = promisify(exec);\n\nexport interface CoreWebVitals {\n  LCP: number; // Largest Contentful Paint (ms)\n  FID: number; // First Input Delay (ms)\n  CLS: number; // Cumulative Layout Shift (score)\n  FCP: number; // First Contentful Paint (ms)\n  TTI: number; // Time to Interactive (ms)\n  TBT: number; // Total Blocking Time (ms)\n  SI: number;  // Speed Index (ms)\n}\n\nexport interface PerformanceScores {\n  performance: number;      // 0-100\n  accessibility: number;    // 0-100\n  bestPractices: number;    // 0-100\n  seo: number;              // 0-100\n  pwa: number;              // 0-100\n}\n\nexport interface PerformanceRecommendation {\n  id: string;\n  title: string;\n  description: string;\n  score: number;\n  displayValue?: string;\n  numericValue?: number;\n  numericUnit?: string;\n  details?: any;\n}\n\nexport interface PerformanceReport {\n  url: string;\n  timestamp: Date;\n  scores: PerformanceScores;\n  coreWebVitals: CoreWebVitals;\n  recommendations: PerformanceRecommendation[];\n  passed: boolean;\n  reportPath?: string;\n  rawReport?: any;\n}\n\nexport interface PerformanceHistory {\n  url: string;\n  reports: PerformanceReport[];\n  trend: {\n    performance: number[];\n    LCP: number[];\n    FID: number[];\n    CLS: number[];\n  };\n}\n\nexport interface LighthouseOptions {\n  formFactor?: 'mobile' | 'desktop';\n  throttling?: 'mobile3G' | 'mobile4G' | 'none';\n  onlyCategories?: string[];\n  skipAudits?: string[];\n  output?: 'json' | 'html' | 'csv';\n  outputPath?: string;\n}\n\nexport class LighthouseRunner {\n  private projectRoot: string;\n  private historyPath: string;\n  private history: Map<string, PerformanceHistory>;\n\n  constructor(projectRoot: string) {\n    this.projectRoot = projectRoot;\n    this.historyPath = path.join(projectRoot, '.azstudio', 'performance-history.json');\n    this.history = new Map();\n  }\n\n  /**\n   * Initialize Lighthouse and load history\n   */\n  async initialize(): Promise<void> {\n    try {\n      // Ensure Lighthouse is installed\n      await execAsync('npm list lighthouse', {\n        cwd: this.projectRoot,\n      });\n    } catch {\n      // Install Lighthouse if not present\n      console.log('Installing Lighthouse...');\n      await execAsync('npm install --save-dev lighthouse', {\n        cwd: this.projectRoot,\n      });\n    }\n\n    // Load performance history\n    await this.loadHistory();\n  }\n\n  /**\n   * Run Lighthouse audit on a preview page\n   */\n  async runAudit(\n    url: string,\n    options: LighthouseOptions = {}\n  ): Promise<PerformanceReport> {\n    try {\n      const {\n        formFactor = 'desktop',\n        throttling = 'none',\n        onlyCategories = ['performance', 'accessibility', 'best-practices', 'seo'],\n        output = 'json',\n        outputPath,\n      } = options;\n\n      // Build Lighthouse command\n      const outputFile = outputPath || path.join(\n        this.projectRoot,\n        '.azstudio',\n        'lighthouse',\n        `report-${Date.now()}.json`\n      );\n\n      await fs.mkdir(path.dirname(outputFile), { recursive: true });\n\n      const command = [\n        'npx lighthouse',\n        url,\n        `--output=${output}`,\n        `--output-path=${outputFile}`,\n        `--form-factor=${formFactor}`,\n        `--throttling-method=${throttling}`,\n        `--only-categories=${onlyCategories.join(',')}`,\n        '--chrome-flags=\"--headless --no-sandbox --disable-gpu\"',\n        '--quiet',\n      ].join(' ');\n\n      console.log(`Running Lighthouse audit on ${url}...`);\n      \n      await execAsync(command, {\n        cwd: this.projectRoot,\n        timeout: 120000, // 2 minutes\n      });\n\n      // Read and parse the report\n      const reportContent = await fs.readFile(outputFile, 'utf-8');\n      const rawReport = JSON.parse(reportContent);\n\n      const report = this.parseReport(url, rawReport);\n      \n      // Save to history\n      await this.addToHistory(report);\n\n      return report;\n    } catch (error: any) {\n      throw new Error(`Lighthouse audit failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Parse Lighthouse report into our format\n   */\n  private parseReport(url: string, rawReport: any): PerformanceReport {\n    const categories = rawReport.categories || {};\n    const audits = rawReport.audits || {};\n\n    // Extract scores\n    const scores: PerformanceScores = {\n      performance: Math.round((categories.performance?.score || 0) * 100),\n      accessibility: Math.round((categories.accessibility?.score || 0) * 100),\n      bestPractices: Math.round((categories['best-practices']?.score || 0) * 100),\n      seo: Math.round((categories.seo?.score || 0) * 100),\n      pwa: Math.round((categories.pwa?.score || 0) * 100),\n    };\n\n    // Extract Core Web Vitals\n    const coreWebVitals: CoreWebVitals = {\n      LCP: audits['largest-contentful-paint']?.numericValue || 0,\n      FID: audits['max-potential-fid']?.numericValue || 0,\n      CLS: audits['cumulative-layout-shift']?.numericValue || 0,\n      FCP: audits['first-contentful-paint']?.numericValue || 0,\n      TTI: audits['interactive']?.numericValue || 0,\n      TBT: audits['total-blocking-time']?.numericValue || 0,\n      SI: audits['speed-index']?.numericValue || 0,\n    };\n\n    // Extract recommendations (failed or warning audits)\n    const recommendations: PerformanceRecommendation[] = [];\n    \n    for (const [id, audit] of Object.entries(audits) as [string, any][]) {\n      if (audit.score !== null && audit.score < 0.9) {\n        recommendations.push({\n          id,\n          title: audit.title,\n          description: audit.description,\n          score: Math.round((audit.score || 0) * 100),\n          displayValue: audit.displayValue,\n          numericValue: audit.numericValue,\n          numericUnit: audit.numericUnit,\n          details: audit.details,\n        });\n      }\n    }\n\n    // Sort recommendations by score (worst first)\n    recommendations.sort((a, b) => a.score - b.score);\n\n    // Determine if passed (performance score >= 90)\n    const passed = scores.performance >= 90;\n\n    return {\n      url,\n      timestamp: new Date(),\n      scores,\n      coreWebVitals,\n      recommendations,\n      passed,\n      rawReport,\n    };\n  }\n\n  /**\n   * Measure Core Web Vitals specifically\n   */\n  async measureCoreWebVitals(url: string): Promise<CoreWebVitals> {\n    const report = await this.runAudit(url, {\n      onlyCategories: ['performance'],\n    });\n\n    return report.coreWebVitals;\n  }\n\n  /**\n   * Get performance scores\n   */\n  async getPerformanceScores(url: string): Promise<PerformanceScores> {\n    const report = await this.runAudit(url);\n    return report.scores;\n  }\n\n  /**\n   * Get performance recommendations\n   */\n  async getRecommendations(url: string): Promise<PerformanceRecommendation[]> {\n    const report = await this.runAudit(url);\n    return report.recommendations;\n  }\n\n  /**\n   * Run audit on multiple pages\n   */\n  async runMultipleAudits(\n    urls: string[],\n    options?: LighthouseOptions\n  ): Promise<PerformanceReport[]> {\n    const reports: PerformanceReport[] = [];\n\n    for (const url of urls) {\n      try {\n        const report = await this.runAudit(url, options);\n        reports.push(report);\n      } catch (error: any) {\n        console.error(`Failed to audit ${url}:`, error.message);\n        // Continue with other URLs\n      }\n    }\n\n    return reports;\n  }\n\n  /**\n   * Add report to performance history\n   */\n  private async addToHistory(report: PerformanceReport): Promise<void> {\n    let history = this.history.get(report.url);\n\n    if (!history) {\n      history = {\n        url: report.url,\n        reports: [],\n        trend: {\n          performance: [],\n          LCP: [],\n          FID: [],\n          CLS: [],\n        },\n      };\n      this.history.set(report.url, history);\n    }\n\n    // Add report\n    history.reports.push(report);\n\n    // Update trends (keep last 30 reports)\n    if (history.reports.length > 30) {\n      history.reports = history.reports.slice(-30);\n    }\n\n    history.trend.performance = history.reports.map(r => r.scores.performance);\n    history.trend.LCP = history.reports.map(r => r.coreWebVitals.LCP);\n    history.trend.FID = history.reports.map(r => r.coreWebVitals.FID);\n    history.trend.CLS = history.reports.map(r => r.coreWebVitals.CLS);\n\n    // Save to disk\n    await this.saveHistory();\n  }\n\n  /**\n   * Get performance history for a URL\n   */\n  getHistory(url: string): PerformanceHistory | undefined {\n    return this.history.get(url);\n  }\n\n  /**\n   * Get all performance history\n   */\n  getAllHistory(): PerformanceHistory[] {\n    return Array.from(this.history.values());\n  }\n\n  /**\n   * Get performance trend for a URL\n   */\n  getTrend(url: string): PerformanceHistory['trend'] | undefined {\n    return this.history.get(url)?.trend;\n  }\n\n  /**\n   * Compare two reports\n   */\n  compareReports(\n    baseline: PerformanceReport,\n    current: PerformanceReport\n  ): {\n    scores: { [key: string]: number };\n    coreWebVitals: { [key: string]: number };\n    improved: boolean;\n  } {\n    const scoreDiff = {\n      performance: current.scores.performance - baseline.scores.performance,\n      accessibility: current.scores.accessibility - baseline.scores.accessibility,\n      bestPractices: current.scores.bestPractices - baseline.scores.bestPractices,\n      seo: current.scores.seo - baseline.scores.seo,\n    };\n\n    const vitalsDiff = {\n      LCP: current.coreWebVitals.LCP - baseline.coreWebVitals.LCP,\n      FID: current.coreWebVitals.FID - baseline.coreWebVitals.FID,\n      CLS: current.coreWebVitals.CLS - baseline.coreWebVitals.CLS,\n      FCP: current.coreWebVitals.FCP - baseline.coreWebVitals.FCP,\n      TTI: current.coreWebVitals.TTI - baseline.coreWebVitals.TTI,\n    };\n\n    // Consider improved if performance score increased or stayed same\n    // and Core Web Vitals didn't regress significantly\n    const improved = \n      scoreDiff.performance >= 0 &&\n      vitalsDiff.LCP <= 200 && // Allow 200ms regression\n      vitalsDiff.CLS <= 0.05;  // Allow 0.05 CLS regression\n\n    return {\n      scores: scoreDiff,\n      coreWebVitals: vitalsDiff,\n      improved,\n    };\n  }\n\n  /**\n   * Generate HTML report\n   */\n  async generateHTMLReport(\n    report: PerformanceReport,\n    outputPath: string\n  ): Promise<void> {\n    const html = this.generateReportHTML(report);\n    await fs.writeFile(outputPath, html, 'utf-8');\n  }\n\n  /**\n   * Generate HTML content for report\n   */\n  private generateReportHTML(report: PerformanceReport): string {\n    const { scores, coreWebVitals, recommendations } = report;\n\n    const getScoreColor = (score: number) => {\n      if (score >= 90) return '#0cce6b';\n      if (score >= 50) return '#ffa400';\n      return '#ff4e42';\n    };\n\n    const getVitalStatus = (metric: string, value: number) => {\n      const thresholds: { [key: string]: { good: number; poor: number } } = {\n        LCP: { good: 2500, poor: 4000 },\n        FID: { good: 100, poor: 300 },\n        CLS: { good: 0.1, poor: 0.25 },\n        FCP: { good: 1800, poor: 3000 },\n        TTI: { good: 3800, poor: 7300 },\n      };\n\n      const threshold = thresholds[metric];\n      if (!threshold) return 'unknown';\n\n      if (value <= threshold.good) return 'good';\n      if (value <= threshold.poor) return 'needs-improvement';\n      return 'poor';\n    };\n\n    return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Performance Report - ${report.url}</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      background: #f5f5f5;\n      padding: 20px;\n    }\n    .container { max-width: 1200px; margin: 0 auto; }\n    .header {\n      background: white;\n      padding: 30px;\n      border-radius: 8px;\n      margin-bottom: 20px;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    h1 { font-size: 24px; margin-bottom: 10px; }\n    .url { color: #666; font-size: 14px; }\n    .timestamp { color: #999; font-size: 12px; margin-top: 5px; }\n    \n    .scores {\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n      gap: 20px;\n      margin-bottom: 20px;\n    }\n    .score-card {\n      background: white;\n      padding: 20px;\n      border-radius: 8px;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      text-align: center;\n    }\n    .score-value {\n      font-size: 48px;\n      font-weight: bold;\n      margin: 10px 0;\n    }\n    .score-label {\n      color: #666;\n      font-size: 14px;\n      text-transform: uppercase;\n      letter-spacing: 1px;\n    }\n    \n    .vitals {\n      background: white;\n      padding: 30px;\n      border-radius: 8px;\n      margin-bottom: 20px;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    h2 { font-size: 20px; margin-bottom: 20px; }\n    .vital-item {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 15px 0;\n      border-bottom: 1px solid #eee;\n    }\n    .vital-item:last-child { border-bottom: none; }\n    .vital-name { font-weight: 500; }\n    .vital-value {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n    }\n    .vital-badge {\n      padding: 4px 12px;\n      border-radius: 12px;\n      font-size: 12px;\n      font-weight: 500;\n    }\n    .vital-badge.good { background: #0cce6b; color: white; }\n    .vital-badge.needs-improvement { background: #ffa400; color: white; }\n    .vital-badge.poor { background: #ff4e42; color: white; }\n    \n    .recommendations {\n      background: white;\n      padding: 30px;\n      border-radius: 8px;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    .recommendation {\n      padding: 20px 0;\n      border-bottom: 1px solid #eee;\n    }\n    .recommendation:last-child { border-bottom: none; }\n    .recommendation-title {\n      font-weight: 500;\n      margin-bottom: 5px;\n      display: flex;\n      align-items: center;\n      gap: 10px;\n    }\n    .recommendation-score {\n      display: inline-block;\n      padding: 2px 8px;\n      border-radius: 4px;\n      font-size: 12px;\n      font-weight: bold;\n      color: white;\n    }\n    .recommendation-description {\n      color: #666;\n      font-size: 14px;\n      line-height: 1.5;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <h1>Performance Report</h1>\n      <div class=\"url\">${report.url}</div>\n      <div class=\"timestamp\">${report.timestamp.toLocaleString()}</div>\n    </div>\n    \n    <div class=\"scores\">\n      ${Object.entries(scores).map(([key, value]) => `\n        <div class=\"score-card\">\n          <div class=\"score-label\">${key}</div>\n          <div class=\"score-value\" style=\"color: ${getScoreColor(value)}\">${value}</div>\n        </div>\n      `).join('')}\n    </div>\n    \n    <div class=\"vitals\">\n      <h2>Core Web Vitals</h2>\n      ${Object.entries(coreWebVitals).map(([key, value]) => {\n        const status = getVitalStatus(key, value);\n        const displayValue = key === 'CLS' \n          ? value.toFixed(3) \n          : `${Math.round(value)}ms`;\n        \n        return `\n          <div class=\"vital-item\">\n            <div class=\"vital-name\">${key}</div>\n            <div class=\"vital-value\">\n              <span>${displayValue}</span>\n              <span class=\"vital-badge ${status}\">${status.replace('-', ' ')}</span>\n            </div>\n          </div>\n        `;\n      }).join('')}\n    </div>\n    \n    <div class=\"recommendations\">\n      <h2>Recommendations (${recommendations.length})</h2>\n      ${recommendations.slice(0, 10).map(rec => `\n        <div class=\"recommendation\">\n          <div class=\"recommendation-title\">\n            <span class=\"recommendation-score\" style=\"background: ${getScoreColor(rec.score)}\">${rec.score}</span>\n            <span>${rec.title}</span>\n          </div>\n          <div class=\"recommendation-description\">${rec.description}</div>\n          ${rec.displayValue ? `<div style=\"margin-top: 5px; font-size: 13px; color: #999;\">${rec.displayValue}</div>` : ''}\n        </div>\n      `).join('')}\n    </div>\n  </div>\n</body>\n</html>`;\n  }\n\n  /**\n   * Load performance history from disk\n   */\n  private async loadHistory(): Promise<void> {\n    try {\n      const content = await fs.readFile(this.historyPath, 'utf-8');\n      const data = JSON.parse(content);\n      \n      this.history = new Map(\n        data.map((h: PerformanceHistory) => [h.url, h])\n      );\n    } catch {\n      // No history file yet\n      this.history = new Map();\n    }\n  }\n\n  /**\n   * Save performance history to disk\n   */\n  private async saveHistory(): Promise<void> {\n    try {\n      await fs.mkdir(path.dirname(this.historyPath), { recursive: true });\n      \n      const data = Array.from(this.history.values());\n      await fs.writeFile(\n        this.historyPath,\n        JSON.stringify(data, null, 2),\n        'utf-8'\n      );\n    } catch (error: any) {\n      console.error('Failed to save performance history:', error.message);\n    }\n  }\n\n  /**\n   * Clear history for a URL\n   */\n  async clearHistory(url: string): Promise<void> {\n    this.history.delete(url);\n    await this.saveHistory();\n  }\n\n  /**\n   * Clear all history\n   */\n  async clearAllHistory(): Promise<void> {\n    this.history.clear();\n    await this.saveHistory();\n  }\n}\n"],"mappings":"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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyBoB,MAAM,CAACpB,GAAG;AACnC,+BAA+BoB,MAAM,CAACwC,SAAS,CAACoC,cAAc,CAAC,CAAC;AAChE;AACA;AACA;AACA,QAAQnH,MAAM,CAACoE,OAAO,CAACrB,MAAM,CAAC,CAAC0C,GAAG,CAAC,CAAC,CAAC2B,GAAG,EAAEN,KAAK,CAAC,KAAK;AACrD;AACA,qCAAqCM,GAAG;AACxC,mDAAmDT,aAAa,CAACG,KAAK,CAAC,KAAKA,KAAK;AACjF;AACA,OAAO,CAAC,CAACpG,IAAI,CAAC,EAAE,CAAC;AACjB;AACA;AACA;AACA;AACA,QAAQV,MAAM,CAACoE,OAAO,CAACZ,aAAa,CAAC,CAACiC,GAAG,CAAC,CAAC,CAAC2B,GAAG,EAAEN,KAAK,CAAC,KAAK;MACpD,MAAMO,MAAM,GAAGT,cAAc,CAACQ,GAAG,EAAEN,KAAK,CAAC;MACzC,MAAMtC,YAAY,GAAG4C,GAAG,KAAK,KAAK,GAC9BN,KAAK,CAACQ,OAAO,CAAC,CAAC,CAAC,GAChB,GAAGrE,IAAI,CAACC,KAAK,CAAC4D,KAAK,CAAC,IAAI;MAE5B,OAAO;AACf;AACA,sCAAsCM,GAAG;AACzC;AACA,sBAAsB5C,YAAY;AAClC,yCAAyC6C,MAAM,KAAKA,MAAM,CAACE,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC;AAC5E;AACA;AACA,SAAS;IACH,CAAC,CAAC,CAAC7G,IAAI,CAAC,EAAE,CAAC;AACjB;AACA;AACA;AACA,6BAA6BuD,eAAe,CAACsB,MAAM;AACnD,QAAQtB,eAAe,CAACuB,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAACC,GAAG,CAAC+B,GAAG,IAAI;AAChD;AACA;AACA,oEAAoEb,aAAa,CAACa,GAAG,CAACrE,KAAK,CAAC,KAAKqE,GAAG,CAACrE,KAAK;AAC1G,oBAAoBqE,GAAG,CAAClD,KAAK;AAC7B;AACA,oDAAoDkD,GAAG,CAACjD,WAAW;AACnE,YAAYiD,GAAG,CAAChD,YAAY,GAAG,+DAA+DgD,GAAG,CAAChD,YAAY,QAAQ,GAAG,EAAE;AAC3H;AACA,OAAO,CAAC,CAAC9D,IAAI,CAAC,EAAE,CAAC;AACjB;AACA;AACA;AACA,QAAQ;EACN;;EAEA;AACF;AACA;EACE,MAAcO,WAAWA,CAAA,EAAkB;IACzC,IAAI;MACF,MAAMwG,OAAO,GAAG,MAAM1I,EAAE,CAACoD,QAAQ,CAAC,IAAI,CAAC1B,WAAW,EAAE,OAAO,CAAC;MAC5D,MAAMiH,IAAI,GAAGrF,IAAI,CAACC,KAAK,CAACmF,OAAO,CAAC;MAEhC,IAAI,CAAC9G,OAAO,GAAG,IAAIC,GAAG,CACpB8G,IAAI,CAACjC,GAAG,CAAEkC,CAAqB,IAAK,CAACA,CAAC,CAACxG,GAAG,EAAEwG,CAAC,CAAC,CAChD,CAAC;IACH,CAAC,CAAC,MAAM;MACN;MACA,IAAI,CAAChH,OAAO,GAAG,IAAIC,GAAG,CAAC,CAAC;IAC1B;EACF;;EAEA;AACF;AACA;EACE,MAAc8E,WAAWA,CAAA,EAAkB;IACzC,IAAI;MACF,MAAM3G,EAAE,CAAC8C,KAAK,CAAChD,IAAI,CAACiD,OAAO,CAAC,IAAI,CAACrB,WAAW,CAAC,EAAE;QAAEsB,SAAS,EAAE;MAAK,CAAC,CAAC;MAEnE,MAAM2F,IAAI,GAAG7B,KAAK,CAACC,IAAI,CAAC,IAAI,CAACnF,OAAO,CAACoF,MAAM,CAAC,CAAC,CAAC;MAC9C,MAAMhH,EAAE,CAAC2H,SAAS,CAChB,IAAI,CAACjG,WAAW,EAChB4B,IAAI,CAACuF,SAAS,CAACF,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,EAC7B,OACF,CAAC;IACH,CAAC,CAAC,OAAOhF,KAAU,EAAE;MACnB3B,OAAO,CAAC2B,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAACE,OAAO,CAAC;IACrE;EACF;;EAEA;AACF;AACA;EACE,MAAMiF,YAAYA,CAAC1G,GAAW,EAAiB;IAC7C,IAAI,CAACR,OAAO,CAACmH,MAAM,CAAC3G,GAAG,CAAC;IACxB,MAAM,IAAI,CAACuE,WAAW,CAAC,CAAC;EAC1B;;EAEA;AACF;AACA;EACE,MAAMqC,eAAeA,CAAA,EAAkB;IACrC,IAAI,CAACpH,OAAO,CAACqH,KAAK,CAAC,CAAC;IACpB,MAAM,IAAI,CAACtC,WAAW,CAAC,CAAC;EAC1B;AACF;AAACuC,OAAA,CAAA3H,gBAAA,GAAAA,gBAAA","ignoreList":[]}