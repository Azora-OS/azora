190f893b3c7f5a744b46e38de44154f4
"use strict";

var _hierarchicalRouter = require("../../services/ai-routing/hierarchical-router");
var _queryClassifier = require("../../services/ai-routing/query-classifier");
var _localLlmService = require("../../services/ai-routing/local-llm-service");
var _rapSystem = require("../../services/ai-routing/rap-system");
var _redisCacheManager = require("../../services/ai-routing/redis-cache-manager");
var _routingMetricsTracker = require("../../services/ai-routing/routing-metrics-tracker");
var _types = require("../../services/ai-routing/types");
var _client = require("@prisma/client");
/**
 * Hierarchical Router Integration Tests
 * Tests for complete hierarchical AI routing flows
 */

describe('Hierarchical Router Integration', () => {
  let router;
  let prisma;
  let config;
  beforeEach(() => {
    prisma = new _client.PrismaClient();
    config = {
      localLLMEnabled: true,
      localLLMModel: 'llama',
      localLLMQuantization: 'q4',
      rapEnabled: true,
      knowledgeOceanUrl: 'http://localhost:8000',
      internalSourceWeight: 0.7,
      externalSourceWeight: 0.3,
      externalLLMEnabled: true,
      externalLLMProvider: 'openai',
      externalLLMModel: 'gpt-4',
      cacheEnabled: true,
      cacheTTL: 3600,
      cacheMaxSize: 1000,
      costTrackingEnabled: true,
      costThreshold: 0.10,
      latencyThreshold: 3000,
      fallbackOnLatency: true,
      redisUrl: process.env.REDIS_URL || 'redis://localhost:6379',
      redisKeyPrefix: 'ai-routing:'
    };

    // Initialize services
    const classifier = new _queryClassifier.QueryClassifier();
    const localLLM = new _localLlmService.LocalLLMService();
    const rapSystem = new _rapSystem.RAPSystem({
      internalSourceWeight: config.internalSourceWeight,
      externalSourceWeight: config.externalSourceWeight,
      maxContextTokens: 2000,
      maxRetrievalResults: 10,
      externalLLMProvider: config.externalLLMProvider,
      externalLLMModel: config.externalLLMModel,
      externalLLMApiKey: process.env.OPENAI_API_KEY || '',
      embeddingApiKey: process.env.OPENAI_API_KEY || '',
      vectorDbApiKey: process.env.PINECONE_API_KEY || ''
    });
    const cache = new _redisCacheManager.RedisCacheManager(config.redisUrl, config.redisKeyPrefix);
    const metrics = new _routingMetricsTracker.RoutingMetricsTracker(prisma);
    router = new _hierarchicalRouter.HierarchicalRouter(config, prisma, classifier, localLLM, rapSystem, cache, metrics);
  });
  afterEach(async () => {
    await prisma.$disconnect();
  });
  describe('Complete Query Routing Flow', () => {
    it('should route simple query through Local LLM', async () => {
      const query = {
        query: 'What is the capital of France?',
        userId: 'test-user-1'
      };
      const result = await router.route(query);
      expect(result).toBeDefined();
      expect(result.content).toBeDefined();
      expect(result.responseTime).toBeGreaterThan(0);
      expect(result.cost).toBeGreaterThanOrEqual(0);
    });
    it('should classify and route moderate query', async () => {
      const query = {
        query: 'Analyze the impact of climate change on global agriculture',
        userId: 'test-user-2'
      };
      const classification = await router.classify(query);
      expect(classification).toBeDefined();
      expect(classification.classifiedAs).toBeDefined();
      expect(classification.routedTo).toBeDefined();
      expect([_types.RoutingTier.LOCAL_LLM, _types.RoutingTier.RAP_SYSTEM, _types.RoutingTier.EXTERNAL_LLM]).toContain(classification.routedTo);
    });
    it('should classify complex query correctly', async () => {
      const query = {
        query: 'Develop a comprehensive multi-year strategic plan for digital transformation that considers organizational culture, technology infrastructure, market dynamics, competitive landscape, regulatory environment, and long-term business sustainability implications',
        userId: 'test-user-3'
      };
      const classification = await router.classify(query);
      expect(classification.classifiedAs).toBeDefined();
      expect(classification.confidence).toBeGreaterThan(0);
      expect(classification.confidence).toBeLessThanOrEqual(1);
    });
  });
  describe('Caching Behavior', () => {
    it('should cache responses and return cached results', async () => {
      const query = {
        query: 'What is Python?',
        userId: 'test-user-4'
      };

      // First request - should not be cached
      const result1 = await router.route(query);
      expect(result1).toBeDefined();

      // Second request - should be cached
      const result2 = await router.route(query);
      expect(result2).toBeDefined();

      // Both should have same content
      expect(result1.content).toBe(result2.content);
    });
    it('should track cache statistics', async () => {
      const query = {
        query: 'Hello world',
        userId: 'test-user-5'
      };

      // Make multiple requests
      for (let i = 0; i < 3; i++) {
        await router.route(query);
      }
      const stats = await router.getCacheStats();
      expect(stats).toBeDefined();
      expect(stats.hits).toBeGreaterThanOrEqual(0);
      expect(stats.misses).toBeGreaterThanOrEqual(0);
      expect(stats.size).toBeGreaterThanOrEqual(0);
    });
  });
  describe('Metrics Tracking', () => {
    it('should track routing metrics', async () => {
      const queries = [{
        query: 'What is AI?',
        userId: 'user-1'
      }, {
        query: 'Analyze market trends',
        userId: 'user-2'
      }, {
        query: 'Develop strategic plan',
        userId: 'user-3'
      }];
      for (const query of queries) {
        await router.route(query);
      }
      const metrics = await router.getMetrics();
      expect(metrics).toBeDefined();
      expect(metrics[_types.RoutingTier.LOCAL_LLM]).toBeDefined();
      expect(metrics[_types.RoutingTier.RAP_SYSTEM]).toBeDefined();
      expect(metrics[_types.RoutingTier.EXTERNAL_LLM]).toBeDefined();
    });
    it('should provide system health status', async () => {
      const query = {
        query: 'Test query',
        userId: 'user-1'
      };
      await router.route(query);
      const health = await router.getSystemHealth();
      expect(health).toBeDefined();
      expect(health.overallSuccessRate).toBeGreaterThanOrEqual(0);
      expect(health.overallSuccessRate).toBeLessThanOrEqual(100);
      expect(health.averageResponseTime).toBeGreaterThanOrEqual(0);
      expect(health.totalRequests).toBeGreaterThanOrEqual(0);
      expect(health.cacheHitRate).toBeGreaterThanOrEqual(0);
    });
    it('should identify best performing tier', async () => {
      const queries = [{
        query: 'What is AI?',
        userId: 'user-1'
      }, {
        query: 'What is ML?',
        userId: 'user-2'
      }, {
        query: 'What is DL?',
        userId: 'user-3'
      }];
      for (const query of queries) {
        await router.route(query);
      }
      const bestTier = await router.getBestPerformingTier();
      expect(bestTier).toBeDefined();
      expect([_types.RoutingTier.LOCAL_LLM, _types.RoutingTier.RAP_SYSTEM, _types.RoutingTier.EXTERNAL_LLM]).toContain(bestTier);
    });
    it('should identify cheapest tier', async () => {
      const cheapestTier = await router.getCheapestTier();
      expect(cheapestTier).toBeDefined();
      expect([_types.RoutingTier.LOCAL_LLM, _types.RoutingTier.RAP_SYSTEM, _types.RoutingTier.EXTERNAL_LLM]).toContain(cheapestTier);
    });
    it('should identify fastest tier', async () => {
      const fastestTier = await router.getFastestTier();
      expect(fastestTier).toBeDefined();
      expect([_types.RoutingTier.LOCAL_LLM, _types.RoutingTier.RAP_SYSTEM, _types.RoutingTier.EXTERNAL_LLM]).toContain(fastestTier);
    });
  });
  describe('Configuration Management', () => {
    it('should allow updating latency thresholds', () => {
      router.setLatencyThreshold(_types.RoutingTier.LOCAL_LLM, 300);
      router.setLatencyThreshold(_types.RoutingTier.RAP_SYSTEM, 1500);
      router.setLatencyThreshold(_types.RoutingTier.EXTERNAL_LLM, 4000);

      // Verify by making a request
      expect(router).toBeDefined();
    });
    it('should allow updating cost thresholds', () => {
      router.setCostThreshold(_types.RoutingTier.LOCAL_LLM, 0);
      router.setCostThreshold(_types.RoutingTier.RAP_SYSTEM, 0.05);
      router.setCostThreshold(_types.RoutingTier.EXTERNAL_LLM, 0.15);
      expect(router).toBeDefined();
    });
    it('should allow updating fallback strategies', () => {
      router.setFallbackStrategy(_types.RoutingTier.LOCAL_LLM, {
        tier: _types.RoutingTier.LOCAL_LLM,
        condition: 'failure',
        threshold: 0,
        nextTier: _types.RoutingTier.RAP_SYSTEM
      });
      expect(router).toBeDefined();
    });
  });
  describe('Cache Management', () => {
    it('should clear cache', async () => {
      const query = {
        query: 'Test query',
        userId: 'user-1'
      };

      // Make a request to populate cache
      await router.route(query);

      // Clear cache
      await router.clearCache();

      // Verify cache is cleared
      const stats = await router.getCacheStats();
      expect(stats.size).toBe(0);
    });
  });
  describe('Metrics Reset', () => {
    it('should reset all metrics', async () => {
      const query = {
        query: 'Test query',
        userId: 'user-1'
      };

      // Make requests to populate metrics
      await router.route(query);

      // Reset metrics
      await router.resetMetrics();

      // Verify metrics are reset
      const metrics = await router.getMetrics();
      expect(metrics[_types.RoutingTier.LOCAL_LLM].totalRequests).toBe(0);
      expect(metrics[_types.RoutingTier.RAP_SYSTEM].totalRequests).toBe(0);
      expect(metrics[_types.RoutingTier.EXTERNAL_LLM].totalRequests).toBe(0);
    });
  });
  describe('Error Handling', () => {
    it('should handle invalid queries gracefully', async () => {
      const query = {
        query: '',
        userId: 'user-1'
      };

      // Should not throw, but handle gracefully
      const result = await router.route(query);
      expect(result).toBeDefined();
    });
    it('should handle very long queries', async () => {
      const longQuery = 'word '.repeat(1000);
      const query = {
        query: longQuery,
        userId: 'user-1'
      };
      const result = await router.route(query);
      expect(result).toBeDefined();
    });
  });
  describe('Multi-Query Routing', () => {
    it('should handle multiple concurrent queries', async () => {
      const queries = [{
        query: 'What is AI?',
        userId: 'user-1'
      }, {
        query: 'Analyze trends',
        userId: 'user-2'
      }, {
        query: 'Develop strategy',
        userId: 'user-3'
      }];
      const results = await Promise.all(queries.map(q => router.route(q)));
      expect(results).toHaveLength(3);
      results.forEach(result => {
        expect(result).toBeDefined();
        expect(result.content).toBeDefined();
        expect(result.routingTier).toBeDefined();
      });
    });
    it('should maintain separate metrics for different query types', async () => {
      const simpleQuery = {
        query: 'What is AI?',
        userId: 'user-1'
      };
      const complexQuery = {
        query: 'Develop comprehensive strategic plan',
        userId: 'user-2'
      };
      await router.route(simpleQuery);
      await router.route(complexQuery);
      const metrics = await router.getMetrics();

      // At least one tier should have requests
      const totalRequests = metrics[_types.RoutingTier.LOCAL_LLM].totalRequests + metrics[_types.RoutingTier.RAP_SYSTEM].totalRequests + metrics[_types.RoutingTier.EXTERNAL_LLM].totalRequests;
      expect(totalRequests).toBeGreaterThanOrEqual(2);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaGllcmFyY2hpY2FsUm91dGVyIiwicmVxdWlyZSIsIl9xdWVyeUNsYXNzaWZpZXIiLCJfbG9jYWxMbG1TZXJ2aWNlIiwiX3JhcFN5c3RlbSIsIl9yZWRpc0NhY2hlTWFuYWdlciIsIl9yb3V0aW5nTWV0cmljc1RyYWNrZXIiLCJfdHlwZXMiLCJfY2xpZW50IiwiZGVzY3JpYmUiLCJyb3V0ZXIiLCJwcmlzbWEiLCJjb25maWciLCJiZWZvcmVFYWNoIiwiUHJpc21hQ2xpZW50IiwibG9jYWxMTE1FbmFibGVkIiwibG9jYWxMTE1Nb2RlbCIsImxvY2FsTExNUXVhbnRpemF0aW9uIiwicmFwRW5hYmxlZCIsImtub3dsZWRnZU9jZWFuVXJsIiwiaW50ZXJuYWxTb3VyY2VXZWlnaHQiLCJleHRlcm5hbFNvdXJjZVdlaWdodCIsImV4dGVybmFsTExNRW5hYmxlZCIsImV4dGVybmFsTExNUHJvdmlkZXIiLCJleHRlcm5hbExMTU1vZGVsIiwiY2FjaGVFbmFibGVkIiwiY2FjaGVUVEwiLCJjYWNoZU1heFNpemUiLCJjb3N0VHJhY2tpbmdFbmFibGVkIiwiY29zdFRocmVzaG9sZCIsImxhdGVuY3lUaHJlc2hvbGQiLCJmYWxsYmFja09uTGF0ZW5jeSIsInJlZGlzVXJsIiwicHJvY2VzcyIsImVudiIsIlJFRElTX1VSTCIsInJlZGlzS2V5UHJlZml4IiwiY2xhc3NpZmllciIsIlF1ZXJ5Q2xhc3NpZmllciIsImxvY2FsTExNIiwiTG9jYWxMTE1TZXJ2aWNlIiwicmFwU3lzdGVtIiwiUkFQU3lzdGVtIiwibWF4Q29udGV4dFRva2VucyIsIm1heFJldHJpZXZhbFJlc3VsdHMiLCJleHRlcm5hbExMTUFwaUtleSIsIk9QRU5BSV9BUElfS0VZIiwiZW1iZWRkaW5nQXBpS2V5IiwidmVjdG9yRGJBcGlLZXkiLCJQSU5FQ09ORV9BUElfS0VZIiwiY2FjaGUiLCJSZWRpc0NhY2hlTWFuYWdlciIsIm1ldHJpY3MiLCJSb3V0aW5nTWV0cmljc1RyYWNrZXIiLCJIaWVyYXJjaGljYWxSb3V0ZXIiLCJhZnRlckVhY2giLCIkZGlzY29ubmVjdCIsIml0IiwicXVlcnkiLCJ1c2VySWQiLCJyZXN1bHQiLCJyb3V0ZSIsImV4cGVjdCIsInRvQmVEZWZpbmVkIiwiY29udGVudCIsInJlc3BvbnNlVGltZSIsInRvQmVHcmVhdGVyVGhhbiIsImNvc3QiLCJ0b0JlR3JlYXRlclRoYW5PckVxdWFsIiwiY2xhc3NpZmljYXRpb24iLCJjbGFzc2lmeSIsImNsYXNzaWZpZWRBcyIsInJvdXRlZFRvIiwiUm91dGluZ1RpZXIiLCJMT0NBTF9MTE0iLCJSQVBfU1lTVEVNIiwiRVhURVJOQUxfTExNIiwidG9Db250YWluIiwiY29uZmlkZW5jZSIsInRvQmVMZXNzVGhhbk9yRXF1YWwiLCJyZXN1bHQxIiwicmVzdWx0MiIsInRvQmUiLCJpIiwic3RhdHMiLCJnZXRDYWNoZVN0YXRzIiwiaGl0cyIsIm1pc3NlcyIsInNpemUiLCJxdWVyaWVzIiwiZ2V0TWV0cmljcyIsImhlYWx0aCIsImdldFN5c3RlbUhlYWx0aCIsIm92ZXJhbGxTdWNjZXNzUmF0ZSIsImF2ZXJhZ2VSZXNwb25zZVRpbWUiLCJ0b3RhbFJlcXVlc3RzIiwiY2FjaGVIaXRSYXRlIiwiYmVzdFRpZXIiLCJnZXRCZXN0UGVyZm9ybWluZ1RpZXIiLCJjaGVhcGVzdFRpZXIiLCJnZXRDaGVhcGVzdFRpZXIiLCJmYXN0ZXN0VGllciIsImdldEZhc3Rlc3RUaWVyIiwic2V0TGF0ZW5jeVRocmVzaG9sZCIsInNldENvc3RUaHJlc2hvbGQiLCJzZXRGYWxsYmFja1N0cmF0ZWd5IiwidGllciIsImNvbmRpdGlvbiIsInRocmVzaG9sZCIsIm5leHRUaWVyIiwiY2xlYXJDYWNoZSIsInJlc2V0TWV0cmljcyIsImxvbmdRdWVyeSIsInJlcGVhdCIsInJlc3VsdHMiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwicSIsInRvSGF2ZUxlbmd0aCIsImZvckVhY2giLCJyb3V0aW5nVGllciIsInNpbXBsZVF1ZXJ5IiwiY29tcGxleFF1ZXJ5Il0sInNvdXJjZXMiOlsiaGllcmFyY2hpY2FsLXJvdXRlci1pbnRlZ3JhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBIaWVyYXJjaGljYWwgUm91dGVyIEludGVncmF0aW9uIFRlc3RzXHJcbiAqIFRlc3RzIGZvciBjb21wbGV0ZSBoaWVyYXJjaGljYWwgQUkgcm91dGluZyBmbG93c1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IEhpZXJhcmNoaWNhbFJvdXRlciB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2FpLXJvdXRpbmcvaGllcmFyY2hpY2FsLXJvdXRlcic7XHJcbmltcG9ydCB7IFF1ZXJ5Q2xhc3NpZmllciB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2FpLXJvdXRpbmcvcXVlcnktY2xhc3NpZmllcic7XHJcbmltcG9ydCB7IExvY2FsTExNU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2FpLXJvdXRpbmcvbG9jYWwtbGxtLXNlcnZpY2UnO1xyXG5pbXBvcnQgeyBSQVBTeXN0ZW0gfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9haS1yb3V0aW5nL3JhcC1zeXN0ZW0nO1xyXG5pbXBvcnQgeyBSZWRpc0NhY2hlTWFuYWdlciB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2FpLXJvdXRpbmcvcmVkaXMtY2FjaGUtbWFuYWdlcic7XHJcbmltcG9ydCB7IFJvdXRpbmdNZXRyaWNzVHJhY2tlciB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2FpLXJvdXRpbmcvcm91dGluZy1tZXRyaWNzLXRyYWNrZXInO1xyXG5pbXBvcnQgeyBBSVF1ZXJ5LCBSb3V0aW5nVGllciwgQUlSb3V0aW5nQ29uZmlnIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvYWktcm91dGluZy90eXBlcyc7XHJcbmltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcclxuXHJcbmRlc2NyaWJlKCdIaWVyYXJjaGljYWwgUm91dGVyIEludGVncmF0aW9uJywgKCkgPT4ge1xyXG4gIGxldCByb3V0ZXI6IEhpZXJhcmNoaWNhbFJvdXRlcjtcclxuICBsZXQgcHJpc21hOiBQcmlzbWFDbGllbnQ7XHJcbiAgbGV0IGNvbmZpZzogQUlSb3V0aW5nQ29uZmlnO1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIHByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKTtcclxuXHJcbiAgICBjb25maWcgPSB7XHJcbiAgICAgIGxvY2FsTExNRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgbG9jYWxMTE1Nb2RlbDogJ2xsYW1hJyxcclxuICAgICAgbG9jYWxMTE1RdWFudGl6YXRpb246ICdxNCcsXHJcbiAgICAgIHJhcEVuYWJsZWQ6IHRydWUsXHJcbiAgICAgIGtub3dsZWRnZU9jZWFuVXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MDAwJyxcclxuICAgICAgaW50ZXJuYWxTb3VyY2VXZWlnaHQ6IDAuNyxcclxuICAgICAgZXh0ZXJuYWxTb3VyY2VXZWlnaHQ6IDAuMyxcclxuICAgICAgZXh0ZXJuYWxMTE1FbmFibGVkOiB0cnVlLFxyXG4gICAgICBleHRlcm5hbExMTVByb3ZpZGVyOiAnb3BlbmFpJyxcclxuICAgICAgZXh0ZXJuYWxMTE1Nb2RlbDogJ2dwdC00JyxcclxuICAgICAgY2FjaGVFbmFibGVkOiB0cnVlLFxyXG4gICAgICBjYWNoZVRUTDogMzYwMCxcclxuICAgICAgY2FjaGVNYXhTaXplOiAxMDAwLFxyXG4gICAgICBjb3N0VHJhY2tpbmdFbmFibGVkOiB0cnVlLFxyXG4gICAgICBjb3N0VGhyZXNob2xkOiAwLjEwLFxyXG4gICAgICBsYXRlbmN5VGhyZXNob2xkOiAzMDAwLFxyXG4gICAgICBmYWxsYmFja09uTGF0ZW5jeTogdHJ1ZSxcclxuICAgICAgcmVkaXNVcmw6IHByb2Nlc3MuZW52LlJFRElTX1VSTCB8fCAncmVkaXM6Ly9sb2NhbGhvc3Q6NjM3OScsXHJcbiAgICAgIHJlZGlzS2V5UHJlZml4OiAnYWktcm91dGluZzonXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIEluaXRpYWxpemUgc2VydmljZXNcclxuICAgIGNvbnN0IGNsYXNzaWZpZXIgPSBuZXcgUXVlcnlDbGFzc2lmaWVyKCk7XHJcbiAgICBjb25zdCBsb2NhbExMTSA9IG5ldyBMb2NhbExMTVNlcnZpY2UoKTtcclxuICAgIGNvbnN0IHJhcFN5c3RlbSA9IG5ldyBSQVBTeXN0ZW0oe1xyXG4gICAgICBpbnRlcm5hbFNvdXJjZVdlaWdodDogY29uZmlnLmludGVybmFsU291cmNlV2VpZ2h0LFxyXG4gICAgICBleHRlcm5hbFNvdXJjZVdlaWdodDogY29uZmlnLmV4dGVybmFsU291cmNlV2VpZ2h0LFxyXG4gICAgICBtYXhDb250ZXh0VG9rZW5zOiAyMDAwLFxyXG4gICAgICBtYXhSZXRyaWV2YWxSZXN1bHRzOiAxMCxcclxuICAgICAgZXh0ZXJuYWxMTE1Qcm92aWRlcjogY29uZmlnLmV4dGVybmFsTExNUHJvdmlkZXIgYXMgJ29wZW5haScgfCAnYW50aHJvcGljJyxcclxuICAgICAgZXh0ZXJuYWxMTE1Nb2RlbDogY29uZmlnLmV4dGVybmFsTExNTW9kZWwsXHJcbiAgICAgIGV4dGVybmFsTExNQXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB8fCAnJyxcclxuICAgICAgZW1iZWRkaW5nQXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB8fCAnJyxcclxuICAgICAgdmVjdG9yRGJBcGlLZXk6IHByb2Nlc3MuZW52LlBJTkVDT05FX0FQSV9LRVkgfHwgJydcclxuICAgIH0pO1xyXG4gICAgY29uc3QgY2FjaGUgPSBuZXcgUmVkaXNDYWNoZU1hbmFnZXIoY29uZmlnLnJlZGlzVXJsLCBjb25maWcucmVkaXNLZXlQcmVmaXgpO1xyXG4gICAgY29uc3QgbWV0cmljcyA9IG5ldyBSb3V0aW5nTWV0cmljc1RyYWNrZXIocHJpc21hKTtcclxuXHJcbiAgICByb3V0ZXIgPSBuZXcgSGllcmFyY2hpY2FsUm91dGVyKGNvbmZpZywgcHJpc21hLCBjbGFzc2lmaWVyLCBsb2NhbExMTSwgcmFwU3lzdGVtLCBjYWNoZSwgbWV0cmljcyk7XHJcbiAgfSk7XHJcblxyXG4gIGFmdGVyRWFjaChhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBwcmlzbWEuJGRpc2Nvbm5lY3QoKTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0NvbXBsZXRlIFF1ZXJ5IFJvdXRpbmcgRmxvdycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgcm91dGUgc2ltcGxlIHF1ZXJ5IHRocm91Z2ggTG9jYWwgTExNJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBxdWVyeTogQUlRdWVyeSA9IHtcclxuICAgICAgICBxdWVyeTogJ1doYXQgaXMgdGhlIGNhcGl0YWwgb2YgRnJhbmNlPycsXHJcbiAgICAgICAgdXNlcklkOiAndGVzdC11c2VyLTEnXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByb3V0ZXIucm91dGUocXVlcnkpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5jb250ZW50KS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnJlc3BvbnNlVGltZSkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICBleHBlY3QocmVzdWx0LmNvc3QpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNsYXNzaWZ5IGFuZCByb3V0ZSBtb2RlcmF0ZSBxdWVyeScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcXVlcnk6IEFJUXVlcnkgPSB7XHJcbiAgICAgICAgcXVlcnk6ICdBbmFseXplIHRoZSBpbXBhY3Qgb2YgY2xpbWF0ZSBjaGFuZ2Ugb24gZ2xvYmFsIGFncmljdWx0dXJlJyxcclxuICAgICAgICB1c2VySWQ6ICd0ZXN0LXVzZXItMidcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gYXdhaXQgcm91dGVyLmNsYXNzaWZ5KHF1ZXJ5KTtcclxuXHJcbiAgICAgIGV4cGVjdChjbGFzc2lmaWNhdGlvbikudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KGNsYXNzaWZpY2F0aW9uLmNsYXNzaWZpZWRBcykudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KGNsYXNzaWZpY2F0aW9uLnJvdXRlZFRvKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QoW1JvdXRpbmdUaWVyLkxPQ0FMX0xMTSwgUm91dGluZ1RpZXIuUkFQX1NZU1RFTSwgUm91dGluZ1RpZXIuRVhURVJOQUxfTExNXSkudG9Db250YWluKFxyXG4gICAgICAgIGNsYXNzaWZpY2F0aW9uLnJvdXRlZFRvXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNsYXNzaWZ5IGNvbXBsZXggcXVlcnkgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBxdWVyeTogQUlRdWVyeSA9IHtcclxuICAgICAgICBxdWVyeTogJ0RldmVsb3AgYSBjb21wcmVoZW5zaXZlIG11bHRpLXllYXIgc3RyYXRlZ2ljIHBsYW4gZm9yIGRpZ2l0YWwgdHJhbnNmb3JtYXRpb24gdGhhdCBjb25zaWRlcnMgb3JnYW5pemF0aW9uYWwgY3VsdHVyZSwgdGVjaG5vbG9neSBpbmZyYXN0cnVjdHVyZSwgbWFya2V0IGR5bmFtaWNzLCBjb21wZXRpdGl2ZSBsYW5kc2NhcGUsIHJlZ3VsYXRvcnkgZW52aXJvbm1lbnQsIGFuZCBsb25nLXRlcm0gYnVzaW5lc3Mgc3VzdGFpbmFiaWxpdHkgaW1wbGljYXRpb25zJyxcclxuICAgICAgICB1c2VySWQ6ICd0ZXN0LXVzZXItMydcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gYXdhaXQgcm91dGVyLmNsYXNzaWZ5KHF1ZXJ5KTtcclxuXHJcbiAgICAgIGV4cGVjdChjbGFzc2lmaWNhdGlvbi5jbGFzc2lmaWVkQXMpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChjbGFzc2lmaWNhdGlvbi5jb25maWRlbmNlKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIGV4cGVjdChjbGFzc2lmaWNhdGlvbi5jb25maWRlbmNlKS50b0JlTGVzc1RoYW5PckVxdWFsKDEpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdDYWNoaW5nIEJlaGF2aW9yJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBjYWNoZSByZXNwb25zZXMgYW5kIHJldHVybiBjYWNoZWQgcmVzdWx0cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcXVlcnk6IEFJUXVlcnkgPSB7XHJcbiAgICAgICAgcXVlcnk6ICdXaGF0IGlzIFB5dGhvbj8nLFxyXG4gICAgICAgIHVzZXJJZDogJ3Rlc3QtdXNlci00J1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gRmlyc3QgcmVxdWVzdCAtIHNob3VsZCBub3QgYmUgY2FjaGVkXHJcbiAgICAgIGNvbnN0IHJlc3VsdDEgPSBhd2FpdCByb3V0ZXIucm91dGUocXVlcnkpO1xyXG4gICAgICBleHBlY3QocmVzdWx0MSkudG9CZURlZmluZWQoKTtcclxuXHJcbiAgICAgIC8vIFNlY29uZCByZXF1ZXN0IC0gc2hvdWxkIGJlIGNhY2hlZFxyXG4gICAgICBjb25zdCByZXN1bHQyID0gYXdhaXQgcm91dGVyLnJvdXRlKHF1ZXJ5KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdDIpLnRvQmVEZWZpbmVkKCk7XHJcblxyXG4gICAgICAvLyBCb3RoIHNob3VsZCBoYXZlIHNhbWUgY29udGVudFxyXG4gICAgICBleHBlY3QocmVzdWx0MS5jb250ZW50KS50b0JlKHJlc3VsdDIuY29udGVudCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHRyYWNrIGNhY2hlIHN0YXRpc3RpY3MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHF1ZXJ5OiBBSVF1ZXJ5ID0ge1xyXG4gICAgICAgIHF1ZXJ5OiAnSGVsbG8gd29ybGQnLFxyXG4gICAgICAgIHVzZXJJZDogJ3Rlc3QtdXNlci01J1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gTWFrZSBtdWx0aXBsZSByZXF1ZXN0c1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgIGF3YWl0IHJvdXRlci5yb3V0ZShxdWVyeSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgcm91dGVyLmdldENhY2hlU3RhdHMoKTtcclxuXHJcbiAgICAgIGV4cGVjdChzdGF0cykudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KHN0YXRzLmhpdHMpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XHJcbiAgICAgIGV4cGVjdChzdGF0cy5taXNzZXMpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XHJcbiAgICAgIGV4cGVjdChzdGF0cy5zaXplKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdNZXRyaWNzIFRyYWNraW5nJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCB0cmFjayByb3V0aW5nIG1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHF1ZXJpZXM6IEFJUXVlcnlbXSA9IFtcclxuICAgICAgICB7IHF1ZXJ5OiAnV2hhdCBpcyBBST8nLCB1c2VySWQ6ICd1c2VyLTEnIH0sXHJcbiAgICAgICAgeyBxdWVyeTogJ0FuYWx5emUgbWFya2V0IHRyZW5kcycsIHVzZXJJZDogJ3VzZXItMicgfSxcclxuICAgICAgICB7IHF1ZXJ5OiAnRGV2ZWxvcCBzdHJhdGVnaWMgcGxhbicsIHVzZXJJZDogJ3VzZXItMycgfVxyXG4gICAgICBdO1xyXG5cclxuICAgICAgZm9yIChjb25zdCBxdWVyeSBvZiBxdWVyaWVzKSB7XHJcbiAgICAgICAgYXdhaXQgcm91dGVyLnJvdXRlKHF1ZXJ5KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgbWV0cmljcyA9IGF3YWl0IHJvdXRlci5nZXRNZXRyaWNzKCk7XHJcblxyXG4gICAgICBleHBlY3QobWV0cmljcykudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KG1ldHJpY3NbUm91dGluZ1RpZXIuTE9DQUxfTExNXSkudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KG1ldHJpY3NbUm91dGluZ1RpZXIuUkFQX1NZU1RFTV0pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChtZXRyaWNzW1JvdXRpbmdUaWVyLkVYVEVSTkFMX0xMTV0pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgc3lzdGVtIGhlYWx0aCBzdGF0dXMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHF1ZXJ5OiBBSVF1ZXJ5ID0geyBxdWVyeTogJ1Rlc3QgcXVlcnknLCB1c2VySWQ6ICd1c2VyLTEnIH07XHJcblxyXG4gICAgICBhd2FpdCByb3V0ZXIucm91dGUocXVlcnkpO1xyXG5cclxuICAgICAgY29uc3QgaGVhbHRoID0gYXdhaXQgcm91dGVyLmdldFN5c3RlbUhlYWx0aCgpO1xyXG5cclxuICAgICAgZXhwZWN0KGhlYWx0aCkudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KGhlYWx0aC5vdmVyYWxsU3VjY2Vzc1JhdGUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XHJcbiAgICAgIGV4cGVjdChoZWFsdGgub3ZlcmFsbFN1Y2Nlc3NSYXRlKS50b0JlTGVzc1RoYW5PckVxdWFsKDEwMCk7XHJcbiAgICAgIGV4cGVjdChoZWFsdGguYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcclxuICAgICAgZXhwZWN0KGhlYWx0aC50b3RhbFJlcXVlc3RzKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xyXG4gICAgICBleHBlY3QoaGVhbHRoLmNhY2hlSGl0UmF0ZSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgYmVzdCBwZXJmb3JtaW5nIHRpZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHF1ZXJpZXM6IEFJUXVlcnlbXSA9IFtcclxuICAgICAgICB7IHF1ZXJ5OiAnV2hhdCBpcyBBST8nLCB1c2VySWQ6ICd1c2VyLTEnIH0sXHJcbiAgICAgICAgeyBxdWVyeTogJ1doYXQgaXMgTUw/JywgdXNlcklkOiAndXNlci0yJyB9LFxyXG4gICAgICAgIHsgcXVlcnk6ICdXaGF0IGlzIERMPycsIHVzZXJJZDogJ3VzZXItMycgfVxyXG4gICAgICBdO1xyXG5cclxuICAgICAgZm9yIChjb25zdCBxdWVyeSBvZiBxdWVyaWVzKSB7XHJcbiAgICAgICAgYXdhaXQgcm91dGVyLnJvdXRlKHF1ZXJ5KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgYmVzdFRpZXIgPSBhd2FpdCByb3V0ZXIuZ2V0QmVzdFBlcmZvcm1pbmdUaWVyKCk7XHJcblxyXG4gICAgICBleHBlY3QoYmVzdFRpZXIpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChbUm91dGluZ1RpZXIuTE9DQUxfTExNLCBSb3V0aW5nVGllci5SQVBfU1lTVEVNLCBSb3V0aW5nVGllci5FWFRFUk5BTF9MTE1dKS50b0NvbnRhaW4oXHJcbiAgICAgICAgYmVzdFRpZXJcclxuICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgY2hlYXBlc3QgdGllcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgY2hlYXBlc3RUaWVyID0gYXdhaXQgcm91dGVyLmdldENoZWFwZXN0VGllcigpO1xyXG5cclxuICAgICAgZXhwZWN0KGNoZWFwZXN0VGllcikudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KFtSb3V0aW5nVGllci5MT0NBTF9MTE0sIFJvdXRpbmdUaWVyLlJBUF9TWVNURU0sIFJvdXRpbmdUaWVyLkVYVEVSTkFMX0xMTV0pLnRvQ29udGFpbihcclxuICAgICAgICBjaGVhcGVzdFRpZXJcclxuICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgZmFzdGVzdCB0aWVyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBmYXN0ZXN0VGllciA9IGF3YWl0IHJvdXRlci5nZXRGYXN0ZXN0VGllcigpO1xyXG5cclxuICAgICAgZXhwZWN0KGZhc3Rlc3RUaWVyKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QoW1JvdXRpbmdUaWVyLkxPQ0FMX0xMTSwgUm91dGluZ1RpZXIuUkFQX1NZU1RFTSwgUm91dGluZ1RpZXIuRVhURVJOQUxfTExNXSkudG9Db250YWluKFxyXG4gICAgICAgIGZhc3Rlc3RUaWVyXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0NvbmZpZ3VyYXRpb24gTWFuYWdlbWVudCcsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgYWxsb3cgdXBkYXRpbmcgbGF0ZW5jeSB0aHJlc2hvbGRzJywgKCkgPT4ge1xyXG4gICAgICByb3V0ZXIuc2V0TGF0ZW5jeVRocmVzaG9sZChSb3V0aW5nVGllci5MT0NBTF9MTE0sIDMwMCk7XHJcbiAgICAgIHJvdXRlci5zZXRMYXRlbmN5VGhyZXNob2xkKFJvdXRpbmdUaWVyLlJBUF9TWVNURU0sIDE1MDApO1xyXG4gICAgICByb3V0ZXIuc2V0TGF0ZW5jeVRocmVzaG9sZChSb3V0aW5nVGllci5FWFRFUk5BTF9MTE0sIDQwMDApO1xyXG5cclxuICAgICAgLy8gVmVyaWZ5IGJ5IG1ha2luZyBhIHJlcXVlc3RcclxuICAgICAgZXhwZWN0KHJvdXRlcikudG9CZURlZmluZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgYWxsb3cgdXBkYXRpbmcgY29zdCB0aHJlc2hvbGRzJywgKCkgPT4ge1xyXG4gICAgICByb3V0ZXIuc2V0Q29zdFRocmVzaG9sZChSb3V0aW5nVGllci5MT0NBTF9MTE0sIDApO1xyXG4gICAgICByb3V0ZXIuc2V0Q29zdFRocmVzaG9sZChSb3V0aW5nVGllci5SQVBfU1lTVEVNLCAwLjA1KTtcclxuICAgICAgcm91dGVyLnNldENvc3RUaHJlc2hvbGQoUm91dGluZ1RpZXIuRVhURVJOQUxfTExNLCAwLjE1KTtcclxuXHJcbiAgICAgIGV4cGVjdChyb3V0ZXIpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGFsbG93IHVwZGF0aW5nIGZhbGxiYWNrIHN0cmF0ZWdpZXMnLCAoKSA9PiB7XHJcbiAgICAgIHJvdXRlci5zZXRGYWxsYmFja1N0cmF0ZWd5KFJvdXRpbmdUaWVyLkxPQ0FMX0xMTSwge1xyXG4gICAgICAgIHRpZXI6IFJvdXRpbmdUaWVyLkxPQ0FMX0xMTSxcclxuICAgICAgICBjb25kaXRpb246ICdmYWlsdXJlJyxcclxuICAgICAgICB0aHJlc2hvbGQ6IDAsXHJcbiAgICAgICAgbmV4dFRpZXI6IFJvdXRpbmdUaWVyLlJBUF9TWVNURU1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBleHBlY3Qocm91dGVyKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdDYWNoZSBNYW5hZ2VtZW50JywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBjbGVhciBjYWNoZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcXVlcnk6IEFJUXVlcnkgPSB7IHF1ZXJ5OiAnVGVzdCBxdWVyeScsIHVzZXJJZDogJ3VzZXItMScgfTtcclxuXHJcbiAgICAgIC8vIE1ha2UgYSByZXF1ZXN0IHRvIHBvcHVsYXRlIGNhY2hlXHJcbiAgICAgIGF3YWl0IHJvdXRlci5yb3V0ZShxdWVyeSk7XHJcblxyXG4gICAgICAvLyBDbGVhciBjYWNoZVxyXG4gICAgICBhd2FpdCByb3V0ZXIuY2xlYXJDYWNoZSgpO1xyXG5cclxuICAgICAgLy8gVmVyaWZ5IGNhY2hlIGlzIGNsZWFyZWRcclxuICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCByb3V0ZXIuZ2V0Q2FjaGVTdGF0cygpO1xyXG4gICAgICBleHBlY3Qoc3RhdHMuc2l6ZSkudG9CZSgwKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnTWV0cmljcyBSZXNldCcsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgcmVzZXQgYWxsIG1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHF1ZXJ5OiBBSVF1ZXJ5ID0geyBxdWVyeTogJ1Rlc3QgcXVlcnknLCB1c2VySWQ6ICd1c2VyLTEnIH07XHJcblxyXG4gICAgICAvLyBNYWtlIHJlcXVlc3RzIHRvIHBvcHVsYXRlIG1ldHJpY3NcclxuICAgICAgYXdhaXQgcm91dGVyLnJvdXRlKHF1ZXJ5KTtcclxuXHJcbiAgICAgIC8vIFJlc2V0IG1ldHJpY3NcclxuICAgICAgYXdhaXQgcm91dGVyLnJlc2V0TWV0cmljcygpO1xyXG5cclxuICAgICAgLy8gVmVyaWZ5IG1ldHJpY3MgYXJlIHJlc2V0XHJcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBhd2FpdCByb3V0ZXIuZ2V0TWV0cmljcygpO1xyXG4gICAgICBleHBlY3QobWV0cmljc1tSb3V0aW5nVGllci5MT0NBTF9MTE1dLnRvdGFsUmVxdWVzdHMpLnRvQmUoMCk7XHJcbiAgICAgIGV4cGVjdChtZXRyaWNzW1JvdXRpbmdUaWVyLlJBUF9TWVNURU1dLnRvdGFsUmVxdWVzdHMpLnRvQmUoMCk7XHJcbiAgICAgIGV4cGVjdChtZXRyaWNzW1JvdXRpbmdUaWVyLkVYVEVSTkFMX0xMTV0udG90YWxSZXF1ZXN0cykudG9CZSgwKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIHF1ZXJpZXMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcXVlcnk6IEFJUXVlcnkgPSB7IHF1ZXJ5OiAnJywgdXNlcklkOiAndXNlci0xJyB9O1xyXG5cclxuICAgICAgLy8gU2hvdWxkIG5vdCB0aHJvdywgYnV0IGhhbmRsZSBncmFjZWZ1bGx5XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJvdXRlci5yb3V0ZShxdWVyeSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB2ZXJ5IGxvbmcgcXVlcmllcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgbG9uZ1F1ZXJ5ID0gJ3dvcmQgJy5yZXBlYXQoMTAwMCk7XHJcbiAgICAgIGNvbnN0IHF1ZXJ5OiBBSVF1ZXJ5ID0geyBxdWVyeTogbG9uZ1F1ZXJ5LCB1c2VySWQ6ICd1c2VyLTEnIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByb3V0ZXIucm91dGUocXVlcnkpO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdNdWx0aS1RdWVyeSBSb3V0aW5nJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbXVsdGlwbGUgY29uY3VycmVudCBxdWVyaWVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBxdWVyaWVzOiBBSVF1ZXJ5W10gPSBbXHJcbiAgICAgICAgeyBxdWVyeTogJ1doYXQgaXMgQUk/JywgdXNlcklkOiAndXNlci0xJyB9LFxyXG4gICAgICAgIHsgcXVlcnk6ICdBbmFseXplIHRyZW5kcycsIHVzZXJJZDogJ3VzZXItMicgfSxcclxuICAgICAgICB7IHF1ZXJ5OiAnRGV2ZWxvcCBzdHJhdGVneScsIHVzZXJJZDogJ3VzZXItMycgfVxyXG4gICAgICBdO1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKHF1ZXJpZXMubWFwKHEgPT4gcm91dGVyLnJvdXRlKHEpKSk7XHJcblxyXG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDMpO1xyXG4gICAgICByZXN1bHRzLmZvckVhY2gocmVzdWx0ID0+IHtcclxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQuY29udGVudCkudG9CZURlZmluZWQoKTtcclxuICAgICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdUaWVyKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gc2VwYXJhdGUgbWV0cmljcyBmb3IgZGlmZmVyZW50IHF1ZXJ5IHR5cGVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzaW1wbGVRdWVyeTogQUlRdWVyeSA9IHsgcXVlcnk6ICdXaGF0IGlzIEFJPycsIHVzZXJJZDogJ3VzZXItMScgfTtcclxuICAgICAgY29uc3QgY29tcGxleFF1ZXJ5OiBBSVF1ZXJ5ID0ge1xyXG4gICAgICAgIHF1ZXJ5OiAnRGV2ZWxvcCBjb21wcmVoZW5zaXZlIHN0cmF0ZWdpYyBwbGFuJyxcclxuICAgICAgICB1c2VySWQ6ICd1c2VyLTInXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBhd2FpdCByb3V0ZXIucm91dGUoc2ltcGxlUXVlcnkpO1xyXG4gICAgICBhd2FpdCByb3V0ZXIucm91dGUoY29tcGxleFF1ZXJ5KTtcclxuXHJcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBhd2FpdCByb3V0ZXIuZ2V0TWV0cmljcygpO1xyXG5cclxuICAgICAgLy8gQXQgbGVhc3Qgb25lIHRpZXIgc2hvdWxkIGhhdmUgcmVxdWVzdHNcclxuICAgICAgY29uc3QgdG90YWxSZXF1ZXN0cyA9XHJcbiAgICAgICAgbWV0cmljc1tSb3V0aW5nVGllci5MT0NBTF9MTE1dLnRvdGFsUmVxdWVzdHMgK1xyXG4gICAgICAgIG1ldHJpY3NbUm91dGluZ1RpZXIuUkFQX1NZU1RFTV0udG90YWxSZXF1ZXN0cyArXHJcbiAgICAgICAgbWV0cmljc1tSb3V0aW5nVGllci5FWFRFUk5BTF9MTE1dLnRvdGFsUmVxdWVzdHM7XHJcblxyXG4gICAgICBleHBlY3QodG90YWxSZXF1ZXN0cykudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgyKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFLQSxJQUFBQSxtQkFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsZ0JBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLGdCQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxVQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxrQkFBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssc0JBQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLE1BQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLE9BQUEsR0FBQVAsT0FBQTtBQVpBO0FBQ0E7QUFDQTtBQUNBOztBQVdBUSxRQUFRLENBQUMsaUNBQWlDLEVBQUUsTUFBTTtFQUNoRCxJQUFJQyxNQUEwQjtFQUM5QixJQUFJQyxNQUFvQjtFQUN4QixJQUFJQyxNQUF1QjtFQUUzQkMsVUFBVSxDQUFDLE1BQU07SUFDZkYsTUFBTSxHQUFHLElBQUlHLG9CQUFZLENBQUMsQ0FBQztJQUUzQkYsTUFBTSxHQUFHO01BQ1BHLGVBQWUsRUFBRSxJQUFJO01BQ3JCQyxhQUFhLEVBQUUsT0FBTztNQUN0QkMsb0JBQW9CLEVBQUUsSUFBSTtNQUMxQkMsVUFBVSxFQUFFLElBQUk7TUFDaEJDLGlCQUFpQixFQUFFLHVCQUF1QjtNQUMxQ0Msb0JBQW9CLEVBQUUsR0FBRztNQUN6QkMsb0JBQW9CLEVBQUUsR0FBRztNQUN6QkMsa0JBQWtCLEVBQUUsSUFBSTtNQUN4QkMsbUJBQW1CLEVBQUUsUUFBUTtNQUM3QkMsZ0JBQWdCLEVBQUUsT0FBTztNQUN6QkMsWUFBWSxFQUFFLElBQUk7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