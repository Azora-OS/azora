{"version":3,"names":["generateAccessToken","generateRefreshToken","verifyToken","revokeToken","require","describe","test","payload","userId","email","role","token","expect","toBeDefined","toBe","split","length","decoded","toThrow","expiryTime","exp","iat"],"sources":["jwt.test.js"],"sourcesContent":["const { generateAccessToken, generateRefreshToken, verifyToken, revokeToken } = require('../src/middleware/jwt');\n\ndescribe('JWT Implementation', () => {\n  describe('Token Generation', () => {\n    test('should generate access token with RS256', () => {\n      const payload = { userId: 1, email: 'test@azora.world', role: 'student' };\n      const token = generateAccessToken(payload);\n      \n      expect(token).toBeDefined();\n      expect(typeof token).toBe('string');\n      expect(token.split('.').length).toBe(3);\n    });\n\n    test('should generate refresh token', () => {\n      const payload = { userId: 1 };\n      const token = generateRefreshToken(payload);\n      \n      expect(token).toBeDefined();\n      expect(typeof token).toBe('string');\n    });\n  });\n\n  describe('Token Verification', () => {\n    test('should verify valid token', () => {\n      const payload = { userId: 1, email: 'test@azora.world', role: 'student' };\n      const token = generateAccessToken(payload);\n      const decoded = verifyToken(token);\n      \n      expect(decoded.userId).toBe(1);\n      expect(decoded.email).toBe('test@azora.world');\n      expect(decoded.role).toBe('student');\n    });\n\n    test('should reject revoked token', () => {\n      const payload = { userId: 1, email: 'test@azora.world' };\n      const token = generateAccessToken(payload);\n      \n      revokeToken(token);\n      \n      expect(() => verifyToken(token)).toThrow('Token has been revoked');\n    });\n  });\n\n  describe('Token Expiry', () => {\n    test('access token should expire in 1 hour', () => {\n      const payload = { userId: 1 };\n      const token = generateAccessToken(payload);\n      const decoded = verifyToken(token);\n      \n      const expiryTime = decoded.exp - decoded.iat;\n      expect(expiryTime).toBe(3600); // 1 hour in seconds\n    });\n  });\n});\n"],"mappings":";;AAAA,MAAM;EAAEA,mBAAmB;EAAEC,oBAAoB;EAAEC,WAAW;EAAEC;AAAY,CAAC,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AAEhHC,QAAQ,CAAC,oBAAoB,EAAE,MAAM;EACnCA,QAAQ,CAAC,kBAAkB,EAAE,MAAM;IACjCC,IAAI,CAAC,yCAAyC,EAAE,MAAM;MACpD,MAAMC,OAAO,GAAG;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE,kBAAkB;QAAEC,IAAI,EAAE;MAAU,CAAC;MACzE,MAAMC,KAAK,GAAGX,mBAAmB,CAACO,OAAO,CAAC;MAE1CK,MAAM,CAACD,KAAK,CAAC,CAACE,WAAW,CAAC,CAAC;MAC3BD,MAAM,CAAC,OAAOD,KAAK,CAAC,CAACG,IAAI,CAAC,QAAQ,CAAC;MACnCF,MAAM,CAACD,KAAK,CAACI,KAAK,CAAC,GAAG,CAAC,CAACC,MAAM,CAAC,CAACF,IAAI,CAAC,CAAC,CAAC;IACzC,CAAC,CAAC;IAEFR,IAAI,CAAC,+BAA+B,EAAE,MAAM;MAC1C,MAAMC,OAAO,GAAG;QAAEC,MAAM,EAAE;MAAE,CAAC;MAC7B,MAAMG,KAAK,GAAGV,oBAAoB,CAACM,OAAO,CAAC;MAE3CK,MAAM,CAACD,KAAK,CAAC,CAACE,WAAW,CAAC,CAAC;MAC3BD,MAAM,CAAC,OAAOD,KAAK,CAAC,CAACG,IAAI,CAAC,QAAQ,CAAC;IACrC,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFT,QAAQ,CAAC,oBAAoB,EAAE,MAAM;IACnCC,IAAI,CAAC,2BAA2B,EAAE,MAAM;MACtC,MAAMC,OAAO,GAAG;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE,kBAAkB;QAAEC,IAAI,EAAE;MAAU,CAAC;MACzE,MAAMC,KAAK,GAAGX,mBAAmB,CAACO,OAAO,CAAC;MAC1C,MAAMU,OAAO,GAAGf,WAAW,CAACS,KAAK,CAAC;MAElCC,MAAM,CAACK,OAAO,CAACT,MAAM,CAAC,CAACM,IAAI,CAAC,CAAC,CAAC;MAC9BF,MAAM,CAACK,OAAO,CAACR,KAAK,CAAC,CAACK,IAAI,CAAC,kBAAkB,CAAC;MAC9CF,MAAM,CAACK,OAAO,CAACP,IAAI,CAAC,CAACI,IAAI,CAAC,SAAS,CAAC;IACtC,CAAC,CAAC;IAEFR,IAAI,CAAC,6BAA6B,EAAE,MAAM;MACxC,MAAMC,OAAO,GAAG;QAAEC,MAAM,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAmB,CAAC;MACxD,MAAME,KAAK,GAAGX,mBAAmB,CAACO,OAAO,CAAC;MAE1CJ,WAAW,CAACQ,KAAK,CAAC;MAElBC,MAAM,CAAC,MAAMV,WAAW,CAACS,KAAK,CAAC,CAAC,CAACO,OAAO,CAAC,wBAAwB,CAAC;IACpE,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFb,QAAQ,CAAC,cAAc,EAAE,MAAM;IAC7BC,IAAI,CAAC,sCAAsC,EAAE,MAAM;MACjD,MAAMC,OAAO,GAAG;QAAEC,MAAM,EAAE;MAAE,CAAC;MAC7B,MAAMG,KAAK,GAAGX,mBAAmB,CAACO,OAAO,CAAC;MAC1C,MAAMU,OAAO,GAAGf,WAAW,CAACS,KAAK,CAAC;MAElC,MAAMQ,UAAU,GAAGF,OAAO,CAACG,GAAG,GAAGH,OAAO,CAACI,GAAG;MAC5CT,MAAM,CAACO,UAAU,CAAC,CAACL,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACjC,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}