{"version":3,"names":["fs","_interopRequireWildcard","require","path","_electron","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","PermissionManager","CONFIG_VERSION","DEFAULT_TEMP_DURATION","mainWindow","auditLog","constructor","configPath","join","app","getPath","config","version","grants","networkAllowlist","autoGrantPatterns","initialize","loadConfig","addDefaultAllowlistEntries","requestPermission","options","type","resource","reason","temporary","duration","existingGrant","findGrant","expiresAt","Date","revokePermission","logPermission","granted","shouldAutoGrant","grantPermission","showPermissionPrompt","permanent","grant","timestamp","expirationDuration","now","filter","g","push","saveConfig","initialLength","length","isNetworkAllowed","domain","entry","find","allowed","isKnownSafeDomain","addToNetworkAllowlist","addedAt","removeFromNetworkAllowlist","getGrants","getNetworkAllowlist","getAuditLog","clearAuditLog","addAutoGrantPattern","pattern","includes","removeAutoGrantPattern","p","getAutoGrantPatterns","startsWith","normalizedResource","replace","some","normalizedPattern","escapedPattern","regex","RegExp","test","safeDomains","safe","endsWith","message","formatPermissionMessage","result","dialog","showMessageBox","buttons","defaultId","cancelId","title","detail","response","defaults","exists","data","readFile","loaded","JSON","parse","map","undefined","error","writeFile","stringify","mode","exports"],"sources":["PermissionManager.ts"],"sourcesContent":["import * as fs from 'fs/promises';\nimport * as path from 'path';\nimport { app, dialog, BrowserWindow } from 'electron';\n\n/**\n * Permission types that can be requested\n */\nexport type PermissionType = \n  | 'filesystem:read'\n  | 'filesystem:write'\n  | 'filesystem:delete'\n  | 'network:request'\n  | 'network:external-api'\n  | 'process:execute'\n  | 'git:operation';\n\n/**\n * Permission grant entry\n */\nexport interface PermissionGrant {\n  type: PermissionType;\n  resource: string;\n  granted: boolean;\n  timestamp: Date;\n  expiresAt?: Date;\n  permanent: boolean;\n}\n\n/**\n * Permission request options\n */\nexport interface PermissionRequestOptions {\n  type: PermissionType;\n  resource: string;\n  reason?: string;\n  temporary?: boolean;\n  duration?: number; // Duration in milliseconds for temporary permissions\n}\n\n/**\n * Network allowlist entry\n */\nexport interface AllowlistEntry {\n  domain: string;\n  allowed: boolean;\n  addedAt: Date;\n  reason?: string;\n}\n\n/**\n * Permission configuration\n */\ninterface PermissionConfig {\n  version: string;\n  grants: PermissionGrant[];\n  networkAllowlist: AllowlistEntry[];\n  autoGrantPatterns: string[];\n}\n\n/**\n * PermissionManager handles all permission requests and grants for AzStudio.\n * It provides a security layer for file system access, network requests,\n * and other sensitive operations.\n * \n * Features:\n * - Permission prompts with clear explanations\n * - Network request allowlisting\n * - Temporary and permanent grants\n * - Auto-grant patterns for trusted paths\n * - Audit logging of all permission grants\n */\nexport class PermissionManager {\n  private static readonly CONFIG_VERSION = '1.0.0';\n  private static readonly DEFAULT_TEMP_DURATION = 3600000; // 1 hour\n\n  private configPath: string;\n  private config: PermissionConfig;\n  private mainWindow: BrowserWindow | null = null;\n  private auditLog: Array<{ timestamp: Date; type: string; resource: string; granted: boolean; reason?: string }> = [];\n\n  constructor() {\n    this.configPath = path.join(app.getPath('userData'), 'permissions.json');\n    this.config = {\n      version: PermissionManager.CONFIG_VERSION,\n      grants: [],\n      networkAllowlist: [],\n      autoGrantPatterns: [\n        // Auto-grant for user's home directory and common dev paths\n        path.join(app.getPath('home'), '**'),\n        path.join(app.getPath('documents'), '**'),\n        path.join(app.getPath('desktop'), '**'),\n      ],\n    };\n  }\n\n  /**\n   * Initialize the permission manager\n   */\n  async initialize(mainWindow: BrowserWindow): Promise<void> {\n    this.mainWindow = mainWindow;\n    await this.loadConfig();\n    \n    // Add default network allowlist entries\n    await this.addDefaultAllowlistEntries();\n  }\n\n  /**\n   * Request permission for an operation\n   */\n  async requestPermission(options: PermissionRequestOptions): Promise<boolean> {\n    const { type, resource, reason, temporary = false, duration } = options;\n\n    // Check if permission already granted\n    const existingGrant = this.findGrant(type, resource);\n    if (existingGrant) {\n      // Check if expired\n      if (existingGrant.expiresAt && existingGrant.expiresAt < new Date()) {\n        // Remove expired grant\n        await this.revokePermission(type, resource);\n      } else {\n        this.logPermission(type, resource, true, 'Already granted');\n        return existingGrant.granted;\n      }\n    }\n\n    // Check auto-grant patterns\n    if (this.shouldAutoGrant(type, resource)) {\n      await this.grantPermission(type, resource, true, duration);\n      this.logPermission(type, resource, true, 'Auto-granted');\n      return true;\n    }\n\n    // Show permission prompt\n    const granted = await this.showPermissionPrompt(type, resource, reason);\n    \n    // Store the grant\n    if (granted) {\n      await this.grantPermission(type, resource, !temporary, duration);\n    }\n    \n    this.logPermission(type, resource, granted, reason);\n    \n    return granted;\n  }\n\n  /**\n   * Grant permission for a resource\n   */\n  async grantPermission(\n    type: PermissionType,\n    resource: string,\n    permanent: boolean = false,\n    duration?: number\n  ): Promise<void> {\n    const grant: PermissionGrant = {\n      type,\n      resource,\n      granted: true,\n      timestamp: new Date(),\n      permanent,\n    };\n\n    if (!permanent) {\n      const expirationDuration = duration || PermissionManager.DEFAULT_TEMP_DURATION;\n      grant.expiresAt = new Date(Date.now() + expirationDuration);\n    }\n\n    // Remove existing grant if any\n    this.config.grants = this.config.grants.filter(\n      g => !(g.type === type && g.resource === resource)\n    );\n\n    this.config.grants.push(grant);\n    await this.saveConfig();\n  }\n\n  /**\n   * Revoke permission for a resource\n   */\n  async revokePermission(type: PermissionType, resource: string): Promise<boolean> {\n    const initialLength = this.config.grants.length;\n    this.config.grants = this.config.grants.filter(\n      g => !(g.type === type && g.resource === resource)\n    );\n    \n    if (this.config.grants.length < initialLength) {\n      await this.saveConfig();\n      return true;\n    }\n    \n    return false;\n  }\n\n  /**\n   * Check if a domain is allowed for network requests\n   */\n  async isNetworkAllowed(domain: string): Promise<boolean> {\n    // Check allowlist\n    const entry = this.config.networkAllowlist.find(e => e.domain === domain);\n    if (entry) {\n      return entry.allowed;\n    }\n\n    // Check if it's a known safe domain\n    if (this.isKnownSafeDomain(domain)) {\n      await this.addToNetworkAllowlist(domain, true, 'Known safe domain');\n      return true;\n    }\n\n    // Request permission\n    const granted = await this.requestPermission({\n      type: 'network:request',\n      resource: domain,\n      reason: `Allow network requests to ${domain}?`,\n    });\n\n    if (granted) {\n      await this.addToNetworkAllowlist(domain, true, 'User granted');\n    }\n\n    return granted;\n  }\n\n  /**\n   * Add domain to network allowlist\n   */\n  async addToNetworkAllowlist(domain: string, allowed: boolean, reason?: string): Promise<void> {\n    // Remove existing entry\n    this.config.networkAllowlist = this.config.networkAllowlist.filter(e => e.domain !== domain);\n\n    this.config.networkAllowlist.push({\n      domain,\n      allowed,\n      addedAt: new Date(),\n      reason,\n    });\n\n    await this.saveConfig();\n  }\n\n  /**\n   * Remove domain from network allowlist\n   */\n  async removeFromNetworkAllowlist(domain: string): Promise<boolean> {\n    const initialLength = this.config.networkAllowlist.length;\n    this.config.networkAllowlist = this.config.networkAllowlist.filter(e => e.domain !== domain);\n    \n    if (this.config.networkAllowlist.length < initialLength) {\n      await this.saveConfig();\n      return true;\n    }\n    \n    return false;\n  }\n\n  /**\n   * Get all permission grants\n   */\n  getGrants(): PermissionGrant[] {\n    // Filter out expired grants\n    const now = new Date();\n    return this.config.grants.filter(g => !g.expiresAt || g.expiresAt > now);\n  }\n\n  /**\n   * Get network allowlist\n   */\n  getNetworkAllowlist(): AllowlistEntry[] {\n    return [...this.config.networkAllowlist];\n  }\n\n  /**\n   * Get audit log\n   */\n  getAuditLog(): Array<{ timestamp: Date; type: string; resource: string; granted: boolean; reason?: string }> {\n    return [...this.auditLog];\n  }\n\n  /**\n   * Clear audit log\n   */\n  clearAuditLog(): void {\n    this.auditLog = [];\n  }\n\n  /**\n   * Add auto-grant pattern\n   */\n  async addAutoGrantPattern(pattern: string): Promise<void> {\n    if (!this.config.autoGrantPatterns.includes(pattern)) {\n      this.config.autoGrantPatterns.push(pattern);\n      await this.saveConfig();\n    }\n  }\n\n  /**\n   * Remove auto-grant pattern\n   */\n  async removeAutoGrantPattern(pattern: string): Promise<boolean> {\n    const initialLength = this.config.autoGrantPatterns.length;\n    this.config.autoGrantPatterns = this.config.autoGrantPatterns.filter(p => p !== pattern);\n    \n    if (this.config.autoGrantPatterns.length < initialLength) {\n      await this.saveConfig();\n      return true;\n    }\n    \n    return false;\n  }\n\n  /**\n   * Get auto-grant patterns\n   */\n  getAutoGrantPatterns(): string[] {\n    return [...this.config.autoGrantPatterns];\n  }\n\n  /**\n   * Find existing grant\n   */\n  private findGrant(type: PermissionType, resource: string): PermissionGrant | undefined {\n    return this.config.grants.find(g => g.type === type && g.resource === resource);\n  }\n\n  /**\n   * Check if permission should be auto-granted\n   */\n  private shouldAutoGrant(type: PermissionType, resource: string): boolean {\n    // Only auto-grant filesystem operations\n    if (!type.startsWith('filesystem:')) {\n      return false;\n    }\n\n    // Normalize paths for comparison (handle both forward and back slashes)\n    const normalizedResource = resource.replace(/\\\\/g, '/');\n\n    // Check against patterns\n    return this.config.autoGrantPatterns.some(pattern => {\n      // Normalize pattern path\n      const normalizedPattern = pattern.replace(/\\\\/g, '/');\n      \n      // Escape special regex characters except * and **\n      const escapedPattern = normalizedPattern\n        .replace(/[.+?^${}()|[\\]]/g, '\\\\$&')\n        .replace(/\\*\\*/g, '___DOUBLESTAR___')\n        .replace(/\\*/g, '[^/]*')\n        .replace(/___DOUBLESTAR___/g, '.*');\n      \n      const regex = new RegExp(`^${escapedPattern}$`);\n      return regex.test(normalizedResource);\n    });\n  }\n\n  /**\n   * Check if domain is known to be safe\n   */\n  private isKnownSafeDomain(domain: string): boolean {\n    const safeDomains = [\n      'api.openai.com',\n      'api.anthropic.com',\n      'api.elevenlabs.io',\n      'api.heygen.com',\n      'github.com',\n      'api.github.com',\n      'gitlab.com',\n      'vercel.com',\n      'railway.app',\n      'render.com',\n    ];\n\n    return safeDomains.some(safe => domain === safe || domain.endsWith(`.${safe}`));\n  }\n\n  /**\n   * Show permission prompt dialog\n   */\n  private async showPermissionPrompt(\n    type: PermissionType,\n    resource: string,\n    reason?: string\n  ): Promise<boolean> {\n    if (!this.mainWindow) {\n      return false;\n    }\n\n    const message = this.formatPermissionMessage(type, resource, reason);\n    \n    const result = await dialog.showMessageBox(this.mainWindow, {\n      type: 'question',\n      buttons: ['Allow', 'Deny', 'Allow Always'],\n      defaultId: 0,\n      cancelId: 1,\n      title: 'Permission Request',\n      message: 'AzStudio Permission Request',\n      detail: message,\n    });\n\n    // If \"Allow Always\" was clicked\n    if (result.response === 2) {\n      await this.grantPermission(type, resource, true);\n      return true;\n    }\n\n    return result.response === 0;\n  }\n\n  /**\n   * Format permission message for display\n   */\n  private formatPermissionMessage(type: PermissionType, resource: string, reason?: string): string {\n    let message = '';\n\n    switch (type) {\n      case 'filesystem:read':\n        message = `Read files from:\\n${resource}`;\n        break;\n      case 'filesystem:write':\n        message = `Write files to:\\n${resource}`;\n        break;\n      case 'filesystem:delete':\n        message = `Delete files from:\\n${resource}`;\n        break;\n      case 'network:request':\n        message = `Make network requests to:\\n${resource}`;\n        break;\n      case 'network:external-api':\n        message = `Access external API:\\n${resource}`;\n        break;\n      case 'process:execute':\n        message = `Execute process:\\n${resource}`;\n        break;\n      case 'git:operation':\n        message = `Perform Git operation:\\n${resource}`;\n        break;\n    }\n\n    if (reason) {\n      message += `\\n\\nReason: ${reason}`;\n    }\n\n    return message;\n  }\n\n  /**\n   * Log permission grant/denial\n   */\n  private logPermission(type: string, resource: string, granted: boolean, reason?: string): void {\n    this.auditLog.push({\n      timestamp: new Date(),\n      type,\n      resource,\n      granted,\n      reason,\n    });\n  }\n\n  /**\n   * Add default network allowlist entries\n   */\n  private async addDefaultAllowlistEntries(): Promise<void> {\n    const defaults = [\n      { domain: 'api.openai.com', reason: 'OpenAI API for AI features' },\n      { domain: 'api.anthropic.com', reason: 'Anthropic API for AI features' },\n      { domain: 'api.elevenlabs.io', reason: 'ElevenLabs API for text-to-speech' },\n      { domain: 'api.heygen.com', reason: 'HeyGen API for video generation' },\n      { domain: 'github.com', reason: 'GitHub for Git operations' },\n      { domain: 'api.github.com', reason: 'GitHub API for repository operations' },\n    ];\n\n    for (const { domain, reason } of defaults) {\n      const exists = this.config.networkAllowlist.some(e => e.domain === domain);\n      if (!exists) {\n        this.config.networkAllowlist.push({\n          domain,\n          allowed: true,\n          addedAt: new Date(),\n          reason,\n        });\n      }\n    }\n\n    await this.saveConfig();\n  }\n\n  /**\n   * Load configuration from file\n   */\n  private async loadConfig(): Promise<void> {\n    try {\n      const data = await fs.readFile(this.configPath, 'utf-8');\n      const loaded = JSON.parse(data);\n      \n      // Merge with defaults\n      this.config = {\n        ...this.config,\n        ...loaded,\n        grants: loaded.grants.map((g: any) => ({\n          ...g,\n          timestamp: new Date(g.timestamp),\n          expiresAt: g.expiresAt ? new Date(g.expiresAt) : undefined,\n        })),\n        networkAllowlist: loaded.networkAllowlist.map((e: any) => ({\n          ...e,\n          addedAt: new Date(e.addedAt),\n        })),\n      };\n    } catch (error) {\n      // Config doesn't exist yet, use defaults\n      await this.saveConfig();\n    }\n  }\n\n  /**\n   * Save configuration to file\n   */\n  private async saveConfig(): Promise<void> {\n    await fs.writeFile(this.configPath, JSON.stringify(this.config, null, 2), { mode: 0o600 });\n  }\n}\n"],"mappings":"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","ignoreList":[]}