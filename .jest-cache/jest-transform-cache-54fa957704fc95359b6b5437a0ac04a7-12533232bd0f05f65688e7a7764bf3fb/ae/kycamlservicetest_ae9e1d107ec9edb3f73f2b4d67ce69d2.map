{"version":3,"names":["request","require","app","describe","it","response","get","expect","status","toBe","body","service","userData","userId","documentType","documentNumber","post","send","set","success","verificationId","toBeDefined","error","isSanctioned"],"sources":["kyc-aml-service.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst app = require('../server.js');\r\n\r\ndescribe('KYC/AML Service', () => {\r\n  describe('GET /health', () => {\r\n    it('should return health status', async () => {\r\n      const response = await request(app).get('/health');\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.status).toBe('OK');\r\n      expect(response.body.service).toBe('kyc-aml-service');\r\n    });\r\n  });\r\n\r\n  describe('POST /api/kyc/verify', () => {\r\n    it('should verify user identity', async () => {\r\n      const userData = {\r\n        userId: 'user_123',\r\n        documentType: 'passport',\r\n        documentNumber: 'P12345678'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/kyc/verify')\r\n        .send(userData)\r\n        .set('Accept', 'application/json');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.verificationId).toBeDefined();\r\n      expect(response.body.status).toBe('verified');\r\n    });\r\n\r\n    it('should return error when required fields are missing', async () => {\r\n      const userData = {\r\n        userId: 'user_123'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/kyc/verify')\r\n        .send(userData)\r\n        .set('Accept', 'application/json');\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Document type and number are required');\r\n    });\r\n  });\r\n\r\n  describe('GET /api/aml/check/:userId', () => {\r\n    it('should check user against watchlists', async () => {\r\n      const userId = 'user_123';\r\n\r\n      const response = await request(app)\r\n        .get(`/api/aml/check/${userId}`)\r\n        .set('Accept', 'application/json');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.success).toBe(true);\r\n      expect(response.body.userId).toBe(userId);\r\n      expect(response.body.isSanctioned).toBeDefined();\r\n    });\r\n  });\r\n\r\n  describe('404 handling', () => {\r\n    it('should return 404 for unknown routes', async () => {\r\n      const response = await request(app).get('/non-existent-route');\r\n      expect(response.status).toBe(404);\r\n      expect(response.body.error).toBe('Route not found');\r\n    });\r\n  });\r\n});"],"mappings":"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","ignoreList":[]}