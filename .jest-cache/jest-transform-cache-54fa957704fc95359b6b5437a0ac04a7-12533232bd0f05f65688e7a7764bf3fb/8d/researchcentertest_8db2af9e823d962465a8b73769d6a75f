470444e20dd3d23f5e3a70d6a75217de
"use strict";

const request = require('supertest');
const app = require('../index');
describe('Research Center Service', () => {
  // Health check test
  describe('GET /health', () => {
    it('should return health status', async () => {
      const response = await request(app).get('/health').expect(200);
      expect(response.body.status).toBe('healthy');
      expect(response.body.service).toBe('research-center-service');
    });
  });

  // Get all research projects test
  describe('GET /api/research-projects', () => {
    it('should return all research projects', async () => {
      const response = await request(app).get('/api/research-projects').expect(200);
      expect(response.body.success).toBe(true);
      expect(Array.isArray(response.body.data)).toBe(true);
      expect(response.body.count).toBeGreaterThanOrEqual(0);
    });
  });

  // Get specific research project test
  describe('GET /api/research-projects/:projectId', () => {
    it('should return specific research project', async () => {
      const response = await request(app).get('/api/research-projects/project_1').expect(200);
      expect(response.body.success).toBe(true);
      expect(response.body.data.id).toBe('project_1');
    });
    it('should return 404 for non-existent project', async () => {
      const response = await request(app).get('/api/research-projects/non-existent').expect(404);
      expect(response.body.error).toBe('Research project not found');
    });
  });

  // Create a new research project test
  describe('POST /api/research-projects', () => {
    it('should create a new research project', async () => {
      const projectData = {
        title: 'New Research Project',
        description: 'A new research project for testing',
        leadResearcher: 'Dr. Test Researcher',
        status: 'active'
      };
      const response = await request(app).post('/api/research-projects').send(projectData).expect(201);
      expect(response.body.success).toBe(true);
      expect(response.body.data.title).toBe('New Research Project');
      expect(response.body.data.description).toBe('A new research project for testing');
      expect(response.body.data.leadResearcher).toBe('Dr. Test Researcher');
    });
    it('should return 400 for missing required fields', async () => {
      const projectData = {
        title: 'New Research Project'
        // Missing description and leadResearcher
      };
      const response = await request(app).post('/api/research-projects').send(projectData).expect(400);
      expect(response.body.error).toBe('Title, description, and lead researcher are required');
    });
  });

  // Update research project test
  describe('PUT /api/research-projects/:projectId', () => {
    let projectId;
    beforeAll(async () => {
      // Create a project first
      const projectData = {
        title: 'Test Research Project',
        description: 'Test research project for updating',
        leadResearcher: 'Dr. Test Researcher'
      };
      const response = await request(app).post('/api/research-projects').send(projectData);
      projectId = response.body.data.id;
    });
    it('should update research project', async () => {
      const updateData = {
        title: 'Updated Research Project',
        status: 'completed'
      };
      const response = await request(app).put(`/api/research-projects/${projectId}`).send(updateData).expect(200);
      expect(response.body.success).toBe(true);
      expect(response.body.data.title).toBe('Updated Research Project');
      expect(response.body.data.status).toBe('completed');
    });
    it('should return 404 for non-existent project', async () => {
      const updateData = {
        title: 'Updated Research Project'
      };
      const response = await request(app).put('/api/research-projects/non-existent').send(updateData).expect(404);
      expect(response.body.error).toBe('Research project not found');
    });
  });

  // Get all publications test
  describe('GET /api/publications', () => {
    it('should return all publications', async () => {
      const response = await request(app).get('/api/publications').expect(200);
      expect(response.body.success).toBe(true);
      expect(Array.isArray(response.body.data)).toBe(true);
      expect(response.body.count).toBeGreaterThanOrEqual(0);
    });
  });

  // Get publications for a specific project test
  describe('GET /api/research-projects/:projectId/publications', () => {
    it('should return publications for a specific project', async () => {
      const response = await request(app).get('/api/research-projects/project_1/publications').expect(200);
      expect(response.body.success).toBe(true);
      expect(Array.isArray(response.body.data)).toBe(true);
    });
  });

  // Create a new publication test
  describe('POST /api/publications', () => {
    it('should create a new publication', async () => {
      const publicationData = {
        title: 'New Research Publication',
        abstract: 'Abstract of the new research publication',
        projectId: 'project_1',
        authors: ['Dr. Test Researcher', 'Dr. Another Researcher']
      };
      const response = await request(app).post('/api/publications').send(publicationData).expect(201);
      expect(response.body.success).toBe(true);
      expect(response.body.data.title).toBe('New Research Publication');
      expect(response.body.data.abstract).toBe('Abstract of the new research publication');
      expect(response.body.data.projectId).toBe('project_1');
    });
    it('should return 400 for missing required fields', async () => {
      const publicationData = {
        title: 'New Research Publication'
        // Missing abstract and projectId
      };
      const response = await request(app).post('/api/publications').send(publicationData).expect(400);
      expect(response.body.error).toBe('Title, abstract, and project ID are required');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1ZXN0IiwicmVxdWlyZSIsImFwcCIsImRlc2NyaWJlIiwiaXQiLCJyZXNwb25zZSIsImdldCIsImV4cGVjdCIsImJvZHkiLCJzdGF0dXMiLCJ0b0JlIiwic2VydmljZSIsInN1Y2Nlc3MiLCJBcnJheSIsImlzQXJyYXkiLCJkYXRhIiwiY291bnQiLCJ0b0JlR3JlYXRlclRoYW5PckVxdWFsIiwiaWQiLCJlcnJvciIsInByb2plY3REYXRhIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImxlYWRSZXNlYXJjaGVyIiwicG9zdCIsInNlbmQiLCJwcm9qZWN0SWQiLCJiZWZvcmVBbGwiLCJ1cGRhdGVEYXRhIiwicHV0IiwicHVibGljYXRpb25EYXRhIiwiYWJzdHJhY3QiLCJhdXRob3JzIl0sInNvdXJjZXMiOlsicmVzZWFyY2gtY2VudGVyLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3N1cGVydGVzdCcpO1xyXG5jb25zdCBhcHAgPSByZXF1aXJlKCcuLi9pbmRleCcpO1xyXG5cclxuZGVzY3JpYmUoJ1Jlc2VhcmNoIENlbnRlciBTZXJ2aWNlJywgKCkgPT4ge1xyXG4gIC8vIEhlYWx0aCBjaGVjayB0ZXN0XHJcbiAgZGVzY3JpYmUoJ0dFVCAvaGVhbHRoJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gaGVhbHRoIHN0YXR1cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcclxuICAgICAgICAuZ2V0KCcvaGVhbHRoJylcclxuICAgICAgICAuZXhwZWN0KDIwMCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdGF0dXMpLnRvQmUoJ2hlYWx0aHknKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc2VydmljZSkudG9CZSgncmVzZWFyY2gtY2VudGVyLXNlcnZpY2UnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyBHZXQgYWxsIHJlc2VhcmNoIHByb2plY3RzIHRlc3RcclxuICBkZXNjcmliZSgnR0VUIC9hcGkvcmVzZWFyY2gtcHJvamVjdHMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBhbGwgcmVzZWFyY2ggcHJvamVjdHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXHJcbiAgICAgICAgLmdldCgnL2FwaS9yZXNlYXJjaC1wcm9qZWN0cycpXHJcbiAgICAgICAgLmV4cGVjdCgyMDApO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzcG9uc2UuYm9keS5kYXRhKSkudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuY291bnQpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gR2V0IHNwZWNpZmljIHJlc2VhcmNoIHByb2plY3QgdGVzdFxyXG4gIGRlc2NyaWJlKCdHRVQgL2FwaS9yZXNlYXJjaC1wcm9qZWN0cy86cHJvamVjdElkJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gc3BlY2lmaWMgcmVzZWFyY2ggcHJvamVjdCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcclxuICAgICAgICAuZ2V0KCcvYXBpL3Jlc2VhcmNoLXByb2plY3RzL3Byb2plY3RfMScpXHJcbiAgICAgICAgLmV4cGVjdCgyMDApO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YS5pZCkudG9CZSgncHJvamVjdF8xJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiA0MDQgZm9yIG5vbi1leGlzdGVudCBwcm9qZWN0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxyXG4gICAgICAgIC5nZXQoJy9hcGkvcmVzZWFyY2gtcHJvamVjdHMvbm9uLWV4aXN0ZW50JylcclxuICAgICAgICAuZXhwZWN0KDQwNCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvcikudG9CZSgnUmVzZWFyY2ggcHJvamVjdCBub3QgZm91bmQnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyBDcmVhdGUgYSBuZXcgcmVzZWFyY2ggcHJvamVjdCB0ZXN0XHJcbiAgZGVzY3JpYmUoJ1BPU1QgL2FwaS9yZXNlYXJjaC1wcm9qZWN0cycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgbmV3IHJlc2VhcmNoIHByb2plY3QnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHByb2plY3REYXRhID0ge1xyXG4gICAgICAgIHRpdGxlOiAnTmV3IFJlc2VhcmNoIFByb2plY3QnLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQSBuZXcgcmVzZWFyY2ggcHJvamVjdCBmb3IgdGVzdGluZycsXHJcbiAgICAgICAgbGVhZFJlc2VhcmNoZXI6ICdEci4gVGVzdCBSZXNlYXJjaGVyJyxcclxuICAgICAgICBzdGF0dXM6ICdhY3RpdmUnXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxyXG4gICAgICAgIC5wb3N0KCcvYXBpL3Jlc2VhcmNoLXByb2plY3RzJylcclxuICAgICAgICAuc2VuZChwcm9qZWN0RGF0YSlcclxuICAgICAgICAuZXhwZWN0KDIwMSk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdWNjZXNzKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLnRpdGxlKS50b0JlKCdOZXcgUmVzZWFyY2ggUHJvamVjdCcpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLmRlc2NyaXB0aW9uKS50b0JlKCdBIG5ldyByZXNlYXJjaCBwcm9qZWN0IGZvciB0ZXN0aW5nJyk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEubGVhZFJlc2VhcmNoZXIpLnRvQmUoJ0RyLiBUZXN0IFJlc2VhcmNoZXInKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBmb3IgbWlzc2luZyByZXF1aXJlZCBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHByb2plY3REYXRhID0ge1xyXG4gICAgICAgIHRpdGxlOiAnTmV3IFJlc2VhcmNoIFByb2plY3QnXHJcbiAgICAgICAgLy8gTWlzc2luZyBkZXNjcmlwdGlvbiBhbmQgbGVhZFJlc2VhcmNoZXJcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXHJcbiAgICAgICAgLnBvc3QoJy9hcGkvcmVzZWFyY2gtcHJvamVjdHMnKVxyXG4gICAgICAgIC5zZW5kKHByb2plY3REYXRhKVxyXG4gICAgICAgIC5leHBlY3QoNDAwKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmVycm9yKS50b0JlKCdUaXRsZSwgZGVzY3JpcHRpb24sIGFuZCBsZWFkIHJlc2VhcmNoZXIgYXJlIHJlcXVpcmVkJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gVXBkYXRlIHJlc2VhcmNoIHByb2plY3QgdGVzdFxyXG4gIGRlc2NyaWJlKCdQVVQgL2FwaS9yZXNlYXJjaC1wcm9qZWN0cy86cHJvamVjdElkJywgKCkgPT4ge1xyXG4gICAgbGV0IHByb2plY3RJZDtcclxuXHJcbiAgICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAvLyBDcmVhdGUgYSBwcm9qZWN0IGZpcnN0XHJcbiAgICAgIGNvbnN0IHByb2plY3REYXRhID0ge1xyXG4gICAgICAgIHRpdGxlOiAnVGVzdCBSZXNlYXJjaCBQcm9qZWN0JyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3QgcmVzZWFyY2ggcHJvamVjdCBmb3IgdXBkYXRpbmcnLFxyXG4gICAgICAgIGxlYWRSZXNlYXJjaGVyOiAnRHIuIFRlc3QgUmVzZWFyY2hlcidcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXHJcbiAgICAgICAgLnBvc3QoJy9hcGkvcmVzZWFyY2gtcHJvamVjdHMnKVxyXG4gICAgICAgIC5zZW5kKHByb2plY3REYXRhKTtcclxuXHJcbiAgICAgIHByb2plY3RJZCA9IHJlc3BvbnNlLmJvZHkuZGF0YS5pZDtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdXBkYXRlIHJlc2VhcmNoIHByb2plY3QnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XHJcbiAgICAgICAgdGl0bGU6ICdVcGRhdGVkIFJlc2VhcmNoIFByb2plY3QnLFxyXG4gICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCdcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXHJcbiAgICAgICAgLnB1dChgL2FwaS9yZXNlYXJjaC1wcm9qZWN0cy8ke3Byb2plY3RJZH1gKVxyXG4gICAgICAgIC5zZW5kKHVwZGF0ZURhdGEpXHJcbiAgICAgICAgLmV4cGVjdCgyMDApO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YS50aXRsZSkudG9CZSgnVXBkYXRlZCBSZXNlYXJjaCBQcm9qZWN0Jyk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEuc3RhdHVzKS50b0JlKCdjb21wbGV0ZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwNCBmb3Igbm9uLWV4aXN0ZW50IHByb2plY3QnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XHJcbiAgICAgICAgdGl0bGU6ICdVcGRhdGVkIFJlc2VhcmNoIFByb2plY3QnXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxyXG4gICAgICAgIC5wdXQoJy9hcGkvcmVzZWFyY2gtcHJvamVjdHMvbm9uLWV4aXN0ZW50JylcclxuICAgICAgICAuc2VuZCh1cGRhdGVEYXRhKVxyXG4gICAgICAgIC5leHBlY3QoNDA0KTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmVycm9yKS50b0JlKCdSZXNlYXJjaCBwcm9qZWN0IG5vdCBmb3VuZCcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIEdldCBhbGwgcHVibGljYXRpb25zIHRlc3RcclxuICBkZXNjcmliZSgnR0VUIC9hcGkvcHVibGljYXRpb25zJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIHB1YmxpY2F0aW9ucycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcclxuICAgICAgICAuZ2V0KCcvYXBpL3B1YmxpY2F0aW9ucycpXHJcbiAgICAgICAgLmV4cGVjdCgyMDApO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzcG9uc2UuYm9keS5kYXRhKSkudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuY291bnQpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gR2V0IHB1YmxpY2F0aW9ucyBmb3IgYSBzcGVjaWZpYyBwcm9qZWN0IHRlc3RcclxuICBkZXNjcmliZSgnR0VUIC9hcGkvcmVzZWFyY2gtcHJvamVjdHMvOnByb2plY3RJZC9wdWJsaWNhdGlvbnMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBwdWJsaWNhdGlvbnMgZm9yIGEgc3BlY2lmaWMgcHJvamVjdCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcclxuICAgICAgICAuZ2V0KCcvYXBpL3Jlc2VhcmNoLXByb2plY3RzL3Byb2plY3RfMS9wdWJsaWNhdGlvbnMnKVxyXG4gICAgICAgIC5leHBlY3QoMjAwKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3BvbnNlLmJvZHkuZGF0YSkpLnRvQmUodHJ1ZSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gQ3JlYXRlIGEgbmV3IHB1YmxpY2F0aW9uIHRlc3RcclxuICBkZXNjcmliZSgnUE9TVCAvYXBpL3B1YmxpY2F0aW9ucycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgbmV3IHB1YmxpY2F0aW9uJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBwdWJsaWNhdGlvbkRhdGEgPSB7XHJcbiAgICAgICAgdGl0bGU6ICdOZXcgUmVzZWFyY2ggUHVibGljYXRpb24nLFxyXG4gICAgICAgIGFic3RyYWN0OiAnQWJzdHJhY3Qgb2YgdGhlIG5ldyByZXNlYXJjaCBwdWJsaWNhdGlvbicsXHJcbiAgICAgICAgcHJvamVjdElkOiAncHJvamVjdF8xJyxcclxuICAgICAgICBhdXRob3JzOiBbJ0RyLiBUZXN0IFJlc2VhcmNoZXInLCAnRHIuIEFub3RoZXIgUmVzZWFyY2hlciddXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxyXG4gICAgICAgIC5wb3N0KCcvYXBpL3B1YmxpY2F0aW9ucycpXHJcbiAgICAgICAgLnNlbmQocHVibGljYXRpb25EYXRhKVxyXG4gICAgICAgIC5leHBlY3QoMjAxKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEudGl0bGUpLnRvQmUoJ05ldyBSZXNlYXJjaCBQdWJsaWNhdGlvbicpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhLmFic3RyYWN0KS50b0JlKCdBYnN0cmFjdCBvZiB0aGUgbmV3IHJlc2VhcmNoIHB1YmxpY2F0aW9uJyk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEucHJvamVjdElkKS50b0JlKCdwcm9qZWN0XzEnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBmb3IgbWlzc2luZyByZXF1aXJlZCBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHB1YmxpY2F0aW9uRGF0YSA9IHtcclxuICAgICAgICB0aXRsZTogJ05ldyBSZXNlYXJjaCBQdWJsaWNhdGlvbidcclxuICAgICAgICAvLyBNaXNzaW5nIGFic3RyYWN0IGFuZCBwcm9qZWN0SWRcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXHJcbiAgICAgICAgLnBvc3QoJy9hcGkvcHVibGljYXRpb25zJylcclxuICAgICAgICAuc2VuZChwdWJsaWNhdGlvbkRhdGEpXHJcbiAgICAgICAgLmV4cGVjdCg0MDApO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQmUoJ1RpdGxlLCBhYnN0cmFjdCwgYW5kIHByb2plY3QgSUQgYXJlIHJlcXVpcmVkJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7Il0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUNwQyxNQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFFL0JFLFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxNQUFNO0VBQ3hDO0VBQ0FBLFFBQVEsQ0FBQyxhQUFhLEVBQUUsTUFBTTtJQUM1QkMsRUFBRSxDQUFDLDZCQUE2QixFQUFFLFlBQVk7TUFDNUMsTUFBTUMsUUFBUSxHQUFHLE1BQU1MLE9BQU8sQ0FBQ0UsR0FBRyxDQUFDLENBQ2hDSSxHQUFHLENBQUMsU0FBUyxDQUFDLENBQ2RDLE1BQU0sQ0FBQyxHQUFHLENBQUM7TUFFZEEsTUFBTSxDQUFDRixRQUFRLENBQUNHLElBQUksQ0FBQ0MsTUFBTSxDQUFDLENBQUNDLElBQUksQ0FBQyxTQUFTLENBQUM7TUFDNUNILE1BQU0sQ0FBQ0YsUUFBUSxDQUFDRyxJQUFJLENBQUNHLE9BQU8sQ0FBQyxDQUFDRCxJQUFJLENBQUMseUJBQXlCLENBQUM7SUFDL0QsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDOztFQUVGO0VBQ0FQLFFBQVEsQ0FBQyw0QkFBNEIsRUFBRSxNQUFNO0lBQzNDQyxFQUFFLENBQUMscUNBQXFDLEVBQUUsWUFBWTtNQUNwRCxNQUFNQyxRQUFRLEdBQUcsTUFBTUwsT0FBTyxDQUFDRSxHQUFHLENBQUMsQ0FDaENJLEdBQUcsQ0FBQyx3QkFBd0IsQ0FBQyxDQUM3QkMsTUFBTSxDQUFDLEdBQUcsQ0FBQztNQUVkQSxNQUFNLENBQUNGLFFBQVEsQ0FBQ0csSUFBSSxDQUFDSSxPQUFPLENBQUMsQ0FBQ0YsSUFBSSxDQUFDLElBQUksQ0FBQztNQUN4Q0gsTUFBTSxDQUFDTSxLQUFLLENBQUNDLE9BQU8sQ0FBQ1QsUUFBUSxDQUFD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