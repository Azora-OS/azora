{"version":3,"names":["_getJestObj","mock","PrismaClient","jest","fn","mockImplementation","userSpending","upsert","mockResolvedValue","deleteMany","costAlert","create","update","_globals","require","_costOptimizer","_types","_client","describe","optimizer","mockPrisma","beforeEach","CostOptimizer","afterEach","clearAllMocks","it","cost","calculateCost","RoutingTier","LOCAL_LLM","expect","toBe","RAP_SYSTEM","toBeGreaterThan","toBeLessThanOrEqual","EXTERNAL_LLM","toBeGreaterThanOrEqual","cost1","cost2","decimalPlaces","toString","split","length","rejects","toThrow","trackSpending","spending","getUserSpending","not","toBeNull","totalSpent","spentByTier","queriesByTier","spending1","spending2","tierMetrics","getTierSpending","totalCost","totalQueries","averageCostPerQuery","i","toHaveBeenCalled","userId","metrics","minCost","maxCost","getSpendingMetrics","avg","getAverageCostPerQuery","total","getTotalCost","getTotalQueries","shouldReject","shouldRejectQuery","undefined"],"sources":["cost-optimizer.test.ts"],"sourcesContent":["/**\r\n * Cost Optimizer Tests\r\n * Tests for cost calculation, tracking, and optimization\r\n */\r\n\r\nimport { describe, it, expect, beforeEach, afterEach } from '@jest/globals';\r\nimport { CostOptimizer, TierCostConfig, CostMetrics, UserSpendingMetrics } from '../cost-optimizer';\r\nimport { RoutingTier } from '../types';\r\nimport { PrismaClient } from '@prisma/client';\r\n\r\n// Mock Prisma\r\njest.mock('@prisma/client', () => ({\r\n  PrismaClient: jest.fn().mockImplementation(() => ({\r\n    userSpending: {\r\n      upsert: jest.fn().mockResolvedValue({}),\r\n      deleteMany: jest.fn().mockResolvedValue({})\r\n    },\r\n    costAlert: {\r\n      create: jest.fn().mockResolvedValue({}),\r\n      update: jest.fn().mockResolvedValue({})\r\n    }\r\n  }))\r\n}));\r\n\r\ndescribe('CostOptimizer', () => {\r\n  let optimizer: CostOptimizer;\r\n  let mockPrisma: any;\r\n\r\n  beforeEach(() => {\r\n    mockPrisma = new PrismaClient();\r\n    optimizer = new CostOptimizer(mockPrisma);\r\n  });\r\n\r\n  afterEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('calculateCost', () => {\r\n    it('should calculate cost for LOCAL_LLM tier (zero cost)', async () => {\r\n      const cost = await optimizer.calculateCost(RoutingTier.LOCAL_LLM, 100, 200);\r\n      expect(cost).toBe(0);\r\n    });\r\n\r\n    it('should calculate cost for RAP_SYSTEM tier', async () => {\r\n      const cost = await optimizer.calculateCost(RoutingTier.RAP_SYSTEM, 100, 200);\r\n      expect(cost).toBeGreaterThan(0);\r\n      expect(cost).toBeLessThanOrEqual(0.05); // Max cost constraint\r\n    });\r\n\r\n    it('should calculate cost for EXTERNAL_LLM tier', async () => {\r\n      const cost = await optimizer.calculateCost(RoutingTier.EXTERNAL_LLM, 100, 200);\r\n      expect(cost).toBeGreaterThan(0);\r\n      expect(cost).toBeLessThanOrEqual(0.10); // Max cost constraint\r\n    });\r\n\r\n    it('should apply minimum cost constraint', async () => {\r\n      const cost = await optimizer.calculateCost(RoutingTier.RAP_SYSTEM, 0, 0);\r\n      expect(cost).toBeGreaterThanOrEqual(0.001); // Min cost for RAP\r\n    });\r\n\r\n    it('should apply maximum cost constraint', async () => {\r\n      const cost = await optimizer.calculateCost(RoutingTier.RAP_SYSTEM, 10000, 10000);\r\n      expect(cost).toBeLessThanOrEqual(0.05); // Max cost for RAP\r\n    });\r\n\r\n    it('should calculate cost based on input tokens', async () => {\r\n      const cost1 = await optimizer.calculateCost(RoutingTier.RAP_SYSTEM, 100, 0);\r\n      const cost2 = await optimizer.calculateCost(RoutingTier.RAP_SYSTEM, 200, 0);\r\n      expect(cost2).toBeGreaterThan(cost1);\r\n    });\r\n\r\n    it('should calculate cost based on output tokens', async () => {\r\n      const cost1 = await optimizer.calculateCost(RoutingTier.RAP_SYSTEM, 0, 100);\r\n      const cost2 = await optimizer.calculateCost(RoutingTier.RAP_SYSTEM, 0, 200);\r\n      expect(cost2).toBeGreaterThan(cost1);\r\n    });\r\n\r\n    it('should round cost to 4 decimal places', async () => {\r\n      const cost = await optimizer.calculateCost(RoutingTier.RAP_SYSTEM, 123, 456);\r\n      const decimalPlaces = (cost.toString().split('.')[1] || '').length;\r\n      expect(decimalPlaces).toBeLessThanOrEqual(4);\r\n    });\r\n\r\n    it('should throw error for unknown tier', async () => {\r\n      await expect(\r\n        optimizer.calculateCost('UNKNOWN_TIER' as RoutingTier, 100, 200)\r\n      ).rejects.toThrow('Unknown routing tier');\r\n    });\r\n\r\n    it('should handle zero tokens', async () => {\r\n      const cost = await optimizer.calculateCost(RoutingTier.LOCAL_LLM, 0, 0);\r\n      expect(cost).toBe(0);\r\n    });\r\n\r\n    it('should handle large token counts', async () => {\r\n      const cost = await optimizer.calculateCost(RoutingTier.EXTERNAL_LLM, 100000, 100000);\r\n      expect(cost).toBeGreaterThan(0);\r\n      expect(cost).toBeLessThanOrEqual(0.10); // Still respects max constraint\r\n    });\r\n  });\r\n\r\n  describe('trackSpending', () => {\r\n    it('should track spending for a user', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n\r\n      const spending = await optimizer.getUserSpending('user-1');\r\n      expect(spending).not.toBeNull();\r\n      expect(spending?.totalSpent).toBe(0.02);\r\n      expect(spending?.spentByTier[RoutingTier.RAP_SYSTEM]).toBe(0.02);\r\n    });\r\n\r\n    it('should accumulate spending for multiple queries', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.03);\r\n\r\n      const spending = await optimizer.getUserSpending('user-1');\r\n      expect(spending?.totalSpent).toBe(0.05);\r\n      expect(spending?.queriesByTier[RoutingTier.RAP_SYSTEM]).toBe(2);\r\n    });\r\n\r\n    it('should track spending across different tiers', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.LOCAL_LLM, 0);\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-1', RoutingTier.EXTERNAL_LLM, 0.05);\r\n\r\n      const spending = await optimizer.getUserSpending('user-1');\r\n      expect(spending?.totalSpent).toBe(0.07);\r\n      expect(spending?.spentByTier[RoutingTier.LOCAL_LLM]).toBe(0);\r\n      expect(spending?.spentByTier[RoutingTier.RAP_SYSTEM]).toBe(0.02);\r\n      expect(spending?.spentByTier[RoutingTier.EXTERNAL_LLM]).toBe(0.05);\r\n    });\r\n\r\n    it('should track spending for multiple users independently', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-2', RoutingTier.RAP_SYSTEM, 0.03);\r\n\r\n      const spending1 = await optimizer.getUserSpending('user-1');\r\n      const spending2 = await optimizer.getUserSpending('user-2');\r\n\r\n      expect(spending1?.totalSpent).toBe(0.02);\r\n      expect(spending2?.totalSpent).toBe(0.03);\r\n    });\r\n\r\n    it('should update tier metrics when tracking spending', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-2', RoutingTier.RAP_SYSTEM, 0.03);\r\n\r\n      const tierMetrics = await optimizer.getTierSpending(RoutingTier.RAP_SYSTEM);\r\n      expect(tierMetrics?.totalCost).toBe(0.05);\r\n      expect(tierMetrics?.totalQueries).toBe(2);\r\n      expect(tierMetrics?.averageCostPerQuery).toBe(0.025);\r\n    });\r\n\r\n    it('should persist spending to database every 50 queries', async () => {\r\n      for (let i = 0; i < 50; i++) {\r\n        await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.01);\r\n      }\r\n\r\n      expect(mockPrisma.userSpending.upsert).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('getUserSpending', () => {\r\n    it('should return null for user with no spending', async () => {\r\n      const spending = await optimizer.getUserSpending('unknown-user');\r\n      expect(spending).toBeNull();\r\n    });\r\n\r\n    it('should return spending metrics for tracked user', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n\r\n      const spending = await optimizer.getUserSpending('user-1');\r\n      expect(spending).not.toBeNull();\r\n      expect(spending?.userId).toBe('user-1');\r\n      expect(spending?.totalSpent).toBe(0.02);\r\n    });\r\n\r\n    it('should include all tier spending in result', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.LOCAL_LLM, 0);\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-1', RoutingTier.EXTERNAL_LLM, 0.05);\r\n\r\n      const spending = await optimizer.getUserSpending('user-1');\r\n      expect(spending?.spentByTier[RoutingTier.LOCAL_LLM]).toBe(0);\r\n      expect(spending?.spentByTier[RoutingTier.RAP_SYSTEM]).toBe(0.02);\r\n      expect(spending?.spentByTier[RoutingTier.EXTERNAL_LLM]).toBe(0.05);\r\n    });\r\n  });\r\n\r\n  describe('getTierSpending', () => {\r\n    it('should return null for tier with no spending', async () => {\r\n      const metrics = await optimizer.getTierSpending(RoutingTier.LOCAL_LLM);\r\n      expect(metrics?.totalCost).toBe(0);\r\n      expect(metrics?.totalQueries).toBe(0);\r\n    });\r\n\r\n    it('should return spending metrics for tier', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-2', RoutingTier.RAP_SYSTEM, 0.03);\r\n\r\n      const metrics = await optimizer.getTierSpending(RoutingTier.RAP_SYSTEM);\r\n      expect(metrics?.totalCost).toBe(0.05);\r\n      expect(metrics?.totalQueries).toBe(2);\r\n      expect(metrics?.averageCostPerQuery).toBe(0.025);\r\n    });\r\n\r\n    it('should track min and max cost per query', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.01);\r\n      await optimizer.trackSpending('user-2', RoutingTier.RAP_SYSTEM, 0.05);\r\n\r\n      const metrics = await optimizer.getTierSpending(RoutingTier.RAP_SYSTEM);\r\n      expect(metrics?.minCost).toBe(0.01);\r\n      expect(metrics?.maxCost).toBe(0.05);\r\n    });\r\n  });\r\n\r\n  describe('getSpendingMetrics', () => {\r\n    it('should return spending for all tiers', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.LOCAL_LLM, 0);\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-1', RoutingTier.EXTERNAL_LLM, 0.05);\r\n\r\n      const metrics = await optimizer.getSpendingMetrics();\r\n      expect(metrics[RoutingTier.LOCAL_LLM]).toBe(0);\r\n      expect(metrics[RoutingTier.RAP_SYSTEM]).toBe(0.02);\r\n      expect(metrics[RoutingTier.EXTERNAL_LLM]).toBe(0.05);\r\n    });\r\n\r\n    it('should return zero for tiers with no spending', async () => {\r\n      const metrics = await optimizer.getSpendingMetrics();\r\n      expect(metrics[RoutingTier.LOCAL_LLM]).toBe(0);\r\n      expect(metrics[RoutingTier.RAP_SYSTEM]).toBe(0);\r\n      expect(metrics[RoutingTier.EXTERNAL_LLM]).toBe(0);\r\n    });\r\n  });\r\n\r\n  describe('getAverageCostPerQuery', () => {\r\n    it('should return 0 for tier with no queries', async () => {\r\n      const avg = await optimizer.getAverageCostPerQuery(RoutingTier.RAP_SYSTEM);\r\n      expect(avg).toBe(0);\r\n    });\r\n\r\n    it('should calculate average cost per query', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-2', RoutingTier.RAP_SYSTEM, 0.04);\r\n\r\n      const avg = await optimizer.getAverageCostPerQuery(RoutingTier.RAP_SYSTEM);\r\n      expect(avg).toBe(0.03);\r\n    });\r\n  });\r\n\r\n  describe('getTotalCost', () => {\r\n    it('should return 0 for tier with no spending', async () => {\r\n      const total = await optimizer.getTotalCost(RoutingTier.RAP_SYSTEM);\r\n      expect(total).toBe(0);\r\n    });\r\n\r\n    it('should return total cost for tier', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-2', RoutingTier.RAP_SYSTEM, 0.03);\r\n\r\n      const total = await optimizer.getTotalCost(RoutingTier.RAP_SYSTEM);\r\n      expect(total).toBe(0.05);\r\n    });\r\n  });\r\n\r\n  describe('getTotalQueries', () => {\r\n    it('should return 0 for tier with no queries', async () => {\r\n      const total = await optimizer.getTotalQueries(RoutingTier.RAP_SYSTEM);\r\n      expect(total).toBe(0);\r\n    });\r\n\r\n    it('should return total queries for tier', async () => {\r\n      await optimizer.trackSpending('user-1', RoutingTier.RAP_SYSTEM, 0.02);\r\n      await optimizer.trackSpending('user-2', RoutingTier.RAP_SYSTEM, 0.03);\r\n\r\n      const total = await optimizer.getTotalQueries(RoutingTier.RAP_SYSTEM);\r\n      expect(total).toBe(2);\r\n    });\r\n  });\r\n\r\n  describe('shouldRejectQuery', () => {\r\n    it('should not reject query within tier max cost', async () => {\r\n      const shouldReject = await optimizer.shouldRejectQuery(RoutingTier.RAP_SYSTEM, 0.02);\r\n      expect(shouldReject).toBe(false);\r\n    });\r\n\r\n    it('should reject query exceeding tier max cost', async () => {\r\n      const shouldReject = await optimizer.shouldRejectQuery(RoutingTier.RAP_SYSTEM, 0.10);\r\n      expect(shouldReject).toBe(true);\r\n    });\r\n\r\n    it('should reject query exceeding user budget', async () => {\r\n      const shouldReject = await optimizer.shouldRejectQuery(\r\n        RoutingTier.RAP_SYSTEM,\r\n        0.02,\r\n        0.01 // User budget\r\n      );\r\n      expect(shouldReject).toBe(true);\r\n    });\r\n\r\n    it('should not reject query within user budget', async () => {\r\n      const shouldReject = await optimizer.shouldRejectQuery(\r\n        RoutingTier.RAP_SYSTEM,\r\n        0.02,\r\n        0.05 // User budget\r\n      );\r\n      expect(shouldReject).toBe(false);\r\n    });\r\n\r\n    it('should handle undefined user budget', async () => {\r\n      const shouldReject = await optimizer.shouldRejectQuery(\r\n        RoutingTier.RAP_SYSTEM,\r\n        0.02,\r\n        undefined\r\n      );\r\n      expect(shouldReject).toBe(false);\r\n    });\r\n  });\r\n});"],"mappings":"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","ignoreList":[]}