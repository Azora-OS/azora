8affe2dc1b3ad6735936d17657872a1d
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ServiceConnectionGenerator = void 0;
var path = _interopRequireWildcard(require("path"));
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) "default" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }
class ServiceConnectionGenerator {
  /**
   * Generate API routes and client code for service-to-service communication
   */
  generateServiceConnection(connection, outputDir) {
    const changes = [];

    // Generate API routes in target service
    changes.push(...this.generateAPIRoutes(connection, outputDir));

    // Generate service client in source service
    changes.push(...this.generateServiceClient(connection, outputDir));

    // Generate authentication middleware if needed
    if (connection.authentication) {
      changes.push(...this.generateAuthMiddleware(connection, outputDir));
    }

    // Generate request validation
    changes.push(...this.generateValidation(connection, outputDir));
    return changes;
  }
  generateAPIRoutes(connection, outputDir) {
    const changes = [];
    const targetDir = path.join(outputDir, 'services', connection.targetService);
    const routeName = this.toKebabCase(connection.sourceService);

    // Generate route controller
    changes.push({
      path: path.join(targetDir, 'src', 'controllers', `${routeName}.controller.ts`),
      type: 'create',
      content: this.generateRouteController(connection)
    });

    // Generate route service
    changes.push({
      path: path.join(targetDir, 'src', 'services', `${routeName}.service.ts`),
      type: 'create',
      content: this.generateRouteService(connection)
    });
    return changes;
  }
  generateRouteController(connection) {
    const serviceName = this.toPascalCase(connection.sourceService);
    return `import { Router, Request, Response, NextFunction } from 'express';
import { ${serviceName}Service } from '../services/${this.toKebabCase(connection.sourceService)}.service';
import { validate } from '../middleware/validation';
import { ${serviceName}Schemas } from '../validation/${this.toKebabCase(connection.sourceService)}.schemas';
${connection.authentication ? "import { authMiddleware } from '../middleware/auth.middleware';" : ''}

export class ${serviceName}Controller {
  public router: Router;
  private ${this.toCamelCase(connection.sourceService)}Service: ${serviceName}Service;

  constructor() {
    this.router = Router();
    this.${this.toCamelCase(connection.sourceService)}Service = new ${serviceName}Service();
    this.initializeRoutes();
  }

  private initializeRoutes(): void {
${connection.endpoints.map(endpoint => {
      const methodName = this.getMethodName(endpoint);
      const hasBody = ['POST', 'PUT', 'PATCH'].includes(endpoint.method);
      return `    // ${endpoint.description}
    this.router.${endpoint.method.toLowerCase()}(
      '${endpoint.path}',
      ${connection.authentication ? 'authMiddleware, ' : ''}${hasBody && endpoint.requestSchema ? `validate(${serviceName}Schemas.${methodName}), ` : ''}this.${methodName}.bind(this)
    );
`;
    }).join('\n')}
  }
${connection.endpoints.map(endpoint => {
      const methodName = this.getMethodName(endpoint);
      return `
  private async ${methodName}(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const result = await this.${this.toCamelCase(connection.sourceService)}Service.${methodName}(${this.getMethodParams(endpoint)});
      res.json({ success: true, data: result });
    } catch (error) {
      next(error);
    }
  }`;
    }).join('\n')}
}
`;
  }
  generateRouteService(connection) {
    const serviceName = this.toPascalCase(connection.sourceService);
    return `export class ${serviceName}Service {
${connection.endpoints.map(endpoint => {
      const methodName = this.getMethodName(endpoint);
      const params = this.getServiceMethodParams(endpoint);
      return `
  async ${methodName}(${params}): Promise<any> {
    // TODO: Implement ${endpoint.description}
    throw new Error('Not implemented');
  }`;
    }).join('\n')}
}
`;
  }
  generateServiceClient(connection, outputDir) {
    const changes = [];
    const sourceDir = path.join(outputDir, 'services', connection.sourceService);
    const clientName = this.toKebabCase(connection.targetService);

    // Generate client class
    changes.push({
      path: path.join(sourceDir, 'src', 'clients', `${clientName}.client.ts`),
      type: 'create',
      content: this.generateClientClass(connection)
    });

    // Generate client types
    changes.push({
      path: path.join(sourceDir, 'src', 'clients', `${clientName}.types.ts`),
      type: 'create',
      content: this.generateClientTypes(connection)
    });
    return changes;
  }
  generateClientClass(connection) {
    const clientName = this.toPascalCase(connection.targetService);
    return `import axios, { AxiosInstance } from 'axios';
${connection.endpoints.map(endpoint => {
      if (endpoint.requestSchema || endpoint.responseSchema) {
        return `import { ${endpoint.requestSchema || ''}, ${endpoint.responseSchema || ''} } from './${this.toKebabCase(connection.targetService)}.types';`;
      }
      return '';
    }).filter(Boolean).join('\n')}

export class ${clientName}Client {
  private client: AxiosInstance;
  private baseURL: string;
${connection.authentication ? '  private authToken?: string;' : ''}

  constructor(baseURL?: string${connection.authentication ? ', authToken?: string' : ''}) {
    this.baseURL = baseURL || process.env.${this.toConstantCase(connection.targetService)}_URL || 'http://localhost:3000';
${connection.authentication ? '    this.authToken = authToken;' : ''}
    
    this.client = axios.create({
      baseURL: this.baseURL,
      timeout: 10000,
      headers: {
        'Content-Type': 'application/json',
${connection.authentication ? "        ...(this.authToken && { Authorization: \`Bearer \${this.authToken}\` })," : ''}
      },
    });
  }
${connection.authentication ? `
  setAuthToken(token: string): void {
    this.authToken = token;
    this.client.defaults.headers.common['Authorization'] = \`Bearer \${token}\`;
  }
` : ''}
${connection.endpoints.map(endpoint => {
      const methodName = this.getMethodName(endpoint);
      const hasBody = ['POST', 'PUT', 'PATCH'].includes(endpoint.method);
      const params = this.getClientMethodParams(endpoint);
      const returnType = endpoint.responseSchema || 'any';
      return `
  async ${methodName}(${params}): Promise<${returnType}> {
    const response = await this.client.${endpoint.method.toLowerCase()}${hasBody ? `(
      '${endpoint.path}',
      ${endpoint.requestSchema ? 'data' : '{}'}
    )` : `('${endpoint.path}')`};
    return response.data.data;
  }`;
    }).join('\n')}
}
`;
  }
  generateClientTypes(connection) {
    const types = new Set();
    connection.endpoints.forEach(endpoint => {
      if (endpoint.requestSchema) types.add(endpoint.requestSchema);
      if (endpoint.responseSchema) types.add(endpoint.responseSchema);
    });
    if (types.size === 0) {
      return '// No types defined for this client\n';
    }
    return Array.from(types).map(type => {
      return `export interface ${type} {
  // TODO: Define ${type} properties
  [key: string]: any;
}
`;
    }).join('\n');
  }
  generateAuthMiddleware(connection, outputDir) {
    const changes = [];
    const targetDir = path.join(outputDir, 'services', connection.targetService);
    changes.push({
      path: path.join(targetDir, 'src', 'middleware', 'auth.middleware.ts'),
      type: 'create',
      content: this.generateAuthMiddlewareContent()
    });
    return changes;
  }
  generateAuthMiddlewareContent() {
    return `import { Request, Response, NextFunction } from 'express';
import jwt from 'jsonwebtoken';
import { AppError } from './error-handler';

interface JWTPayload {
  userId: string;
  email: string;
}

declare global {
  namespace Express {
    interface Request {
      user?: JWTPayload;
    }
  }
}

export const authMiddleware = (
  req: Request,
  res: Response,
  next: NextFunction
): void => {
  try {
    const token = req.headers.authorization?.replace('Bearer ', '');

    if (!token) {
      throw new AppError(401, 'Authentication required');
    }

    const secret = process.env.JWT_SECRET || 'your-secret-key';
    const decoded = jwt.verify(token, secret) as JWTPayload;

    req.user = decoded;
    next();
  } catch (error) {
    next(new AppError(401, 'Invalid or expired token'));
  }
};

export const serviceAuthMiddleware = (
  req: Request,
  res: Response,
  next: NextFunction
): void => {
  try {
    const apiKey = req.headers['x-api-key'];

    if (!apiKey) {
      throw new AppError(401, 'API key required');
    }

    const validApiKey = process.env.SERVICE_API_KEY;
    if (apiKey !== validApiKey) {
      throw new AppError(401, 'Invalid API key');
    }

    next();
  } catch (error) {
    next(error);
  }
};
`;
  }
  generateValidation(connection, outputDir) {
    const changes = [];
    const targetDir = path.join(outputDir, 'services', connection.targetService);
    const schemaName = this.toKebabCase(connection.sourceService);
    changes.push({
      path: path.join(targetDir, 'src', 'validation', `${schemaName}.schemas.ts`),
      type: 'create',
      content: this.generateValidationSchemas(connection)
    });
    return changes;
  }
  generateValidationSchemas(connection) {
    const serviceName = this.toPascalCase(connection.sourceService);
    return `import { z } from 'zod';

export const ${serviceName}Schemas = {
${connection.endpoints.filter(e => e.requestSchema).map(endpoint => {
      const methodName = this.getMethodName(endpoint);
      return `  ${methodName}: z.object({
    body: z.object({
      // TODO: Define validation schema for ${endpoint.description}
    }),
  }),
`;
    }).join('\n')}
};
`;
  }

  // Helper methods
  getMethodName(endpoint) {
    const pathParts = endpoint.path.split('/').filter(p => p && !p.startsWith(':'));
    const action = endpoint.method.toLowerCase();
    return `${action}${pathParts.map(p => this.toPascalCase(p)).join('')}`;
  }
  getMethodParams(endpoint) {
    const params = [];

    // Extract path parameters
    const pathParams = endpoint.path.match(/:(\w+)/g);
    if (pathParams) {
      params.push(...pathParams.map(p => `req.params.${p.slice(1)}`));
    }

    // Add body for POST/PUT/PATCH
    if (['POST', 'PUT', 'PATCH'].includes(endpoint.method)) {
      params.push('req.body');
    }

    // Add query params
    if (endpoint.method === 'GET') {
      params.push('req.query');
    }
    return params.join(', ');
  }
  getServiceMethodParams(endpoint) {
    const params = [];

    // Extract path parameters
    const pathParams = endpoint.path.match(/:(\w+)/g);
    if (pathParams) {
      params.push(...pathParams.map(p => `${p.slice(1)}: string`));
    }

    // Add body for POST/PUT/PATCH
    if (['POST', 'PUT', 'PATCH'].includes(endpoint.method)) {
      params.push('data: any');
    }

    // Add query params
    if (endpoint.method === 'GET') {
      params.push('query?: any');
    }
    return params.join(', ');
  }
  getClientMethodParams(endpoint) {
    const params = [];

    // Extract path parameters
    const pathParams = endpoint.path.match(/:(\w+)/g);
    if (pathParams) {
      params.push(...pathParams.map(p => `${p.slice(1)}: string`));
    }

    // Add body for POST/PUT/PATCH
    if (['POST', 'PUT', 'PATCH'].includes(endpoint.method) && endpoint.requestSchema) {
      params.push(`data: ${endpoint.requestSchema}`);
    }
    return params.join(', ');
  }
  toKebabCase(str) {
    return str.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[\s_]+/g, '-').toLowerCase();
  }
  toCamelCase(str) {
    return str.replace(/[-_\s]+(.)?/g, (_, c) => c ? c.toUpperCase() : '').replace(/^[A-Z]/, c => c.toLowerCase());
  }
  toPascalCase(str) {
    const camel = this.toCamelCase(str);
    return camel.charAt(0).toUpperCase() + camel.slice(1);
  }
  toConstantCase(str) {
    return str.replace(/([a-z])([A-Z])/g, '$1_$2').replace(/[\s-]+/g, '_').toUpperCase();
  }
}
exports.ServiceConnectionGenerator = ServiceConnectionGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwYXRoIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiZSIsInQiLCJXZWFrTWFwIiwiciIsIm4iLCJfX2VzTW9kdWxlIiwibyIsImkiLCJmIiwiX19wcm90b19fIiwiZGVmYXVsdCIsImhhcyIsImdldCIsInNldCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiU2VydmljZUNvbm5lY3Rpb25HZW5lcmF0b3IiLCJnZW5lcmF0ZVNlcnZpY2VDb25uZWN0aW9uIiwiY29ubmVjdGlvbiIsIm91dHB1dERpciIsImNoYW5nZXMiLCJwdXNoIiwiZ2VuZXJhdGVBUElSb3V0ZXMiLCJnZW5lcmF0ZVNlcnZpY2VDbGllbnQiLCJhdXRoZW50aWNhdGlvbiIsImdlbmVyYXRlQXV0aE1pZGRsZXdhcmUiLCJnZW5lcmF0ZVZhbGlkYXRpb24iLCJ0YXJnZXREaXIiLCJqb2luIiwidGFyZ2V0U2VydmljZSIsInJvdXRlTmFtZSIsInRvS2ViYWJDYXNlIiwic291cmNlU2VydmljZSIsInR5cGUiLCJjb250ZW50IiwiZ2VuZXJhdGVSb3V0ZUNvbnRyb2xsZXIiLCJnZW5lcmF0ZVJvdXRlU2VydmljZSIsInNlcnZpY2VOYW1lIiwidG9QYXNjYWxDYXNlIiwidG9DYW1lbENhc2UiLCJlbmRwb2ludHMiLCJtYXAiLCJlbmRwb2ludCIsIm1ldGhvZE5hbWUiLCJnZXRNZXRob2ROYW1lIiwiaGFzQm9keSIsImluY2x1ZGVzIiwibWV0aG9kIiwiZGVzY3JpcHRpb24iLCJ0b0xvd2VyQ2FzZSIsInJlcXVlc3RTY2hlbWEiLCJnZXRNZXRob2RQYXJhbXMiLCJwYXJhbXMiLCJnZXRTZXJ2aWNlTWV0aG9kUGFyYW1zIiwic291cmNlRGlyIiwiY2xpZW50TmFtZSIsImdlbmVyYXRlQ2xpZW50Q2xhc3MiLCJnZW5lcmF0ZUNsaWVudFR5cGVzIiwicmVzcG9uc2VTY2hlbWEiLCJmaWx0ZXIiLCJCb29sZWFuIiwidG9Db25zdGFudENhc2UiLCJnZXRDbGllbnRNZXRob2RQYXJhbXMiLCJyZXR1cm5UeXBlIiwidHlwZXMiLCJTZXQiLCJmb3JFYWNoIiwiYWRkIiwic2l6ZSIsIkFycmF5IiwiZnJvbSIsImdlbmVyYXRlQXV0aE1pZGRsZXdhcmVDb250ZW50Iiwic2NoZW1hTmFtZSIsImdlbmVyYXRlVmFsaWRhdGlvblNjaGVtYXMiLCJwYXRoUGFydHMiLCJzcGxpdCIsInAiLCJzdGFydHNXaXRoIiwiYWN0aW9uIiwicGF0aFBhcmFtcyIsIm1hdGNoIiwic2xpY2UiLCJzdHIiLCJyZXBsYWNlIiwiXyIsImMiLCJ0b1VwcGVyQ2FzZSIsImNhbWVsIiwiY2hhckF0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIlNlcnZpY2VDb25uZWN0aW9uR2VuZXJhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBGaWxlQ2hhbmdlIH0gZnJvbSAnLi4vQ2hhbmdlc2V0TWFuYWdlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VydmljZUNvbm5lY3Rpb24ge1xuICBzb3VyY2VTZXJ2aWNlOiBzdHJpbmc7XG4gIHRhcmdldFNlcnZpY2U6IHN0cmluZztcbiAgZW5kcG9pbnRzOiBDb25uZWN0aW9uRW5kcG9pbnRbXTtcbiAgYXV0aGVudGljYXRpb24/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbm5lY3Rpb25FbmRwb2ludCB7XG4gIG1ldGhvZDogJ0dFVCcgfCAnUE9TVCcgfCAnUFVUJyB8ICdERUxFVEUnIHwgJ1BBVENIJztcbiAgcGF0aDogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICByZXF1ZXN0U2NoZW1hPzogc3RyaW5nO1xuICByZXNwb25zZVNjaGVtYT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFNlcnZpY2VDb25uZWN0aW9uR2VuZXJhdG9yIHtcbiAgLyoqXG4gICAqIEdlbmVyYXRlIEFQSSByb3V0ZXMgYW5kIGNsaWVudCBjb2RlIGZvciBzZXJ2aWNlLXRvLXNlcnZpY2UgY29tbXVuaWNhdGlvblxuICAgKi9cbiAgZ2VuZXJhdGVTZXJ2aWNlQ29ubmVjdGlvbihjb25uZWN0aW9uOiBTZXJ2aWNlQ29ubmVjdGlvbiwgb3V0cHV0RGlyOiBzdHJpbmcpOiBGaWxlQ2hhbmdlW10ge1xuICAgIGNvbnN0IGNoYW5nZXM6IEZpbGVDaGFuZ2VbXSA9IFtdO1xuXG4gICAgLy8gR2VuZXJhdGUgQVBJIHJvdXRlcyBpbiB0YXJnZXQgc2VydmljZVxuICAgIGNoYW5nZXMucHVzaCguLi50aGlzLmdlbmVyYXRlQVBJUm91dGVzKGNvbm5lY3Rpb24sIG91dHB1dERpcikpO1xuXG4gICAgLy8gR2VuZXJhdGUgc2VydmljZSBjbGllbnQgaW4gc291cmNlIHNlcnZpY2VcbiAgICBjaGFuZ2VzLnB1c2goLi4udGhpcy5nZW5lcmF0ZVNlcnZpY2VDbGllbnQoY29ubmVjdGlvbiwgb3V0cHV0RGlyKSk7XG5cbiAgICAvLyBHZW5lcmF0ZSBhdXRoZW50aWNhdGlvbiBtaWRkbGV3YXJlIGlmIG5lZWRlZFxuICAgIGlmIChjb25uZWN0aW9uLmF1dGhlbnRpY2F0aW9uKSB7XG4gICAgICBjaGFuZ2VzLnB1c2goLi4udGhpcy5nZW5lcmF0ZUF1dGhNaWRkbGV3YXJlKGNvbm5lY3Rpb24sIG91dHB1dERpcikpO1xuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIHJlcXVlc3QgdmFsaWRhdGlvblxuICAgIGNoYW5nZXMucHVzaCguLi50aGlzLmdlbmVyYXRlVmFsaWRhdGlvbihjb25uZWN0aW9uLCBvdXRwdXREaXIpKTtcblxuICAgIHJldHVybiBjaGFuZ2VzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUFQSVJvdXRlcyhjb25uZWN0aW9uOiBTZXJ2aWNlQ29ubmVjdGlvbiwgb3V0cHV0RGlyOiBzdHJpbmcpOiBGaWxlQ2hhbmdlW10ge1xuICAgIGNvbnN0IGNoYW5nZXM6IEZpbGVDaGFuZ2VbXSA9IFtdO1xuICAgIGNvbnN0IHRhcmdldERpciA9IHBhdGguam9pbihvdXRwdXREaXIsICdzZXJ2aWNlcycsIGNvbm5lY3Rpb24udGFyZ2V0U2VydmljZSk7XG4gICAgY29uc3Qgcm91dGVOYW1lID0gdGhpcy50b0tlYmFiQ2FzZShjb25uZWN0aW9uLnNvdXJjZVNlcnZpY2UpO1xuXG4gICAgLy8gR2VuZXJhdGUgcm91dGUgY29udHJvbGxlclxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4odGFyZ2V0RGlyLCAnc3JjJywgJ2NvbnRyb2xsZXJzJywgYCR7cm91dGVOYW1lfS5jb250cm9sbGVyLnRzYCksXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgIGNvbnRlbnQ6IHRoaXMuZ2VuZXJhdGVSb3V0ZUNvbnRyb2xsZXIoY29ubmVjdGlvbiksXG4gICAgfSk7XG5cbiAgICAvLyBHZW5lcmF0ZSByb3V0ZSBzZXJ2aWNlXG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHBhdGg6IHBhdGguam9pbih0YXJnZXREaXIsICdzcmMnLCAnc2VydmljZXMnLCBgJHtyb3V0ZU5hbWV9LnNlcnZpY2UudHNgKSxcbiAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZVJvdXRlU2VydmljZShjb25uZWN0aW9uKSxcbiAgICB9KTtcblxuICAgIHJldHVybiBjaGFuZ2VzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVJvdXRlQ29udHJvbGxlcihjb25uZWN0aW9uOiBTZXJ2aWNlQ29ubmVjdGlvbik6IHN0cmluZyB7XG4gICAgY29uc3Qgc2VydmljZU5hbWUgPSB0aGlzLnRvUGFzY2FsQ2FzZShjb25uZWN0aW9uLnNvdXJjZVNlcnZpY2UpO1xuICAgIFxuICAgIHJldHVybiBgaW1wb3J0IHsgUm91dGVyLCBSZXF1ZXN0LCBSZXNwb25zZSwgTmV4dEZ1bmN0aW9uIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyAke3NlcnZpY2VOYW1lfVNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy8ke3RoaXMudG9LZWJhYkNhc2UoY29ubmVjdGlvbi5zb3VyY2VTZXJ2aWNlKX0uc2VydmljZSc7XG5pbXBvcnQgeyB2YWxpZGF0ZSB9IGZyb20gJy4uL21pZGRsZXdhcmUvdmFsaWRhdGlvbic7XG5pbXBvcnQgeyAke3NlcnZpY2VOYW1lfVNjaGVtYXMgfSBmcm9tICcuLi92YWxpZGF0aW9uLyR7dGhpcy50b0tlYmFiQ2FzZShjb25uZWN0aW9uLnNvdXJjZVNlcnZpY2UpfS5zY2hlbWFzJztcbiR7Y29ubmVjdGlvbi5hdXRoZW50aWNhdGlvbiA/IFwiaW1wb3J0IHsgYXV0aE1pZGRsZXdhcmUgfSBmcm9tICcuLi9taWRkbGV3YXJlL2F1dGgubWlkZGxld2FyZSc7XCIgOiAnJ31cblxuZXhwb3J0IGNsYXNzICR7c2VydmljZU5hbWV9Q29udHJvbGxlciB7XG4gIHB1YmxpYyByb3V0ZXI6IFJvdXRlcjtcbiAgcHJpdmF0ZSAke3RoaXMudG9DYW1lbENhc2UoY29ubmVjdGlvbi5zb3VyY2VTZXJ2aWNlKX1TZXJ2aWNlOiAke3NlcnZpY2VOYW1lfVNlcnZpY2U7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yb3V0ZXIgPSBSb3V0ZXIoKTtcbiAgICB0aGlzLiR7dGhpcy50b0NhbWVsQ2FzZShjb25uZWN0aW9uLnNvdXJjZVNlcnZpY2UpfVNlcnZpY2UgPSBuZXcgJHtzZXJ2aWNlTmFtZX1TZXJ2aWNlKCk7XG4gICAgdGhpcy5pbml0aWFsaXplUm91dGVzKCk7XG4gIH1cblxuICBwcml2YXRlIGluaXRpYWxpemVSb3V0ZXMoKTogdm9pZCB7XG4ke2Nvbm5lY3Rpb24uZW5kcG9pbnRzLm1hcChlbmRwb2ludCA9PiB7XG4gIGNvbnN0IG1ldGhvZE5hbWUgPSB0aGlzLmdldE1ldGhvZE5hbWUoZW5kcG9pbnQpO1xuICBjb25zdCBoYXNCb2R5ID0gWydQT1NUJywgJ1BVVCcsICdQQVRDSCddLmluY2x1ZGVzKGVuZHBvaW50Lm1ldGhvZCk7XG4gIFxuICByZXR1cm4gYCAgICAvLyAke2VuZHBvaW50LmRlc2NyaXB0aW9ufVxuICAgIHRoaXMucm91dGVyLiR7ZW5kcG9pbnQubWV0aG9kLnRvTG93ZXJDYXNlKCl9KFxuICAgICAgJyR7ZW5kcG9pbnQucGF0aH0nLFxuICAgICAgJHtjb25uZWN0aW9uLmF1dGhlbnRpY2F0aW9uID8gJ2F1dGhNaWRkbGV3YXJlLCAnIDogJyd9JHtoYXNCb2R5ICYmIGVuZHBvaW50LnJlcXVlc3RTY2hlbWEgPyBgdmFsaWRhdGUoJHtzZXJ2aWNlTmFtZX1TY2hlbWFzLiR7bWV0aG9kTmFtZX0pLCBgIDogJyd9dGhpcy4ke21ldGhvZE5hbWV9LmJpbmQodGhpcylcbiAgICApO1xuYDtcbn0pLmpvaW4oJ1xcbicpfVxuICB9XG4ke2Nvbm5lY3Rpb24uZW5kcG9pbnRzLm1hcChlbmRwb2ludCA9PiB7XG4gIGNvbnN0IG1ldGhvZE5hbWUgPSB0aGlzLmdldE1ldGhvZE5hbWUoZW5kcG9pbnQpO1xuICBcbiAgcmV0dXJuIGBcbiAgcHJpdmF0ZSBhc3luYyAke21ldGhvZE5hbWV9KHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuJHt0aGlzLnRvQ2FtZWxDYXNlKGNvbm5lY3Rpb24uc291cmNlU2VydmljZSl9U2VydmljZS4ke21ldGhvZE5hbWV9KCR7dGhpcy5nZXRNZXRob2RQYXJhbXMoZW5kcG9pbnQpfSk7XG4gICAgICByZXMuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbmV4dChlcnJvcik7XG4gICAgfVxuICB9YDtcbn0pLmpvaW4oJ1xcbicpfVxufVxuYDtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVSb3V0ZVNlcnZpY2UoY29ubmVjdGlvbjogU2VydmljZUNvbm5lY3Rpb24pOiBzdHJpbmcge1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gdGhpcy50b1Bhc2NhbENhc2UoY29ubmVjdGlvbi5zb3VyY2VTZXJ2aWNlKTtcbiAgICBcbiAgICByZXR1cm4gYGV4cG9ydCBjbGFzcyAke3NlcnZpY2VOYW1lfVNlcnZpY2Uge1xuJHtjb25uZWN0aW9uLmVuZHBvaW50cy5tYXAoZW5kcG9pbnQgPT4ge1xuICBjb25zdCBtZXRob2ROYW1lID0gdGhpcy5nZXRNZXRob2ROYW1lKGVuZHBvaW50KTtcbiAgY29uc3QgcGFyYW1zID0gdGhpcy5nZXRTZXJ2aWNlTWV0aG9kUGFyYW1zKGVuZHBvaW50KTtcbiAgXG4gIHJldHVybiBgXG4gIGFzeW5jICR7bWV0aG9kTmFtZX0oJHtwYXJhbXN9KTogUHJvbWlzZTxhbnk+IHtcbiAgICAvLyBUT0RPOiBJbXBsZW1lbnQgJHtlbmRwb2ludC5kZXNjcmlwdGlvbn1cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vdCBpbXBsZW1lbnRlZCcpO1xuICB9YDtcbn0pLmpvaW4oJ1xcbicpfVxufVxuYDtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVTZXJ2aWNlQ2xpZW50KGNvbm5lY3Rpb246IFNlcnZpY2VDb25uZWN0aW9uLCBvdXRwdXREaXI6IHN0cmluZyk6IEZpbGVDaGFuZ2VbXSB7XG4gICAgY29uc3QgY2hhbmdlczogRmlsZUNoYW5nZVtdID0gW107XG4gICAgY29uc3Qgc291cmNlRGlyID0gcGF0aC5qb2luKG91dHB1dERpciwgJ3NlcnZpY2VzJywgY29ubmVjdGlvbi5zb3VyY2VTZXJ2aWNlKTtcbiAgICBjb25zdCBjbGllbnROYW1lID0gdGhpcy50b0tlYmFiQ2FzZShjb25uZWN0aW9uLnRhcmdldFNlcnZpY2UpO1xuXG4gICAgLy8gR2VuZXJhdGUgY2xpZW50IGNsYXNzXG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHBhdGg6IHBhdGguam9pbihzb3VyY2VEaXIsICdzcmMnLCAnY2xpZW50cycsIGAke2NsaWVudE5hbWV9LmNsaWVudC50c2ApLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlQ2xpZW50Q2xhc3MoY29ubmVjdGlvbiksXG4gICAgfSk7XG5cbiAgICAvLyBHZW5lcmF0ZSBjbGllbnQgdHlwZXNcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgcGF0aDogcGF0aC5qb2luKHNvdXJjZURpciwgJ3NyYycsICdjbGllbnRzJywgYCR7Y2xpZW50TmFtZX0udHlwZXMudHNgKSxcbiAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZUNsaWVudFR5cGVzKGNvbm5lY3Rpb24pLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNoYW5nZXM7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQ2xpZW50Q2xhc3MoY29ubmVjdGlvbjogU2VydmljZUNvbm5lY3Rpb24pOiBzdHJpbmcge1xuICAgIGNvbnN0IGNsaWVudE5hbWUgPSB0aGlzLnRvUGFzY2FsQ2FzZShjb25uZWN0aW9uLnRhcmdldFNlcnZpY2UpO1xuICAgIFxuICAgIHJldHVybiBgaW1wb3J0IGF4aW9zLCB7IEF4aW9zSW5zdGFuY2UgfSBmcm9tICdheGlvcyc7XG4ke2Nvbm5lY3Rpb24uZW5kcG9pbnRzLm1hcChlbmRwb2ludCA9PiB7XG4gIGlmIChlbmRwb2ludC5yZXF1ZXN0U2NoZW1hIHx8IGVuZHBvaW50LnJlc3BvbnNlU2NoZW1hKSB7XG4gICAgcmV0dXJuIGBpbXBvcnQgeyAke2VuZHBvaW50LnJlcXVlc3RTY2hlbWEgfHwgJyd9LCAke2VuZHBvaW50LnJlc3BvbnNlU2NoZW1hIHx8ICcnfSB9IGZyb20gJy4vJHt0aGlzLnRvS2ViYWJDYXNlKGNvbm5lY3Rpb24udGFyZ2V0U2VydmljZSl9LnR5cGVzJztgO1xuICB9XG4gIHJldHVybiAnJztcbn0pLmZpbHRlcihCb29sZWFuKS5qb2luKCdcXG4nKX1cblxuZXhwb3J0IGNsYXNzICR7Y2xpZW50TmFtZX1DbGllbnQge1xuICBwcml2YXRlIGNsaWVudDogQXhpb3NJbnN0YW5jZTtcbiAgcHJpdmF0ZSBiYXNlVVJMOiBzdHJpbmc7XG4ke2Nvbm5lY3Rpb24uYXV0aGVudGljYXRpb24gPyAnICBwcml2YXRlIGF1dGhUb2tlbj86IHN0cmluZzsnIDogJyd9XG5cbiAgY29uc3RydWN0b3IoYmFzZVVSTD86IHN0cmluZyR7Y29ubmVjdGlvbi5hdXRoZW50aWNhdGlvbiA/ICcsIGF1dGhUb2tlbj86IHN0cmluZycgOiAnJ30pIHtcbiAgICB0aGlzLmJhc2VVUkwgPSBiYXNlVVJMIHx8IHByb2Nlc3MuZW52LiR7dGhpcy50b0NvbnN0YW50Q2FzZShjb25uZWN0aW9uLnRhcmdldFNlcnZpY2UpfV9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCc7XG4ke2Nvbm5lY3Rpb24uYXV0aGVudGljYXRpb24gPyAnICAgIHRoaXMuYXV0aFRva2VuID0gYXV0aFRva2VuOycgOiAnJ31cbiAgICBcbiAgICB0aGlzLmNsaWVudCA9IGF4aW9zLmNyZWF0ZSh7XG4gICAgICBiYXNlVVJMOiB0aGlzLmJhc2VVUkwsXG4gICAgICB0aW1lb3V0OiAxMDAwMCxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiR7Y29ubmVjdGlvbi5hdXRoZW50aWNhdGlvbiA/IFwiICAgICAgICAuLi4odGhpcy5hdXRoVG9rZW4gJiYgeyBBdXRob3JpemF0aW9uOiBcXGBCZWFyZXIgXFwke3RoaXMuYXV0aFRva2VufVxcYCB9KSxcIiA6ICcnfVxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuJHtjb25uZWN0aW9uLmF1dGhlbnRpY2F0aW9uID8gYFxuICBzZXRBdXRoVG9rZW4odG9rZW46IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuYXV0aFRva2VuID0gdG9rZW47XG4gICAgdGhpcy5jbGllbnQuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ0F1dGhvcml6YXRpb24nXSA9IFxcYEJlYXJlciBcXCR7dG9rZW59XFxgO1xuICB9XG5gIDogJyd9XG4ke2Nvbm5lY3Rpb24uZW5kcG9pbnRzLm1hcChlbmRwb2ludCA9PiB7XG4gIGNvbnN0IG1ldGhvZE5hbWUgPSB0aGlzLmdldE1ldGhvZE5hbWUoZW5kcG9pbnQpO1xuICBjb25zdCBoYXNCb2R5ID0gWydQT1NUJywgJ1BVVCcsICdQQVRDSCddLmluY2x1ZGVzKGVuZHBvaW50Lm1ldGhvZCk7XG4gIGNvbnN0IHBhcmFtcyA9IHRoaXMuZ2V0Q2xpZW50TWV0aG9kUGFyYW1zKGVuZHBvaW50KTtcbiAgY29uc3QgcmV0dXJuVHlwZSA9IGVuZHBvaW50LnJlc3BvbnNlU2NoZW1hIHx8ICdhbnknO1xuICBcbiAgcmV0dXJuIGBcbiAgYXN5bmMgJHttZXRob2ROYW1lfSgke3BhcmFtc30pOiBQcm9taXNlPCR7cmV0dXJuVHlwZX0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2xpZW50LiR7ZW5kcG9pbnQubWV0aG9kLnRvTG93ZXJDYXNlKCl9JHtoYXNCb2R5ID8gYChcbiAgICAgICcke2VuZHBvaW50LnBhdGh9JyxcbiAgICAgICR7ZW5kcG9pbnQucmVxdWVzdFNjaGVtYSA/ICdkYXRhJyA6ICd7fSd9XG4gICAgKWAgOiBgKCcke2VuZHBvaW50LnBhdGh9JylgfTtcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5kYXRhO1xuICB9YDtcbn0pLmpvaW4oJ1xcbicpfVxufVxuYDtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVDbGllbnRUeXBlcyhjb25uZWN0aW9uOiBTZXJ2aWNlQ29ubmVjdGlvbik6IHN0cmluZyB7XG4gICAgY29uc3QgdHlwZXMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICBcbiAgICBjb25uZWN0aW9uLmVuZHBvaW50cy5mb3JFYWNoKGVuZHBvaW50ID0+IHtcbiAgICAgIGlmIChlbmRwb2ludC5yZXF1ZXN0U2NoZW1hKSB0eXBlcy5hZGQoZW5kcG9pbnQucmVxdWVzdFNjaGVtYSk7XG4gICAgICBpZiAoZW5kcG9pbnQucmVzcG9uc2VTY2hlbWEpIHR5cGVzLmFkZChlbmRwb2ludC5yZXNwb25zZVNjaGVtYSk7XG4gICAgfSk7XG5cbiAgICBpZiAodHlwZXMuc2l6ZSA9PT0gMCkge1xuICAgICAgcmV0dXJuICcvLyBObyB0eXBlcyBkZWZpbmVkIGZvciB0aGlzIGNsaWVudFxcbic7XG4gICAgfVxuXG4gICAgcmV0dXJuIEFycmF5LmZyb20odHlwZXMpLm1hcCh0eXBlID0+IHtcbiAgICAgIHJldHVybiBgZXhwb3J0IGludGVyZmFjZSAke3R5cGV9IHtcbiAgLy8gVE9ETzogRGVmaW5lICR7dHlwZX0gcHJvcGVydGllc1xuICBba2V5OiBzdHJpbmddOiBhbnk7XG59XG5gO1xuICAgIH0pLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUF1dGhNaWRkbGV3YXJlKGNvbm5lY3Rpb246IFNlcnZpY2VDb25uZWN0aW9uLCBvdXRwdXREaXI6IHN0cmluZyk6IEZpbGVDaGFuZ2VbXSB7XG4gICAgY29uc3QgY2hhbmdlczogRmlsZUNoYW5nZVtdID0gW107XG4gICAgY29uc3QgdGFyZ2V0RGlyID0gcGF0aC5qb2luKG91dHB1dERpciwgJ3NlcnZpY2VzJywgY29ubmVjdGlvbi50YXJnZXRTZXJ2aWNlKTtcblxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4odGFyZ2V0RGlyLCAnc3JjJywgJ21pZGRsZXdhcmUnLCAnYXV0aC5taWRkbGV3YXJlLnRzJyksXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgIGNvbnRlbnQ6IHRoaXMuZ2VuZXJhdGVBdXRoTWlkZGxld2FyZUNvbnRlbnQoKSxcbiAgICB9KTtcblxuICAgIHJldHVybiBjaGFuZ2VzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUF1dGhNaWRkbGV3YXJlQ29udGVudCgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgaW1wb3J0IHsgUmVxdWVzdCwgUmVzcG9uc2UsIE5leHRGdW5jdGlvbiB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuaW1wb3J0IHsgQXBwRXJyb3IgfSBmcm9tICcuL2Vycm9yLWhhbmRsZXInO1xuXG5pbnRlcmZhY2UgSldUUGF5bG9hZCB7XG4gIHVzZXJJZDogc3RyaW5nO1xuICBlbWFpbDogc3RyaW5nO1xufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIG5hbWVzcGFjZSBFeHByZXNzIHtcbiAgICBpbnRlcmZhY2UgUmVxdWVzdCB7XG4gICAgICB1c2VyPzogSldUUGF5bG9hZDtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGF1dGhNaWRkbGV3YXJlID0gKFxuICByZXE6IFJlcXVlc3QsXG4gIHJlczogUmVzcG9uc2UsXG4gIG5leHQ6IE5leHRGdW5jdGlvblxuKTogdm9pZCA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdG9rZW4gPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uPy5yZXBsYWNlKCdCZWFyZXIgJywgJycpO1xuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgdGhyb3cgbmV3IEFwcEVycm9yKDQwMSwgJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyk7XG4gICAgfVxuXG4gICAgY29uc3Qgc2VjcmV0ID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAneW91ci1zZWNyZXQta2V5JztcbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgc2VjcmV0KSBhcyBKV1RQYXlsb2FkO1xuXG4gICAgcmVxLnVzZXIgPSBkZWNvZGVkO1xuICAgIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBuZXh0KG5ldyBBcHBFcnJvcig0MDEsICdJbnZhbGlkIG9yIGV4cGlyZWQgdG9rZW4nKSk7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBzZXJ2aWNlQXV0aE1pZGRsZXdhcmUgPSAoXG4gIHJlcTogUmVxdWVzdCxcbiAgcmVzOiBSZXNwb25zZSxcbiAgbmV4dDogTmV4dEZ1bmN0aW9uXG4pOiB2b2lkID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhcGlLZXkgPSByZXEuaGVhZGVyc1sneC1hcGkta2V5J107XG5cbiAgICBpZiAoIWFwaUtleSkge1xuICAgICAgdGhyb3cgbmV3IEFwcEVycm9yKDQwMSwgJ0FQSSBrZXkgcmVxdWlyZWQnKTtcbiAgICB9XG5cbiAgICBjb25zdCB2YWxpZEFwaUtleSA9IHByb2Nlc3MuZW52LlNFUlZJQ0VfQVBJX0tFWTtcbiAgICBpZiAoYXBpS2V5ICE9PSB2YWxpZEFwaUtleSkge1xuICAgICAgdGhyb3cgbmV3IEFwcEVycm9yKDQwMSwgJ0ludmFsaWQgQVBJIGtleScpO1xuICAgIH1cblxuICAgIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBuZXh0KGVycm9yKTtcbiAgfVxufTtcbmA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlVmFsaWRhdGlvbihjb25uZWN0aW9uOiBTZXJ2aWNlQ29ubmVjdGlvbiwgb3V0cHV0RGlyOiBzdHJpbmcpOiBGaWxlQ2hhbmdlW10ge1xuICAgIGNvbnN0IGNoYW5nZXM6IEZpbGVDaGFuZ2VbXSA9IFtdO1xuICAgIGNvbnN0IHRhcmdldERpciA9IHBhdGguam9pbihvdXRwdXREaXIsICdzZXJ2aWNlcycsIGNvbm5lY3Rpb24udGFyZ2V0U2VydmljZSk7XG4gICAgY29uc3Qgc2NoZW1hTmFtZSA9IHRoaXMudG9LZWJhYkNhc2UoY29ubmVjdGlvbi5zb3VyY2VTZXJ2aWNlKTtcblxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4odGFyZ2V0RGlyLCAnc3JjJywgJ3ZhbGlkYXRpb24nLCBgJHtzY2hlbWFOYW1lfS5zY2hlbWFzLnRzYCksXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgIGNvbnRlbnQ6IHRoaXMuZ2VuZXJhdGVWYWxpZGF0aW9uU2NoZW1hcyhjb25uZWN0aW9uKSxcbiAgICB9KTtcblxuICAgIHJldHVybiBjaGFuZ2VzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVZhbGlkYXRpb25TY2hlbWFzKGNvbm5lY3Rpb246IFNlcnZpY2VDb25uZWN0aW9uKTogc3RyaW5nIHtcbiAgICBjb25zdCBzZXJ2aWNlTmFtZSA9IHRoaXMudG9QYXNjYWxDYXNlKGNvbm5lY3Rpb24uc291cmNlU2VydmljZSk7XG4gICAgXG4gICAgcmV0dXJuIGBpbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuZXhwb3J0IGNvbnN0ICR7c2VydmljZU5hbWV9U2NoZW1hcyA9IHtcbiR7Y29ubmVjdGlvbi5lbmRwb2ludHMuZmlsdGVyKGUgPT4gZS5yZXF1ZXN0U2NoZW1hKS5tYXAoZW5kcG9pbnQgPT4ge1xuICBjb25zdCBtZXRob2ROYW1lID0gdGhpcy5nZXRNZXRob2ROYW1lKGVuZHBvaW50KTtcbiAgXG4gIHJldHVybiBgICAke21ldGhvZE5hbWV9OiB6Lm9iamVjdCh7XG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLy8gVE9ETzogRGVmaW5lIHZhbGlkYXRpb24gc2NoZW1hIGZvciAke2VuZHBvaW50LmRlc2NyaXB0aW9ufVxuICAgIH0pLFxuICB9KSxcbmA7XG59KS5qb2luKCdcXG4nKX1cbn07XG5gO1xuICB9XG5cbiAgLy8gSGVscGVyIG1ldGhvZHNcbiAgcHJpdmF0ZSBnZXRNZXRob2ROYW1lKGVuZHBvaW50OiBDb25uZWN0aW9uRW5kcG9pbnQpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhdGhQYXJ0cyA9IGVuZHBvaW50LnBhdGguc3BsaXQoJy8nKS5maWx0ZXIocCA9PiBwICYmICFwLnN0YXJ0c1dpdGgoJzonKSk7XG4gICAgY29uc3QgYWN0aW9uID0gZW5kcG9pbnQubWV0aG9kLnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuIGAke2FjdGlvbn0ke3BhdGhQYXJ0cy5tYXAocCA9PiB0aGlzLnRvUGFzY2FsQ2FzZShwKSkuam9pbignJyl9YDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TWV0aG9kUGFyYW1zKGVuZHBvaW50OiBDb25uZWN0aW9uRW5kcG9pbnQpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhcmFtczogc3RyaW5nW10gPSBbXTtcbiAgICBcbiAgICAvLyBFeHRyYWN0IHBhdGggcGFyYW1ldGVyc1xuICAgIGNvbnN0IHBhdGhQYXJhbXMgPSBlbmRwb2ludC5wYXRoLm1hdGNoKC86KFxcdyspL2cpO1xuICAgIGlmIChwYXRoUGFyYW1zKSB7XG4gICAgICBwYXJhbXMucHVzaCguLi5wYXRoUGFyYW1zLm1hcChwID0+IGByZXEucGFyYW1zLiR7cC5zbGljZSgxKX1gKSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIGJvZHkgZm9yIFBPU1QvUFVUL1BBVENIXG4gICAgaWYgKFsnUE9TVCcsICdQVVQnLCAnUEFUQ0gnXS5pbmNsdWRlcyhlbmRwb2ludC5tZXRob2QpKSB7XG4gICAgICBwYXJhbXMucHVzaCgncmVxLmJvZHknKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgcXVlcnkgcGFyYW1zXG4gICAgaWYgKGVuZHBvaW50Lm1ldGhvZCA9PT0gJ0dFVCcpIHtcbiAgICAgIHBhcmFtcy5wdXNoKCdyZXEucXVlcnknKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGFyYW1zLmpvaW4oJywgJyk7XG4gIH1cblxuICBwcml2YXRlIGdldFNlcnZpY2VNZXRob2RQYXJhbXMoZW5kcG9pbnQ6IENvbm5lY3Rpb25FbmRwb2ludCk6IHN0cmluZyB7XG4gICAgY29uc3QgcGFyYW1zOiBzdHJpbmdbXSA9IFtdO1xuICAgIFxuICAgIC8vIEV4dHJhY3QgcGF0aCBwYXJhbWV0ZXJzXG4gICAgY29uc3QgcGF0aFBhcmFtcyA9IGVuZHBvaW50LnBhdGgubWF0Y2goLzooXFx3KykvZyk7XG4gICAgaWYgKHBhdGhQYXJhbXMpIHtcbiAgICAgIHBhcmFtcy5wdXNoKC4uLnBhdGhQYXJhbXMubWFwKHAgPT4gYCR7cC5zbGljZSgxKX06IHN0cmluZ2ApKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgYm9keSBmb3IgUE9TVC9QVVQvUEFUQ0hcbiAgICBpZiAoWydQT1NUJywgJ1BVVCcsICdQQVRDSCddLmluY2x1ZGVzKGVuZHBvaW50Lm1ldGhvZCkpIHtcbiAgICAgIHBhcmFtcy5wdXNoKCdkYXRhOiBhbnknKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgcXVlcnkgcGFyYW1zXG4gICAgaWYgKGVuZHBvaW50Lm1ldGhvZCA9PT0gJ0dFVCcpIHtcbiAgICAgIHBhcmFtcy5wdXNoKCdxdWVyeT86IGFueScpO1xuICAgIH1cblxuICAgIHJldHVybiBwYXJhbXMuam9pbignLCAnKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q2xpZW50TWV0aG9kUGFyYW1zKGVuZHBvaW50OiBDb25uZWN0aW9uRW5kcG9pbnQpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhcmFtczogc3RyaW5nW10gPSBbXTtcbiAgICBcbiAgICAvLyBFeHRyYWN0IHBhdGggcGFyYW1ldGVyc1xuICAgIGNvbnN0IHBhdGhQYXJhbXMgPSBlbmRwb2ludC5wYXRoLm1hdGNoKC86KFxcdyspL2cpO1xuICAgIGlmIChwYXRoUGFyYW1zKSB7XG4gICAgICBwYXJhbXMucHVzaCguLi5wYXRoUGFyYW1zLm1hcChwID0+IGAke3Auc2xpY2UoMSl9OiBzdHJpbmdgKSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIGJvZHkgZm9yIFBPU1QvUFVUL1BBVENIXG4gICAgaWYgKFsnUE9TVCcsICdQVVQnLCAnUEFUQ0gnXS5pbmNsdWRlcyhlbmRwb2ludC5tZXRob2QpICYmIGVuZHBvaW50LnJlcXVlc3RTY2hlbWEpIHtcbiAgICAgIHBhcmFtcy5wdXNoKGBkYXRhOiAke2VuZHBvaW50LnJlcXVlc3RTY2hlbWF9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcy5qb2luKCcsICcpO1xuICB9XG5cbiAgcHJpdmF0ZSB0b0tlYmFiQ2FzZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHN0clxuICAgICAgLnJlcGxhY2UoLyhbYS16XSkoW0EtWl0pL2csICckMS0kMicpXG4gICAgICAucmVwbGFjZSgvW1xcc19dKy9nLCAnLScpXG4gICAgICAudG9Mb3dlckNhc2UoKTtcbiAgfVxuXG4gIHByaXZhdGUgdG9DYW1lbENhc2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBzdHJcbiAgICAgIC5yZXBsYWNlKC9bLV9cXHNdKyguKT8vZywgKF8sIGMpID0+IChjID8gYy50b1VwcGVyQ2FzZSgpIDogJycpKVxuICAgICAgLnJlcGxhY2UoL15bQS1aXS8sIGMgPT4gYy50b0xvd2VyQ2FzZSgpKTtcbiAgfVxuXG4gIHByaXZhdGUgdG9QYXNjYWxDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBjYW1lbCA9IHRoaXMudG9DYW1lbENhc2Uoc3RyKTtcbiAgICByZXR1cm4gY2FtZWwuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBjYW1lbC5zbGljZSgxKTtcbiAgfVxuXG4gIHByaXZhdGUgdG9Db25zdGFudENhc2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBzdHJcbiAgICAgIC5yZXBsYWNlKC8oW2Etel0pKFtBLVpdKS9nLCAnJDFfJDInKVxuICAgICAgLnJlcGxhY2UoL1tcXHMtXSsvZywgJ18nKVxuICAgICAgLnRvVXBwZXJDYXNlKCk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsSUFBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQTZCLFNBQUFELHdCQUFBRSxDQUFBLEVBQUFDLENBQUEsNkJBQUFDLE9BQUEsTUFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBSix1QkFBQSxZQUFBQSxDQUFBRSxDQUFBLEVBQUFDLENBQUEsU0FBQUEsQ0FBQSxJQUFBRCxDQUFBLElBQUFBLENBQUEsQ0FBQUssVUFBQSxTQUFBTCxDQUFBLE1BQUFNLENBQUEsRUFBQUMsQ0FBQSxFQUFBQyxDQUFBLEtBQUFDLFNBQUEsUUFBQUMsT0FBQSxFQUFBVixDQUFBLGlCQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFNBQUFRLENBQUEsTUFBQUYsQ0FBQSxHQUFBTCxDQUFBLEdBQUFHLENBQUEsR0FBQUQsQ0FBQSxRQUFBRyxDQUFBLENBQUFLLEdBQUEs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