{"version":3,"names":["_getJestObj","mock","PrismaClient","jest","fn","course","findMany","payment","_teacherPayment","require","_client","describe","mockPrisma","beforeEach","clearAllMocks","it","mockResolvedValue","id","amount","status","revenue","teacherPaymentService","calculateRevenue","expect","totalRevenue","toBe","instructorCut","azoraCut","result","processWithdrawal","success","history","getPaymentHistory","toHaveLength"],"sources":["teacher-payment.service.test.ts"],"sourcesContent":["import { teacherPaymentService } from '../teacher-payment.service';\r\nimport { PrismaClient } from '@prisma/client';\r\n\r\njest.mock('@prisma/client', () => ({\r\n  PrismaClient: jest.fn(() => ({\r\n    course: { findMany: jest.fn() },\r\n    payment: { findMany: jest.fn() },\r\n  })),\r\n}));\r\n\r\ndescribe('TeacherPaymentService', () => {\r\n  let mockPrisma: any;\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    mockPrisma = new PrismaClient();\r\n  });\r\n\r\n  describe('calculateRevenue', () => {\r\n    it('should calculate revenue with 70/30 split', async () => {\r\n      mockPrisma.course.findMany.mockResolvedValue([{ id: 'course-1' }]);\r\n      mockPrisma.payment.findMany.mockResolvedValue([\r\n        { amount: 100, status: 'completed' },\r\n        { amount: 200, status: 'completed' },\r\n      ]);\r\n\r\n      const revenue = await teacherPaymentService.calculateRevenue('instructor-1', '2024-01');\r\n\r\n      expect(revenue.totalRevenue).toBe(300);\r\n      expect(revenue.instructorCut).toBe(210); // 70%\r\n      expect(revenue.azoraCut).toBe(90); // 30%\r\n    });\r\n  });\r\n\r\n  describe('processWithdrawal', () => {\r\n    it('should process withdrawal', async () => {\r\n      const result = await teacherPaymentService.processWithdrawal('instructor-1', 100);\r\n\r\n      expect(result.success).toBe(true);\r\n      expect(result.amount).toBe(100);\r\n    });\r\n  });\r\n\r\n  describe('getPaymentHistory', () => {\r\n    it('should retrieve payment history', async () => {\r\n      mockPrisma.course.findMany.mockResolvedValue([{ id: 'course-1' }]);\r\n      mockPrisma.payment.findMany.mockResolvedValue([\r\n        { id: 'payment-1', amount: 100 },\r\n        { id: 'payment-2', amount: 200 },\r\n      ]);\r\n\r\n      const history = await teacherPaymentService.getPaymentHistory('instructor-1');\r\n\r\n      expect(history).toHaveLength(2);\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}