{"version":3,"names":["_getJestObj","mock","_library","require","_tokenBurnCalculator","_burnTracker","_leaderboardUpdater","_tokenBurn","_tokenBurnRepository","_client","jest","describe","calculator","burnTracker","leaderboardUpdater","repository","prisma","beforeEach","TokenBurnCalculator","TokenBurnRepository","BurnTracker","LeaderboardUpdater","PrismaClient","it","userId","saleAmount","Decimal","initialSupply","initialCirculating","burnCalculation","calculateBurn","BurnTransactionType","COURSE_SALE","expect","burnRate","toBe","burnedAmount","toString","netAmount","mockTransaction","id","amount","transactionType","reason","blockchainTxHash","blockchainStatus","BlockchainStatus","PENDING","createdAt","Date","updatedAt","spyOn","mockResolvedValue","transaction","logBurnTransaction","confirmedTransaction","CONFIRMED","confirmed","confirmBurnTransaction","mockSupply","totalSupply","circulatingSupply","burnedSupply","minus","updatedSupply","updateSupplyAfterBurn","sales","burns","map","sale","totalBurned","reduce","sum","burn","plus","toHaveLength","transactions","type","mockHistory","tx","i","times","total","history","getBurnHistory","withdrawalAmount","userBalance","EARNINGS_WITHDRAWAL","validation","validateBurnTransaction","isValid","errors","newBalance","burnedFromBalance","insufficientBalance","toContain","smallBalance","warnings","length","toBeGreaterThan","largeWithdrawal","largeBalance","redemptionAmount","TOKEN_REDEMPTION","featureAccess","feature","grantedAt","expiresAt","now","smallRedemption","users","tokens","ownerships","u","percentage","dividedBy","toNumber","sort","a","b","toBeCloseTo","userTokens","initialOwnership","newSupply","newOwnership","mockRankingUpdates","newRank","previousRank","ownershipPercentage","changed","changedCount","filter","r","date","rank","totalUsers","userRank","percentile","currentBurned","forEach","finalCirculating","concurrentBurns","Array","from","_","expectedTotal","toThrow","largeAmount","smallAmount","toBeNull","FAILED","startTime","calculateBulkBurns","endTime","duration","toBeLessThan","totalBurn","calculateTotalBurn","toBeDefined"],"sources":["token-burn-flows.test.ts"],"sourcesContent":["/**\r\n * Token Burn Integration Tests\r\n * Tests for complete token burn flows integrated into payment operations\r\n * \r\n * Covers:\r\n * - Sale → Burn → Supply Update flow\r\n * - Withdrawal → Burn → Balance Update flow\r\n * - Redemption → Burn → Feature Access flow\r\n * - Leaderboard Ranking Updates\r\n */\r\n\r\nimport { Decimal } from '@prisma/client/runtime/library';\r\nimport { TokenBurnCalculator } from '../../services/tokens/token-burn-calculator';\r\nimport { BurnTracker } from '../../services/tokens/burn-tracker';\r\nimport { LeaderboardUpdater } from '../../services/tokens/leaderboard-updater';\r\nimport { BurnTransactionType, BlockchainStatus } from '../../services/tokens/token-burn.types';\r\nimport { TokenBurnRepository } from '../../services/tokens/token-burn-repository';\r\nimport { PrismaClient } from '@prisma/client';\r\n\r\n// Mock Prisma\r\njest.mock('@prisma/client');\r\n\r\ndescribe('Token Burn Integration Flows', () => {\r\n  let calculator: TokenBurnCalculator;\r\n  let burnTracker: BurnTracker;\r\n  let leaderboardUpdater: LeaderboardUpdater;\r\n  let repository: TokenBurnRepository;\r\n  let prisma: jest.Mocked<PrismaClient>;\r\n\r\n  beforeEach(() => {\r\n    calculator = new TokenBurnCalculator();\r\n    repository = new TokenBurnRepository();\r\n    burnTracker = new BurnTracker(repository);\r\n    leaderboardUpdater = new LeaderboardUpdater();\r\n    prisma = new PrismaClient() as jest.Mocked<PrismaClient>;\r\n  });\r\n\r\n  describe('Complete Sale → Burn → Supply Update Flow', () => {\r\n    it('should execute complete course sale burn flow', async () => {\r\n      const userId = 'user-123';\r\n      const saleAmount = new Decimal(100);\r\n      const initialSupply = new Decimal(1000000);\r\n      const initialCirculating = new Decimal(900000);\r\n\r\n      // Step 1: Calculate burn on sale\r\n      const burnCalculation = calculator.calculateBurn(\r\n        saleAmount,\r\n        BurnTransactionType.COURSE_SALE\r\n      );\r\n\r\n      expect(burnCalculation.burnRate).toBe(0.05);\r\n      expect(burnCalculation.burnedAmount.toString()).toBe('5');\r\n      expect(burnCalculation.netAmount.toString()).toBe('95');\r\n\r\n      // Step 2: Log burn transaction\r\n      const mockTransaction = {\r\n        id: 'burn-tx-1',\r\n        userId,\r\n        amount: saleAmount,\r\n        burnRate: burnCalculation.burnRate,\r\n        burnedAmount: burnCalculation.burnedAmount,\r\n        transactionType: BurnTransactionType.COURSE_SALE,\r\n        reason: 'Course sale',\r\n        blockchainTxHash: null,\r\n        blockchainStatus: BlockchainStatus.PENDING,\r\n        createdAt: new Date(),\r\n        updatedAt: new Date(),\r\n      };\r\n\r\n      jest.spyOn(repository, 'createBurnTransaction').mockResolvedValue(mockTransaction);\r\n\r\n      const transaction = await burnTracker.logBurnTransaction(\r\n        userId,\r\n        saleAmount,\r\n        burnCalculation.burnRate,\r\n        burnCalculation.burnedAmount,\r\n        BurnTransactionType.COURSE_SALE,\r\n        'Course sale'\r\n      );\r\n\r\n      expect(transaction.id).toBe('burn-tx-1');\r\n      expect(transaction.burnedAmount.toString()).toBe('5');\r\n\r\n      // Step 3: Confirm blockchain transaction\r\n      const confirmedTransaction = {\r\n        ...mockTransaction,\r\n        blockchainTxHash: '0x123abc',\r\n        blockchainStatus: BlockchainStatus.CONFIRMED,\r\n      };\r\n\r\n      jest.spyOn(repository, 'updateBurnTransactionHash').mockResolvedValue(confirmedTransaction);\r\n\r\n      const confirmed = await burnTracker.confirmBurnTransaction(\r\n        'burn-tx-1',\r\n        '0x123abc',\r\n        BlockchainStatus.CONFIRMED\r\n      );\r\n\r\n      expect(confirmed.blockchainStatus).toBe(BlockchainStatus.CONFIRMED);\r\n      expect(confirmed.blockchainTxHash).toBe('0x123abc');\r\n\r\n      // Step 4: Update token supply\r\n      const mockSupply = {\r\n        id: 'supply-1',\r\n        totalSupply: initialSupply,\r\n        circulatingSupply: initialCirculating,\r\n        burnedSupply: new Decimal(100000),\r\n        createdAt: new Date(),\r\n        updatedAt: new Date(),\r\n      };\r\n\r\n      jest.spyOn(repository, 'getTokenSupply').mockResolvedValue(mockSupply);\r\n      jest.spyOn(repository, 'updateTokenSupply').mockResolvedValue({\r\n        ...mockSupply,\r\n        burnedSupply: new Decimal(100005),\r\n        circulatingSupply: initialCirculating.minus(new Decimal(5)),\r\n      });\r\n\r\n      const updatedSupply = await burnTracker.updateSupplyAfterBurn(\r\n        initialSupply,\r\n        initialCirculating,\r\n        burnCalculation.burnedAmount\r\n      );\r\n\r\n      expect(updatedSupply.burnedSupply.toString()).toBe('100005');\r\n      expect(updatedSupply.circulatingSupply.toString()).toBe('899995');\r\n    });\r\n\r\n    it('should handle multiple concurrent sales with burns', async () => {\r\n      const sales = [\r\n        { userId: 'user-1', amount: new Decimal(100) },\r\n        { userId: 'user-2', amount: new Decimal(200) },\r\n        { userId: 'user-3', amount: new Decimal(150) },\r\n      ];\r\n\r\n      const burns = sales.map((sale) =>\r\n        calculator.calculateBurn(sale.amount, BurnTransactionType.COURSE_SALE)\r\n      );\r\n\r\n      const totalBurned = burns.reduce(\r\n        (sum, burn) => sum.plus(burn.burnedAmount),\r\n        new Decimal(0)\r\n      );\r\n\r\n      expect(burns).toHaveLength(3);\r\n      expect(burns[0].burnedAmount.toString()).toBe('5'); // 5% of 100\r\n      expect(burns[1].burnedAmount.toString()).toBe('10'); // 5% of 200\r\n      expect(burns[2].burnedAmount.toString()).toBe('7.5'); // 5% of 150\r\n      expect(totalBurned.toString()).toBe('22.5');\r\n    });\r\n\r\n    it('should track cumulative burns across multiple sales', async () => {\r\n      const userId = 'user-123';\r\n      const transactions = [\r\n        { amount: new Decimal(100), type: BurnTransactionType.COURSE_SALE },\r\n        { amount: new Decimal(200), type: BurnTransactionType.COURSE_SALE },\r\n        { amount: new Decimal(150), type: BurnTransactionType.COURSE_SALE },\r\n      ];\r\n\r\n      const mockHistory = {\r\n        transactions: transactions.map((tx, i) => ({\r\n          id: `burn-tx-${i}`,\r\n          userId,\r\n          amount: tx.amount,\r\n          burnRate: 0.05,\r\n          burnedAmount: tx.amount.times(0.05),\r\n          transactionType: tx.type,\r\n          reason: 'Course sale',\r\n          blockchainTxHash: '0x123',\r\n          blockchainStatus: BlockchainStatus.CONFIRMED,\r\n          createdAt: new Date(),\r\n          updatedAt: new Date(),\r\n        })),\r\n        total: 3,\r\n        totalBurned: new Decimal(22.5),\r\n      };\r\n\r\n      jest.spyOn(repository, 'getBurnHistory').mockResolvedValue(mockHistory);\r\n\r\n      const history = await burnTracker.getBurnHistory({ userId });\r\n\r\n      expect(history.transactions).toHaveLength(3);\r\n      expect(history.totalBurned.toString()).toBe('22.5');\r\n    });\r\n  });\r\n\r\n  describe('Complete Withdrawal → Burn → Balance Update Flow', () => {\r\n    it('should execute complete earnings withdrawal burn flow', async () => {\r\n      const userId = 'user-456';\r\n      const withdrawalAmount = new Decimal(1000);\r\n      const userBalance = new Decimal(5000);\r\n\r\n      // Step 1: Calculate burn on withdrawal\r\n      const burnCalculation = calculator.calculateBurn(\r\n        withdrawalAmount,\r\n        BurnTransactionType.EARNINGS_WITHDRAWAL\r\n      );\r\n\r\n      expect(burnCalculation.burnRate).toBe(0.03);\r\n      expect(burnCalculation.burnedAmount.toString()).toBe('30');\r\n      expect(burnCalculation.netAmount.toString()).toBe('970');\r\n\r\n      // Step 2: Validate user has sufficient balance\r\n      const validation = calculator.validateBurnTransaction(\r\n        withdrawalAmount,\r\n        BurnTransactionType.EARNINGS_WITHDRAWAL,\r\n        userBalance\r\n      );\r\n\r\n      expect(validation.isValid).toBe(true);\r\n      expect(validation.errors).toHaveLength(0);\r\n\r\n      // Step 3: Log burn transaction\r\n      const mockTransaction = {\r\n        id: 'burn-tx-2',\r\n        userId,\r\n        amount: withdrawalAmount,\r\n        burnRate: burnCalculation.burnRate,\r\n        burnedAmount: burnCalculation.burnedAmount,\r\n        transactionType: BurnTransactionType.EARNINGS_WITHDRAWAL,\r\n        reason: 'Earnings withdrawal',\r\n        blockchainTxHash: null,\r\n        blockchainStatus: BlockchainStatus.PENDING,\r\n        createdAt: new Date(),\r\n        updatedAt: new Date(),\r\n      };\r\n\r\n      jest.spyOn(repository, 'createBurnTransaction').mockResolvedValue(mockTransaction);\r\n\r\n      const transaction = await burnTracker.logBurnTransaction(\r\n        userId,\r\n        withdrawalAmount,\r\n        burnCalculation.burnRate,\r\n        burnCalculation.burnedAmount,\r\n        BurnTransactionType.EARNINGS_WITHDRAWAL,\r\n        'Earnings withdrawal'\r\n      );\r\n\r\n      expect(transaction.burnedAmount.toString()).toBe('30');\r\n\r\n      // Step 4: Update user balance (net amount after burn)\r\n      const newBalance = userBalance.minus(withdrawalAmount);\r\n      const burnedFromBalance = burnCalculation.burnedAmount;\r\n\r\n      expect(newBalance.toString()).toBe('4000');\r\n      expect(burnedFromBalance.toString()).toBe('30');\r\n    });\r\n\r\n    it('should reject withdrawal if insufficient balance for burn', async () => {\r\n      const withdrawalAmount = new Decimal(1000);\r\n      const insufficientBalance = new Decimal(500); // Less than withdrawal amount\r\n\r\n      const validation = calculator.validateBurnTransaction(\r\n        withdrawalAmount,\r\n        BurnTransactionType.EARNINGS_WITHDRAWAL,\r\n        insufficientBalance\r\n      );\r\n\r\n      expect(validation.isValid).toBe(false);\r\n      expect(validation.errors).toContain(\r\n        'Insufficient balance. Required: 1000, Available: 500'\r\n      );\r\n    });\r\n\r\n    it('should warn on significant burn relative to balance', async () => {\r\n      const withdrawalAmount = new Decimal(100);\r\n      const smallBalance = new Decimal(5); // Only 5 tokens\r\n\r\n      const validation = calculator.validateBurnTransaction(\r\n        withdrawalAmount,\r\n        BurnTransactionType.EARNINGS_WITHDRAWAL,\r\n        smallBalance\r\n      );\r\n\r\n      expect(validation.isValid).toBe(false);\r\n      expect(validation.warnings.length).toBeGreaterThan(0);\r\n    });\r\n\r\n    it('should handle large withdrawal amounts correctly', async () => {\r\n      const largeWithdrawal = new Decimal('50000');\r\n      const largeBalance = new Decimal('100000');\r\n\r\n      const burnCalculation = calculator.calculateBurn(\r\n        largeWithdrawal,\r\n        BurnTransactionType.EARNINGS_WITHDRAWAL\r\n      );\r\n\r\n      expect(burnCalculation.burnedAmount.toString()).toBe('1500'); // 3% of 50000\r\n      expect(burnCalculation.netAmount.toString()).toBe('48500');\r\n\r\n      const validation = calculator.validateBurnTransaction(\r\n        largeWithdrawal,\r\n        BurnTransactionType.EARNINGS_WITHDRAWAL,\r\n        largeBalance\r\n      );\r\n\r\n      expect(validation.isValid).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('Complete Redemption → Burn → Feature Access Flow', () => {\r\n    it('should execute complete token redemption burn flow', async () => {\r\n      const userId = 'user-789';\r\n      const redemptionAmount = new Decimal(500);\r\n      const userBalance = new Decimal(1000);\r\n\r\n      // Step 1: Calculate burn on redemption\r\n      const burnCalculation = calculator.calculateBurn(\r\n        redemptionAmount,\r\n        BurnTransactionType.TOKEN_REDEMPTION\r\n      );\r\n\r\n      expect(burnCalculation.burnRate).toBe(0.02);\r\n      expect(burnCalculation.burnedAmount.toString()).toBe('10');\r\n      expect(burnCalculation.netAmount.toString()).toBe('490');\r\n\r\n      // Step 2: Validate user has sufficient balance\r\n      const validation = calculator.validateBurnTransaction(\r\n        redemptionAmount,\r\n        BurnTransactionType.TOKEN_REDEMPTION,\r\n        userBalance\r\n      );\r\n\r\n      expect(validation.isValid).toBe(true);\r\n\r\n      // Step 3: Log burn transaction\r\n      const mockTransaction = {\r\n        id: 'burn-tx-3',\r\n        userId,\r\n        amount: redemptionAmount,\r\n        burnRate: burnCalculation.burnRate,\r\n        burnedAmount: burnCalculation.burnedAmount,\r\n        transactionType: BurnTransactionType.TOKEN_REDEMPTION,\r\n        reason: 'Premium feature redemption',\r\n        blockchainTxHash: null,\r\n        blockchainStatus: BlockchainStatus.PENDING,\r\n        createdAt: new Date(),\r\n        updatedAt: new Date(),\r\n      };\r\n\r\n      jest.spyOn(repository, 'createBurnTransaction').mockResolvedValue(mockTransaction);\r\n\r\n      const transaction = await burnTracker.logBurnTransaction(\r\n        userId,\r\n        redemptionAmount,\r\n        burnCalculation.burnRate,\r\n        burnCalculation.burnedAmount,\r\n        BurnTransactionType.TOKEN_REDEMPTION,\r\n        'Premium feature redemption'\r\n      );\r\n\r\n      expect(transaction.burnedAmount.toString()).toBe('10');\r\n\r\n      // Step 4: Deduct tokens from user balance\r\n      const newBalance = userBalance.minus(redemptionAmount);\r\n\r\n      expect(newBalance.toString()).toBe('500');\r\n\r\n      // Step 5: Grant feature access (simulated)\r\n      const featureAccess = {\r\n        userId,\r\n        feature: 'premium_analytics',\r\n        grantedAt: new Date(),\r\n        expiresAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30 days\r\n      };\r\n\r\n      expect(featureAccess.userId).toBe(userId);\r\n      expect(featureAccess.feature).toBe('premium_analytics');\r\n    });\r\n\r\n    it('should handle small redemption amounts', async () => {\r\n      const smallRedemption = new Decimal('10');\r\n      const userBalance = new Decimal('100');\r\n\r\n      const burnCalculation = calculator.calculateBurn(\r\n        smallRedemption,\r\n        BurnTransactionType.TOKEN_REDEMPTION\r\n      );\r\n\r\n      expect(burnCalculation.burnedAmount.toString()).toBe('0.2'); // 2% of 10\r\n      expect(burnCalculation.netAmount.toString()).toBe('9.8');\r\n\r\n      const validation = calculator.validateBurnTransaction(\r\n        smallRedemption,\r\n        BurnTransactionType.TOKEN_REDEMPTION,\r\n        userBalance\r\n      );\r\n\r\n      expect(validation.isValid).toBe(true);\r\n    });\r\n\r\n    it('should track redemption burns separately from other burns', async () => {\r\n      const userId = 'user-123';\r\n\r\n      const mockHistory = {\r\n        transactions: [\r\n          {\r\n            id: 'burn-tx-1',\r\n            userId,\r\n            amount: new Decimal(100),\r\n            burnRate: 0.02,\r\n            burnedAmount: new Decimal(2),\r\n            transactionType: BurnTransactionType.TOKEN_REDEMPTION,\r\n            reason: 'Premium feature',\r\n            blockchainTxHash: '0x123',\r\n            blockchainStatus: BlockchainStatus.CONFIRMED,\r\n            createdAt: new Date(),\r\n            updatedAt: new Date(),\r\n          },\r\n          {\r\n            id: 'burn-tx-2',\r\n            userId,\r\n            amount: new Decimal(200),\r\n            burnRate: 0.02,\r\n            burnedAmount: new Decimal(4),\r\n            transactionType: BurnTransactionType.TOKEN_REDEMPTION,\r\n            reason: 'Premium feature',\r\n            blockchainTxHash: '0x124',\r\n            blockchainStatus: BlockchainStatus.CONFIRMED,\r\n            createdAt: new Date(),\r\n            updatedAt: new Date(),\r\n          },\r\n        ],\r\n        total: 2,\r\n        totalBurned: new Decimal(6),\r\n      };\r\n\r\n      jest.spyOn(repository, 'getBurnHistory').mockResolvedValue(mockHistory);\r\n\r\n      const history = await burnTracker.getBurnHistory({\r\n        userId,\r\n        transactionType: BurnTransactionType.TOKEN_REDEMPTION,\r\n      });\r\n\r\n      expect(history.transactions).toHaveLength(2);\r\n      expect(history.totalBurned.toString()).toBe('6');\r\n    });\r\n  });\r\n\r\n  describe('Leaderboard Ranking Updates on Burn', () => {\r\n    it('should update leaderboard rankings after burn', async () => {\r\n      const users = [\r\n        { userId: 'user-1', tokens: new Decimal(10000) },\r\n        { userId: 'user-2', tokens: new Decimal(5000) },\r\n        { userId: 'user-3', tokens: new Decimal(2000) },\r\n      ];\r\n\r\n      const totalSupply = new Decimal(20000);\r\n\r\n      // Calculate ownership percentages\r\n      const ownerships = users.map((u) => ({\r\n        userId: u.userId,\r\n        percentage: u.tokens.dividedBy(totalSupply).times(100).toNumber(),\r\n      }));\r\n\r\n      // Sort by ownership (descending)\r\n      ownerships.sort((a, b) => b.percentage - a.percentage);\r\n\r\n      expect(ownerships[0].userId).toBe('user-1');\r\n      expect(ownerships[0].percentage).toBeCloseTo(50, 1);\r\n      expect(ownerships[1].userId).toBe('user-2');\r\n      expect(ownerships[1].percentage).toBeCloseTo(25, 1);\r\n      expect(ownerships[2].userId).toBe('user-3');\r\n      expect(ownerships[2].percentage).toBeCloseTo(10, 1);\r\n    });\r\n\r\n    it('should recalculate rankings when supply changes due to burn', async () => {\r\n      const initialSupply = new Decimal(20000);\r\n      const userTokens = new Decimal(5000);\r\n\r\n      // Initial ownership\r\n      const initialOwnership = userTokens\r\n        .dividedBy(initialSupply)\r\n        .times(100)\r\n        .toNumber();\r\n\r\n      expect(initialOwnership).toBeCloseTo(25, 1);\r\n\r\n      // After burn: supply decreases to 19000\r\n      const burnedAmount = new Decimal(1000);\r\n      const newSupply = initialSupply.minus(burnedAmount);\r\n\r\n      // New ownership (user tokens unchanged, but supply decreased)\r\n      const newOwnership = userTokens\r\n        .dividedBy(newSupply)\r\n        .times(100)\r\n        .toNumber();\r\n\r\n      expect(newOwnership).toBeCloseTo(26.3, 1); // Increased due to lower supply\r\n      expect(newOwnership).toBeGreaterThan(initialOwnership);\r\n    });\r\n\r\n    it('should handle ranking changes for multiple users', async () => {\r\n      const mockRankingUpdates = [\r\n        {\r\n          userId: 'user-1',\r\n          newRank: 1,\r\n          previousRank: 2,\r\n          ownershipPercentage: 30,\r\n          changed: true,\r\n        },\r\n        {\r\n          userId: 'user-2',\r\n          newRank: 2,\r\n          previousRank: 1,\r\n          ownershipPercentage: 25,\r\n          changed: true,\r\n        },\r\n        {\r\n          userId: 'user-3',\r\n          newRank: 3,\r\n          previousRank: 3,\r\n          ownershipPercentage: 20,\r\n          changed: false,\r\n        },\r\n      ];\r\n\r\n      const changedCount = mockRankingUpdates.filter((r) => r.changed).length;\r\n\r\n      expect(mockRankingUpdates).toHaveLength(3);\r\n      expect(changedCount).toBe(2);\r\n      expect(mockRankingUpdates[0].newRank).toBe(1);\r\n      expect(mockRankingUpdates[1].newRank).toBe(2);\r\n    });\r\n\r\n    it('should track historical ranking changes', async () => {\r\n      const userId = 'user-123';\r\n      const mockHistory = [\r\n        {\r\n          date: new Date('2024-01-01'),\r\n          rank: 100,\r\n          ownershipPercentage: 0.5,\r\n        },\r\n        {\r\n          date: new Date('2024-01-02'),\r\n          rank: 95,\r\n          ownershipPercentage: 0.52,\r\n        },\r\n        {\r\n          date: new Date('2024-01-03'),\r\n          rank: 90,\r\n          ownershipPercentage: 0.55,\r\n        },\r\n      ];\r\n\r\n      expect(mockHistory).toHaveLength(3);\r\n      expect(mockHistory[0].rank).toBe(100);\r\n      expect(mockHistory[2].rank).toBe(90);\r\n      expect(mockHistory[2].ownershipPercentage).toBeGreaterThan(mockHistory[0].ownershipPercentage);\r\n    });\r\n\r\n    it('should calculate ranking percentile correctly', async () => {\r\n      const totalUsers = 1000;\r\n      const userRank = 100;\r\n\r\n      const percentile = ((totalUsers - userRank) / totalUsers) * 100;\r\n\r\n      expect(percentile).toBe(90); // Top 10%\r\n    });\r\n\r\n    it('should handle edge case of single user', async () => {\r\n      const totalUsers = 1;\r\n      const userRank = 1;\r\n\r\n      const percentile = ((totalUsers - userRank) / totalUsers) * 100;\r\n\r\n      expect(percentile).toBe(0); // Only user, no percentile\r\n    });\r\n  });\r\n\r\n  describe('Cross-Flow Integration', () => {\r\n    it('should handle mixed transaction types in single flow', async () => {\r\n      const userId = 'user-123';\r\n      const transactions = [\r\n        { amount: new Decimal(100), type: BurnTransactionType.COURSE_SALE },\r\n        { amount: new Decimal(1000), type: BurnTransactionType.EARNINGS_WITHDRAWAL },\r\n        { amount: new Decimal(500), type: BurnTransactionType.TOKEN_REDEMPTION },\r\n      ];\r\n\r\n      const burns = transactions.map((tx) =>\r\n        calculator.calculateBurn(tx.amount, tx.type)\r\n      );\r\n\r\n      const totalBurned = burns.reduce(\r\n        (sum, burn) => sum.plus(burn.burnedAmount),\r\n        new Decimal(0)\r\n      );\r\n\r\n      expect(burns[0].burnedAmount.toString()).toBe('5'); // 5% of 100\r\n      expect(burns[1].burnedAmount.toString()).toBe('30'); // 3% of 1000\r\n      expect(burns[2].burnedAmount.toString()).toBe('10'); // 2% of 500\r\n      expect(totalBurned.toString()).toBe('45');\r\n    });\r\n\r\n    it('should maintain consistency across supply updates', async () => {\r\n      const initialSupply = new Decimal(1000000);\r\n      const initialCirculating = new Decimal(900000);\r\n      let currentBurned = new Decimal(0);\r\n\r\n      // Simulate multiple burns\r\n      const burns = [\r\n        new Decimal(100), // 5% of 2000 sale\r\n        new Decimal(30), // 3% of 1000 withdrawal\r\n        new Decimal(10), // 2% of 500 redemption\r\n      ];\r\n\r\n      burns.forEach((burn) => {\r\n        currentBurned = currentBurned.plus(burn);\r\n      });\r\n\r\n      const finalCirculating = initialCirculating.minus(currentBurned);\r\n\r\n      expect(currentBurned.toString()).toBe('140');\r\n      expect(finalCirculating.toString()).toBe('899860');\r\n    });\r\n\r\n    it('should handle concurrent burns without data loss', async () => {\r\n      const concurrentBurns = Array.from({ length: 10 }, (_, i) => ({\r\n        userId: `user-${i}`,\r\n        amount: new Decimal(100 * (i + 1)),\r\n        type: BurnTransactionType.COURSE_SALE,\r\n      }));\r\n\r\n      const burns = concurrentBurns.map((burn) =>\r\n        calculator.calculateBurn(burn.amount, burn.type)\r\n      );\r\n\r\n      const totalBurned = burns.reduce(\r\n        (sum, burn) => sum.plus(burn.burnedAmount),\r\n        new Decimal(0)\r\n      );\r\n\r\n      // Sum of 5% of (100, 200, 300, ..., 1000)\r\n      const expectedTotal = new Decimal(2750); // 5% of 55000\r\n\r\n      expect(totalBurned.toString()).toBe(expectedTotal.toString());\r\n    });\r\n  });\r\n\r\n  describe('Error Handling and Edge Cases', () => {\r\n    it('should handle zero burn amount gracefully', async () => {\r\n      expect(() => {\r\n        calculator.calculateBurn(new Decimal(0), BurnTransactionType.COURSE_SALE);\r\n      }).toThrow('Amount must be greater than 0');\r\n    });\r\n\r\n    it('should handle negative amounts', async () => {\r\n      expect(() => {\r\n        calculator.calculateBurn(new Decimal(-100), BurnTransactionType.COURSE_SALE);\r\n      }).toThrow('Amount must be greater than 0');\r\n    });\r\n\r\n    it('should handle very large amounts', async () => {\r\n      const largeAmount = new Decimal('999999999999.99');\r\n      const burn = calculator.calculateBurn(largeAmount, BurnTransactionType.COURSE_SALE);\r\n\r\n      expect(burn.burnedAmount.toString()).toBe('49999999999.9995');\r\n      expect(burn.netAmount.toString()).toBe('949999999999.9905');\r\n    });\r\n\r\n    it('should handle very small amounts', async () => {\r\n      const smallAmount = new Decimal('0.01');\r\n      const burn = calculator.calculateBurn(smallAmount, BurnTransactionType.COURSE_SALE);\r\n\r\n      expect(burn.burnedAmount.toString()).toBe('0.0005');\r\n      expect(burn.netAmount.toString()).toBe('0.0095');\r\n    });\r\n\r\n    it('should validate transaction type', async () => {\r\n      const validation = calculator.validateBurnTransaction(\r\n        new Decimal(100),\r\n        'INVALID_TYPE' as any,\r\n        new Decimal(200)\r\n      );\r\n\r\n      expect(validation.isValid).toBe(false);\r\n      expect(validation.errors.length).toBeGreaterThan(0);\r\n    });\r\n\r\n    it('should handle pending blockchain transactions', async () => {\r\n      const mockTransaction = {\r\n        id: 'burn-tx-1',\r\n        userId: 'user-123',\r\n        amount: new Decimal(100),\r\n        burnRate: 0.05,\r\n        burnedAmount: new Decimal(5),\r\n        transactionType: BurnTransactionType.COURSE_SALE,\r\n        reason: 'Course sale',\r\n        blockchainTxHash: null,\r\n        blockchainStatus: BlockchainStatus.PENDING,\r\n        createdAt: new Date(),\r\n        updatedAt: new Date(),\r\n      };\r\n\r\n      jest.spyOn(repository, 'createBurnTransaction').mockResolvedValue(mockTransaction);\r\n\r\n      const transaction = await burnTracker.logBurnTransaction(\r\n        'user-123',\r\n        new Decimal(100),\r\n        0.05,\r\n        new Decimal(5),\r\n        BurnTransactionType.COURSE_SALE,\r\n        'Course sale'\r\n      );\r\n\r\n      expect(transaction.blockchainStatus).toBe(BlockchainStatus.PENDING);\r\n      expect(transaction.blockchainTxHash).toBeNull();\r\n    });\r\n\r\n    it('should handle failed blockchain transactions', async () => {\r\n      const mockTransaction = {\r\n        id: 'burn-tx-1',\r\n        userId: 'user-123',\r\n        amount: new Decimal(100),\r\n        burnRate: 0.05,\r\n        burnedAmount: new Decimal(5),\r\n        transactionType: BurnTransactionType.COURSE_SALE,\r\n        reason: 'Course sale',\r\n        blockchainTxHash: null,\r\n        blockchainStatus: BlockchainStatus.FAILED,\r\n        createdAt: new Date(),\r\n        updatedAt: new Date(),\r\n      };\r\n\r\n      jest.spyOn(repository, 'createBurnTransaction').mockResolvedValue(mockTransaction);\r\n\r\n      const transaction = await burnTracker.logBurnTransaction(\r\n        'user-123',\r\n        new Decimal(100),\r\n        0.05,\r\n        new Decimal(5),\r\n        BurnTransactionType.COURSE_SALE,\r\n        'Course sale'\r\n      );\r\n\r\n      expect(transaction.blockchainStatus).toBe(BlockchainStatus.FAILED);\r\n    });\r\n  });\r\n\r\n  describe('Performance and Scalability', () => {\r\n    it('should calculate burns efficiently for bulk operations', async () => {\r\n      const startTime = Date.now();\r\n\r\n      const transactions = Array.from({ length: 1000 }, (_, i) => ({\r\n        amount: new Decimal(100 * (i + 1)),\r\n        type: BurnTransactionType.COURSE_SALE,\r\n      }));\r\n\r\n      const burns = calculator.calculateBulkBurns(transactions);\r\n\r\n      const endTime = Date.now();\r\n      const duration = endTime - startTime;\r\n\r\n      expect(burns).toHaveLength(1000);\r\n      expect(duration).toBeLessThan(1000); // Should complete in less than 1 second\r\n    });\r\n\r\n    it('should calculate total burn efficiently', async () => {\r\n      const transactions = Array.from({ length: 1000 }, (_, i) => ({\r\n        amount: new Decimal(100 * (i + 1)),\r\n        type: BurnTransactionType.COURSE_SALE,\r\n      }));\r\n\r\n      const totalBurn = calculator.calculateTotalBurn(transactions);\r\n\r\n      expect(totalBurn).toBeDefined();\r\n      expect(totalBurn.toNumber()).toBeGreaterThan(0);\r\n    });\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}