00837d49d2bc78c7f201eefe11cf8f3c
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ServiceGenerator = void 0;
var path = _interopRequireWildcard(require("path"));
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) "default" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }
class ServiceGenerator {
  /**
   * Generate complete service boilerplate
   */
  generateService(spec, outputDir) {
    const changes = [];
    const serviceName = this.toKebabCase(spec.name);
    const serviceDir = path.join(outputDir, 'services', serviceName);

    // Generate main service file
    changes.push({
      path: path.join(serviceDir, 'src', 'index.ts'),
      type: 'create',
      content: this.generateIndexFile(spec)
    });

    // Generate controller
    changes.push({
      path: path.join(serviceDir, 'src', 'controllers', `${serviceName}.controller.ts`),
      type: 'create',
      content: this.generateController(spec)
    });

    // Generate service layer
    changes.push({
      path: path.join(serviceDir, 'src', 'services', `${serviceName}.service.ts`),
      type: 'create',
      content: this.generateServiceLayer(spec)
    });

    // Generate repository if database is enabled
    if (spec.database) {
      changes.push({
        path: path.join(serviceDir, 'src', 'repositories', `${serviceName}.repository.ts`),
        type: 'create',
        content: this.generateRepository(spec)
      });
      changes.push({
        path: path.join(serviceDir, 'prisma', 'schema.prisma'),
        type: 'create',
        content: this.generatePrismaSchema(spec)
      });
    }

    // Generate middleware
    changes.push({
      path: path.join(serviceDir, 'src', 'middleware', 'error-handler.ts'),
      type: 'create',
      content: this.generateErrorHandler()
    });
    if (spec.authentication) {
      changes.push({
        path: path.join(serviceDir, 'src', 'middleware', 'auth.ts'),
        type: 'create',
        content: this.generateAuthMiddleware()
      });
    }

    // Generate types
    changes.push({
      path: path.join(serviceDir, 'src', 'types', 'index.ts'),
      type: 'create',
      content: this.generateTypes(spec)
    });

    // Generate validation schemas
    changes.push({
      path: path.join(serviceDir, 'src', 'validation', 'schemas.ts'),
      type: 'create',
      content: this.generateValidationSchemas(spec)
    });

    // Generate package.json
    changes.push({
      path: path.join(serviceDir, 'package.json'),
      type: 'create',
      content: this.generatePackageJson(spec)
    });

    // Generate tsconfig.json
    changes.push({
      path: path.join(serviceDir, 'tsconfig.json'),
      type: 'create',
      content: this.generateTsConfig()
    });

    // Generate .env.example
    changes.push({
      path: path.join(serviceDir, '.env.example'),
      type: 'create',
      content: this.generateEnvExample(spec)
    });

    // Generate README
    changes.push({
      path: path.join(serviceDir, 'README.md'),
      type: 'create',
      content: this.generateReadme(spec)
    });
    return changes;
  }

  /**
   * Generate index.ts file
   */
  generateIndexFile(spec) {
    const serviceName = this.toPascalCase(spec.name);
    const port = spec.port || 3000;
    return `import express, { Application } from 'express';
import cors from 'cors';
import helmet from 'helmet';
import { ${serviceName}Controller } from './controllers/${this.toKebabCase(spec.name)}.controller';
import { errorHandler } from './middleware/error-handler';
${spec.authentication ? "import { authMiddleware } from './middleware/auth';" : ''}

const app: Application = express();
const PORT = process.env.PORT || ${port};

// Middleware
app.use(helmet());
app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Health check
app.get('/health', (req, res) => {
  res.json({ status: 'healthy', service: '${spec.name}' });
});

// Routes
const controller = new ${serviceName}Controller();
app.use('/api/${this.toKebabCase(spec.name)}', controller.router);

// Error handling
app.use(errorHandler);

// Start server
app.listen(PORT, () => {
  console.log(\`${spec.name} service running on port \${PORT}\`);
});

export default app;
`;
  }

  /**
   * Generate controller file
   */
  generateController(spec) {
    const serviceName = this.toPascalCase(spec.name);
    const serviceVar = this.toCamelCase(spec.name);
    return `import { Router, Request, Response, NextFunction } from 'express';
import { ${serviceName}Service } from '../services/${this.toKebabCase(spec.name)}.service';
import { validate } from '../middleware/validation';
import { ${serviceName}Schema } from '../validation/schemas';
${spec.authentication ? "import { authMiddleware } from '../middleware/auth';" : ''}

export class ${serviceName}Controller {
  public router: Router;
  private ${serviceVar}Service: ${serviceName}Service;

  constructor() {
    this.router = Router();
    this.${serviceVar}Service = new ${serviceName}Service();
    this.initializeRoutes();
  }

  private initializeRoutes(): void {
    // GET all
    this.router.get('/', ${spec.authentication ? 'authMiddleware, ' : ''}this.getAll.bind(this));
    
    // GET by ID
    this.router.get('/:id', ${spec.authentication ? 'authMiddleware, ' : ''}this.getById.bind(this));
    
    // POST create
    this.router.post(
      '/',
      ${spec.authentication ? 'authMiddleware, ' : ''}validate(${serviceName}Schema.create),
      this.create.bind(this)
    );
    
    // PUT update
    this.router.put(
      '/:id',
      ${spec.authentication ? 'authMiddleware, ' : ''}validate(${serviceName}Schema.update),
      this.update.bind(this)
    );
    
    // DELETE
    this.router.delete('/:id', ${spec.authentication ? 'authMiddleware, ' : ''}this.delete.bind(this));
  }

  private async getAll(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const items = await this.${serviceVar}Service.findAll();
      res.json({ success: true, data: items });
    } catch (error) {
      next(error);
    }
  }

  private async getById(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const { id } = req.params;
      const item = await this.${serviceVar}Service.findById(id);
      
      if (!item) {
        res.status(404).json({ success: false, error: 'Not found' });
        return;
      }
      
      res.json({ success: true, data: item });
    } catch (error) {
      next(error);
    }
  }

  private async create(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const item = await this.${serviceVar}Service.create(req.body);
      res.status(201).json({ success: true, data: item });
    } catch (error) {
      next(error);
    }
  }

  private async update(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const { id } = req.params;
      const item = await this.${serviceVar}Service.update(id, req.body);
      
      if (!item) {
        res.status(404).json({ success: false, error: 'Not found' });
        return;
      }
      
      res.json({ success: true, data: item });
    } catch (error) {
      next(error);
    }
  }

  private async delete(req: Request, res: Response, next: NextFunction): Promise<void> {
    try {
      const { id } = req.params;
      await this.${serviceVar}Service.delete(id);
      res.status(204).send();
    } catch (error) {
      next(error);
    }
  }
}
`;
  }

  /**
   * Generate service layer file
   */
  generateServiceLayer(spec) {
    const serviceName = this.toPascalCase(spec.name);
    return `${spec.database ? `import { ${serviceName}Repository } from '../repositories/${this.toKebabCase(spec.name)}.repository';` : ''}
import { ${serviceName}, Create${serviceName}Input, Update${serviceName}Input } from '../types';

export class ${serviceName}Service {
  ${spec.database ? `private repository: ${serviceName}Repository;` : ''}

  constructor() {
    ${spec.database ? `this.repository = new ${serviceName}Repository();` : ''}
  }

  async findAll(): Promise<${serviceName}[]> {
    ${spec.database ? `return this.repository.findAll();` : `// TODO: Implement findAll logic\n    return [];`}
  }

  async findById(id: string): Promise<${serviceName} | null> {
    ${spec.database ? `return this.repository.findById(id);` : `// TODO: Implement findById logic\n    return null;`}
  }

  async create(data: Create${serviceName}Input): Promise<${serviceName}> {
    // Add business logic here
    ${spec.database ? `return this.repository.create(data);` : `// TODO: Implement create logic\n    throw new Error('Not implemented');`}
  }

  async update(id: string, data: Update${serviceName}Input): Promise<${serviceName} | null> {
    // Add business logic here
    ${spec.database ? `return this.repository.update(id, data);` : `// TODO: Implement update logic\n    return null;`}
  }

  async delete(id: string): Promise<void> {
    ${spec.database ? `await this.repository.delete(id);` : `// TODO: Implement delete logic`}
  }
}
`;
  }

  /**
   * Generate repository file
   */
  generateRepository(spec) {
    const serviceName = this.toPascalCase(spec.name);
    const modelName = this.toCamelCase(spec.name);
    return `import { PrismaClient } from '@prisma/client';
import { ${serviceName}, Create${serviceName}Input, Update${serviceName}Input } from '../types';

const prisma = new PrismaClient();

export class ${serviceName}Repository {
  async findAll(): Promise<${serviceName}[]> {
    return prisma.${modelName}.findMany();
  }

  async findById(id: string): Promise<${serviceName} | null> {
    return prisma.${modelName}.findUnique({
      where: { id },
    });
  }

  async create(data: Create${serviceName}Input): Promise<${serviceName}> {
    return prisma.${modelName}.create({
      data,
    });
  }

  async update(id: string, data: Update${serviceName}Input): Promise<${serviceName} | null> {
    return prisma.${modelName}.update({
      where: { id },
      data,
    });
  }

  async delete(id: string): Promise<void> {
    await prisma.${modelName}.delete({
      where: { id },
    });
  }
}
`;
  }

  /**
   * Generate Prisma schema
   */
  generatePrismaSchema(spec) {
    const modelName = this.toPascalCase(spec.name);
    return `generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ${modelName} {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Add your fields here
  name      String
  
  @@map("${this.toSnakeCase(spec.name)}")
}
`;
  }

  /**
   * Generate error handler middleware
   */
  generateErrorHandler() {
    return `import { Request, Response, NextFunction } from 'express';

export class AppError extends Error {
  constructor(
    public statusCode: number,
    public message: string,
    public isOperational = true
  ) {
    super(message);
    Object.setPrototypeOf(this, AppError.prototype);
  }
}

export const errorHandler = (
  err: Error | AppError,
  req: Request,
  res: Response,
  next: NextFunction
): void => {
  if (err instanceof AppError) {
    res.status(err.statusCode).json({
      success: false,
      error: err.message,
    });
    return;
  }

  // Log unexpected errors
  console.error('Unexpected error:', err);

  res.status(500).json({
    success: false,
    error: 'Internal server error',
  });
};
`;
  }

  /**
   * Generate auth middleware
   */
  generateAuthMiddleware() {
    return `import { Request, Response, NextFunction } from 'express';
import jwt from 'jsonwebtoken';
import { AppError } from './error-handler';

interface JWTPayload {
  userId: string;
  email: string;
}

declare global {
  namespace Express {
    interface Request {
      user?: JWTPayload;
    }
  }
}

export const authMiddleware = (
  req: Request,
  res: Response,
  next: NextFunction
): void => {
  try {
    const token = req.headers.authorization?.replace('Bearer ', '');

    if (!token) {
      throw new AppError(401, 'Authentication required');
    }

    const secret = process.env.JWT_SECRET || 'your-secret-key';
    const decoded = jwt.verify(token, secret) as JWTPayload;

    req.user = decoded;
    next();
  } catch (error) {
    next(new AppError(401, 'Invalid or expired token'));
  }
};
`;
  }

  /**
   * Generate types file
   */
  generateTypes(spec) {
    const serviceName = this.toPascalCase(spec.name);
    return `export interface ${serviceName} {
  id: string;
  createdAt: Date;
  updatedAt: Date;
  name: string;
  // Add more fields as needed
}

export interface Create${serviceName}Input {
  name: string;
  // Add more fields as needed
}

export interface Update${serviceName}Input {
  name?: string;
  // Add more fields as needed
}
`;
  }

  /**
   * Generate validation schemas
   */
  generateValidationSchemas(spec) {
    const serviceName = this.toPascalCase(spec.name);
    return `import { z } from 'zod';

export const ${serviceName}Schema = {
  create: z.object({
    body: z.object({
      name: z.string().min(1).max(255),
      // Add more validation rules
    }),
  }),

  update: z.object({
    body: z.object({
      name: z.string().min(1).max(255).optional(),
      // Add more validation rules
    }),
    params: z.object({
      id: z.string().cuid(),
    }),
  }),
};
`;
  }

  /**
   * Generate package.json
   */
  generatePackageJson(spec) {
    const serviceName = this.toKebabCase(spec.name);
    return JSON.stringify({
      name: serviceName,
      version: '1.0.0',
      description: `${spec.name} service`,
      main: 'dist/index.js',
      scripts: {
        dev: 'ts-node-dev --respawn --transpile-only src/index.ts',
        build: 'tsc',
        start: 'node dist/index.js',
        test: 'jest',
        'test:watch': 'jest --watch',
        lint: 'eslint src --ext .ts',
        'lint:fix': 'eslint src --ext .ts --fix'
      },
      dependencies: {
        express: '^4.18.2',
        cors: '^2.8.5',
        helmet: '^7.1.0',
        zod: '^3.22.4',
        ...(spec.database && {
          '@prisma/client': '^5.7.1'
        }),
        ...(spec.authentication && {
          jsonwebtoken: '^9.0.2',
          '@types/jsonwebtoken': '^9.0.5'
        })
      },
      devDependencies: {
        '@types/express': '^4.17.21',
        '@types/cors': '^2.8.17',
        '@types/node': '^20.10.5',
        typescript: '^5.3.3',
        'ts-node-dev': '^2.0.0',
        jest: '^29.7.0',
        '@types/jest': '^29.5.11',
        'ts-jest': '^29.1.1',
        eslint: '^8.56.0',
        '@typescript-eslint/eslint-plugin': '^6.15.0',
        '@typescript-eslint/parser': '^6.15.0',
        ...(spec.database && {
          prisma: '^5.7.1'
        })
      }
    }, null, 2);
  }

  /**
   * Generate tsconfig.json
   */
  generateTsConfig() {
    return JSON.stringify({
      compilerOptions: {
        target: 'ES2020',
        module: 'commonjs',
        lib: ['ES2020'],
        outDir: './dist',
        rootDir: './src',
        strict: true,
        esModuleInterop: true,
        skipLibCheck: true,
        forceConsistentCasingInFileNames: true,
        resolveJsonModule: true,
        declaration: true,
        declarationMap: true,
        sourceMap: true
      },
      include: ['src/**/*'],
      exclude: ['node_modules', 'dist', '**/*.test.ts']
    }, null, 2);
  }

  /**
   * Generate .env.example
   */
  generateEnvExample(spec) {
    let env = `PORT=${spec.port || 3000}\nNODE_ENV=development\n`;
    if (spec.database) {
      env += '\nDATABASE_URL=postgresql://user:password@localhost:5432/dbname\n';
    }
    if (spec.authentication) {
      env += '\nJWT_SECRET=your-secret-key-here\n';
    }
    return env;
  }

  /**
   * Generate README.md
   */
  generateReadme(spec) {
    const serviceName = spec.name;
    return `# ${serviceName} Service

## Description

${serviceName} service generated by AzStudio.

## Installation

\`\`\`bash
npm install
\`\`\`

## Configuration

Copy \`.env.example\` to \`.env\` and configure your environment variables.

${spec.database ? `## Database Setup

\`\`\`bash
npx prisma migrate dev
npx prisma generate
\`\`\`
` : ''}

## Development

\`\`\`bash
npm run dev
\`\`\`

## Build

\`\`\`bash
npm run build
\`\`\`

## Production

\`\`\`bash
npm start
\`\`\`

## Testing

\`\`\`bash
npm test
\`\`\`

## API Endpoints

- \`GET /api/${this.toKebabCase(serviceName)}\` - Get all items
- \`GET /api/${this.toKebabCase(serviceName)}/:id\` - Get item by ID
- \`POST /api/${this.toKebabCase(serviceName)}\` - Create new item
- \`PUT /api/${this.toKebabCase(serviceName)}/:id\` - Update item
- \`DELETE /api/${this.toKebabCase(serviceName)}/:id\` - Delete item

## Health Check

\`GET /health\` - Service health status
`;
  }

  // Utility methods
  toKebabCase(str) {
    return str.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[\s_]+/g, '-').toLowerCase();
  }
  toCamelCase(str) {
    return str.replace(/[-_\s]+(.)?/g, (_, c) => c ? c.toUpperCase() : '').replace(/^[A-Z]/, c => c.toLowerCase());
  }
  toPascalCase(str) {
    const camel = this.toCamelCase(str);
    return camel.charAt(0).toUpperCase() + camel.slice(1);
  }
  toSnakeCase(str) {
    return str.replace(/([a-z])([A-Z])/g, '$1_$2').replace(/[\s-]+/g, '_').toLowerCase();
  }
}
exports.ServiceGenerator = ServiceGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwYXRoIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiZSIsInQiLCJXZWFrTWFwIiwiciIsIm4iLCJfX2VzTW9kdWxlIiwibyIsImkiLCJmIiwiX19wcm90b19fIiwiZGVmYXVsdCIsImhhcyIsImdldCIsInNldCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiU2VydmljZUdlbmVyYXRvciIsImdlbmVyYXRlU2VydmljZSIsInNwZWMiLCJvdXRwdXREaXIiLCJjaGFuZ2VzIiwic2VydmljZU5hbWUiLCJ0b0tlYmFiQ2FzZSIsIm5hbWUiLCJzZXJ2aWNlRGlyIiwiam9pbiIsInB1c2giLCJ0eXBlIiwiY29udGVudCIsImdlbmVyYXRlSW5kZXhGaWxlIiwiZ2VuZXJhdGVDb250cm9sbGVyIiwiZ2VuZXJhdGVTZXJ2aWNlTGF5ZXIiLCJkYXRhYmFzZSIsImdlbmVyYXRlUmVwb3NpdG9yeSIsImdlbmVyYXRlUHJpc21hU2NoZW1hIiwiZ2VuZXJhdGVFcnJvckhhbmRsZXIiLCJhdXRoZW50aWNhdGlvbiIsImdlbmVyYXRlQXV0aE1pZGRsZXdhcmUiLCJnZW5lcmF0ZVR5cGVzIiwiZ2VuZXJhdGVWYWxpZGF0aW9uU2NoZW1hcyIsImdlbmVyYXRlUGFja2FnZUpzb24iLCJnZW5lcmF0ZVRzQ29uZmlnIiwiZ2VuZXJhdGVFbnZFeGFtcGxlIiwiZ2VuZXJhdGVSZWFkbWUiLCJ0b1Bhc2NhbENhc2UiLCJwb3J0Iiwic2VydmljZVZhciIsInRvQ2FtZWxDYXNlIiwibW9kZWxOYW1lIiwidG9TbmFrZUNhc2UiLCJKU09OIiwic3RyaW5naWZ5IiwidmVyc2lvbiIsImRlc2NyaXB0aW9uIiwibWFpbiIsInNjcmlwdHMiLCJkZXYiLCJidWlsZCIsInN0YXJ0IiwidGVzdCIsImxpbnQiLCJkZXBlbmRlbmNpZXMiLCJleHByZXNzIiwiY29ycyIsImhlbG1ldCIsInpvZCIsImpzb253ZWJ0b2tlbiIsImRldkRlcGVuZGVuY2llcyIsInR5cGVzY3JpcHQiLCJqZXN0IiwiZXNsaW50IiwicHJpc21hIiwiY29tcGlsZXJPcHRpb25zIiwidGFyZ2V0IiwibW9kdWxlIiwibGliIiwib3V0RGlyIiwicm9vdERpciIsInN0cmljdCIsImVzTW9kdWxlSW50ZXJvcCIsInNraXBMaWJDaGVjayIsImZvcmNlQ29uc2lzdGVudENhc2luZ0luRmlsZU5hbWVzIiwicmVzb2x2ZUpzb25Nb2R1bGUiLCJkZWNsYXJhdGlvbiIsImRlY2xhcmF0aW9uTWFwIiwic291cmNlTWFwIiwiaW5jbHVkZSIsImV4Y2x1ZGUiLCJlbnYiLCJzdHIiLCJyZXBsYWNlIiwidG9Mb3dlckNhc2UiLCJfIiwiYyIsInRvVXBwZXJDYXNlIiwiY2FtZWwiLCJjaGFyQXQiLCJzbGljZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJTZXJ2aWNlR2VuZXJhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBGaWxlQ2hhbmdlIH0gZnJvbSAnLi9DaGFuZ2VzZXRNYW5hZ2VyJztcblxuZXhwb3J0IGludGVyZmFjZSBTZXJ2aWNlU3BlYyB7XG4gIG5hbWU6IHN0cmluZztcbiAgdHlwZTogJ3Jlc3QtYXBpJyB8ICdncmFwaHFsJyB8ICdtaWNyb3NlcnZpY2UnIHwgJ3dvcmtlcic7XG4gIHBvcnQ/OiBudW1iZXI7XG4gIGRhdGFiYXNlPzogYm9vbGVhbjtcbiAgYXV0aGVudGljYXRpb24/OiBib29sZWFuO1xuICBmZWF0dXJlcz86IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgY2xhc3MgU2VydmljZUdlbmVyYXRvciB7XG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBjb21wbGV0ZSBzZXJ2aWNlIGJvaWxlcnBsYXRlXG4gICAqL1xuICBnZW5lcmF0ZVNlcnZpY2Uoc3BlYzogU2VydmljZVNwZWMsIG91dHB1dERpcjogc3RyaW5nKTogRmlsZUNoYW5nZVtdIHtcbiAgICBjb25zdCBjaGFuZ2VzOiBGaWxlQ2hhbmdlW10gPSBbXTtcbiAgICBjb25zdCBzZXJ2aWNlTmFtZSA9IHRoaXMudG9LZWJhYkNhc2Uoc3BlYy5uYW1lKTtcbiAgICBjb25zdCBzZXJ2aWNlRGlyID0gcGF0aC5qb2luKG91dHB1dERpciwgJ3NlcnZpY2VzJywgc2VydmljZU5hbWUpO1xuXG4gICAgLy8gR2VuZXJhdGUgbWFpbiBzZXJ2aWNlIGZpbGVcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICdzcmMnLCAnaW5kZXgudHMnKSxcbiAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZUluZGV4RmlsZShzcGVjKSxcbiAgICB9KTtcblxuICAgIC8vIEdlbmVyYXRlIGNvbnRyb2xsZXJcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICdzcmMnLCAnY29udHJvbGxlcnMnLCBgJHtzZXJ2aWNlTmFtZX0uY29udHJvbGxlci50c2ApLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlQ29udHJvbGxlcihzcGVjKSxcbiAgICB9KTtcblxuICAgIC8vIEdlbmVyYXRlIHNlcnZpY2UgbGF5ZXJcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICdzcmMnLCAnc2VydmljZXMnLCBgJHtzZXJ2aWNlTmFtZX0uc2VydmljZS50c2ApLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlU2VydmljZUxheWVyKHNwZWMpLFxuICAgIH0pO1xuXG4gICAgLy8gR2VuZXJhdGUgcmVwb3NpdG9yeSBpZiBkYXRhYmFzZSBpcyBlbmFibGVkXG4gICAgaWYgKHNwZWMuZGF0YWJhc2UpIHtcbiAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgIHBhdGg6IHBhdGguam9pbihzZXJ2aWNlRGlyLCAnc3JjJywgJ3JlcG9zaXRvcmllcycsIGAke3NlcnZpY2VOYW1lfS5yZXBvc2l0b3J5LnRzYCksXG4gICAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlUmVwb3NpdG9yeShzcGVjKSxcbiAgICAgIH0pO1xuXG4gICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ3ByaXNtYScsICdzY2hlbWEucHJpc21hJyksXG4gICAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlUHJpc21hU2NoZW1hKHNwZWMpLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgbWlkZGxld2FyZVxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ3NyYycsICdtaWRkbGV3YXJlJywgJ2Vycm9yLWhhbmRsZXIudHMnKSxcbiAgICAgIHR5cGU6ICdjcmVhdGUnLFxuICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZUVycm9ySGFuZGxlcigpLFxuICAgIH0pO1xuXG4gICAgaWYgKHNwZWMuYXV0aGVudGljYXRpb24pIHtcbiAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgIHBhdGg6IHBhdGguam9pbihzZXJ2aWNlRGlyLCAnc3JjJywgJ21pZGRsZXdhcmUnLCAnYXV0aC50cycpLFxuICAgICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgICAgY29udGVudDogdGhpcy5nZW5lcmF0ZUF1dGhNaWRkbGV3YXJlKCksXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSB0eXBlc1xuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ3NyYycsICd0eXBlcycsICdpbmRleC50cycpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlVHlwZXMoc3BlYyksXG4gICAgfSk7XG5cbiAgICAvLyBHZW5lcmF0ZSB2YWxpZGF0aW9uIHNjaGVtYXNcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgcGF0aDogcGF0aC5qb2luKHNlcnZpY2VEaXIsICdzcmMnLCAndmFsaWRhdGlvbicsICdzY2hlbWFzLnRzJyksXG4gICAgICB0eXBlOiAnY3JlYXRlJyxcbiAgICAgIGNvbnRlbnQ6IHRoaXMuZ2VuZXJhdGVWYWxpZGF0aW9uU2NoZW1hcyhzcGVjKSxcbiAgICB9KTtcblxuICAgIC8vIEdlbmVyYXRlIHBhY2thZ2UuanNvblxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ3BhY2thZ2UuanNvbicpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlUGFja2FnZUpzb24oc3BlYyksXG4gICAgfSk7XG5cbiAgICAvLyBHZW5lcmF0ZSB0c2NvbmZpZy5qc29uXG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHBhdGg6IHBhdGguam9pbihzZXJ2aWNlRGlyLCAndHNjb25maWcuanNvbicpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlVHNDb25maWcoKSxcbiAgICB9KTtcblxuICAgIC8vIEdlbmVyYXRlIC5lbnYuZXhhbXBsZVxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJy5lbnYuZXhhbXBsZScpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlRW52RXhhbXBsZShzcGVjKSxcbiAgICB9KTtcblxuICAgIC8vIEdlbmVyYXRlIFJFQURNRVxuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oc2VydmljZURpciwgJ1JFQURNRS5tZCcpLFxuICAgICAgdHlwZTogJ2NyZWF0ZScsXG4gICAgICBjb250ZW50OiB0aGlzLmdlbmVyYXRlUmVhZG1lKHNwZWMpLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNoYW5nZXM7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgaW5kZXgudHMgZmlsZVxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUluZGV4RmlsZShzcGVjOiBTZXJ2aWNlU3BlYyk6IHN0cmluZyB7XG4gICAgY29uc3Qgc2VydmljZU5hbWUgPSB0aGlzLnRvUGFzY2FsQ2FzZShzcGVjLm5hbWUpO1xuICAgIGNvbnN0IHBvcnQgPSBzcGVjLnBvcnQgfHwgMzAwMDtcblxuICAgIHJldHVybiBgaW1wb3J0IGV4cHJlc3MsIHsgQXBwbGljYXRpb24gfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBjb3JzIGZyb20gJ2NvcnMnO1xuaW1wb3J0IGhlbG1ldCBmcm9tICdoZWxtZXQnO1xuaW1wb3J0IHsgJHtzZXJ2aWNlTmFtZX1Db250cm9sbGVyIH0gZnJvbSAnLi9jb250cm9sbGVycy8ke3RoaXMudG9LZWJhYkNhc2Uoc3BlYy5uYW1lKX0uY29udHJvbGxlcic7XG5pbXBvcnQgeyBlcnJvckhhbmRsZXIgfSBmcm9tICcuL21pZGRsZXdhcmUvZXJyb3ItaGFuZGxlcic7XG4ke3NwZWMuYXV0aGVudGljYXRpb24gPyBcImltcG9ydCB7IGF1dGhNaWRkbGV3YXJlIH0gZnJvbSAnLi9taWRkbGV3YXJlL2F1dGgnO1wiIDogJyd9XG5cbmNvbnN0IGFwcDogQXBwbGljYXRpb24gPSBleHByZXNzKCk7XG5jb25zdCBQT1JUID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCAke3BvcnR9O1xuXG4vLyBNaWRkbGV3YXJlXG5hcHAudXNlKGhlbG1ldCgpKTtcbmFwcC51c2UoY29ycygpKTtcbmFwcC51c2UoZXhwcmVzcy5qc29uKCkpO1xuYXBwLnVzZShleHByZXNzLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7XG5cbi8vIEhlYWx0aCBjaGVja1xuYXBwLmdldCgnL2hlYWx0aCcsIChyZXEsIHJlcykgPT4ge1xuICByZXMuanNvbih7IHN0YXR1czogJ2hlYWx0aHknLCBzZXJ2aWNlOiAnJHtzcGVjLm5hbWV9JyB9KTtcbn0pO1xuXG4vLyBSb3V0ZXNcbmNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgJHtzZXJ2aWNlTmFtZX1Db250cm9sbGVyKCk7XG5hcHAudXNlKCcvYXBpLyR7dGhpcy50b0tlYmFiQ2FzZShzcGVjLm5hbWUpfScsIGNvbnRyb2xsZXIucm91dGVyKTtcblxuLy8gRXJyb3IgaGFuZGxpbmdcbmFwcC51c2UoZXJyb3JIYW5kbGVyKTtcblxuLy8gU3RhcnQgc2VydmVyXG5hcHAubGlzdGVuKFBPUlQsICgpID0+IHtcbiAgY29uc29sZS5sb2coXFxgJHtzcGVjLm5hbWV9IHNlcnZpY2UgcnVubmluZyBvbiBwb3J0IFxcJHtQT1JUfVxcYCk7XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgYXBwO1xuYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBjb250cm9sbGVyIGZpbGVcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDb250cm9sbGVyKHNwZWM6IFNlcnZpY2VTcGVjKTogc3RyaW5nIHtcbiAgICBjb25zdCBzZXJ2aWNlTmFtZSA9IHRoaXMudG9QYXNjYWxDYXNlKHNwZWMubmFtZSk7XG4gICAgY29uc3Qgc2VydmljZVZhciA9IHRoaXMudG9DYW1lbENhc2Uoc3BlYy5uYW1lKTtcblxuICAgIHJldHVybiBgaW1wb3J0IHsgUm91dGVyLCBSZXF1ZXN0LCBSZXNwb25zZSwgTmV4dEZ1bmN0aW9uIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyAke3NlcnZpY2VOYW1lfVNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy8ke3RoaXMudG9LZWJhYkNhc2Uoc3BlYy5uYW1lKX0uc2VydmljZSc7XG5pbXBvcnQgeyB2YWxpZGF0ZSB9IGZyb20gJy4uL21pZGRsZXdhcmUvdmFsaWRhdGlvbic7XG5pbXBvcnQgeyAke3NlcnZpY2VOYW1lfVNjaGVtYSB9IGZyb20gJy4uL3ZhbGlkYXRpb24vc2NoZW1hcyc7XG4ke3NwZWMuYXV0aGVudGljYXRpb24gPyBcImltcG9ydCB7IGF1dGhNaWRkbGV3YXJlIH0gZnJvbSAnLi4vbWlkZGxld2FyZS9hdXRoJztcIiA6ICcnfVxuXG5leHBvcnQgY2xhc3MgJHtzZXJ2aWNlTmFtZX1Db250cm9sbGVyIHtcbiAgcHVibGljIHJvdXRlcjogUm91dGVyO1xuICBwcml2YXRlICR7c2VydmljZVZhcn1TZXJ2aWNlOiAke3NlcnZpY2VOYW1lfVNlcnZpY2U7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yb3V0ZXIgPSBSb3V0ZXIoKTtcbiAgICB0aGlzLiR7c2VydmljZVZhcn1TZXJ2aWNlID0gbmV3ICR7c2VydmljZU5hbWV9U2VydmljZSgpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZVJvdXRlcygpO1xuICB9XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplUm91dGVzKCk6IHZvaWQge1xuICAgIC8vIEdFVCBhbGxcbiAgICB0aGlzLnJvdXRlci5nZXQoJy8nLCAke3NwZWMuYXV0aGVudGljYXRpb24gPyAnYXV0aE1pZGRsZXdhcmUsICcgOiAnJ310aGlzLmdldEFsbC5iaW5kKHRoaXMpKTtcbiAgICBcbiAgICAvLyBHRVQgYnkgSURcbiAgICB0aGlzLnJvdXRlci5nZXQoJy86aWQnLCAke3NwZWMuYXV0aGVudGljYXRpb24gPyAnYXV0aE1pZGRsZXdhcmUsICcgOiAnJ310aGlzLmdldEJ5SWQuYmluZCh0aGlzKSk7XG4gICAgXG4gICAgLy8gUE9TVCBjcmVhdGVcbiAgICB0aGlzLnJvdXRlci5wb3N0KFxuICAgICAgJy8nLFxuICAgICAgJHtzcGVjLmF1dGhlbnRpY2F0aW9uID8gJ2F1dGhNaWRkbGV3YXJlLCAnIDogJyd9dmFsaWRhdGUoJHtzZXJ2aWNlTmFtZX1TY2hlbWEuY3JlYXRlKSxcbiAgICAgIHRoaXMuY3JlYXRlLmJpbmQodGhpcylcbiAgICApO1xuICAgIFxuICAgIC8vIFBVVCB1cGRhdGVcbiAgICB0aGlzLnJvdXRlci5wdXQoXG4gICAgICAnLzppZCcsXG4gICAgICAke3NwZWMuYXV0aGVudGljYXRpb24gPyAnYXV0aE1pZGRsZXdhcmUsICcgOiAnJ312YWxpZGF0ZSgke3NlcnZpY2VOYW1lfVNjaGVtYS51cGRhdGUpLFxuICAgICAgdGhpcy51cGRhdGUuYmluZCh0aGlzKVxuICAgICk7XG4gICAgXG4gICAgLy8gREVMRVRFXG4gICAgdGhpcy5yb3V0ZXIuZGVsZXRlKCcvOmlkJywgJHtzcGVjLmF1dGhlbnRpY2F0aW9uID8gJ2F1dGhNaWRkbGV3YXJlLCAnIDogJyd9dGhpcy5kZWxldGUuYmluZCh0aGlzKSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldEFsbChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBpdGVtcyA9IGF3YWl0IHRoaXMuJHtzZXJ2aWNlVmFyfVNlcnZpY2UuZmluZEFsbCgpO1xuICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBpdGVtcyB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbmV4dChlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRCeUlkKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgICBjb25zdCBpdGVtID0gYXdhaXQgdGhpcy4ke3NlcnZpY2VWYXJ9U2VydmljZS5maW5kQnlJZChpZCk7XG4gICAgICBcbiAgICAgIGlmICghaXRlbSkge1xuICAgICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBmb3VuZCcgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBpdGVtIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZShyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBpdGVtID0gYXdhaXQgdGhpcy4ke3NlcnZpY2VWYXJ9U2VydmljZS5jcmVhdGUocmVxLmJvZHkpO1xuICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBpdGVtIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHVwZGF0ZShyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgICAgY29uc3QgaXRlbSA9IGF3YWl0IHRoaXMuJHtzZXJ2aWNlVmFyfVNlcnZpY2UudXBkYXRlKGlkLCByZXEuYm9keSk7XG4gICAgICBcbiAgICAgIGlmICghaXRlbSkge1xuICAgICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBmb3VuZCcgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBpdGVtIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGRlbGV0ZShyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgICAgYXdhaXQgdGhpcy4ke3NlcnZpY2VWYXJ9U2VydmljZS5kZWxldGUoaWQpO1xuICAgICAgcmVzLnN0YXR1cygyMDQpLnNlbmQoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbmV4dChlcnJvcik7XG4gICAgfVxuICB9XG59XG5gO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHNlcnZpY2UgbGF5ZXIgZmlsZVxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVNlcnZpY2VMYXllcihzcGVjOiBTZXJ2aWNlU3BlYyk6IHN0cmluZyB7XG4gICAgY29uc3Qgc2VydmljZU5hbWUgPSB0aGlzLnRvUGFzY2FsQ2FzZShzcGVjLm5hbWUpO1xuXG4gICAgcmV0dXJuIGAke3NwZWMuZGF0YWJhc2UgPyBgaW1wb3J0IHsgJHtzZXJ2aWNlTmFtZX1SZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yaWVzLyR7dGhpcy50b0tlYmFiQ2FzZShzcGVjLm5hbWUpfS5yZXBvc2l0b3J5JztgIDogJyd9XG5pbXBvcnQgeyAke3NlcnZpY2VOYW1lfSwgQ3JlYXRlJHtzZXJ2aWNlTmFtZX1JbnB1dCwgVXBkYXRlJHtzZXJ2aWNlTmFtZX1JbnB1dCB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzICR7c2VydmljZU5hbWV9U2VydmljZSB7XG4gICR7c3BlYy5kYXRhYmFzZSA/IGBwcml2YXRlIHJlcG9zaXRvcnk6ICR7c2VydmljZU5hbWV9UmVwb3NpdG9yeTtgIDogJyd9XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgJHtzcGVjLmRhdGFiYXNlID8gYHRoaXMucmVwb3NpdG9yeSA9IG5ldyAke3NlcnZpY2VOYW1lfVJlcG9zaXRvcnkoKTtgIDogJyd9XG4gIH1cblxuICBhc3luYyBmaW5kQWxsKCk6IFByb21pc2U8JHtzZXJ2aWNlTmFtZX1bXT4ge1xuICAgICR7c3BlYy5kYXRhYmFzZSA/IGByZXR1cm4gdGhpcy5yZXBvc2l0b3J5LmZpbmRBbGwoKTtgIDogYC8vIFRPRE86IEltcGxlbWVudCBmaW5kQWxsIGxvZ2ljXFxuICAgIHJldHVybiBbXTtgfVxuICB9XG5cbiAgYXN5bmMgZmluZEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8JHtzZXJ2aWNlTmFtZX0gfCBudWxsPiB7XG4gICAgJHtzcGVjLmRhdGFiYXNlID8gYHJldHVybiB0aGlzLnJlcG9zaXRvcnkuZmluZEJ5SWQoaWQpO2AgOiBgLy8gVE9ETzogSW1wbGVtZW50IGZpbmRCeUlkIGxvZ2ljXFxuICAgIHJldHVybiBudWxsO2B9XG4gIH1cblxuICBhc3luYyBjcmVhdGUoZGF0YTogQ3JlYXRlJHtzZXJ2aWNlTmFtZX1JbnB1dCk6IFByb21pc2U8JHtzZXJ2aWNlTmFtZX0+IHtcbiAgICAvLyBBZGQgYnVzaW5lc3MgbG9naWMgaGVyZVxuICAgICR7c3BlYy5kYXRhYmFzZSA/IGByZXR1cm4gdGhpcy5yZXBvc2l0b3J5LmNyZWF0ZShkYXRhKTtgIDogYC8vIFRPRE86IEltcGxlbWVudCBjcmVhdGUgbG9naWNcXG4gICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgaW1wbGVtZW50ZWQnKTtgfVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIGRhdGE6IFVwZGF0ZSR7c2VydmljZU5hbWV9SW5wdXQpOiBQcm9taXNlPCR7c2VydmljZU5hbWV9IHwgbnVsbD4ge1xuICAgIC8vIEFkZCBidXNpbmVzcyBsb2dpYyBoZXJlXG4gICAgJHtzcGVjLmRhdGFiYXNlID8gYHJldHVybiB0aGlzLnJlcG9zaXRvcnkudXBkYXRlKGlkLCBkYXRhKTtgIDogYC8vIFRPRE86IEltcGxlbWVudCB1cGRhdGUgbG9naWNcXG4gICAgcmV0dXJuIG51bGw7YH1cbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZShpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgJHtzcGVjLmRhdGFiYXNlID8gYGF3YWl0IHRoaXMucmVwb3NpdG9yeS5kZWxldGUoaWQpO2AgOiBgLy8gVE9ETzogSW1wbGVtZW50IGRlbGV0ZSBsb2dpY2B9XG4gIH1cbn1cbmA7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcmVwb3NpdG9yeSBmaWxlXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlUmVwb3NpdG9yeShzcGVjOiBTZXJ2aWNlU3BlYyk6IHN0cmluZyB7XG4gICAgY29uc3Qgc2VydmljZU5hbWUgPSB0aGlzLnRvUGFzY2FsQ2FzZShzcGVjLm5hbWUpO1xuICAgIGNvbnN0IG1vZGVsTmFtZSA9IHRoaXMudG9DYW1lbENhc2Uoc3BlYy5uYW1lKTtcblxuICAgIHJldHVybiBgaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuaW1wb3J0IHsgJHtzZXJ2aWNlTmFtZX0sIENyZWF0ZSR7c2VydmljZU5hbWV9SW5wdXQsIFVwZGF0ZSR7c2VydmljZU5hbWV9SW5wdXQgfSBmcm9tICcuLi90eXBlcyc7XG5cbmNvbnN0IHByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKTtcblxuZXhwb3J0IGNsYXNzICR7c2VydmljZU5hbWV9UmVwb3NpdG9yeSB7XG4gIGFzeW5jIGZpbmRBbGwoKTogUHJvbWlzZTwke3NlcnZpY2VOYW1lfVtdPiB7XG4gICAgcmV0dXJuIHByaXNtYS4ke21vZGVsTmFtZX0uZmluZE1hbnkoKTtcbiAgfVxuXG4gIGFzeW5jIGZpbmRCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPCR7c2VydmljZU5hbWV9IHwgbnVsbD4ge1xuICAgIHJldHVybiBwcmlzbWEuJHttb2RlbE5hbWV9LmZpbmRVbmlxdWUoe1xuICAgICAgd2hlcmU6IHsgaWQgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZShkYXRhOiBDcmVhdGUke3NlcnZpY2VOYW1lfUlucHV0KTogUHJvbWlzZTwke3NlcnZpY2VOYW1lfT4ge1xuICAgIHJldHVybiBwcmlzbWEuJHttb2RlbE5hbWV9LmNyZWF0ZSh7XG4gICAgICBkYXRhLFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIGRhdGE6IFVwZGF0ZSR7c2VydmljZU5hbWV9SW5wdXQpOiBQcm9taXNlPCR7c2VydmljZU5hbWV9IHwgbnVsbD4ge1xuICAgIHJldHVybiBwcmlzbWEuJHttb2RlbE5hbWV9LnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZCB9LFxuICAgICAgZGF0YSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZShpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgcHJpc21hLiR7bW9kZWxOYW1lfS5kZWxldGUoe1xuICAgICAgd2hlcmU6IHsgaWQgfSxcbiAgICB9KTtcbiAgfVxufVxuYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBQcmlzbWEgc2NoZW1hXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlUHJpc21hU2NoZW1hKHNwZWM6IFNlcnZpY2VTcGVjKTogc3RyaW5nIHtcbiAgICBjb25zdCBtb2RlbE5hbWUgPSB0aGlzLnRvUGFzY2FsQ2FzZShzcGVjLm5hbWUpO1xuXG4gICAgcmV0dXJuIGBnZW5lcmF0b3IgY2xpZW50IHtcbiAgcHJvdmlkZXIgPSBcInByaXNtYS1jbGllbnQtanNcIlxufVxuXG5kYXRhc291cmNlIGRiIHtcbiAgcHJvdmlkZXIgPSBcInBvc3RncmVzcWxcIlxuICB1cmwgICAgICA9IGVudihcIkRBVEFCQVNFX1VSTFwiKVxufVxuXG5tb2RlbCAke21vZGVsTmFtZX0ge1xuICBpZCAgICAgICAgU3RyaW5nICAgQGlkIEBkZWZhdWx0KGN1aWQoKSlcbiAgY3JlYXRlZEF0IERhdGVUaW1lIEBkZWZhdWx0KG5vdygpKVxuICB1cGRhdGVkQXQgRGF0ZVRpbWUgQHVwZGF0ZWRBdFxuICBcbiAgLy8gQWRkIHlvdXIgZmllbGRzIGhlcmVcbiAgbmFtZSAgICAgIFN0cmluZ1xuICBcbiAgQEBtYXAoXCIke3RoaXMudG9TbmFrZUNhc2Uoc3BlYy5uYW1lKX1cIilcbn1cbmA7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgZXJyb3IgaGFuZGxlciBtaWRkbGV3YXJlXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlRXJyb3JIYW5kbGVyKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBpbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSwgTmV4dEZ1bmN0aW9uIH0gZnJvbSAnZXhwcmVzcyc7XG5cbmV4cG9ydCBjbGFzcyBBcHBFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHN0YXR1c0NvZGU6IG51bWJlcixcbiAgICBwdWJsaWMgbWVzc2FnZTogc3RyaW5nLFxuICAgIHB1YmxpYyBpc09wZXJhdGlvbmFsID0gdHJ1ZVxuICApIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgQXBwRXJyb3IucHJvdG90eXBlKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgZXJyb3JIYW5kbGVyID0gKFxuICBlcnI6IEVycm9yIHwgQXBwRXJyb3IsXG4gIHJlcTogUmVxdWVzdCxcbiAgcmVzOiBSZXNwb25zZSxcbiAgbmV4dDogTmV4dEZ1bmN0aW9uXG4pOiB2b2lkID0+IHtcbiAgaWYgKGVyciBpbnN0YW5jZW9mIEFwcEVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyhlcnIuc3RhdHVzQ29kZSkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnIubWVzc2FnZSxcbiAgICB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBMb2cgdW5leHBlY3RlZCBlcnJvcnNcbiAgY29uc29sZS5lcnJvcignVW5leHBlY3RlZCBlcnJvcjonLCBlcnIpO1xuXG4gIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicsXG4gIH0pO1xufTtcbmA7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgYXV0aCBtaWRkbGV3YXJlXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlQXV0aE1pZGRsZXdhcmUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGltcG9ydCB7IFJlcXVlc3QsIFJlc3BvbnNlLCBOZXh0RnVuY3Rpb24gfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCB7IEFwcEVycm9yIH0gZnJvbSAnLi9lcnJvci1oYW5kbGVyJztcblxuaW50ZXJmYWNlIEpXVFBheWxvYWQge1xuICB1c2VySWQ6IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbn1cblxuZGVjbGFyZSBnbG9iYWwge1xuICBuYW1lc3BhY2UgRXhwcmVzcyB7XG4gICAgaW50ZXJmYWNlIFJlcXVlc3Qge1xuICAgICAgdXNlcj86IEpXVFBheWxvYWQ7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBhdXRoTWlkZGxld2FyZSA9IChcbiAgcmVxOiBSZXF1ZXN0LFxuICByZXM6IFJlc3BvbnNlLFxuICBuZXh0OiBOZXh0RnVuY3Rpb25cbik6IHZvaWQgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8ucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcblxuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBBcHBFcnJvcig0MDEsICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgJ3lvdXItc2VjcmV0LWtleSc7XG4gICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIHNlY3JldCkgYXMgSldUUGF5bG9hZDtcblxuICAgIHJlcS51c2VyID0gZGVjb2RlZDtcbiAgICBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbmV4dChuZXcgQXBwRXJyb3IoNDAxLCAnSW52YWxpZCBvciBleHBpcmVkIHRva2VuJykpO1xuICB9XG59O1xuYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSB0eXBlcyBmaWxlXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlVHlwZXMoc3BlYzogU2VydmljZVNwZWMpOiBzdHJpbmcge1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gdGhpcy50b1Bhc2NhbENhc2Uoc3BlYy5uYW1lKTtcblxuICAgIHJldHVybiBgZXhwb3J0IGludGVyZmFjZSAke3NlcnZpY2VOYW1lfSB7XG4gIGlkOiBzdHJpbmc7XG4gIGNyZWF0ZWRBdDogRGF0ZTtcbiAgdXBkYXRlZEF0OiBEYXRlO1xuICBuYW1lOiBzdHJpbmc7XG4gIC8vIEFkZCBtb3JlIGZpZWxkcyBhcyBuZWVkZWRcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGUke3NlcnZpY2VOYW1lfUlucHV0IHtcbiAgbmFtZTogc3RyaW5nO1xuICAvLyBBZGQgbW9yZSBmaWVsZHMgYXMgbmVlZGVkXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBkYXRlJHtzZXJ2aWNlTmFtZX1JbnB1dCB7XG4gIG5hbWU/OiBzdHJpbmc7XG4gIC8vIEFkZCBtb3JlIGZpZWxkcyBhcyBuZWVkZWRcbn1cbmA7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgdmFsaWRhdGlvbiBzY2hlbWFzXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlVmFsaWRhdGlvblNjaGVtYXMoc3BlYzogU2VydmljZVNwZWMpOiBzdHJpbmcge1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gdGhpcy50b1Bhc2NhbENhc2Uoc3BlYy5uYW1lKTtcblxuICAgIHJldHVybiBgaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbmV4cG9ydCBjb25zdCAke3NlcnZpY2VOYW1lfVNjaGVtYSA9IHtcbiAgY3JlYXRlOiB6Lm9iamVjdCh7XG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgbmFtZTogei5zdHJpbmcoKS5taW4oMSkubWF4KDI1NSksXG4gICAgICAvLyBBZGQgbW9yZSB2YWxpZGF0aW9uIHJ1bGVzXG4gICAgfSksXG4gIH0pLFxuXG4gIHVwZGF0ZTogei5vYmplY3Qoe1xuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIG5hbWU6IHouc3RyaW5nKCkubWluKDEpLm1heCgyNTUpLm9wdGlvbmFsKCksXG4gICAgICAvLyBBZGQgbW9yZSB2YWxpZGF0aW9uIHJ1bGVzXG4gICAgfSksXG4gICAgcGFyYW1zOiB6Lm9iamVjdCh7XG4gICAgICBpZDogei5zdHJpbmcoKS5jdWlkKCksXG4gICAgfSksXG4gIH0pLFxufTtcbmA7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcGFja2FnZS5qc29uXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlUGFja2FnZUpzb24oc3BlYzogU2VydmljZVNwZWMpOiBzdHJpbmcge1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gdGhpcy50b0tlYmFiQ2FzZShzcGVjLm5hbWUpO1xuXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG5hbWU6IHNlcnZpY2VOYW1lLFxuICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgIGRlc2NyaXB0aW9uOiBgJHtzcGVjLm5hbWV9IHNlcnZpY2VgLFxuICAgICAgbWFpbjogJ2Rpc3QvaW5kZXguanMnLFxuICAgICAgc2NyaXB0czoge1xuICAgICAgICBkZXY6ICd0cy1ub2RlLWRldiAtLXJlc3Bhd24gLS10cmFuc3BpbGUtb25seSBzcmMvaW5kZXgudHMnLFxuICAgICAgICBidWlsZDogJ3RzYycsXG4gICAgICAgIHN0YXJ0OiAnbm9kZSBkaXN0L2luZGV4LmpzJyxcbiAgICAgICAgdGVzdDogJ2plc3QnLFxuICAgICAgICAndGVzdDp3YXRjaCc6ICdqZXN0IC0td2F0Y2gnLFxuICAgICAgICBsaW50OiAnZXNsaW50IHNyYyAtLWV4dCAudHMnLFxuICAgICAgICAnbGludDpmaXgnOiAnZXNsaW50IHNyYyAtLWV4dCAudHMgLS1maXgnLFxuICAgICAgfSxcbiAgICAgIGRlcGVuZGVuY2llczoge1xuICAgICAgICBleHByZXNzOiAnXjQuMTguMicsXG4gICAgICAgIGNvcnM6ICdeMi44LjUnLFxuICAgICAgICBoZWxtZXQ6ICdeNy4xLjAnLFxuICAgICAgICB6b2Q6ICdeMy4yMi40JyxcbiAgICAgICAgLi4uKHNwZWMuZGF0YWJhc2UgJiYge1xuICAgICAgICAgICdAcHJpc21hL2NsaWVudCc6ICdeNS43LjEnLFxuICAgICAgICB9KSxcbiAgICAgICAgLi4uKHNwZWMuYXV0aGVudGljYXRpb24gJiYge1xuICAgICAgICAgIGpzb253ZWJ0b2tlbjogJ145LjAuMicsXG4gICAgICAgICAgJ0B0eXBlcy9qc29ud2VidG9rZW4nOiAnXjkuMC41JyxcbiAgICAgICAgfSksXG4gICAgICB9LFxuICAgICAgZGV2RGVwZW5kZW5jaWVzOiB7XG4gICAgICAgICdAdHlwZXMvZXhwcmVzcyc6ICdeNC4xNy4yMScsXG4gICAgICAgICdAdHlwZXMvY29ycyc6ICdeMi44LjE3JyxcbiAgICAgICAgJ0B0eXBlcy9ub2RlJzogJ14yMC4xMC41JyxcbiAgICAgICAgdHlwZXNjcmlwdDogJ141LjMuMycsXG4gICAgICAgICd0cy1ub2RlLWRldic6ICdeMi4wLjAnLFxuICAgICAgICBqZXN0OiAnXjI5LjcuMCcsXG4gICAgICAgICdAdHlwZXMvamVzdCc6ICdeMjkuNS4xMScsXG4gICAgICAgICd0cy1qZXN0JzogJ14yOS4xLjEnLFxuICAgICAgICBlc2xpbnQ6ICdeOC41Ni4wJyxcbiAgICAgICAgJ0B0eXBlc2NyaXB0LWVzbGludC9lc2xpbnQtcGx1Z2luJzogJ142LjE1LjAnLFxuICAgICAgICAnQHR5cGVzY3JpcHQtZXNsaW50L3BhcnNlcic6ICdeNi4xNS4wJyxcbiAgICAgICAgLi4uKHNwZWMuZGF0YWJhc2UgJiYge1xuICAgICAgICAgIHByaXNtYTogJ141LjcuMScsXG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICB9LCBudWxsLCAyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSB0c2NvbmZpZy5qc29uXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlVHNDb25maWcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgY29tcGlsZXJPcHRpb25zOiB7XG4gICAgICAgIHRhcmdldDogJ0VTMjAyMCcsXG4gICAgICAgIG1vZHVsZTogJ2NvbW1vbmpzJyxcbiAgICAgICAgbGliOiBbJ0VTMjAyMCddLFxuICAgICAgICBvdXREaXI6ICcuL2Rpc3QnLFxuICAgICAgICByb290RGlyOiAnLi9zcmMnLFxuICAgICAgICBzdHJpY3Q6IHRydWUsXG4gICAgICAgIGVzTW9kdWxlSW50ZXJvcDogdHJ1ZSxcbiAgICAgICAgc2tpcExpYkNoZWNrOiB0cnVlLFxuICAgICAgICBmb3JjZUNvbnNpc3RlbnRDYXNpbmdJbkZpbGVOYW1lczogdHJ1ZSxcbiAgICAgICAgcmVzb2x2ZUpzb25Nb2R1bGU6IHRydWUsXG4gICAgICAgIGRlY2xhcmF0aW9uOiB0cnVlLFxuICAgICAgICBkZWNsYXJhdGlvbk1hcDogdHJ1ZSxcbiAgICAgICAgc291cmNlTWFwOiB0cnVlLFxuICAgICAgfSxcbiAgICAgIGluY2x1ZGU6IFsnc3JjLyoqLyonXSxcbiAgICAgIGV4Y2x1ZGU6IFsnbm9kZV9tb2R1bGVzJywgJ2Rpc3QnLCAnKiovKi50ZXN0LnRzJ10sXG4gICAgfSwgbnVsbCwgMik7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgLmVudi5leGFtcGxlXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlRW52RXhhbXBsZShzcGVjOiBTZXJ2aWNlU3BlYyk6IHN0cmluZyB7XG4gICAgbGV0IGVudiA9IGBQT1JUPSR7c3BlYy5wb3J0IHx8IDMwMDB9XFxuTk9ERV9FTlY9ZGV2ZWxvcG1lbnRcXG5gO1xuXG4gICAgaWYgKHNwZWMuZGF0YWJhc2UpIHtcbiAgICAgIGVudiArPSAnXFxuREFUQUJBU0VfVVJMPXBvc3RncmVzcWw6Ly91c2VyOnBhc3N3b3JkQGxvY2FsaG9zdDo1NDMyL2RibmFtZVxcbic7XG4gICAgfVxuXG4gICAgaWYgKHNwZWMuYXV0aGVudGljYXRpb24pIHtcbiAgICAgIGVudiArPSAnXFxuSldUX1NFQ1JFVD15b3VyLXNlY3JldC1rZXktaGVyZVxcbic7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVudjtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBSRUFETUUubWRcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVSZWFkbWUoc3BlYzogU2VydmljZVNwZWMpOiBzdHJpbmcge1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gc3BlYy5uYW1lO1xuXG4gICAgcmV0dXJuIGAjICR7c2VydmljZU5hbWV9IFNlcnZpY2VcblxuIyMgRGVzY3JpcHRpb25cblxuJHtzZXJ2aWNlTmFtZX0gc2VydmljZSBnZW5lcmF0ZWQgYnkgQXpTdHVkaW8uXG5cbiMjIEluc3RhbGxhdGlvblxuXG5cXGBcXGBcXGBiYXNoXG5ucG0gaW5zdGFsbFxuXFxgXFxgXFxgXG5cbiMjIENvbmZpZ3VyYXRpb25cblxuQ29weSBcXGAuZW52LmV4YW1wbGVcXGAgdG8gXFxgLmVudlxcYCBhbmQgY29uZmlndXJlIHlvdXIgZW52aXJvbm1lbnQgdmFyaWFibGVzLlxuXG4ke3NwZWMuZGF0YWJhc2UgPyBgIyMgRGF0YWJhc2UgU2V0dXBcblxuXFxgXFxgXFxgYmFzaFxubnB4IHByaXNtYSBtaWdyYXRlIGRldlxubnB4IHByaXNtYSBnZW5lcmF0ZVxuXFxgXFxgXFxgXG5gIDogJyd9XG5cbiMjIERldmVsb3BtZW50XG5cblxcYFxcYFxcYGJhc2hcbm5wbSBydW4gZGV2XG5cXGBcXGBcXGBcblxuIyMgQnVpbGRcblxuXFxgXFxgXFxgYmFzaFxubnBtIHJ1biBidWlsZFxuXFxgXFxgXFxgXG5cbiMjIFByb2R1Y3Rpb25cblxuXFxgXFxgXFxgYmFzaFxubnBtIHN0YXJ0XG5cXGBcXGBcXGBcblxuIyMgVGVzdGluZ1xuXG5cXGBcXGBcXGBiYXNoXG5ucG0gdGVzdFxuXFxgXFxgXFxgXG5cbiMjIEFQSSBFbmRwb2ludHNcblxuLSBcXGBHRVQgL2FwaS8ke3RoaXMudG9LZWJhYkNhc2Uoc2VydmljZU5hbWUpfVxcYCAtIEdldCBhbGwgaXRlbXNcbi0gXFxgR0VUIC9hcGkvJHt0aGlzLnRvS2ViYWJDYXNlKHNlcnZpY2VOYW1lKX0vOmlkXFxgIC0gR2V0IGl0ZW0gYnkgSURcbi0gXFxgUE9TVCAvYXBpLyR7dGhpcy50b0tlYmFiQ2FzZShzZXJ2aWNlTmFtZSl9XFxgIC0gQ3JlYXRlIG5ldyBpdGVtXG4tIFxcYFBVVCAvYXBpLyR7dGhpcy50b0tlYmFiQ2FzZShzZXJ2aWNlTmFtZSl9LzppZFxcYCAtIFVwZGF0ZSBpdGVtXG4tIFxcYERFTEVURSAvYXBpLyR7dGhpcy50b0tlYmFiQ2FzZShzZXJ2aWNlTmFtZSl9LzppZFxcYCAtIERlbGV0ZSBpdGVtXG5cbiMjIEhlYWx0aCBDaGVja1xuXG5cXGBHRVQgL2hlYWx0aFxcYCAtIFNlcnZpY2UgaGVhbHRoIHN0YXR1c1xuYDtcbiAgfVxuXG4gIC8vIFV0aWxpdHkgbWV0aG9kc1xuICBwcml2YXRlIHRvS2ViYWJDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gc3RyXG4gICAgICAucmVwbGFjZSgvKFthLXpdKShbQS1aXSkvZywgJyQxLSQyJylcbiAgICAgIC5yZXBsYWNlKC9bXFxzX10rL2csICctJylcbiAgICAgIC50b0xvd2VyQ2FzZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSB0b0NhbWVsQ2FzZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHN0clxuICAgICAgLnJlcGxhY2UoL1stX1xcc10rKC4pPy9nLCAoXywgYykgPT4gKGMgPyBjLnRvVXBwZXJDYXNlKCkgOiAnJykpXG4gICAgICAucmVwbGFjZSgvXltBLVpdLywgYyA9PiBjLnRvTG93ZXJDYXNlKCkpO1xuICB9XG5cbiAgcHJpdmF0ZSB0b1Bhc2NhbENhc2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNhbWVsID0gdGhpcy50b0NhbWVsQ2FzZShzdHIpO1xuICAgIHJldHVybiBjYW1lbC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNhbWVsLnNsaWNlKDEpO1xuICB9XG5cbiAgcHJpdmF0ZSB0b1NuYWtlQ2FzZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHN0clxuICAgICAgLnJlcGxhY2UoLyhbYS16XSkoW0EtWl0pL2csICckMV8kMicpXG4gICAgICAucmVwbGFjZSgvW1xccy1dKy9nLCAnXycpXG4gICAgICAudG9Mb3dlckNhc2UoKTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxJQUFBLEdBQUFDLHVCQUFBLENBQUFDLE9BQUE7QUFBNkIsU0FBQUQsd0JBQUFFLENBQUEsRUFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxNQUFBQyxDQUFBLE9BQUFELE9BQUEsSUFBQUUsQ0FBQSxPQUFBRixPQUFBLFlBQUFKLHVCQUFBLFlBQUFBLENBQUFFLENBQUEsRUFBQUMsQ0FBQSxTQUFBQSxDQUFBLElBQUFELENBQUEsSUFBQUEsQ0FBQSxDQUFBSyxVQUFBLFNBQUFMLENBQUEsTUFBQU0sQ0FBQSxFQUFBQyxDQUFBLEVBQUFDLENBQUEsS0FBQUMsU0FBQSxRQUFBQyxPQUFBLEVBQUFWLENBQUEsaUJBQUFBLENBQUEsdUJBQUFBLENBQUEseUJBQUFBLENBQUEsU0FBQVEsQ0FBQSxNQUFBRixDQUFBLEdBQUFMLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLFFBQUFHLENBQUEsQ0FBQUssR0FBQSxDQUFBWCxDQUFBLFVBQUFNLENBQUEsQ0FBQU0sR0FBQSxDQUFBWixDQUFBLEdBQUFNLENBQUEsQ0FBQU8sR0FBQSxDQUFBYixDQUFBLEVBQUFRLENBQUEsZ0JBQUFQLENBQUEsSUFBQUQsQ0FBQSxnQkFBQUMsQ0FBQSxPQUFBYSxjQUFBLENBQUFDLElBQUEsQ0FBQWYsQ0FBQSxFQUFBQyxDQUFBLE9BQUFNLENBQUEsSUFBQUQsQ0FBQSxHQUFBVSxNQUFBLENBQUFDLGNB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