{"version":3,"names":["services","name","port","testEndpoint","url","timeout","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","signal","headers","clearTimeout","success","ok","status","error","message","run","results","passed","details","console","log","healthResults","service","health","serviceHealth","metricsResults","metrics","metricsEndpoints","swaggerResults","swagger","swaggerEndpoints","walletToBlockchain","method","interServiceCommunication","notFoundTest","errorHandling","notFoundReturns404","allHealthChecks","Object","values","allMetrics","every","h","m","summary","failedHealth","filter","length","failedMetrics","stack"],"sources":["azora-nexus-services.test.js"],"sourcesContent":["/*\r\nAZORA PROPRIETARY LICENSE\r\n\r\nCopyright Â© 2025 Azora ES (Pty) Ltd. All Rights Reserved.\r\n\r\nSee LICENSE file for details.\r\n*/\r\n\r\n/**\r\n * Azora Nexus Services Integration Test\r\n *\r\n * Tests communication and coordination between all Azora Nexus services\r\n * Validates service health, metrics endpoints, API endpoints, and inter-service communication\r\n */\r\n\r\nconst services = [\r\n  { name: 'wallet', port: 4100 },\r\n  { name: 'blockchain', port: 4101 },\r\n  { name: 'ai-trading', port: 4102 },\r\n  { name: 'ai-valuation', port: 4103 },\r\n  { name: 'backed-valuation', port: 4104 },\r\n  { name: 'compliance', port: 4105 },\r\n  { name: 'dashboard', port: 4106 },\r\n  { name: 'defi', port: 4107 },\r\n  { name: 'global-adoption', port: 4108 },\r\n  { name: 'guardian', port: 4109 },\r\n  { name: 'identity', port: 4110 },\r\n  { name: 'ledger', port: 4111 },\r\n  { name: 'liquidity', port: 4112 },\r\n  { name: 'marketplace', port: 4113 },\r\n  { name: 'nft', port: 4114 },\r\n  { name: 'partnerships', port: 4115 },\r\n  { name: 'reporting', port: 4116 },\r\n  { name: 'revenue', port: 4117 },\r\n  { name: 'staking', port: 4118 },\r\n  { name: 'user-growth', port: 4119 },\r\n  { name: 'subscription', port: 4129 },\r\n]\r\n\r\nasync function testEndpoint(url, timeout = 5000) {\r\n  try {\r\n    const controller = new AbortController()\r\n    const timeoutId = setTimeout(() => controller.abort(), timeout)\r\n\r\n    const response = await fetch(url, {\r\n      signal: controller.signal,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    })\r\n\r\n    clearTimeout(timeoutId)\r\n    return { success: response.ok, status: response.status }\r\n  } catch (error) {\r\n    return { success: false, error: error.message }\r\n  }\r\n}\r\n\r\nexport async function run() {\r\n  const results = {\r\n    passed: false,\r\n    details: {},\r\n    error: null,\r\n  }\r\n\r\n  try {\r\n    console.log('  ðŸŒ Testing Azora Nexus services integration...')\r\n\r\n    // Test 1: Service health checks\r\n    const healthResults = {}\r\n    for (const service of services) {\r\n      const health = await testEndpoint(`http://localhost:${service.port}/health`)\r\n      healthResults[service.name] = health.success\r\n    }\r\n    results.details.serviceHealth = healthResults\r\n\r\n    // Test 2: Prometheus metrics endpoints\r\n    const metricsResults = {}\r\n    for (const service of services) {\r\n      const metrics = await testEndpoint(`http://localhost:${service.port}/metrics`)\r\n      metricsResults[service.name] = metrics.success\r\n    }\r\n    results.details.metricsEndpoints = metricsResults\r\n\r\n    // Test 3: Swagger/API documentation endpoints\r\n    const swaggerResults = {}\r\n    for (const service of services) {\r\n      const swagger = await testEndpoint(`http://localhost:${service.port}/api-docs`)\r\n      swaggerResults[service.name] = swagger.success\r\n    }\r\n    results.details.swaggerEndpoints = swaggerResults\r\n\r\n    // Test 4: Service-to-service communication (example: wallet -> blockchain)\r\n    const walletToBlockchain = await testEndpoint(\r\n      'http://localhost:4101/api/blockchain/status',\r\n      { method: 'GET' }\r\n    )\r\n    results.details.interServiceCommunication = {\r\n      walletToBlockchain: walletToBlockchain.success,\r\n    }\r\n\r\n    // Test 5: Error handling - test 404 handler\r\n    const notFoundTest = await testEndpoint('http://localhost:4100/api/nonexistent')\r\n    results.details.errorHandling = {\r\n      notFoundReturns404: notFoundTest.status === 404,\r\n    }\r\n\r\n    // Determine overall pass/fail\r\n    const allHealthChecks = Object.values(healthResults)\r\n    const allMetrics = Object.values(metricsResults)\r\n\r\n    results.passed =\r\n      allHealthChecks.every((h) => h === true) && allMetrics.every((m) => m === true)\r\n\r\n    if (results.passed) {\r\n      results.details.summary = 'All Azora Nexus services integration tests passed'\r\n    } else {\r\n      const failedHealth = allHealthChecks.filter((h) => !h).length\r\n      const failedMetrics = allMetrics.filter((m) => !m).length\r\n      results.details.summary = `Failed: ${failedHealth} health checks, ${failedMetrics} metrics endpoints`\r\n    }\r\n  } catch (error) {\r\n    results.error = error.message\r\n    results.details.error = error.stack\r\n  }\r\n\r\n  return results\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]}