8c8f18ea0709b788fb95c2e79c6a47e7
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getTestDatabaseUrl = getTestDatabaseUrl;
exports.getTestEnv = getTestEnv;
exports.getTestRedisUrl = getTestRedisUrl;
exports.isDebugEnabled = isDebugEnabled;
exports.isTestEnv = isTestEnv;
exports.loadTestEnv = loadTestEnv;
var _dotenv = require("dotenv");
var _path = require("path");
/**
 * Load test environment variables
 */
function loadTestEnv() {
  // Load .env.test file
  const envPath = (0, _path.resolve)(process.cwd(), '.env.test');
  const result = (0, _dotenv.config)({
    path: envPath
  });
  if (result.error) {
    console.warn('Warning: .env.test file not found, using default test values');
  }

  // Ensure NODE_ENV is set to test
  process.env.NODE_ENV = 'test';

  // Validate required environment variables
  validateTestEnv();
}

/**
 * Validate required test environment variables
 */
function validateTestEnv() {
  const required = ['DATABASE_URL', 'REDIS_URL', 'JWT_SECRET'];
  const missing = [];
  for (const key of required) {
    if (!process.env[key]) {
      missing.push(key);
    }
  }
  if (missing.length > 0) {
    throw new Error(`Missing required test environment variables: ${missing.join(', ')}\n` + 'Please create a .env.test file with the required variables.');
  }
}

/**
 * Get test environment variable with fallback
 */
function getTestEnv(key, fallback) {
  const value = process.env[key];
  if (!value && !fallback) {
    throw new Error(`Environment variable ${key} is not set and no fallback provided`);
  }
  return value || fallback;
}

/**
 * Check if running in test environment
 */
function isTestEnv() {
  return process.env.NODE_ENV === 'test';
}

/**
 * Get database URL for tests
 */
function getTestDatabaseUrl() {
  return getTestEnv('DATABASE_URL', 'postgresql://postgres:test@localhost:5432/azora_test');
}

/**
 * Get Redis URL for tests
 */
function getTestRedisUrl() {
  return getTestEnv('REDIS_URL', 'redis://localhost:6379');
}

/**
 * Check if debug mode is enabled for tests
 */
function isDebugEnabled() {
  return process.env.DEBUG_TESTS === 'true';
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZG90ZW52IiwicmVxdWlyZSIsIl9wYXRoIiwibG9hZFRlc3RFbnYiLCJlbnZQYXRoIiwicmVzb2x2ZSIsInByb2Nlc3MiLCJjd2QiLCJyZXN1bHQiLCJjb25maWciLCJwYXRoIiwiZXJyb3IiLCJjb25zb2xlIiwid2FybiIsImVudiIsIk5PREVfRU5WIiwidmFsaWRhdGVUZXN0RW52IiwicmVxdWlyZWQiLCJtaXNzaW5nIiwia2V5IiwicHVzaCIsImxlbmd0aCIsIkVycm9yIiwiam9pbiIsImdldFRlc3RFbnYiLCJmYWxsYmFjayIsInZhbHVlIiwiaXNUZXN0RW52IiwiZ2V0VGVzdERhdGFiYXNlVXJsIiwiZ2V0VGVzdFJlZGlzVXJsIiwiaXNEZWJ1Z0VuYWJsZWQiLCJERUJVR19URVNUUyJdLCJzb3VyY2VzIjpbImVudi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb25maWcgfSBmcm9tICdkb3RlbnYnO1xyXG5pbXBvcnQgeyByZXNvbHZlIH0gZnJvbSAncGF0aCc7XHJcblxyXG4vKipcclxuICogTG9hZCB0ZXN0IGVudmlyb25tZW50IHZhcmlhYmxlc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGxvYWRUZXN0RW52KCk6IHZvaWQge1xyXG4gIC8vIExvYWQgLmVudi50ZXN0IGZpbGVcclxuICBjb25zdCBlbnZQYXRoID0gcmVzb2x2ZShwcm9jZXNzLmN3ZCgpLCAnLmVudi50ZXN0Jyk7XHJcbiAgY29uc3QgcmVzdWx0ID0gY29uZmlnKHsgcGF0aDogZW52UGF0aCB9KTtcclxuICBcclxuICBpZiAocmVzdWx0LmVycm9yKSB7XHJcbiAgICBjb25zb2xlLndhcm4oJ1dhcm5pbmc6IC5lbnYudGVzdCBmaWxlIG5vdCBmb3VuZCwgdXNpbmcgZGVmYXVsdCB0ZXN0IHZhbHVlcycpO1xyXG4gIH1cclxuICBcclxuICAvLyBFbnN1cmUgTk9ERV9FTlYgaXMgc2V0IHRvIHRlc3RcclxuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICd0ZXN0JztcclxuICBcclxuICAvLyBWYWxpZGF0ZSByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcclxuICB2YWxpZGF0ZVRlc3RFbnYoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIHJlcXVpcmVkIHRlc3QgZW52aXJvbm1lbnQgdmFyaWFibGVzXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZVRlc3RFbnYoKTogdm9pZCB7XHJcbiAgY29uc3QgcmVxdWlyZWQgPSBbXHJcbiAgICAnREFUQUJBU0VfVVJMJyxcclxuICAgICdSRURJU19VUkwnLFxyXG4gICAgJ0pXVF9TRUNSRVQnLFxyXG4gIF07XHJcbiAgXHJcbiAgY29uc3QgbWlzc2luZzogc3RyaW5nW10gPSBbXTtcclxuICBcclxuICBmb3IgKGNvbnN0IGtleSBvZiByZXF1aXJlZCkge1xyXG4gICAgaWYgKCFwcm9jZXNzLmVudltrZXldKSB7XHJcbiAgICAgIG1pc3NpbmcucHVzaChrZXkpO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBpZiAobWlzc2luZy5sZW5ndGggPiAwKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgIGBNaXNzaW5nIHJlcXVpcmVkIHRlc3QgZW52aXJvbm1lbnQgdmFyaWFibGVzOiAke21pc3Npbmcuam9pbignLCAnKX1cXG5gICtcclxuICAgICAgJ1BsZWFzZSBjcmVhdGUgYSAuZW52LnRlc3QgZmlsZSB3aXRoIHRoZSByZXF1aXJlZCB2YXJpYWJsZXMuJ1xyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgdGVzdCBlbnZpcm9ubWVudCB2YXJpYWJsZSB3aXRoIGZhbGxiYWNrXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGVzdEVudihrZXk6IHN0cmluZywgZmFsbGJhY2s/OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGNvbnN0IHZhbHVlID0gcHJvY2Vzcy5lbnZba2V5XTtcclxuICBcclxuICBpZiAoIXZhbHVlICYmICFmYWxsYmFjaykge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBFbnZpcm9ubWVudCB2YXJpYWJsZSAke2tleX0gaXMgbm90IHNldCBhbmQgbm8gZmFsbGJhY2sgcHJvdmlkZWRgKTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHZhbHVlIHx8IGZhbGxiYWNrITtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHJ1bm5pbmcgaW4gdGVzdCBlbnZpcm9ubWVudFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzVGVzdEVudigpOiBib29sZWFuIHtcclxuICByZXR1cm4gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICd0ZXN0JztcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBkYXRhYmFzZSBVUkwgZm9yIHRlc3RzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGVzdERhdGFiYXNlVXJsKCk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGdldFRlc3RFbnYoJ0RBVEFCQVNFX1VSTCcsICdwb3N0Z3Jlc3FsOi8vcG9zdGdyZXM6dGVzdEBsb2NhbGhvc3Q6NTQzMi9hem9yYV90ZXN0Jyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgUmVkaXMgVVJMIGZvciB0ZXN0c1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRlc3RSZWRpc1VybCgpOiBzdHJpbmcge1xyXG4gIHJldHVybiBnZXRUZXN0RW52KCdSRURJU19VUkwnLCAncmVkaXM6Ly9sb2NhbGhvc3Q6NjM3OScpO1xyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgZGVidWcgbW9kZSBpcyBlbmFibGVkIGZvciB0ZXN0c1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzRGVidWdFbmFibGVkKCk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBwcm9jZXNzLmVudi5ERUJVR19URVNUUyA9PT0gJ3RydWUnO1xyXG59XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFELE9BQUE7QUFFQTtBQUNBO0FBQ0E7QUFDTyxTQUFTRSxXQUFXQSxDQUFBLEVBQVM7RUFDbEM7RUFDQSxNQUFNQyxPQUFPLEdBQUcsSUFBQUMsYUFBTyxFQUFDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsV0FBVyxDQUFDO0VBQ25ELE1BQU1DLE1BQU0sR0FBRyxJQUFBQyxjQUFNLEVBQUM7SUFBRUMsSUFBSSxFQUFFTjtFQUFRLENBQUMsQ0FBQztFQUV4QyxJQUFJSSxNQUFNLENBQUNHLEtBQUssRUFBRTtJQUNoQkMsT0FBTyxDQUFDQyxJQUFJLENBQUMsOERBQThELENBQUM7RUFDOUU7O0VBRUE7RUFDQVAsT0FBTyxDQUFDUSxHQUFHLENBQUNDLFFBQVEsR0FBRyxNQUFNOztFQUU3QjtFQUNBQyxlQUFlLENBQUMsQ0FBQztBQUNuQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTQSxlQUFlQSxDQUFBLEVBQVM7RUFDL0IsTUFBTUMsUUFBUSxHQUFHLENBQ2YsY0FBYyxFQUNkLFdBQVcsRUFDWCxZQUFZLENBQ2I7RUFFRCxNQUFNQyxPQUFpQixHQUFHLEVBQUU7RUFFNUIsS0FBSyxNQUFNQyxHQUFHLElBQUlGLFFBQVEsRUFBRTtJQUMxQixJQUFJLENBQUNYLE9BQU8sQ0FBQ1EsR0FBRyxDQUFDSyxHQUFHLENBQUMsRUFBRTtNQUNyQkQsT0FBTyxDQUFDRSxJQUFJLENBQUNELEdBQUcsQ0FBQztJQUNuQjtFQUNGO0VBRUEsSUFBSUQsT0FBTyxDQUFDRyxNQUFNLEdBQUcsQ0FBQyxFQUFFO0lBQ3RCLE1BQU0sSUFBSUMsS0FBSyxDQUNiLGdEQUFnREosT0FBTyxDQUFDSyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksR0FDdEUsNkRBQ0YsQ0FBQztFQUNIO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ08sU0FBU0MsVUFBVUEsQ0FBQ0wsR0FBVyxFQUFFTSxRQUFpQixFQUFVO0VBQ2pFLE1BQU1DLEtBQUssR0FBR3BCLE9BQU8sQ0FBQ1EsR0FBRyxDQUFDSyxHQUFHLENBQUM7RUFFOUIsSUFBSSxDQUFDTyxLQUFLLElBQUksQ0FBQ0QsUUFBUSxFQUFFO0lBQ3ZCLE1BQU0sSUFBSUgsS0FBSyxDQUFDLHdCQUF3QkgsR0FBRyxzQ0FBc0MsQ0FBQztFQUNwRjtFQUVBLE9BQU9PLEtBQUssSUFBSUQsUUFBUztBQUMzQjs7QUFFQTtBQUNBO0FBQ0E7QUFDTyxTQUFTRSxTQUFTQSxDQUFBLEVBQVk7RUFDbkMsT0FBT3JCLE9BQU8sQ0FBQ1EsR0FBRyxDQUFDQyxRQUFRLEtBQUssTUFBTTtBQUN4Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDTyxTQUFTYSxrQkFBa0JBLENBQUEsRUFBVztFQUMzQyxPQUFPSixVQUFVLENBQUMsY0FBYyxFQUFFLHNEQUFzRCxDQUFDO0FBQzNGOztBQUVBO0FBQ0E7QUFDQTtBQUNPLFNBQVNLLGVBQWVBLENBQUEsRUFBVztFQUN4QyxPQUFPTCxVQUFVLENBQUMsV0FBVyxFQUFFLHdCQUF3QixDQUFDO0FBQzFEOztBQUVBO0FBQ0E7QUFDQTtBQUNPLFNBQVNNLGNBQWNBLENBQUEsRUFBWTtFQUN4QyxPQUFPeEIsT0FBTyxDQUFDUSxHQUFHLENBQUNpQixXQUFXLEtBQUssTUFBTTtBQUMzQyIsImlnbm9yZUxpc3QiOltdfQ==