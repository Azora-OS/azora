{"version":3,"names":["_express","require","_uuid","_structuredLogger","_metrics","cov_tkkm0f9lo","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","undefined","s","f","b","_coverageSchema","coverage","actualCoverage","requestIdMiddleware","req","res","next","requestId","headers","uuidv4","startTime","Date","now","setHeader","httpLoggingMiddleware","originalSend","send","data","duration","statusCode","recordHttpRequest","method","structuredLogger","logHttpRequest","userId","call","errorHandlingMiddleware","err","status","errorType","recordHttpError","error","message","json","success","timestamp","toISOString","systemMetricsMiddleware","Math","random","updateSystemMetrics","slowRequestMiddleware","slowThresholdMs","warn","threshold","requestBodyLoggingMiddleware","process","env","LOG_REQUEST_BODY","debug","body"],"sources":["monitoring.middleware.ts"],"sourcesContent":["/**\r\n * Monitoring Middleware\r\n * Tracks HTTP requests, errors, and performance metrics\r\n */\r\n\r\nimport { Request, Response, NextFunction } from 'express';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { structuredLogger } from '../utils/structured-logger';\r\nimport {\r\n  recordHttpRequest,\r\n  recordHttpError,\r\n  updateSystemMetrics,\r\n} from '../utils/metrics';\r\n\r\n/**\r\n * Extend Express Request to include monitoring data\r\n */\r\ndeclare global {\r\n  namespace Express {\r\n    interface Request {\r\n      requestId: string;\r\n      startTime: number;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Middleware to add request ID and start time\r\n */\r\nexport function requestIdMiddleware(\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction\r\n): void {\r\n  req.requestId = req.headers['x-request-id'] as string || uuidv4();\r\n  req.startTime = Date.now();\r\n\r\n  // Add request ID to response headers\r\n  res.setHeader('X-Request-ID', req.requestId);\r\n\r\n  next();\r\n}\r\n\r\n/**\r\n * Middleware to log HTTP requests and record metrics\r\n */\r\nexport function httpLoggingMiddleware(\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction // eslint-disable-line @typescript-eslint/no-unused-vars\r\n): void {\r\n  // Capture the original send function\r\n  const originalSend = res.send;\r\n\r\n  // Override send to capture response\r\n  res.send = function (data: any) {\r\n    const duration = (Date.now() - req.startTime) / 1000; // Convert to seconds\r\n    const statusCode = res.statusCode;\r\n\r\n    // Record metrics\r\n    recordHttpRequest(req.method, req.path, statusCode, duration);\r\n\r\n    // Log request\r\n    structuredLogger.logHttpRequest(\r\n      req.method,\r\n      req.path,\r\n      statusCode,\r\n      duration,\r\n      {\r\n        requestId: req.requestId,\r\n        userId: (req as any).userId,\r\n      }\r\n    );\r\n\r\n    // Call original send\r\n    return originalSend.call(this, data);\r\n  };\r\n\r\n  next();\r\n}\r\n\r\n/**\r\n * Middleware to handle errors and record error metrics\r\n */\r\nexport function errorHandlingMiddleware(\r\n  err: any,\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction\r\n): void {\r\n  const statusCode = err.status || err.statusCode || 500;\r\n  const errorType = err.name || 'UnknownError';\r\n\r\n  // Record error metric\r\n  recordHttpError(req.method, req.path, errorType);\r\n\r\n  // Log error\r\n  structuredLogger.error(\r\n    `HTTP Error: ${err.message}`,\r\n    err,\r\n    {\r\n      requestId: req.requestId,\r\n      userId: (req as any).userId,\r\n    },\r\n    {\r\n      method: req.method,\r\n      path: req.path,\r\n      statusCode,\r\n      errorType,\r\n    }\r\n  );\r\n\r\n  // Send error response\r\n  res.status(statusCode).json({\r\n    success: false,\r\n    error: err.message || 'Internal server error',\r\n    requestId: req.requestId,\r\n    timestamp: new Date().toISOString(),\r\n  });\r\n}\r\n\r\n/**\r\n * Middleware to update system metrics periodically\r\n */\r\nexport function systemMetricsMiddleware(\r\n  req: Request, // eslint-disable-line @typescript-eslint/no-unused-vars\r\n  res: Response, // eslint-disable-line @typescript-eslint/no-unused-vars\r\n  next: NextFunction\r\n): void {\r\n  // Update system metrics every 10 requests\r\n  if (Math.random() < 0.1) {\r\n    updateSystemMetrics();\r\n  }\r\n\r\n  next();\r\n}\r\n\r\n/**\r\n * Middleware to log slow requests\r\n */\r\nexport function slowRequestMiddleware(\r\n  slowThresholdMs: number = 1000\r\n) {\r\n  return (req: Request, res: Response, next: NextFunction): void => {\r\n    const originalSend = res.send;\r\n\r\n    res.send = function (data: any) {\r\n      const duration = Date.now() - req.startTime;\r\n\r\n      if (duration > slowThresholdMs) {\r\n        structuredLogger.warn(\r\n          `Slow request detected: ${req.method} ${req.path} took ${duration}ms`,\r\n          {\r\n            requestId: req.requestId,\r\n            userId: (req as any).userId,\r\n          },\r\n          {\r\n            method: req.method,\r\n            path: req.path,\r\n            duration,\r\n            threshold: slowThresholdMs,\r\n          }\r\n        );\r\n      }\r\n\r\n      return originalSend.call(this, data);\r\n    };\r\n\r\n    next();\r\n  };\r\n}\r\n\r\n/**\r\n * Middleware to log request body (for debugging)\r\n */\r\nexport function requestBodyLoggingMiddleware(\r\n  req: Request,\r\n  res: Response, // eslint-disable-line @typescript-eslint/no-unused-vars\r\n  next: NextFunction\r\n): void {\r\n  if (process.env.LOG_REQUEST_BODY === 'true' && req.method !== 'GET') {\r\n    structuredLogger.debug(\r\n      `Request body: ${req.method} ${req.path}`,\r\n      {\r\n        requestId: req.requestId,\r\n        userId: (req as any).userId,\r\n      },\r\n      {\r\n        body: req.body,\r\n      }\r\n    );\r\n  }\r\n\r\n  next();\r\n}\r\n"],"mappings":";;;;;;;;;;;;AAKA;AAAA;AAAAA,QAAA,GAAAC,OAAA;AACA;AAAA;AAAAC,KAAA,GAAAD,OAAA;AACA;AAAA;AAAAE,iBAAA,GAAAF,OAAA;AACA;AAAA;AAAAG,QAAA,GAAAH,OAAA;AAI0B;AAAA,SAAAI,cAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,MAAA,OAAAC,QAAA;EAAA,IAAAC,GAAA;EAAA,IAAAC,YAAA;IAAAL,IAAA;IAAAM,YAAA;MAAA;QAAAC,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,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","ignoreList":[]}