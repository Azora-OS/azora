6ad5a88b2dd7e33b6edefb12ba8e9adf
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.PlaywrightRunner = void 0;
var _child_process = require("child_process");
var _util = require("util");
var path = _interopRequireWildcard(require("path"));
var fs = _interopRequireWildcard(require("fs/promises"));
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) "default" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }
const execAsync = (0, _util.promisify)(_child_process.exec);
class PlaywrightRunner {
  constructor(projectRoot, previewServerUrl = 'http://localhost:3000') {
    this.projectRoot = projectRoot;
    this.previewServerUrl = previewServerUrl;
  }

  /**
   * Configure Playwright with browsers
   */
  async configure() {
    try {
      // Install Playwright browsers if not already installed
      await execAsync('npx playwright install', {
        cwd: this.projectRoot,
        timeout: 300000 // 5 minutes for browser installation
      });
    } catch (error) {
      throw new Error(`Failed to configure Playwright: ${error.message}`);
    }
  }

  /**
   * Start local preview server for testing
   */
  async startPreviewServer() {
    // Check if server is already running
    try {
      const response = await fetch(this.previewServerUrl);
      if (response.ok) {
        console.log('Preview server already running');
        return;
      }
    } catch {
      // Server not running, start it
    }

    // Start the preview server (implementation depends on project setup)
    // This is a placeholder - actual implementation would start the dev server
    console.log(`Starting preview server at ${this.previewServerUrl}`);
  }

  /**
   * Stop the preview server
   */
  async stopPreviewServer() {
    if (this.previewServerProcess) {
      this.previewServerProcess.kill();
      this.previewServerProcess = undefined;
    }
  }

  /**
   * Generate E2E test scenarios from user journeys
   */
  generateTestScenarios(userJourneys) {
    return userJourneys.map((journey, index) => ({
      name: `user-journey-${index + 1}`,
      description: journey.join(' â†’ '),
      userJourney: journey,
      priority: index === 0 ? 'critical' : 'high'
    }));
  }

  /**
   * Generate Playwright test file from scenario
   */
  async generateTestFile(scenario) {
    const testFilePath = path.join(this.projectRoot, 'tests', 'e2e', `${scenario.name}.spec.ts`);
    const testContent = this.generateTestContent(scenario);
    await fs.writeFile(testFilePath, testContent, 'utf-8');
    return testFilePath;
  }

  /**
   * Generate test content from scenario
   */
  generateTestContent(scenario) {
    const steps = scenario.userJourney.map((step, index) => {
      return `  // Step ${index + 1}: ${step}
  await page.waitForLoadState('networkidle');
  await page.screenshot({ path: \`screenshots/\${testInfo.title}-step-${index + 1}.png\` });`;
    }).join('\n\n');
    return `import { test, expect } from '@playwright/test';

/**
 * E2E Test: ${scenario.name}
 * Description: ${scenario.description}
 * Priority: ${scenario.priority}
 * 
 * User Journey:
${scenario.userJourney.map((step, i) => ` * ${i + 1}. ${step}`).join('\n')}
 */

test.describe('${scenario.name}', () => {
  test('should complete user journey successfully', async ({ page }, testInfo) => {
    // Navigate to application
    await page.goto('/');
    
${steps}
    
    // Verify final state
    await expect(page).toHaveTitle(/AzStudio/);
  });
  
  test('should handle errors gracefully', async ({ page }) => {
    // Test error scenarios
    await page.goto('/');
    
    // Add error handling tests based on the journey
    await expect(page.locator('body')).toBeVisible();
  });
});
`;
  }

  /**
   * Run E2E tests against local preview server
   */
  async runTests(scenarios) {
    try {
      // Generate test files if scenarios provided
      if (scenarios && scenarios.length > 0) {
        for (const scenario of scenarios) {
          await this.generateTestFile(scenario);
        }
      }

      // Run Playwright tests
      const {
        stdout
      } = await execAsync('npx playwright test --reporter=json', {
        cwd: this.projectRoot,
        timeout: 600000,
        // 10 minutes
        env: {
          ...process.env,
          PLAYWRIGHT_BASE_URL: this.previewServerUrl
        }
      });
      return this.parseTestResults(stdout);
    } catch (error) {
      // Parse results even on failure
      if (error.stdout) {
        return this.parseTestResults(error.stdout);
      }
      return {
        passed: 0,
        failed: 1,
        total: 1,
        duration: 0,
        results: [{
          scenario: 'Test execution',
          passed: false,
          duration: 0,
          error: error.message
        }]
      };
    }
  }

  /**
   * Run specific test file
   */
  async runTestFile(testFile) {
    try {
      const {
        stdout
      } = await execAsync(`npx playwright test ${testFile} --reporter=json`, {
        cwd: this.projectRoot,
        timeout: 300000
      });
      return this.parseTestResults(stdout);
    } catch (error) {
      if (error.stdout) {
        return this.parseTestResults(error.stdout);
      }
      return {
        passed: 0,
        failed: 1,
        total: 1,
        duration: 0,
        results: [{
          scenario: path.basename(testFile),
          passed: false,
          duration: 0,
          error: error.message
        }]
      };
    }
  }

  /**
   * Parse Playwright JSON output
   */
  parseTestResults(output) {
    try {
      const jsonMatch = output.match(/\{[\s\S]*\}/);
      if (!jsonMatch) {
        throw new Error('No JSON output found');
      }
      const results = JSON.parse(jsonMatch[0]);
      const suites = results.suites || [];
      const testResults = [];
      let passed = 0;
      let failed = 0;
      let totalDuration = 0;
      const extractTests = suite => {
        if (suite.specs) {
          for (const spec of suite.specs) {
            for (const test of spec.tests || []) {
              const result = test.results?.[0];
              const isPassed = result?.status === 'passed';
              if (isPassed) passed++;else failed++;
              totalDuration += result?.duration || 0;
              testResults.push({
                scenario: spec.title || 'Unknown',
                passed: isPassed,
                duration: result?.duration || 0,
                error: result?.error?.message,
                screenshots: result?.attachments?.filter(a => a.contentType?.includes('image')).map(a => a.path),
                video: result?.attachments?.find(a => a.contentType?.includes('video'))?.path,
                trace: result?.attachments?.find(a => a.name === 'trace')?.path
              });
            }
          }
        }
        if (suite.suites) {
          for (const subSuite of suite.suites) {
            extractTests(subSuite);
          }
        }
      };
      for (const suite of suites) {
        extractTests(suite);
      }
      return {
        passed,
        failed,
        total: passed + failed,
        duration: totalDuration,
        results: testResults,
        reportPath: path.join(this.projectRoot, 'test-results', 'html', 'index.html')
      };
    } catch (error) {
      // Fallback parsing for non-JSON output
      const passedMatch = output.match(/(\d+) passed/);
      const failedMatch = output.match(/(\d+) failed/);
      return {
        passed: passedMatch ? parseInt(passedMatch[1]) : 0,
        failed: failedMatch ? parseInt(failedMatch[1]) : 0,
        total: 0,
        duration: 0,
        results: []
      };
    }
  }

  /**
   * Capture screenshots on failure
   */
  async captureScreenshot(page, name) {
    const screenshotPath = path.join(this.projectRoot, 'test-results', 'screenshots', `${name}-${Date.now()}.png`);
    await fs.mkdir(path.dirname(screenshotPath), {
      recursive: true
    });
    await page.screenshot({
      path: screenshotPath,
      fullPage: true
    });
    return screenshotPath;
  }

  /**
   * Get test artifacts (screenshots, videos, traces)
   */
  async getTestArtifacts(testName) {
    const resultsDir = path.join(this.projectRoot, 'test-results');
    try {
      const files = await fs.readdir(resultsDir, {
        recursive: true
      });
      return {
        screenshots: files.filter(f => f.includes(testName) && f.endsWith('.png')),
        videos: files.filter(f => f.includes(testName) && f.endsWith('.webm')),
        traces: files.filter(f => f.includes(testName) && f.endsWith('.zip'))
      };
    } catch {
      return {
        screenshots: [],
        videos: [],
        traces: []
      };
    }
  }

  /**
   * Generate HTML report
   */
  async generateReport() {
    try {
      await execAsync('npx playwright show-report', {
        cwd: this.projectRoot
      });
      return path.join(this.projectRoot, 'test-results', 'html', 'index.html');
    } catch (error) {
      throw new Error(`Failed to generate report: ${error.message}`);
    }
  }
}
exports.PlaywrightRunner = PlaywrightRunner;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY2hpbGRfcHJvY2VzcyIsInJlcXVpcmUiLCJfdXRpbCIsInBhdGgiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsImZzIiwiZSIsInQiLCJXZWFrTWFwIiwiciIsIm4iLCJfX2VzTW9kdWxlIiwibyIsImkiLCJmIiwiX19wcm90b19fIiwiZGVmYXVsdCIsImhhcyIsImdldCIsInNldCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZXhlY0FzeW5jIiwicHJvbWlzaWZ5IiwiZXhlYyIsIlBsYXl3cmlnaHRSdW5uZXIiLCJjb25zdHJ1Y3RvciIsInByb2plY3RSb290IiwicHJldmlld1NlcnZlclVybCIsImNvbmZpZ3VyZSIsImN3ZCIsInRpbWVvdXQiLCJlcnJvciIsIkVycm9yIiwibWVzc2FnZSIsInN0YXJ0UHJldmlld1NlcnZlciIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsImNvbnNvbGUiLCJsb2ciLCJzdG9wUHJldmlld1NlcnZlciIsInByZXZpZXdTZXJ2ZXJQcm9jZXNzIiwia2lsbCIsInVuZGVmaW5lZCIsImdlbmVyYXRlVGVzdFNjZW5hcmlvcyIsInVzZXJKb3VybmV5cyIsIm1hcCIsImpvdXJuZXkiLCJpbmRleCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImpvaW4iLCJ1c2VySm91cm5leSIsInByaW9yaXR5IiwiZ2VuZXJhdGVUZXN0RmlsZSIsInNjZW5hcmlvIiwidGVzdEZpbGVQYXRoIiwidGVzdENvbnRlbnQiLCJnZW5lcmF0ZVRlc3RDb250ZW50Iiwid3JpdGVGaWxlIiwic3RlcHMiLCJzdGVwIiwicnVuVGVzdHMiLCJzY2VuYXJpb3MiLCJsZW5ndGgiLCJzdGRvdXQiLCJlbnYiLCJwcm9jZXNzIiwiUExBWVdSSUdIVF9CQVNFX1VSTCIsInBhcnNlVGVzdFJlc3VsdHMiLCJwYXNzZWQiLCJmYWlsZWQiLCJ0b3RhbCIsImR1cmF0aW9uIiwicmVzdWx0cyIsInJ1blRlc3RGaWxlIiwidGVzdEZpbGUiLCJiYXNlbmFtZSIsIm91dHB1dCIsImpzb25NYXRjaCIsIm1hdGNoIiwiSlNPTiIsInBhcnNlIiwic3VpdGVzIiwidGVzdFJlc3VsdHMiLCJ0b3RhbER1cmF0aW9uIiwiZXh0cmFjdFRlc3RzIiwic3VpdGUiLCJzcGVjcyIsInNwZWMiLCJ0ZXN0IiwidGVzdHMiLCJyZXN1bHQiLCJpc1Bhc3NlZCIsInN0YXR1cyIsInB1c2giLCJ0aXRsZSIsInNjcmVlbnNob3RzIiwiYXR0YWNobWVudHMiLCJmaWx0ZXIiLCJhIiwiY29udGVudFR5cGUiLCJpbmNsdWRlcyIsInZpZGVvIiwiZmluZCIsInRyYWNlIiwic3ViU3VpdGUiLCJyZXBvcnRQYXRoIiwicGFzc2VkTWF0Y2giLCJmYWlsZWRNYXRjaCIsInBhcnNlSW50IiwiY2FwdHVyZVNjcmVlbnNob3QiLCJwYWdlIiwic2NyZWVuc2hvdFBhdGgiLCJEYXRlIiwibm93IiwibWtkaXIiLCJkaXJuYW1lIiwicmVjdXJzaXZlIiwic2NyZWVuc2hvdCIsImZ1bGxQYWdlIiwiZ2V0VGVzdEFydGlmYWN0cyIsInRlc3ROYW1lIiwicmVzdWx0c0RpciIsImZpbGVzIiwicmVhZGRpciIsImVuZHNXaXRoIiwidmlkZW9zIiwidHJhY2VzIiwiZ2VuZXJhdGVSZXBvcnQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiUGxheXdyaWdodFJ1bm5lci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGVjIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcy9wcm9taXNlcyc7XG5cbmNvbnN0IGV4ZWNBc3luYyA9IHByb21pc2lmeShleGVjKTtcblxuZXhwb3J0IGludGVyZmFjZSBFMkVUZXN0U2NlbmFyaW8ge1xuICBuYW1lOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHVzZXJKb3VybmV5OiBzdHJpbmdbXTtcbiAgcHJpb3JpdHk6ICdjcml0aWNhbCcgfCAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEUyRVRlc3RSZXN1bHQge1xuICBzY2VuYXJpbzogc3RyaW5nO1xuICBwYXNzZWQ6IGJvb2xlYW47XG4gIGR1cmF0aW9uOiBudW1iZXI7XG4gIGVycm9yPzogc3RyaW5nO1xuICBzY3JlZW5zaG90cz86IHN0cmluZ1tdO1xuICB2aWRlbz86IHN0cmluZztcbiAgdHJhY2U/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRTJFUmVzdWx0cyB7XG4gIHBhc3NlZDogbnVtYmVyO1xuICBmYWlsZWQ6IG51bWJlcjtcbiAgdG90YWw6IG51bWJlcjtcbiAgZHVyYXRpb246IG51bWJlcjtcbiAgcmVzdWx0czogRTJFVGVzdFJlc3VsdFtdO1xuICByZXBvcnRQYXRoPzogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgUGxheXdyaWdodFJ1bm5lciB7XG4gIHByaXZhdGUgcHJvamVjdFJvb3Q6IHN0cmluZztcbiAgcHJpdmF0ZSBwcmV2aWV3U2VydmVyVXJsOiBzdHJpbmc7XG4gIHByaXZhdGUgcHJldmlld1NlcnZlclByb2Nlc3M/OiBhbnk7XG5cbiAgY29uc3RydWN0b3IocHJvamVjdFJvb3Q6IHN0cmluZywgcHJldmlld1NlcnZlclVybDogc3RyaW5nID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcpIHtcbiAgICB0aGlzLnByb2plY3RSb290ID0gcHJvamVjdFJvb3Q7XG4gICAgdGhpcy5wcmV2aWV3U2VydmVyVXJsID0gcHJldmlld1NlcnZlclVybDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb25maWd1cmUgUGxheXdyaWdodCB3aXRoIGJyb3dzZXJzXG4gICAqL1xuICBhc3luYyBjb25maWd1cmUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEluc3RhbGwgUGxheXdyaWdodCBicm93c2VycyBpZiBub3QgYWxyZWFkeSBpbnN0YWxsZWRcbiAgICAgIGF3YWl0IGV4ZWNBc3luYygnbnB4IHBsYXl3cmlnaHQgaW5zdGFsbCcsIHtcbiAgICAgICAgY3dkOiB0aGlzLnByb2plY3RSb290LFxuICAgICAgICB0aW1lb3V0OiAzMDAwMDAsIC8vIDUgbWludXRlcyBmb3IgYnJvd3NlciBpbnN0YWxsYXRpb25cbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGNvbmZpZ3VyZSBQbGF5d3JpZ2h0OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IGxvY2FsIHByZXZpZXcgc2VydmVyIGZvciB0ZXN0aW5nXG4gICAqL1xuICBhc3luYyBzdGFydFByZXZpZXdTZXJ2ZXIoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gQ2hlY2sgaWYgc2VydmVyIGlzIGFscmVhZHkgcnVubmluZ1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMucHJldmlld1NlcnZlclVybCk7XG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1ByZXZpZXcgc2VydmVyIGFscmVhZHkgcnVubmluZycpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICAvLyBTZXJ2ZXIgbm90IHJ1bm5pbmcsIHN0YXJ0IGl0XG4gICAgfVxuXG4gICAgLy8gU3RhcnQgdGhlIHByZXZpZXcgc2VydmVyIChpbXBsZW1lbnRhdGlvbiBkZXBlbmRzIG9uIHByb2plY3Qgc2V0dXApXG4gICAgLy8gVGhpcyBpcyBhIHBsYWNlaG9sZGVyIC0gYWN0dWFsIGltcGxlbWVudGF0aW9uIHdvdWxkIHN0YXJ0IHRoZSBkZXYgc2VydmVyXG4gICAgY29uc29sZS5sb2coYFN0YXJ0aW5nIHByZXZpZXcgc2VydmVyIGF0ICR7dGhpcy5wcmV2aWV3U2VydmVyVXJsfWApO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgdGhlIHByZXZpZXcgc2VydmVyXG4gICAqL1xuICBhc3luYyBzdG9wUHJldmlld1NlcnZlcigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5wcmV2aWV3U2VydmVyUHJvY2Vzcykge1xuICAgICAgdGhpcy5wcmV2aWV3U2VydmVyUHJvY2Vzcy5raWxsKCk7XG4gICAgICB0aGlzLnByZXZpZXdTZXJ2ZXJQcm9jZXNzID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBFMkUgdGVzdCBzY2VuYXJpb3MgZnJvbSB1c2VyIGpvdXJuZXlzXG4gICAqL1xuICBnZW5lcmF0ZVRlc3RTY2VuYXJpb3ModXNlckpvdXJuZXlzOiBzdHJpbmdbXVtdKTogRTJFVGVzdFNjZW5hcmlvW10ge1xuICAgIHJldHVybiB1c2VySm91cm5leXMubWFwKChqb3VybmV5LCBpbmRleCkgPT4gKHtcbiAgICAgIG5hbWU6IGB1c2VyLWpvdXJuZXktJHtpbmRleCArIDF9YCxcbiAgICAgIGRlc2NyaXB0aW9uOiBqb3VybmV5LmpvaW4oJyDihpIgJyksXG4gICAgICB1c2VySm91cm5leTogam91cm5leSxcbiAgICAgIHByaW9yaXR5OiBpbmRleCA9PT0gMCA/ICdjcml0aWNhbCcgOiAnaGlnaCcsXG4gICAgfSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIFBsYXl3cmlnaHQgdGVzdCBmaWxlIGZyb20gc2NlbmFyaW9cbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlVGVzdEZpbGUoc2NlbmFyaW86IEUyRVRlc3RTY2VuYXJpbyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgdGVzdEZpbGVQYXRoID0gcGF0aC5qb2luKFxuICAgICAgdGhpcy5wcm9qZWN0Um9vdCxcbiAgICAgICd0ZXN0cycsXG4gICAgICAnZTJlJyxcbiAgICAgIGAke3NjZW5hcmlvLm5hbWV9LnNwZWMudHNgXG4gICAgKTtcblxuICAgIGNvbnN0IHRlc3RDb250ZW50ID0gdGhpcy5nZW5lcmF0ZVRlc3RDb250ZW50KHNjZW5hcmlvKTtcbiAgICBhd2FpdCBmcy53cml0ZUZpbGUodGVzdEZpbGVQYXRoLCB0ZXN0Q29udGVudCwgJ3V0Zi04Jyk7XG5cbiAgICByZXR1cm4gdGVzdEZpbGVQYXRoO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHRlc3QgY29udGVudCBmcm9tIHNjZW5hcmlvXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlVGVzdENvbnRlbnQoc2NlbmFyaW86IEUyRVRlc3RTY2VuYXJpbyk6IHN0cmluZyB7XG4gICAgY29uc3Qgc3RlcHMgPSBzY2VuYXJpby51c2VySm91cm5leS5tYXAoKHN0ZXAsIGluZGV4KSA9PiB7XG4gICAgICByZXR1cm4gYCAgLy8gU3RlcCAke2luZGV4ICsgMX06ICR7c3RlcH1cbiAgYXdhaXQgcGFnZS53YWl0Rm9yTG9hZFN0YXRlKCduZXR3b3JraWRsZScpO1xuICBhd2FpdCBwYWdlLnNjcmVlbnNob3QoeyBwYXRoOiBcXGBzY3JlZW5zaG90cy9cXCR7dGVzdEluZm8udGl0bGV9LXN0ZXAtJHtpbmRleCArIDF9LnBuZ1xcYCB9KTtgO1xuICAgIH0pLmpvaW4oJ1xcblxcbicpO1xuXG4gICAgcmV0dXJuIGBpbXBvcnQgeyB0ZXN0LCBleHBlY3QgfSBmcm9tICdAcGxheXdyaWdodC90ZXN0JztcblxuLyoqXG4gKiBFMkUgVGVzdDogJHtzY2VuYXJpby5uYW1lfVxuICogRGVzY3JpcHRpb246ICR7c2NlbmFyaW8uZGVzY3JpcHRpb259XG4gKiBQcmlvcml0eTogJHtzY2VuYXJpby5wcmlvcml0eX1cbiAqIFxuICogVXNlciBKb3VybmV5OlxuJHtzY2VuYXJpby51c2VySm91cm5leS5tYXAoKHN0ZXAsIGkpID0+IGAgKiAke2kgKyAxfS4gJHtzdGVwfWApLmpvaW4oJ1xcbicpfVxuICovXG5cbnRlc3QuZGVzY3JpYmUoJyR7c2NlbmFyaW8ubmFtZX0nLCAoKSA9PiB7XG4gIHRlc3QoJ3Nob3VsZCBjb21wbGV0ZSB1c2VyIGpvdXJuZXkgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKHsgcGFnZSB9LCB0ZXN0SW5mbykgPT4ge1xuICAgIC8vIE5hdmlnYXRlIHRvIGFwcGxpY2F0aW9uXG4gICAgYXdhaXQgcGFnZS5nb3RvKCcvJyk7XG4gICAgXG4ke3N0ZXBzfVxuICAgIFxuICAgIC8vIFZlcmlmeSBmaW5hbCBzdGF0ZVxuICAgIGF3YWl0IGV4cGVjdChwYWdlKS50b0hhdmVUaXRsZSgvQXpTdHVkaW8vKTtcbiAgfSk7XG4gIFxuICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKHsgcGFnZSB9KSA9PiB7XG4gICAgLy8gVGVzdCBlcnJvciBzY2VuYXJpb3NcbiAgICBhd2FpdCBwYWdlLmdvdG8oJy8nKTtcbiAgICBcbiAgICAvLyBBZGQgZXJyb3IgaGFuZGxpbmcgdGVzdHMgYmFzZWQgb24gdGhlIGpvdXJuZXlcbiAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdib2R5JykpLnRvQmVWaXNpYmxlKCk7XG4gIH0pO1xufSk7XG5gO1xuICB9XG5cbiAgLyoqXG4gICAqIFJ1biBFMkUgdGVzdHMgYWdhaW5zdCBsb2NhbCBwcmV2aWV3IHNlcnZlclxuICAgKi9cbiAgYXN5bmMgcnVuVGVzdHMoc2NlbmFyaW9zPzogRTJFVGVzdFNjZW5hcmlvW10pOiBQcm9taXNlPEUyRVJlc3VsdHM+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2VuZXJhdGUgdGVzdCBmaWxlcyBpZiBzY2VuYXJpb3MgcHJvdmlkZWRcbiAgICAgIGlmIChzY2VuYXJpb3MgJiYgc2NlbmFyaW9zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZm9yIChjb25zdCBzY2VuYXJpbyBvZiBzY2VuYXJpb3MpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmdlbmVyYXRlVGVzdEZpbGUoc2NlbmFyaW8pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFJ1biBQbGF5d3JpZ2h0IHRlc3RzXG4gICAgICBjb25zdCB7IHN0ZG91dCB9ID0gYXdhaXQgZXhlY0FzeW5jKCducHggcGxheXdyaWdodCB0ZXN0IC0tcmVwb3J0ZXI9anNvbicsIHtcbiAgICAgICAgY3dkOiB0aGlzLnByb2plY3RSb290LFxuICAgICAgICB0aW1lb3V0OiA2MDAwMDAsIC8vIDEwIG1pbnV0ZXNcbiAgICAgICAgZW52OiB7XG4gICAgICAgICAgLi4ucHJvY2Vzcy5lbnYsXG4gICAgICAgICAgUExBWVdSSUdIVF9CQVNFX1VSTDogdGhpcy5wcmV2aWV3U2VydmVyVXJsLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB0aGlzLnBhcnNlVGVzdFJlc3VsdHMoc3Rkb3V0KTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAvLyBQYXJzZSByZXN1bHRzIGV2ZW4gb24gZmFpbHVyZVxuICAgICAgaWYgKGVycm9yLnN0ZG91dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZVRlc3RSZXN1bHRzKGVycm9yLnN0ZG91dCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhc3NlZDogMCxcbiAgICAgICAgZmFpbGVkOiAxLFxuICAgICAgICB0b3RhbDogMSxcbiAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgIHJlc3VsdHM6IFt7XG4gICAgICAgICAgc2NlbmFyaW86ICdUZXN0IGV4ZWN1dGlvbicsXG4gICAgICAgICAgcGFzc2VkOiBmYWxzZSxcbiAgICAgICAgICBkdXJhdGlvbjogMCxcbiAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgfV0sXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSdW4gc3BlY2lmaWMgdGVzdCBmaWxlXG4gICAqL1xuICBhc3luYyBydW5UZXN0RmlsZSh0ZXN0RmlsZTogc3RyaW5nKTogUHJvbWlzZTxFMkVSZXN1bHRzPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgc3Rkb3V0IH0gPSBhd2FpdCBleGVjQXN5bmMoYG5weCBwbGF5d3JpZ2h0IHRlc3QgJHt0ZXN0RmlsZX0gLS1yZXBvcnRlcj1qc29uYCwge1xuICAgICAgICBjd2Q6IHRoaXMucHJvamVjdFJvb3QsXG4gICAgICAgIHRpbWVvdXQ6IDMwMDAwMCxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5wYXJzZVRlc3RSZXN1bHRzKHN0ZG91dCk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgaWYgKGVycm9yLnN0ZG91dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZVRlc3RSZXN1bHRzKGVycm9yLnN0ZG91dCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhc3NlZDogMCxcbiAgICAgICAgZmFpbGVkOiAxLFxuICAgICAgICB0b3RhbDogMSxcbiAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgIHJlc3VsdHM6IFt7XG4gICAgICAgICAgc2NlbmFyaW86IHBhdGguYmFzZW5hbWUodGVzdEZpbGUpLFxuICAgICAgICAgIHBhc3NlZDogZmFsc2UsXG4gICAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIH1dLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgUGxheXdyaWdodCBKU09OIG91dHB1dFxuICAgKi9cbiAgcHJpdmF0ZSBwYXJzZVRlc3RSZXN1bHRzKG91dHB1dDogc3RyaW5nKTogRTJFUmVzdWx0cyB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGpzb25NYXRjaCA9IG91dHB1dC5tYXRjaCgvXFx7W1xcc1xcU10qXFx9Lyk7XG4gICAgICBpZiAoIWpzb25NYXRjaCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIEpTT04gb3V0cHV0IGZvdW5kJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSk7XG4gICAgICBjb25zdCBzdWl0ZXMgPSByZXN1bHRzLnN1aXRlcyB8fCBbXTtcbiAgICAgIFxuICAgICAgY29uc3QgdGVzdFJlc3VsdHM6IEUyRVRlc3RSZXN1bHRbXSA9IFtdO1xuICAgICAgbGV0IHBhc3NlZCA9IDA7XG4gICAgICBsZXQgZmFpbGVkID0gMDtcbiAgICAgIGxldCB0b3RhbER1cmF0aW9uID0gMDtcblxuICAgICAgY29uc3QgZXh0cmFjdFRlc3RzID0gKHN1aXRlOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKHN1aXRlLnNwZWNzKSB7XG4gICAgICAgICAgZm9yIChjb25zdCBzcGVjIG9mIHN1aXRlLnNwZWNzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHRlc3Qgb2Ygc3BlYy50ZXN0cyB8fCBbXSkge1xuICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0ZXN0LnJlc3VsdHM/LlswXTtcbiAgICAgICAgICAgICAgY29uc3QgaXNQYXNzZWQgPSByZXN1bHQ/LnN0YXR1cyA9PT0gJ3Bhc3NlZCc7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBpZiAoaXNQYXNzZWQpIHBhc3NlZCsrO1xuICAgICAgICAgICAgICBlbHNlIGZhaWxlZCsrO1xuXG4gICAgICAgICAgICAgIHRvdGFsRHVyYXRpb24gKz0gcmVzdWx0Py5kdXJhdGlvbiB8fCAwO1xuXG4gICAgICAgICAgICAgIHRlc3RSZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgICAgIHNjZW5hcmlvOiBzcGVjLnRpdGxlIHx8ICdVbmtub3duJyxcbiAgICAgICAgICAgICAgICBwYXNzZWQ6IGlzUGFzc2VkLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiByZXN1bHQ/LmR1cmF0aW9uIHx8IDAsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHJlc3VsdD8uZXJyb3I/Lm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgc2NyZWVuc2hvdHM6IHJlc3VsdD8uYXR0YWNobWVudHNcbiAgICAgICAgICAgICAgICAgID8uZmlsdGVyKChhOiBhbnkpID0+IGEuY29udGVudFR5cGU/LmluY2x1ZGVzKCdpbWFnZScpKVxuICAgICAgICAgICAgICAgICAgLm1hcCgoYTogYW55KSA9PiBhLnBhdGgpLFxuICAgICAgICAgICAgICAgIHZpZGVvOiByZXN1bHQ/LmF0dGFjaG1lbnRzXG4gICAgICAgICAgICAgICAgICA/LmZpbmQoKGE6IGFueSkgPT4gYS5jb250ZW50VHlwZT8uaW5jbHVkZXMoJ3ZpZGVvJykpPy5wYXRoLFxuICAgICAgICAgICAgICAgIHRyYWNlOiByZXN1bHQ/LmF0dGFjaG1lbnRzXG4gICAgICAgICAgICAgICAgICA/LmZpbmQoKGE6IGFueSkgPT4gYS5uYW1lID09PSAndHJhY2UnKT8ucGF0aCxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1aXRlLnN1aXRlcykge1xuICAgICAgICAgIGZvciAoY29uc3Qgc3ViU3VpdGUgb2Ygc3VpdGUuc3VpdGVzKSB7XG4gICAgICAgICAgICBleHRyYWN0VGVzdHMoc3ViU3VpdGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgZm9yIChjb25zdCBzdWl0ZSBvZiBzdWl0ZXMpIHtcbiAgICAgICAgZXh0cmFjdFRlc3RzKHN1aXRlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGFzc2VkLFxuICAgICAgICBmYWlsZWQsXG4gICAgICAgIHRvdGFsOiBwYXNzZWQgKyBmYWlsZWQsXG4gICAgICAgIGR1cmF0aW9uOiB0b3RhbER1cmF0aW9uLFxuICAgICAgICByZXN1bHRzOiB0ZXN0UmVzdWx0cyxcbiAgICAgICAgcmVwb3J0UGF0aDogcGF0aC5qb2luKHRoaXMucHJvamVjdFJvb3QsICd0ZXN0LXJlc3VsdHMnLCAnaHRtbCcsICdpbmRleC5odG1sJyksXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIC8vIEZhbGxiYWNrIHBhcnNpbmcgZm9yIG5vbi1KU09OIG91dHB1dFxuICAgICAgY29uc3QgcGFzc2VkTWF0Y2ggPSBvdXRwdXQubWF0Y2goLyhcXGQrKSBwYXNzZWQvKTtcbiAgICAgIGNvbnN0IGZhaWxlZE1hdGNoID0gb3V0cHV0Lm1hdGNoKC8oXFxkKykgZmFpbGVkLyk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhc3NlZDogcGFzc2VkTWF0Y2ggPyBwYXJzZUludChwYXNzZWRNYXRjaFsxXSkgOiAwLFxuICAgICAgICBmYWlsZWQ6IGZhaWxlZE1hdGNoID8gcGFyc2VJbnQoZmFpbGVkTWF0Y2hbMV0pIDogMCxcbiAgICAgICAgdG90YWw6IDAsXG4gICAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgICByZXN1bHRzOiBbXSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhcHR1cmUgc2NyZWVuc2hvdHMgb24gZmFpbHVyZVxuICAgKi9cbiAgYXN5bmMgY2FwdHVyZVNjcmVlbnNob3QocGFnZTogYW55LCBuYW1lOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHNjcmVlbnNob3RQYXRoID0gcGF0aC5qb2luKFxuICAgICAgdGhpcy5wcm9qZWN0Um9vdCxcbiAgICAgICd0ZXN0LXJlc3VsdHMnLFxuICAgICAgJ3NjcmVlbnNob3RzJyxcbiAgICAgIGAke25hbWV9LSR7RGF0ZS5ub3coKX0ucG5nYFxuICAgICk7XG5cbiAgICBhd2FpdCBmcy5ta2RpcihwYXRoLmRpcm5hbWUoc2NyZWVuc2hvdFBhdGgpLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICBhd2FpdCBwYWdlLnNjcmVlbnNob3QoeyBwYXRoOiBzY3JlZW5zaG90UGF0aCwgZnVsbFBhZ2U6IHRydWUgfSk7XG5cbiAgICByZXR1cm4gc2NyZWVuc2hvdFBhdGg7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRlc3QgYXJ0aWZhY3RzIChzY3JlZW5zaG90cywgdmlkZW9zLCB0cmFjZXMpXG4gICAqL1xuICBhc3luYyBnZXRUZXN0QXJ0aWZhY3RzKHRlc3ROYW1lOiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgICBzY3JlZW5zaG90czogc3RyaW5nW107XG4gICAgdmlkZW9zOiBzdHJpbmdbXTtcbiAgICB0cmFjZXM6IHN0cmluZ1tdO1xuICB9PiB7XG4gICAgY29uc3QgcmVzdWx0c0RpciA9IHBhdGguam9pbih0aGlzLnByb2plY3RSb290LCAndGVzdC1yZXN1bHRzJyk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgZnMucmVhZGRpcihyZXN1bHRzRGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2NyZWVuc2hvdHM6IGZpbGVzLmZpbHRlcihmID0+IGYuaW5jbHVkZXModGVzdE5hbWUpICYmIGYuZW5kc1dpdGgoJy5wbmcnKSksXG4gICAgICAgIHZpZGVvczogZmlsZXMuZmlsdGVyKGYgPT4gZi5pbmNsdWRlcyh0ZXN0TmFtZSkgJiYgZi5lbmRzV2l0aCgnLndlYm0nKSksXG4gICAgICAgIHRyYWNlczogZmlsZXMuZmlsdGVyKGYgPT4gZi5pbmNsdWRlcyh0ZXN0TmFtZSkgJiYgZi5lbmRzV2l0aCgnLnppcCcpKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4geyBzY3JlZW5zaG90czogW10sIHZpZGVvczogW10sIHRyYWNlczogW10gfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgSFRNTCByZXBvcnRcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlUmVwb3J0KCk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGV4ZWNBc3luYygnbnB4IHBsYXl3cmlnaHQgc2hvdy1yZXBvcnQnLCB7XG4gICAgICAgIGN3ZDogdGhpcy5wcm9qZWN0Um9vdCxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcGF0aC5qb2luKHRoaXMucHJvamVjdFJvb3QsICd0ZXN0LXJlc3VsdHMnLCAnaHRtbCcsICdpbmRleC5odG1sJyk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2VuZXJhdGUgcmVwb3J0OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLGNBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLElBQUEsR0FBQUMsdUJBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLEVBQUEsR0FBQUQsdUJBQUEsQ0FBQUgsT0FBQTtBQUFrQyxTQUFBRyx3QkFBQUUsQ0FBQSxFQUFBQyxDQUFBLDZCQUFBQyxPQUFBLE1BQUFDLENBQUEsT0FBQUQsT0FBQSxJQUFBRSxDQUFBLE9BQUFGLE9BQUEsWUFBQUosdUJBQUEsWUFBQUEsQ0FBQUUsQ0FBQSxFQUFBQyxDQUFBLFNBQUFBLENBQUEsSUFBQUQsQ0FBQSxJQUFBQSxDQUFBLENBQUFLLFVBQUEsU0FBQUwsQ0FBQSxNQUFBTSxDQUFBLEVBQUFDLENBQUEsRUFBQUMsQ0FBQSxLQUFBQyxTQUFBLFFBQUFDLE9BQUEsRUFBQVYsQ0FBQSxpQkFBQUEsQ0FBQSx1QkFBQUEsQ0FBQSx5QkFBQUEsQ0FBQSxTQUFBUSxDQUFBLE1BQUFGLENBQUEsR0FBQUwsQ0FBQSxHQUFBRyxDQUFBLEdBQUFELENBQUEsUUFBQUcsQ0FBQSxDQUFBSyxHQUFBLENBQUFYLENBQUEsVUFBQU0sQ0FBQSxDQUFBTSxHQUFBLENBQUFaLENBQUEsR0FBQU0sQ0FBQSxDQUFBTyxHQUFBLENBQUFiLENBQUEsRUFBQVEsQ0FBQSxnQkFBQVAsQ0FBQSxJQUFBRCxDQUFBLGdCQUFBQyxDQUFBLE9BQUFhLGNBQUEsQ0FBQUMsSUFBQSxDQUFBZixDQUFBLEVBQUFDLENBQUEsT0FBQU0sQ0FBQSxJQUFBRCxDQUFBLEdBQUFVLE1BQUEsQ0FBQUMsY0FBQSxL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