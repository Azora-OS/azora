{"version":3,"names":["path","_interopRequireWildcard","require","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","StorageServiceComponent","generateStorageService","config","outputDir","changes","serviceName","serviceDir","join","push","type","content","generateIndexFile","generateStorageController","generateStorageServiceFile","generateProviderService","enableImageOptimization","generateImageService","generateFileRepository","generateUploadMiddleware","generateTypes","generateValidationSchemas","generatePrismaSchema","generatePackageJson","generateEnvExample","generateReadme","port","enableSignedUrls","provider","maxSize","maxFileSize","dependencies","express","cors","helmet","zod","multer","JSON","stringify","name","version","description","main","scripts","dev","build","start","test","devDependencies","typescript","jest","prisma","env","toUpperCase","exports"],"sources":["StorageServiceComponent.ts"],"sourcesContent":["import * as path from 'path';\nimport { FileChange } from '../ChangesetManager';\n\nexport interface StorageServiceConfig {\n  name: string;\n  port?: number;\n  provider?: 's3' | 'r2' | 'local';\n  enableImageOptimization?: boolean;\n  enableSignedUrls?: boolean;\n  maxFileSize?: number; // in MB\n}\n\nexport class StorageServiceComponent {\n  /**\n   * Generate complete storage service with S3/R2 integration\n   */\n  generateStorageService(config: StorageServiceConfig, outputDir: string): FileChange[] {\n    const changes: FileChange[] = [];\n    const serviceName = 'storage-service';\n    const serviceDir = path.join(outputDir, 'services', serviceName);\n\n    // Main service file\n    changes.push({\n      path: path.join(serviceDir, 'src', 'index.ts'),\n      type: 'create',\n      content: this.generateIndexFile(config),\n    });\n\n    // Controllers\n    changes.push({\n      path: path.join(serviceDir, 'src', 'controllers', 'storage.controller.ts'),\n      type: 'create',\n      content: this.generateStorageController(config),\n    });\n\n    // Services\n    changes.push({\n      path: path.join(serviceDir, 'src', 'services', 'storage.service.ts'),\n      type: 'create',\n      content: this.generateStorageServiceFile(config),\n    });\n\n    changes.push({\n      path: path.join(serviceDir, 'src', 'services', 'provider.service.ts'),\n      type: 'create',\n      content: this.generateProviderService(config),\n    });\n\n    if (config.enableImageOptimization) {\n      changes.push({\n        path: path.join(serviceDir, 'src', 'services', 'image.service.ts'),\n        type: 'create',\n        content: this.generateImageService(),\n      });\n    }\n\n    // Repository\n    changes.push({\n      path: path.join(serviceDir, 'src', 'repositories', 'file.repository.ts'),\n      type: 'create',\n      content: this.generateFileRepository(),\n    });\n\n    // Middleware\n    changes.push({\n      path: path.join(serviceDir, 'src', 'middleware', 'upload.middleware.ts'),\n      type: 'create',\n      content: this.generateUploadMiddleware(config),\n    });\n\n    // Types\n    changes.push({\n      path: path.join(serviceDir, 'src', 'types', 'index.ts'),\n      type: 'create',\n      content: this.generateTypes(config),\n    });\n\n    // Validation schemas\n    changes.push({\n      path: path.join(serviceDir, 'src', 'validation', 'storage.schemas.ts'),\n      type: 'create',\n      content: this.generateValidationSchemas(),\n    });\n\n    // Prisma schema\n    changes.push({\n      path: path.join(serviceDir, 'prisma', 'schema.prisma'),\n      type: 'create',\n      content: this.generatePrismaSchema(),\n    });\n\n    // Configuration files\n    changes.push({\n      path: path.join(serviceDir, 'package.json'),\n      type: 'create',\n      content: this.generatePackageJson(config),\n    });\n\n    changes.push({\n      path: path.join(serviceDir, '.env.example'),\n      type: 'create',\n      content: this.generateEnvExample(config),\n    });\n\n    changes.push({\n      path: path.join(serviceDir, 'README.md'),\n      type: 'create',\n      content: this.generateReadme(config),\n    });\n\n    return changes;\n  }\n\n  private generateIndexFile(config: StorageServiceConfig): string {\n    const port = config.port || 3004;\n    return `import express, { Application } from 'express';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport { StorageController } from './controllers/storage.controller';\nimport { errorHandler } from './middleware/error-handler';\n\nconst app: Application = express();\nconst PORT = process.env.PORT || ${port};\n\n// Middleware\napp.use(helmet());\napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\n\n// Health check\napp.get('/health', (req, res) => {\n  res.json({ status: 'healthy', service: 'storage-service' });\n});\n\n// Routes\nconst storageController = new StorageController();\napp.use('/api/storage', storageController.router);\n\n// Error handling\napp.use(errorHandler);\n\n// Start server\napp.listen(PORT, () => {\n  console.log(\\`Storage service running on port \\${PORT}\\`);\n});\n\nexport default app;\n`;\n  }\n\n  private generateStorageController(config: StorageServiceConfig): string {\n    return `import { Router, Request, Response, NextFunction } from 'express';\nimport { StorageService } from '../services/storage.service';\nimport { uploadMiddleware } from '../middleware/upload.middleware';\nimport { authMiddleware } from '../middleware/auth.middleware';\n\nexport class StorageController {\n  public router: Router;\n  private storageService: StorageService;\n\n  constructor() {\n    this.router = Router();\n    this.storageService = new StorageService();\n    this.initializeRoutes();\n  }\n\n  private initializeRoutes(): void {\n    // Upload file\n    this.router.post(\n      '/upload',\n      authMiddleware,\n      uploadMiddleware.single('file'),\n      this.uploadFile.bind(this)\n    );\n    \n    // Upload multiple files\n    this.router.post(\n      '/upload-multiple',\n      authMiddleware,\n      uploadMiddleware.array('files', 10),\n      this.uploadMultiple.bind(this)\n    );\n    \n    // Get file\n    this.router.get('/:id', this.getFile.bind(this));\n    \n    // Download file\n    this.router.get('/:id/download', this.downloadFile.bind(this));\n${config.enableSignedUrls ? `\n    // Get signed URL\n    this.router.get('/:id/signed-url', authMiddleware, this.getSignedUrl.bind(this));\n` : ''}\n    // Delete file\n    this.router.delete('/:id', authMiddleware, this.deleteFile.bind(this));\n    \n    // List user files\n    this.router.get('/', authMiddleware, this.listFiles.bind(this));\n  }\n\n  private async uploadFile(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      if (!req.file) {\n        res.status(400).json({ success: false, error: 'No file provided' });\n        return;\n      }\n\n      const file = await this.storageService.uploadFile(\n        req.file,\n        req.user!.userId\n      );\n\n      res.json({ success: true, data: file });\n    } catch (error) {\n      next(error);\n    }\n  }\n\n  private async uploadMultiple(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      if (!req.files || !Array.isArray(req.files)) {\n        res.status(400).json({ success: false, error: 'No files provided' });\n        return;\n      }\n\n      const files = await this.storageService.uploadMultiple(\n        req.files,\n        req.user!.userId\n      );\n\n      res.json({ success: true, data: files });\n    } catch (error) {\n      next(error);\n    }\n  }\n\n  private async getFile(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      const file = await this.storageService.getFile(req.params.id);\n      res.json({ success: true, data: file });\n    } catch (error) {\n      next(error);\n    }\n  }\n\n  private async downloadFile(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      const { url, file } = await this.storageService.getDownloadUrl(req.params.id);\n      res.redirect(url);\n    } catch (error) {\n      next(error);\n    }\n  }\n${config.enableSignedUrls ? `\n  private async getSignedUrl(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      const url = await this.storageService.getSignedUrl(req.params.id, req.user!.userId);\n      res.json({ success: true, data: { url } });\n    } catch (error) {\n      next(error);\n    }\n  }\n` : ''}\n  private async deleteFile(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      await this.storageService.deleteFile(req.params.id, req.user!.userId);\n      res.json({ success: true, message: 'File deleted' });\n    } catch (error) {\n      next(error);\n    }\n  }\n\n  private async listFiles(req: Request, res: Response, next: NextFunction): Promise<void> {\n    try {\n      const files = await this.storageService.listUserFiles(req.user!.userId);\n      res.json({ success: true, data: files });\n    } catch (error) {\n      next(error);\n    }\n  }\n}\n`;\n  }\n\n  private generateStorageServiceFile(config: StorageServiceConfig): string {\n    return `import { ProviderService } from './provider.service';\n${config.enableImageOptimization ? \"import { ImageService } from './image.service';\" : ''}\nimport { FileRepository } from '../repositories/file.repository';\nimport { AppError } from '../middleware/error-handler';\nimport { File, UploadedFile } from '../types';\nimport * as crypto from 'crypto';\n\nexport class StorageService {\n  private providerService: ProviderService;\n${config.enableImageOptimization ? '  private imageService: ImageService;' : ''}\n  private fileRepository: FileRepository;\n\n  constructor() {\n    this.providerService = new ProviderService();\n${config.enableImageOptimization ? '    this.imageService = new ImageService();' : ''}\n    this.fileRepository = new FileRepository();\n  }\n\n  async uploadFile(file: Express.Multer.File, userId: string): Promise<File> {\n    const fileKey = this.generateFileKey(file.originalname);\n${config.enableImageOptimization ? `\n    // Optimize image if applicable\n    let buffer = file.buffer;\n    if (this.isImage(file.mimetype)) {\n      buffer = await this.imageService.optimize(buffer, file.mimetype);\n    }\n` : '    const buffer = file.buffer;'}\n    // Upload to storage provider\n    const url = await this.providerService.upload(fileKey, buffer, file.mimetype);\n\n    // Save metadata to database\n    const savedFile = await this.fileRepository.create({\n      userId,\n      key: fileKey,\n      originalName: file.originalname,\n      mimeType: file.mimetype,\n      size: file.size,\n      url,\n    });\n\n    return savedFile;\n  }\n\n  async uploadMultiple(files: Express.Multer.File[], userId: string): Promise<File[]> {\n    const uploadPromises = files.map(file => this.uploadFile(file, userId));\n    return Promise.all(uploadPromises);\n  }\n\n  async getFile(id: string): Promise<File> {\n    const file = await this.fileRepository.findById(id);\n    if (!file) {\n      throw new AppError(404, 'File not found');\n    }\n    return file;\n  }\n\n  async getDownloadUrl(id: string): Promise<{ url: string; file: File }> {\n    const file = await this.getFile(id);\n    const url = await this.providerService.getPublicUrl(file.key);\n    return { url, file };\n  }\n${config.enableSignedUrls ? `\n  async getSignedUrl(id: string, userId: string): Promise<string> {\n    const file = await this.getFile(id);\n    \n    if (file.userId !== userId) {\n      throw new AppError(403, 'Access denied');\n    }\n\n    return this.providerService.getSignedUrl(file.key, 3600); // 1 hour expiry\n  }\n` : ''}\n  async deleteFile(id: string, userId: string): Promise<void> {\n    const file = await this.getFile(id);\n    \n    if (file.userId !== userId) {\n      throw new AppError(403, 'Access denied');\n    }\n\n    await this.providerService.delete(file.key);\n    await this.fileRepository.delete(id);\n  }\n\n  async listUserFiles(userId: string): Promise<File[]> {\n    return this.fileRepository.findByUserId(userId);\n  }\n\n  private generateFileKey(originalName: string): string {\n    const timestamp = Date.now();\n    const random = crypto.randomBytes(8).toString('hex');\n    const ext = originalName.split('.').pop();\n    return \\`uploads/\\${timestamp}-\\${random}.\\${ext}\\`;\n  }\n${config.enableImageOptimization ? `\n  private isImage(mimeType: string): boolean {\n    return mimeType.startsWith('image/');\n  }\n` : ''}\n}\n`;\n  }\n\n  private generateProviderService(config: StorageServiceConfig): string {\n    const provider = config.provider || 's3';\n    \n    return `${provider === 's3' || provider === 'r2' ? \"import { S3Client, PutObjectCommand, DeleteObjectCommand, GetObjectCommand } from '@aws-sdk/client-s3';\\nimport { getSignedUrl } from '@aws-sdk/s3-request-presigner';\" : ''}\n${provider === 'local' ? \"import * as fs from 'fs/promises';\\nimport * as path from 'path';\" : ''}\n\nexport class ProviderService {\n${provider === 's3' || provider === 'r2' ? `  private s3Client: S3Client;\n  private bucket: string;\n\n  constructor() {\n    this.s3Client = new S3Client({\n      region: process.env.${provider === 'r2' ? 'R2_REGION' : 'AWS_REGION'} || 'auto',\n      endpoint: process.env.${provider === 'r2' ? 'R2_ENDPOINT' : 'S3_ENDPOINT'},\n      credentials: {\n        accessKeyId: process.env.${provider === 'r2' ? 'R2_ACCESS_KEY_ID' : 'AWS_ACCESS_KEY_ID'}!,\n        secretAccessKey: process.env.${provider === 'r2' ? 'R2_SECRET_ACCESS_KEY' : 'AWS_SECRET_ACCESS_KEY'}!,\n      },\n    });\n    this.bucket = process.env.${provider === 'r2' ? 'R2_BUCKET' : 'S3_BUCKET'}!;\n  }\n\n  async upload(key: string, buffer: Buffer, contentType: string): Promise<string> {\n    const command = new PutObjectCommand({\n      Bucket: this.bucket,\n      Key: key,\n      Body: buffer,\n      ContentType: contentType,\n    });\n\n    await this.s3Client.send(command);\n    return this.getPublicUrl(key);\n  }\n\n  async delete(key: string): Promise<void> {\n    const command = new DeleteObjectCommand({\n      Bucket: this.bucket,\n      Key: key,\n    });\n\n    await this.s3Client.send(command);\n  }\n\n  async getPublicUrl(key: string): Promise<string> {\n    const endpoint = process.env.${provider === 'r2' ? 'R2_PUBLIC_URL' : 'S3_PUBLIC_URL'};\n    return \\`\\${endpoint}/\\${key}\\`;\n  }\n\n  async getSignedUrl(key: string, expiresIn: number = 3600): Promise<string> {\n    const command = new GetObjectCommand({\n      Bucket: this.bucket,\n      Key: key,\n    });\n\n    return getSignedUrl(this.s3Client, command, { expiresIn });\n  }` : ''}${provider === 'local' ? `  private uploadDir: string;\n\n  constructor() {\n    this.uploadDir = process.env.UPLOAD_DIR || path.join(process.cwd(), 'uploads');\n  }\n\n  async upload(key: string, buffer: Buffer, contentType: string): Promise<string> {\n    const filePath = path.join(this.uploadDir, key);\n    const dir = path.dirname(filePath);\n\n    // Ensure directory exists\n    await fs.mkdir(dir, { recursive: true });\n\n    // Write file\n    await fs.writeFile(filePath, buffer);\n\n    return this.getPublicUrl(key);\n  }\n\n  async delete(key: string): Promise<void> {\n    const filePath = path.join(this.uploadDir, key);\n    await fs.unlink(filePath);\n  }\n\n  async getPublicUrl(key: string): Promise<string> {\n    const baseUrl = process.env.BASE_URL || 'http://localhost:${config.port || 3004}';\n    return \\`\\${baseUrl}/files/\\${key}\\`;\n  }\n\n  async getSignedUrl(key: string, expiresIn: number = 3600): Promise<string> {\n    // For local storage, just return the public URL\n    return this.getPublicUrl(key);\n  }` : ''}\n}\n`;\n  }\n\n  private generateImageService(): string {\n    return `import sharp from 'sharp';\n\nexport class ImageService {\n  async optimize(buffer: Buffer, mimeType: string): Promise<Buffer> {\n    const image = sharp(buffer);\n    const metadata = await image.metadata();\n\n    // Resize if too large\n    if (metadata.width && metadata.width > 2000) {\n      image.resize(2000, null, { withoutEnlargement: true });\n    }\n\n    // Convert to appropriate format and optimize\n    if (mimeType === 'image/png') {\n      return image.png({ quality: 80, compressionLevel: 9 }).toBuffer();\n    } else if (mimeType === 'image/jpeg' || mimeType === 'image/jpg') {\n      return image.jpeg({ quality: 80, progressive: true }).toBuffer();\n    } else if (mimeType === 'image/webp') {\n      return image.webp({ quality: 80 }).toBuffer();\n    }\n\n    return buffer;\n  }\n\n  async generateThumbnail(buffer: Buffer, width: number = 200): Promise<Buffer> {\n    return sharp(buffer)\n      .resize(width, null, { withoutEnlargement: true })\n      .jpeg({ quality: 70 })\n      .toBuffer();\n  }\n}\n`;\n  }\n\n  private generateFileRepository(): string {\n    return `import { PrismaClient } from '@prisma/client';\nimport { File, CreateFileInput } from '../types';\n\nconst prisma = new PrismaClient();\n\nexport class FileRepository {\n  async create(data: CreateFileInput): Promise<File> {\n    return prisma.file.create({ data });\n  }\n\n  async findById(id: string): Promise<File | null> {\n    return prisma.file.findUnique({ where: { id } });\n  }\n\n  async findByUserId(userId: string): Promise<File[]> {\n    return prisma.file.findMany({\n      where: { userId },\n      orderBy: { createdAt: 'desc' },\n    });\n  }\n\n  async delete(id: string): Promise<void> {\n    await prisma.file.delete({ where: { id } });\n  }\n}\n`;\n  }\n\n  private generateUploadMiddleware(config: StorageServiceConfig): string {\n    const maxSize = (config.maxFileSize || 10) * 1024 * 1024; // Convert MB to bytes\n    \n    return `import multer from 'multer';\nimport { AppError } from './error-handler';\n\nconst storage = multer.memoryStorage();\n\nconst fileFilter = (req: any, file: Express.Multer.File, cb: multer.FileFilterCallback) => {\n  // Add file type validation here if needed\n  cb(null, true);\n};\n\nexport const uploadMiddleware = multer({\n  storage,\n  fileFilter,\n  limits: {\n    fileSize: ${maxSize}, // ${config.maxFileSize || 10}MB\n  },\n});\n`;\n  }\n\n  private generateTypes(config: StorageServiceConfig): string {\n    return `export interface File {\n  id: string;\n  userId: string;\n  key: string;\n  originalName: string;\n  mimeType: string;\n  size: number;\n  url: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface CreateFileInput {\n  userId: string;\n  key: string;\n  originalName: string;\n  mimeType: string;\n  size: number;\n  url: string;\n}\n\nexport interface UploadedFile {\n  id: string;\n  url: string;\n  originalName: string;\n  size: number;\n  mimeType: string;\n}\n`;\n  }\n\n  private generateValidationSchemas(): string {\n    return `import { z } from 'zod';\n\nexport const StorageSchemas = {\n  upload: z.object({\n    file: z.any(),\n  }),\n};\n`;\n  }\n\n  private generatePrismaSchema(): string {\n    return `generator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"postgresql\"\n  url      = env(\"DATABASE_URL\")\n}\n\nmodel File {\n  id           String   @id @default(cuid())\n  userId       String\n  key          String   @unique\n  originalName String\n  mimeType     String\n  size         Int\n  url          String\n  createdAt    DateTime @default(now())\n  updatedAt    DateTime @updatedAt\n  \n  @@index([userId])\n  @@index([createdAt])\n  @@map(\"files\")\n}\n`;\n  }\n\n  private generatePackageJson(config: StorageServiceConfig): string {\n    const provider = config.provider || 's3';\n    const dependencies: Record<string, string> = {\n      express: '^4.18.2',\n      cors: '^2.8.5',\n      helmet: '^7.1.0',\n      zod: '^3.22.4',\n      '@prisma/client': '^5.7.1',\n      multer: '^1.4.5-lts.1',\n    };\n\n    if (provider === 's3' || provider === 'r2') {\n      dependencies['@aws-sdk/client-s3'] = '^3.470.0';\n      dependencies['@aws-sdk/s3-request-presigner'] = '^3.470.0';\n    }\n\n    if (config.enableImageOptimization) {\n      dependencies['sharp'] = '^0.33.1';\n    }\n\n    return JSON.stringify({\n      name: 'storage-service',\n      version: '1.0.0',\n      description: 'File Storage Service',\n      main: 'dist/index.js',\n      scripts: {\n        dev: 'ts-node-dev --respawn --transpile-only src/index.ts',\n        build: 'tsc',\n        start: 'node dist/index.js',\n        test: 'jest',\n        'test:watch': 'jest --watch',\n        'prisma:generate': 'prisma generate',\n        'prisma:migrate': 'prisma migrate dev',\n      },\n      dependencies,\n      devDependencies: {\n        '@types/express': '^4.17.21',\n        '@types/cors': '^2.8.17',\n        '@types/node': '^20.10.5',\n        '@types/multer': '^1.4.11',\n        typescript: '^5.3.3',\n        'ts-node-dev': '^2.0.0',\n        jest: '^29.7.0',\n        '@types/jest': '^29.5.11',\n        'ts-jest': '^29.1.1',\n        prisma: '^5.7.1',\n      },\n    }, null, 2);\n  }\n\n  private generateEnvExample(config: StorageServiceConfig): string {\n    const provider = config.provider || 's3';\n    let env = `PORT=${config.port || 3004}\\nNODE_ENV=development\\n\\nDATABASE_URL=postgresql://user:password@localhost:5432/storage_db\\n`;\n\n    if (provider === 's3') {\n      env += '\\nAWS_REGION=us-east-1\\nAWS_ACCESS_KEY_ID=your_access_key\\nAWS_SECRET_ACCESS_KEY=your_secret_key\\nS3_BUCKET=your-bucket-name\\nS3_PUBLIC_URL=https://your-bucket.s3.amazonaws.com\\n';\n    } else if (provider === 'r2') {\n      env += '\\nR2_REGION=auto\\nR2_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com\\nR2_ACCESS_KEY_ID=your_access_key\\nR2_SECRET_ACCESS_KEY=your_secret_key\\nR2_BUCKET=your-bucket-name\\nR2_PUBLIC_URL=https://your-domain.com\\n';\n    } else if (provider === 'local') {\n      env += '\\nUPLOAD_DIR=./uploads\\nBASE_URL=http://localhost:3004\\n';\n    }\n\n    return env;\n  }\n\n  private generateReadme(config: StorageServiceConfig): string {\n    const provider = config.provider || 's3';\n    return `# Storage Service\n\nFile storage service with ${provider.toUpperCase()} integration${config.enableImageOptimization ? ' and image optimization' : ''}.\n\n## Features\n\n- File upload and download\n- ${provider.toUpperCase()} storage integration\n${config.enableSignedUrls ? '- Signed URL generation\\n' : ''}${config.enableImageOptimization ? '- Automatic image optimization\\n' : ''}- File metadata tracking\n- Multi-file upload support\n\n## Installation\n\n\\`\\`\\`bash\nnpm install\n\\`\\`\\`\n\n## Database Setup\n\n\\`\\`\\`bash\nnpx prisma migrate dev\nnpx prisma generate\n\\`\\`\\`\n\n## Configuration\n\nCopy \\`.env.example\\` to \\`.env\\` and configure your ${provider.toUpperCase()} credentials.\n\n## Development\n\n\\`\\`\\`bash\nnpm run dev\n\\`\\`\\`\n\n## Production\n\n\\`\\`\\`bash\nnpm run build\nnpm start\n\\`\\`\\`\n\n## API Endpoints\n\n- \\`POST /api/storage/upload\\` - Upload single file\n- \\`POST /api/storage/upload-multiple\\` - Upload multiple files\n- \\`GET /api/storage/:id\\` - Get file metadata\n- \\`GET /api/storage/:id/download\\` - Download file\n${config.enableSignedUrls ? '- `GET /api/storage/:id/signed-url` - Get signed URL\\n' : ''}- \\`DELETE /api/storage/:id\\` - Delete file\n- \\`GET /api/storage\\` - List user files\n\n## Testing\n\n\\`\\`\\`bash\nnpm test\n\\`\\`\\`\n${config.enableImageOptimization ? `\n## Image Optimization\n\nImages are automatically optimized on upload:\n- Resized to max 2000px width\n- Compressed with quality 80\n- Converted to appropriate format\n` : ''}\n`;\n  }\n}\n"],"mappings":"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D,MAAMuB,IAAI,GAAGvB,MAAM,CAACuB,IAAI,IAAI,IAAI;IAChC,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmCA,IAAI;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQb,yBAAyBA,CAACV,MAA4B,EAAU;IACtE,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEA,MAAM,CAACwB,gBAAgB,GAAG;AAC5B;AACA;AACA,CAAC,GAAG,EAAE;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAExB,MAAM,CAACwB,gBAAgB,GAAG;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,EAAE;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQb,0BAA0BA,CAACX,MAA4B,EAAU;IACvE,OAAO;AACX,EAAEA,MAAM,CAACa,uBAAuB,GAAG,iDAAiD,GAAG,EAAE;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEb,MAAM,CAACa,uBAAuB,GAAG,uCAAuC,GAAG,EAAE;AAC/E;AACA;AACA;AACA;AACA,EAAEb,MAAM,CAACa,uBAAuB,GAAG,6CAA6C,GAAG,EAAE;AACrF;AACA;AACA;AACA;AACA;AACA,EAAEb,MAAM,CAACa,uBAAuB,GAAG;AACnC;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,iCAAiC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEb,MAAM,CAACwB,gBAAgB,GAAG;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,EAAE;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAExB,MAAM,CAACa,uBAAuB,GAAG;AACnC;AACA;AACA;AACA,CAAC,GAAG,EAAE;AACN;AACA,CAAC;EACC;EAEQD,uBAAuBA,CAACZ,MAA4B,EAAU;IACpE,MAAMyB,QAAQ,GAAGzB,MAAM,CAACyB,QAAQ,IAAI,IAAI;IAExC,OAAO,GAAGA,QAAQ,KAAK,IAAI,IAAIA,QAAQ,KAAK,IAAI,GAAG,wKAAwK,GAAG,EAAE;AACpO,EAAEA,QAAQ,KAAK,OAAO,GAAG,mEAAmE,GAAG,EAAE;AACjG;AACA;AACA,EAAEA,QAAQ,KAAK,IAAI,IAAIA,QAAQ,KAAK,IAAI,GAAG;AAC3C;AACA;AACA;AACA;AACA,4BAA4BA,QAAQ,KAAK,IAAI,GAAG,WAAW,GAAG,YAAY;AAC1E,8BAA8BA,QAAQ,KAAK,IAAI,GAAG,aAAa,GAAG,aAAa;AAC/E;AACA,mCAAmCA,QAAQ,KAAK,IAAI,GAAG,kBAAkB,GAAG,mBAAmB;AAC/F,uCAAuCA,QAAQ,KAAK,IAAI,GAAG,sBAAsB,GAAG,uBAAuB;AAC3G;AACA;AACA,gCAAgCA,QAAQ,KAAK,IAAI,GAAG,WAAW,GAAG,WAAW;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmCA,QAAQ,KAAK,IAAI,GAAG,eAAe,GAAG,eAAe;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,GAAG,EAAE,GAAGA,QAAQ,KAAK,OAAO,GAAG;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgEzB,MAAM,CAACuB,IAAI,IAAI,IAAI;AACnF;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,GAAG,EAAE;AACT;AACA,CAAC;EACC;EAEQT,oBAAoBA,CAAA,EAAW;IACrC,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQC,sBAAsBA,CAAA,EAAW;IACvC,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EACC;EAEQC,wBAAwBA,CAAChB,MAA4B,EAAU;IACrE,MAAM0B,OAAO,GAAG,CAAC1B,MAAM,CAAC2B,WAAW,IAAI,EAAE,IAAI,IAAI,GAAG,IAAI,CAAC,CAAC;;IAE1D,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgBD,OAAO,QAAQ1B,MAAM,CAAC2B,WAAW,IAAI,EAAE;AACvD;AACA;AACA,CAAC;EACC;EAEQV,aAAaA,CAACjB,MAA4B,EAAU;IAC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","ignoreList":[]}