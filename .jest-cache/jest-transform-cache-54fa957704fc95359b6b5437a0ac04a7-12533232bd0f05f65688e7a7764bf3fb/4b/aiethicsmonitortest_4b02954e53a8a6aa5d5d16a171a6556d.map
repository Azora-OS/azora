{"version":3,"names":["request","require","app","describe","afterAll","done","close","it","response","get","expect","status","toBe","body","toHaveProperty","ethicsRequest","aiDecision","context","sensitivity","impact","user","post","send","data","invalidRequest","complianceRequest","action","purpose","Array","isArray"],"sources":["ai-ethics-monitor.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst app = require('../index.js');\r\n\r\ndescribe('AI Ethics Monitor Service', () => {\r\n  // Close the server after all tests\r\n  afterAll((done) => {\r\n    app.close(done);\r\n  });\r\n\r\n  describe('GET /health', () => {\r\n    it('should return health status', async () => {\r\n      const response = await request(app).get('/health');\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('status', 'healthy');\r\n      expect(response.body).toHaveProperty('service', 'ai-ethics-monitor');\r\n    });\r\n  });\r\n\r\n  describe('POST /api/monitor', () => {\r\n    it('should perform AI ethics analysis', async () => {\r\n      const ethicsRequest = {\r\n        aiDecision: 'Recommend loan approval',\r\n        context: {\r\n          sensitivity: 'medium',\r\n          impact: 'high'\r\n        },\r\n        user: 'test-user-123'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/monitor')\r\n        .send(ethicsRequest);\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(response.body).toHaveProperty('success', true);\r\n      expect(response.body).toHaveProperty('data');\r\n      expect(response.body.data).toHaveProperty('id');\r\n      expect(response.body.data).toHaveProperty('decision', ethicsRequest.aiDecision);\r\n      expect(response.body.data).toHaveProperty('ethicalScore');\r\n      expect(response.body.data).toHaveProperty('violations');\r\n      expect(response.body.data).toHaveProperty('recommendations');\r\n    });\r\n\r\n    it('should return error for missing AI decision', async () => {\r\n      const invalidRequest = {\r\n        context: { sensitivity: 'high' }\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/monitor')\r\n        .send(invalidRequest);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body).toHaveProperty('error');\r\n    });\r\n  });\r\n\r\n  describe('POST /api/compliance', () => {\r\n    it('should check constitutional AI compliance', async () => {\r\n      const complianceRequest = {\r\n        action: 'Process personal data',\r\n        context: {\r\n          purpose: 'user profiling'\r\n        }\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/compliance')\r\n        .send(complianceRequest);\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(response.body).toHaveProperty('success', true);\r\n      expect(response.body).toHaveProperty('data');\r\n      expect(response.body.data).toHaveProperty('id');\r\n      expect(response.body.data).toHaveProperty('action', complianceRequest.action);\r\n      expect(response.body.data).toHaveProperty('compliant');\r\n      expect(response.body.data).toHaveProperty('violations');\r\n      expect(response.body.data).toHaveProperty('recommendations');\r\n    });\r\n\r\n    it('should return error for missing action', async () => {\r\n      const invalidRequest = {\r\n        context: { purpose: 'testing' }\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/compliance')\r\n        .send(invalidRequest);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body).toHaveProperty('error');\r\n    });\r\n  });\r\n\r\n  describe('GET /api/reports', () => {\r\n    it('should return all ethics reports', async () => {\r\n      const response = await request(app).get('/api/reports');\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('success', true);\r\n      expect(response.body).toHaveProperty('data');\r\n      expect(Array.isArray(response.body.data)).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/compliance-reports', () => {\r\n    it('should return all compliance reports', async () => {\r\n      const response = await request(app).get('/api/compliance-reports');\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('success', true);\r\n      expect(response.body).toHaveProperty('data');\r\n      expect(Array.isArray(response.body.data)).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('GET /api/violations', () => {\r\n    it('should return all violations', async () => {\r\n      const response = await request(app).get('/api/violations');\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('success', true);\r\n      expect(response.body).toHaveProperty('data');\r\n      expect(Array.isArray(response.body.data)).toBe(true);\r\n    });\r\n  });\r\n});"],"mappings":"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","ignoreList":[]}