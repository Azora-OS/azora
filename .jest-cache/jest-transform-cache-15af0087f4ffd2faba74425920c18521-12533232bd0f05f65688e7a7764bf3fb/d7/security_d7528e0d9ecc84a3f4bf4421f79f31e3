17e0e142915f9fb805b78d25eb871eab
/* istanbul ignore next */
function cov_xtav1166v() {
  var path = "/workspaces/azora/services/shared/middleware/security.ts";
  var hash = "894fbbab82cdc128791d6c91f74e360348577942";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/shared/middleware/security.ts",
    statementMap: {
      "0": {
        start: {
          line: 5,
          column: 26
        },
        end: {
          line: 10,
          column: 2
        }
      },
      "1": {
        start: {
          line: 12,
          column: 33
        },
        end: {
          line: 18,
          column: 2
        }
      },
      "2": {
        start: {
          line: 12,
          column: 56
        },
        end: {
          line: 18,
          column: 2
        }
      },
      "3": {
        start: {
          line: 21,
          column: 28
        },
        end: {
          line: 33,
          column: 1
        }
      },
      "4": {
        start: {
          line: 35,
          column: 28
        },
        end: {
          line: 49,
          column: 2
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 12,
            column: 33
          },
          end: {
            line: 12,
            column: 34
          }
        },
        loc: {
          start: {
            line: 12,
            column: 56
          },
          end: {
            line: 18,
            column: 2
          }
        },
        line: 12
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 6,
            column: 10
          },
          end: {
            line: 6,
            column: 60
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 6,
            column: 10
          },
          end: {
            line: 6,
            column: 33
          }
        }, {
          start: {
            line: 6,
            column: 37
          },
          end: {
            line: 6,
            column: 60
          }
        }],
        line: 6
      },
      "1": {
        loc: {
          start: {
            line: 12,
            column: 34
          },
          end: {
            line: 12,
            column: 51
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 12,
            column: 48
          },
          end: {
            line: 12,
            column: 51
          }
        }],
        line: 12
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0
    },
    f: {
      "0": 0
    },
    b: {
      "0": [0, 0],
      "1": [0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "894fbbab82cdc128791d6c91f74e360348577942"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_xtav1166v = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_xtav1166v();
import rateLimit from 'express-rate-limit';
import helmet from 'helmet';
import cors from 'cors';
export const corsConfig =
/* istanbul ignore next */
(cov_xtav1166v().s[0]++, cors({
  origin:
  /* istanbul ignore next */
  (cov_xtav1166v().b[0][0]++, process.env.CORS_ORIGIN) ||
  /* istanbul ignore next */
  (cov_xtav1166v().b[0][1]++, 'http://localhost:3000'),
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],
  allowedHeaders: ['Content-Type', 'Authorization']
}));
/* istanbul ignore next */
cov_xtav1166v().s[1]++;
export const createRateLimiter = (max =
/* istanbul ignore next */
(cov_xtav1166v().b[1][0]++, 100)) => {
  /* istanbul ignore next */
  cov_xtav1166v().f[0]++;
  cov_xtav1166v().s[2]++;
  return rateLimit({
    windowMs: 15 * 60 * 1000,
    max,
    message: 'Too many requests from this IP',
    standardHeaders: true,
    legacyHeaders: false
  });
};

// Pre-configured rate limiters for different service types
export const rateLimiters =
/* istanbul ignore next */
(cov_xtav1166v().s[3]++, {
  // General API - 100 requests per 15 minutes
  general: createRateLimiter(100),
  // Financial operations - 50 requests per 15 minutes (stricter)
  financial: createRateLimiter(50),
  // Auth operations - 30 requests per 15 minutes (very strict)
  auth: createRateLimiter(30),
  // Public endpoints - 200 requests per 15 minutes (lenient)
  public: createRateLimiter(200)
});
export const helmetConfig =
/* istanbul ignore next */
(cov_xtav1166v().s[4]++, helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      scriptSrc: ["'self'"],
      imgSrc: ["'self'", "data:", "https:"]
    }
  },
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  }
}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfeHRhdjExNjZ2IiwiYWN0dWFsQ292ZXJhZ2UiLCJyYXRlTGltaXQiLCJoZWxtZXQiLCJjb3JzIiwiY29yc0NvbmZpZyIsInMiLCJvcmlnaW4iLCJiIiwicHJvY2VzcyIsImVudiIsIkNPUlNfT1JJR0lOIiwiY3JlZGVudGlhbHMiLCJtZXRob2RzIiwiYWxsb3dlZEhlYWRlcnMiLCJjcmVhdGVSYXRlTGltaXRlciIsIm1heCIsImYiLCJ3aW5kb3dNcyIsIm1lc3NhZ2UiLCJzdGFuZGFyZEhlYWRlcnMiLCJsZWdhY3lIZWFkZXJzIiwicmF0ZUxpbWl0ZXJzIiwiZ2VuZXJhbCIsImZpbmFuY2lhbCIsImF1dGgiLCJwdWJsaWMiLCJoZWxtZXRDb25maWciLCJjb250ZW50U2VjdXJpdHlQb2xpY3kiLCJkaXJlY3RpdmVzIiwiZGVmYXVsdFNyYyIsInN0eWxlU3JjIiwic2NyaXB0U3JjIiwiaW1nU3JjIiwiaHN0cyIsIm1heEFnZSIsImluY2x1ZGVTdWJEb21haW5zIiwicHJlbG9hZCJdLCJzb3VyY2VzIjpbInNlY3VyaXR5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCByYXRlTGltaXQgZnJvbSAnZXhwcmVzcy1yYXRlLWxpbWl0JztcbmltcG9ydCBoZWxtZXQgZnJvbSAnaGVsbWV0JztcbmltcG9ydCBjb3JzIGZyb20gJ2NvcnMnO1xuXG5leHBvcnQgY29uc3QgY29yc0NvbmZpZyA9IGNvcnMoe1xuICBvcmlnaW46IHByb2Nlc3MuZW52LkNPUlNfT1JJR0lOIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnLFxuICBjcmVkZW50aWFsczogdHJ1ZSxcbiAgbWV0aG9kczogWydHRVQnLCAnUE9TVCcsICdQVVQnLCAnREVMRVRFJywgJ1BBVENIJ10sXG4gIGFsbG93ZWRIZWFkZXJzOiBbJ0NvbnRlbnQtVHlwZScsICdBdXRob3JpemF0aW9uJ11cbn0pO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlUmF0ZUxpbWl0ZXIgPSAobWF4OiBudW1iZXIgPSAxMDApID0+IHJhdGVMaW1pdCh7XG4gIHdpbmRvd01zOiAxNSAqIDYwICogMTAwMCxcbiAgbWF4LFxuICBtZXNzYWdlOiAnVG9vIG1hbnkgcmVxdWVzdHMgZnJvbSB0aGlzIElQJyxcbiAgc3RhbmRhcmRIZWFkZXJzOiB0cnVlLFxuICBsZWdhY3lIZWFkZXJzOiBmYWxzZSxcbn0pO1xuXG4vLyBQcmUtY29uZmlndXJlZCByYXRlIGxpbWl0ZXJzIGZvciBkaWZmZXJlbnQgc2VydmljZSB0eXBlc1xuZXhwb3J0IGNvbnN0IHJhdGVMaW1pdGVycyA9IHtcbiAgLy8gR2VuZXJhbCBBUEkgLSAxMDAgcmVxdWVzdHMgcGVyIDE1IG1pbnV0ZXNcbiAgZ2VuZXJhbDogY3JlYXRlUmF0ZUxpbWl0ZXIoMTAwKSxcbiAgXG4gIC8vIEZpbmFuY2lhbCBvcGVyYXRpb25zIC0gNTAgcmVxdWVzdHMgcGVyIDE1IG1pbnV0ZXMgKHN0cmljdGVyKVxuICBmaW5hbmNpYWw6IGNyZWF0ZVJhdGVMaW1pdGVyKDUwKSxcbiAgXG4gIC8vIEF1dGggb3BlcmF0aW9ucyAtIDMwIHJlcXVlc3RzIHBlciAxNSBtaW51dGVzICh2ZXJ5IHN0cmljdClcbiAgYXV0aDogY3JlYXRlUmF0ZUxpbWl0ZXIoMzApLFxuICBcbiAgLy8gUHVibGljIGVuZHBvaW50cyAtIDIwMCByZXF1ZXN0cyBwZXIgMTUgbWludXRlcyAobGVuaWVudClcbiAgcHVibGljOiBjcmVhdGVSYXRlTGltaXRlcigyMDApLFxufTtcblxuZXhwb3J0IGNvbnN0IGhlbG1ldENvbmZpZyA9IGhlbG1ldCh7XG4gIGNvbnRlbnRTZWN1cml0eVBvbGljeToge1xuICAgIGRpcmVjdGl2ZXM6IHtcbiAgICAgIGRlZmF1bHRTcmM6IFtcIidzZWxmJ1wiXSxcbiAgICAgIHN0eWxlU3JjOiBbXCInc2VsZidcIiwgXCIndW5zYWZlLWlubGluZSdcIl0sXG4gICAgICBzY3JpcHRTcmM6IFtcIidzZWxmJ1wiXSxcbiAgICAgIGltZ1NyYzogW1wiJ3NlbGYnXCIsIFwiZGF0YTpcIiwgXCJodHRwczpcIl0sXG4gICAgfSxcbiAgfSxcbiAgaHN0czoge1xuICAgIG1heEFnZTogMzE1MzYwMDAsXG4gICAgaW5jbHVkZVN1YkRvbWFpbnM6IHRydWUsXG4gICAgcHJlbG9hZDogdHJ1ZVxuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBZVk7SUFBQUEsYUFBQSxZQUFBQSxDQUFBO01BQUEsT0FBQUMsY0FBQTtJQUFBO0VBQUE7RUFBQSxPQUFBQSxjQUFBO0FBQUE7QUFBQUQsYUFBQTtBQWZaLE9BQU9FLFNBQVMsTUFBTSxvQkFBb0I7QUFDMUMsT0FBT0MsTUFBTSxNQUFNLFFBQVE7QUFDM0IsT0FBT0MsSUFBSSxNQUFNLE1BQU07QUFFdkIsT0FBTyxNQUFNQyxVQUFVO0FBQUE7QUFBQSxDQUFBTCxhQUFBLEdBQUFNLENBQUEsT0FBR0YsSUFBSSxDQUFDO0VBQzdCRyxNQUFNO0VBQUU7RUFBQSxDQUFBUCxhQUFBLEdBQUFRLENBQUEsVUFBQUMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFdBQVc7RUFBQTtFQUFBLENBQUFYLGFBQUEsR0FBQVEsQ0FBQSxVQUFJLHVCQUF1QjtFQUMxREksV0FBVyxFQUFFLElBQUk7RUFDakJDLE9BQU8sRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUM7RUFDbERDLGNBQWMsRUFBRSxDQUFDLGNBQWMsRUFBRSxlQUFlO0FBQ2xELENBQUMsQ0FBQztBQUFDO0FBQUFkLGFBQUEsR0FBQU0sQ0FBQTtBQUVILE9BQU8sTUFBTVMsaUJBQWlCLEdBQUdBLENBQUNDLEdBQVc7QUFBQTtBQUFBLENBQUFoQixhQUFBLEdBQUFRLENBQUEsVUFBRyxHQUFHLE1BQUs7RUFBQTtFQUFBUixhQUFBLEdBQUFpQixDQUFBO0VBQUFqQixhQUFBLEdBQUFNLENBQUE7RUFBQSxPQUFBSixTQUFTLENBQUM7SUFDaEVnQixRQUFRLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJO0lBQ3hCRixHQUFHO0lBQ0hHLE9BQU8sRUFBRSxnQ0FBZ0M7SUFDekNDLGVBQWUsRUFBRSxJQUFJO0lBQ3JCQyxhQUFhLEVBQUU7RUFDakIsQ0FBQyxDQUFDO0FBQUQsQ0FBQzs7QUFFRjtBQUNBLE9BQU8sTUFBTUMsWUFBWTtBQUFBO0FBQUEsQ0FBQXRCLGFBQUEsR0FBQU0sQ0FBQSxPQUFHO0VBQzFCO0VBQ0FpQixPQUFPLEVBQUVSLGlCQUFpQixDQUFDLEdBQUcsQ0FBQztFQUUvQjtFQUNBUyxTQUFTLEVBQUVULGlCQUFpQixDQUFDLEVBQUUsQ0FBQztFQUVoQztFQUNBVSxJQUFJLEVBQUVWLGlCQUFpQixDQUFDLEVBQUUsQ0FBQztFQUUzQjtFQUNBVyxNQUFNLEVBQUVYLGlCQUFpQixDQUFDLEdBQUc7QUFDL0IsQ0FBQztBQUVELE9BQU8sTUFBTVksWUFBWTtBQUFBO0FBQUEsQ0FBQTNCLGFBQUEsR0FBQU0sQ0FBQSxPQUFHSCxNQUFNLENBQUM7RUFDakN5QixxQkFBcUIsRUFBRTtJQUNyQkMsVUFBVSxFQUFFO01BQ1ZDLFVBQVUsRUFBRSxDQUFDLFFBQVEsQ0FBQztNQUN0QkMsUUFBUSxFQUFFLENBQUMsUUFBUSxFQUFFLGlCQUFpQixDQUFDO01BQ3ZDQyxTQUFTLEVBQUUsQ0FBQyxRQUFRLENBQUM7TUFDckJDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsUUFBUTtJQUN0QztFQUNGLENBQUM7RUFDREMsSUFBSSxFQUFFO0lBQ0pDLE1BQU0sRUFBRSxRQUFRO0lBQ2hCQyxpQkFBaUIsRUFBRSxJQUFJO0lBQ3ZCQyxPQUFPLEVBQUU7RUFDWDtBQUNGLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==