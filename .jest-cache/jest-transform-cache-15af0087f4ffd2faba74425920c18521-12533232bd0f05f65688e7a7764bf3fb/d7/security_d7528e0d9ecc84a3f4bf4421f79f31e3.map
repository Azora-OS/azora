{"version":3,"names":["cov_xtav1166v","actualCoverage","rateLimit","helmet","cors","corsConfig","s","origin","b","process","env","CORS_ORIGIN","credentials","methods","allowedHeaders","createRateLimiter","max","f","windowMs","message","standardHeaders","legacyHeaders","rateLimiters","general","financial","auth","public","helmetConfig","contentSecurityPolicy","directives","defaultSrc","styleSrc","scriptSrc","imgSrc","hsts","maxAge","includeSubDomains","preload"],"sources":["security.ts"],"sourcesContent":["import rateLimit from 'express-rate-limit';\nimport helmet from 'helmet';\nimport cors from 'cors';\n\nexport const corsConfig = cors({\n  origin: process.env.CORS_ORIGIN || 'http://localhost:3000',\n  credentials: true,\n  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n  allowedHeaders: ['Content-Type', 'Authorization']\n});\n\nexport const createRateLimiter = (max: number = 100) => rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max,\n  message: 'Too many requests from this IP',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\n// Pre-configured rate limiters for different service types\nexport const rateLimiters = {\n  // General API - 100 requests per 15 minutes\n  general: createRateLimiter(100),\n  \n  // Financial operations - 50 requests per 15 minutes (stricter)\n  financial: createRateLimiter(50),\n  \n  // Auth operations - 30 requests per 15 minutes (very strict)\n  auth: createRateLimiter(30),\n  \n  // Public endpoints - 200 requests per 15 minutes (lenient)\n  public: createRateLimiter(200),\n};\n\nexport const helmetConfig = helmet({\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [\"'self'\"],\n      styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n      scriptSrc: [\"'self'\"],\n      imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    },\n  },\n  hsts: {\n    maxAge: 31536000,\n    includeSubDomains: true,\n    preload: true\n  }\n});\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAfZ,OAAOE,SAAS,MAAM,oBAAoB;AAC1C,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,IAAI,MAAM,MAAM;AAEvB,OAAO,MAAMC,UAAU;AAAA;AAAA,CAAAL,aAAA,GAAAM,CAAA,OAAGF,IAAI,CAAC;EAC7BG,MAAM;EAAE;EAAA,CAAAP,aAAA,GAAAQ,CAAA,UAAAC,OAAO,CAACC,GAAG,CAACC,WAAW;EAAA;EAAA,CAAAX,aAAA,GAAAQ,CAAA,UAAI,uBAAuB;EAC1DI,WAAW,EAAE,IAAI;EACjBC,OAAO,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,CAAC;EAClDC,cAAc,EAAE,CAAC,cAAc,EAAE,eAAe;AAClD,CAAC,CAAC;AAAC;AAAAd,aAAA,GAAAM,CAAA;AAEH,OAAO,MAAMS,iBAAiB,GAAGA,CAACC,GAAW;AAAA;AAAA,CAAAhB,aAAA,GAAAQ,CAAA,UAAG,GAAG,MAAK;EAAA;EAAAR,aAAA,GAAAiB,CAAA;EAAAjB,aAAA,GAAAM,CAAA;EAAA,OAAAJ,SAAS,CAAC;IAChEgB,QAAQ,EAAE,EAAE,GAAG,EAAE,GAAG,IAAI;IACxBF,GAAG;IACHG,OAAO,EAAE,gCAAgC;IACzCC,eAAe,EAAE,IAAI;IACrBC,aAAa,EAAE;EACjB,CAAC,CAAC;AAAD,CAAC;;AAEF;AACA,OAAO,MAAMC,YAAY;AAAA;AAAA,CAAAtB,aAAA,GAAAM,CAAA,OAAG;EAC1B;EACAiB,OAAO,EAAER,iBAAiB,CAAC,GAAG,CAAC;EAE/B;EACAS,SAAS,EAAET,iBAAiB,CAAC,EAAE,CAAC;EAEhC;EACAU,IAAI,EAAEV,iBAAiB,CAAC,EAAE,CAAC;EAE3B;EACAW,MAAM,EAAEX,iBAAiB,CAAC,GAAG;AAC/B,CAAC;AAED,OAAO,MAAMY,YAAY;AAAA;AAAA,CAAA3B,aAAA,GAAAM,CAAA,OAAGH,MAAM,CAAC;EACjCyB,qBAAqB,EAAE;IACrBC,UAAU,EAAE;MACVC,UAAU,EAAE,CAAC,QAAQ,CAAC;MACtBC,QAAQ,EAAE,CAAC,QAAQ,EAAE,iBAAiB,CAAC;MACvCC,SAAS,EAAE,CAAC,QAAQ,CAAC;MACrBC,MAAM,EAAE,CAAC,QAAQ,EAAE,OAAO,EAAE,QAAQ;IACtC;EACF,CAAC;EACDC,IAAI,EAAE;IACJC,MAAM,EAAE,QAAQ;IAChBC,iBAAiB,EAAE,IAAI;IACvBC,OAAO,EAAE;EACX;AACF,CAAC,CAAC","ignoreList":[]}