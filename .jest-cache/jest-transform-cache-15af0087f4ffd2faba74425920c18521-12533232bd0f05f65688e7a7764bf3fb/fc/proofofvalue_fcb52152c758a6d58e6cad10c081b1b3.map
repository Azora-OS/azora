{"version":3,"names":["cov_2kuzrz4n1w","actualCoverage","ValueCalculator","crypto","ProofOfValue","constructor","baseReward","b","f","s","valueCalculator","difficultyAdjustment","mine","contribution","console","log","type","userId","valueScore","updateUserScore","contributionValue","calculateContributionValue","attributionBonus","calculateAttributionBonus","reward","calculateReward","miningReward","amount","difficulty","timestamp","Date","toISOString","transactionId","randomUUID","mintTokens","metadata","attributedCreators","count","length","Math","min","fetch","method","headers","body","JSON","stringify","from","to","currency","data","proofOfValue","error","adjustDifficulty","networkHashRate","getStats","leaderboard","getLeaderboard","getUserScore"],"sources":["proof-of-value.ts"],"sourcesContent":["import { ValueCalculator, ValueContribution, ValueScore } from './value-calculator';\nimport crypto from 'crypto';\n\nexport interface MiningReward {\n    userId: string;\n    amount: number;\n    valueScore: number;\n    difficulty: number;\n    attributionBonus: number;\n    timestamp: string;\n    transactionId: string;\n}\n\nexport class ProofOfValue {\n    private valueCalculator: ValueCalculator;\n    private baseReward: number;\n    private difficultyAdjustment: number;\n\n    constructor(baseReward: number = 10) {\n        this.valueCalculator = new ValueCalculator();\n        this.baseReward = baseReward;\n        this.difficultyAdjustment = 1.0;\n    }\n\n    /**\n     * Mine AZR tokens based on value contribution\n     */\n    async mine(contribution: ValueContribution): Promise<MiningReward> {\n        console.log(`⛏️ PoV Mining: ${contribution.type} by ${contribution.userId}`);\n\n        // Calculate value score\n        const valueScore = this.valueCalculator.updateUserScore(contribution);\n\n        // Calculate reward\n        const contributionValue = this.valueCalculator.calculateContributionValue(contribution);\n        const attributionBonus = this.calculateAttributionBonus(contribution);\n\n        const reward = this.calculateReward(\n            contributionValue,\n            this.difficultyAdjustment,\n            attributionBonus\n        );\n\n        // Create mining reward\n        const miningReward: MiningReward = {\n            userId: contribution.userId,\n            amount: reward,\n            valueScore: contributionValue,\n            difficulty: this.difficultyAdjustment,\n            attributionBonus,\n            timestamp: new Date().toISOString(),\n            transactionId: `pov-${crypto.randomUUID()}`\n        };\n\n        // Mint tokens (integrate with blockchain)\n        await this.mintTokens(miningReward);\n\n        console.log(`✅ Mined ${reward} AZR for ${contribution.userId}`);\n\n        return miningReward;\n    }\n\n    /**\n     * Calculate mining reward\n     */\n    private calculateReward(\n        valueScore: number,\n        difficulty: number,\n        attributionBonus: number\n    ): number {\n        return this.baseReward * (valueScore / 100) * difficulty * (1 + attributionBonus);\n    }\n\n    /**\n     * Calculate attribution bonus\n     */\n    private calculateAttributionBonus(contribution: ValueContribution): number {\n        // Bonus for properly attributing others\n        if (contribution.metadata.attributedCreators) {\n            const count = contribution.metadata.attributedCreators.length;\n            return Math.min(0.5, count * 0.1); // Max 50% bonus, 10% per attribution\n        }\n        return 0;\n    }\n\n    /**\n     * Mint tokens to user's wallet\n     */\n    private async mintTokens(reward: MiningReward): Promise<void> {\n        try {\n            // Integrate with blockchain\n            await fetch('http://localhost:3011/api/blockchain/transaction', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    from: 'ubo-fund', // Ubuntu fund mints new tokens\n                    to: reward.userId,\n                    amount: reward.amount,\n                    currency: 'AZR',\n                    type: 'Mining',\n                    data: {\n                        proofOfValue: true,\n                        valueScore: reward.valueScore,\n                        difficulty: reward.difficulty,\n                        attributionBonus: reward.attributionBonus\n                    }\n                })\n            });\n        } catch (error) {\n            console.error('Failed to mint tokens:', error);\n            throw error;\n        }\n    }\n\n    /**\n     * Adjust difficulty based on network activity\n     */\n    adjustDifficulty(networkHashRate: number): void {\n        // Increase difficulty if too many tokens being mined\n        if (networkHashRate > 1000) {\n            this.difficultyAdjustment *= 1.1;\n        } else if (networkHashRate < 100) {\n            this.difficultyAdjustment *= 0.9;\n        }\n\n        console.log(`⚙️ Difficulty adjusted to ${this.difficultyAdjustment}`);\n    }\n\n    /**\n     * Get mining statistics\n     */\n    getStats() {\n        return {\n            baseReward: this.baseReward,\n            difficulty: this.difficultyAdjustment,\n            leaderboard: this.valueCalculator.getLeaderboard(10)\n        };\n    }\n\n    /**\n     * Get user's value score\n     */\n    getUserScore(userId: string): ValueScore | undefined {\n        return this.valueCalculator.getUserScore(userId);\n    }\n}\n\nexport default ProofOfValue;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ,SAASE,eAAe,QAAuC,oBAAoB;AACnF,OAAOC,MAAM,MAAM,QAAQ;AAY3B,OAAO,MAAMC,YAAY,CAAC;EAKtBC,WAAWA,CAACC,UAAkB;EAAA;EAAA,CAAAN,cAAA,GAAAO,CAAA,UAAG,EAAE,GAAE;IAAA;IAAAP,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IACjC,IAAI,CAACC,eAAe,GAAG,IAAIR,eAAe,CAAC,CAAC;IAAC;IAAAF,cAAA,GAAAS,CAAA;IAC7C,IAAI,CAACH,UAAU,GAAGA,UAAU;IAAC;IAAAN,cAAA,GAAAS,CAAA;IAC7B,IAAI,CAACE,oBAAoB,GAAG,GAAG;EACnC;;EAEA;AACJ;AACA;EACI,MAAMC,IAAIA,CAACC,YAA+B,EAAyB;IAAA;IAAAb,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IAC/DK,OAAO,CAACC,GAAG,CAAC,kBAAkBF,YAAY,CAACG,IAAI,OAAOH,YAAY,CAACI,MAAM,EAAE,CAAC;;IAE5E;IACA,MAAMC,UAAU;IAAA;IAAA,CAAAlB,cAAA,GAAAS,CAAA,OAAG,IAAI,CAACC,eAAe,CAACS,eAAe,CAACN,YAAY,CAAC;;IAErE;IACA,MAAMO,iBAAiB;IAAA;IAAA,CAAApB,cAAA,GAAAS,CAAA,OAAG,IAAI,CAACC,eAAe,CAACW,0BAA0B,CAACR,YAAY,CAAC;IACvF,MAAMS,gBAAgB;IAAA;IAAA,CAAAtB,cAAA,GAAAS,CAAA,OAAG,IAAI,CAACc,yBAAyB,CAACV,YAAY,CAAC;IAErE,MAAMW,MAAM;IAAA;IAAA,CAAAxB,cAAA,GAAAS,CAAA,OAAG,IAAI,CAACgB,eAAe,CAC/BL,iBAAiB,EACjB,IAAI,CAACT,oBAAoB,EACzBW,gBACJ,CAAC;;IAED;IACA,MAAMI,YAA0B;IAAA;IAAA,CAAA1B,cAAA,GAAAS,CAAA,OAAG;MAC/BQ,MAAM,EAAEJ,YAAY,CAACI,MAAM;MAC3BU,MAAM,EAAEH,MAAM;MACdN,UAAU,EAAEE,iBAAiB;MAC7BQ,UAAU,EAAE,IAAI,CAACjB,oBAAoB;MACrCW,gBAAgB;MAChBO,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MACnCC,aAAa,EAAE,OAAO7B,MAAM,CAAC8B,UAAU,CAAC,CAAC;IAC7C,CAAC;;IAED;IAAA;IAAAjC,cAAA,GAAAS,CAAA;IACA,MAAM,IAAI,CAACyB,UAAU,CAACR,YAAY,CAAC;IAAC;IAAA1B,cAAA,GAAAS,CAAA;IAEpCK,OAAO,CAACC,GAAG,CAAC,WAAWS,MAAM,YAAYX,YAAY,CAACI,MAAM,EAAE,CAAC;IAAC;IAAAjB,cAAA,GAAAS,CAAA;IAEhE,OAAOiB,YAAY;EACvB;;EAEA;AACJ;AACA;EACYD,eAAeA,CACnBP,UAAkB,EAClBU,UAAkB,EAClBN,gBAAwB,EAClB;IAAA;IAAAtB,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IACN,OAAO,IAAI,CAACH,UAAU,IAAIY,UAAU,GAAG,GAAG,CAAC,GAAGU,UAAU,IAAI,CAAC,GAAGN,gBAAgB,CAAC;EACrF;;EAEA;AACJ;AACA;EACYC,yBAAyBA,CAACV,YAA+B,EAAU;IAAA;IAAAb,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IACvE;IACA,IAAII,YAAY,CAACsB,QAAQ,CAACC,kBAAkB,EAAE;MAAA;MAAApC,cAAA,GAAAO,CAAA;MAC1C,MAAM8B,KAAK;MAAA;MAAA,CAAArC,cAAA,GAAAS,CAAA,QAAGI,YAAY,CAACsB,QAAQ,CAACC,kBAAkB,CAACE,MAAM;MAAC;MAAAtC,cAAA,GAAAS,CAAA;MAC9D,OAAO8B,IAAI,CAACC,GAAG,CAAC,GAAG,EAAEH,KAAK,GAAG,GAAG,CAAC,CAAC,CAAC;IACvC,CAAC;IAAA;IAAA;MAAArC,cAAA,GAAAO,CAAA;IAAA;IAAAP,cAAA,GAAAS,CAAA;IACD,OAAO,CAAC;EACZ;;EAEA;AACJ;AACA;EACI,MAAcyB,UAAUA,CAACV,MAAoB,EAAiB;IAAA;IAAAxB,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IAC1D,IAAI;MAAA;MAAAT,cAAA,GAAAS,CAAA;MACA;MACA,MAAMgC,KAAK,CAAC,kDAAkD,EAAE;QAC5DC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACjBC,IAAI,EAAE,UAAU;UAAE;UAClBC,EAAE,EAAExB,MAAM,CAACP,MAAM;UACjBU,MAAM,EAAEH,MAAM,CAACG,MAAM;UACrBsB,QAAQ,EAAE,KAAK;UACfjC,IAAI,EAAE,QAAQ;UACdkC,IAAI,EAAE;YACFC,YAAY,EAAE,IAAI;YAClBjC,UAAU,EAAEM,MAAM,CAACN,UAAU;YAC7BU,UAAU,EAAEJ,MAAM,CAACI,UAAU;YAC7BN,gBAAgB,EAAEE,MAAM,CAACF;UAC7B;QACJ,CAAC;MACL,CAAC,CAAC;IACN,CAAC,CAAC,OAAO8B,KAAK,EAAE;MAAA;MAAApD,cAAA,GAAAS,CAAA;MACZK,OAAO,CAACsC,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAAC;MAAApD,cAAA,GAAAS,CAAA;MAC/C,MAAM2C,KAAK;IACf;EACJ;;EAEA;AACJ;AACA;EACIC,gBAAgBA,CAACC,eAAuB,EAAQ;IAAA;IAAAtD,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IAC5C;IACA,IAAI6C,eAAe,GAAG,IAAI,EAAE;MAAA;MAAAtD,cAAA,GAAAO,CAAA;MAAAP,cAAA,GAAAS,CAAA;MACxB,IAAI,CAACE,oBAAoB,IAAI,GAAG;IACpC,CAAC,MAAM;MAAA;MAAAX,cAAA,GAAAO,CAAA;MAAAP,cAAA,GAAAS,CAAA;MAAA,IAAI6C,eAAe,GAAG,GAAG,EAAE;QAAA;QAAAtD,cAAA,GAAAO,CAAA;QAAAP,cAAA,GAAAS,CAAA;QAC9B,IAAI,CAACE,oBAAoB,IAAI,GAAG;MACpC,CAAC;MAAA;MAAA;QAAAX,cAAA,GAAAO,CAAA;MAAA;IAAD;IAAC;IAAAP,cAAA,GAAAS,CAAA;IAEDK,OAAO,CAACC,GAAG,CAAC,6BAA6B,IAAI,CAACJ,oBAAoB,EAAE,CAAC;EACzE;;EAEA;AACJ;AACA;EACI4C,QAAQA,CAAA,EAAG;IAAA;IAAAvD,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IACP,OAAO;MACHH,UAAU,EAAE,IAAI,CAACA,UAAU;MAC3BsB,UAAU,EAAE,IAAI,CAACjB,oBAAoB;MACrC6C,WAAW,EAAE,IAAI,CAAC9C,eAAe,CAAC+C,cAAc,CAAC,EAAE;IACvD,CAAC;EACL;;EAEA;AACJ;AACA;EACIC,YAAYA,CAACzC,MAAc,EAA0B;IAAA;IAAAjB,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IACjD,OAAO,IAAI,CAACC,eAAe,CAACgD,YAAY,CAACzC,MAAM,CAAC;EACpD;AACJ;AAEA,eAAeb,YAAY","ignoreList":[]}