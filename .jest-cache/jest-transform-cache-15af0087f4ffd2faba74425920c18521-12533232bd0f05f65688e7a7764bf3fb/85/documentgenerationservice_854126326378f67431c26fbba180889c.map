{"version":3,"names":["cov_vdz701lht","actualCoverage","AppError","legalService","PDFDocument","s","pdfkitLoaded","loadPDFKit","f","b","pdfkit","default","error","console","warn","generatedDocuments","Map","documentVersions","documentStorage","DocumentGenerationService","generateDocument","businessId","data","userId","getTemplateById","templateId","validation","validateTemplatePlaceholders","valid","missingFields","join","document","set","id","has","get","push","generatePDF","documentId","getDocumentById","Promise","resolve","reject","PDFKit","fallbackPDF","createFallbackPDF","pdfDoc","size","margin","chunks","on","chunk","pdfBuffer","Buffer","concat","addContentToPDF","end","generateStyledDocument","styling","content","applyStyleToContent","generateBatchDocuments","documents","results","doc","generated","getGeneratedDocument","updateGeneratedDocument","updates","updateDocument","exportAsText","exportAsJSON","templateVersion","status","signedAt","signerId","createdAt","updatedAt","getGenerationHistory","docs","Array","from","values","filter","d","map","generatedAt","getDocumentVersions","versions","v","index","version","restoreDocumentVersion","versionNumber","length","targetVersion","updated","storePDF","retrievePDF","pdf","validateDocumentData","errors","warnings","Object","entries","forEach","key","value","trim","getGenerationStats","byStatus","byTemplate","totalGenerated","pdfContent","toLocaleDateString","substring","fontSize","font","text","align","moveDown","width","styledContent","headerText","footerText","documentGenerationService"],"sources":["document-generation.service.ts"],"sourcesContent":["import { generateUUID } from '../utils/uuid.js';\nimport { LegalDocument, LegalDocumentRequest } from '../types/index.js';\nimport { AppError } from '../middleware/errorHandler.js';\nimport { legalService } from './legal.service.js';\n\n// Lazy load pdfkit to avoid import errors if not installed\nlet PDFDocument: any = null;\nlet pdfkitLoaded = false;\n\nconst loadPDFKit = async () => {\n  if (!pdfkitLoaded) {\n    try {\n      // @ts-ignore - dynamic import\n      const pdfkit = await import('pdfkit');\n      PDFDocument = pdfkit.default || pdfkit;\n      pdfkitLoaded = true;\n    } catch (error) {\n      console.warn('pdfkit not available, PDF generation will use fallback');\n      pdfkitLoaded = true;\n    }\n  }\n  return PDFDocument;\n};\n\n// Mock storage for generated documents and versions\nconst generatedDocuments: Map<string, LegalDocument> = new Map();\nconst documentVersions: Map<string, LegalDocument[]> = new Map();\nconst documentStorage: Map<string, Buffer> = new Map();\n\nexport class DocumentGenerationService {\n  /**\n   * Generate document from template with data population\n   * Requirements: 3.2, 3.3\n   */\n  async generateDocument(\n    businessId: string,\n    data: LegalDocumentRequest,\n    userId: string\n  ): Promise<LegalDocument> {\n    // Validate template exists\n    await legalService.getTemplateById(data.templateId);\n\n    // Validate all required placeholders are provided\n    const validation = await legalService.validateTemplatePlaceholders(data.templateId, data.data);\n    if (!validation.valid) {\n      throw new AppError(400, `Missing required fields: ${validation.missingFields.join(', ')}`);\n    }\n\n    // Generate document using legal service\n    const document = await legalService.generateDocument(businessId, data, userId);\n\n    // Store generated document\n    generatedDocuments.set(document.id, document);\n\n    // Initialize version history\n    if (!documentVersions.has(document.id)) {\n      documentVersions.set(document.id, []);\n    }\n    documentVersions.get(document.id)!.push({ ...document });\n\n    return document;\n  }\n\n  /**\n   * Generate PDF from document content\n   * Requirements: 3.2, 3.3\n   */\n  async generatePDF(documentId: string, userId: string): Promise<Buffer> {\n    const document = await legalService.getDocumentById(documentId, userId);\n\n    return new Promise(async (resolve, reject) => {\n      try {\n        const PDFKit = await loadPDFKit();\n\n        if (!PDFKit) {\n          // Fallback: return simple text-based PDF representation\n          const fallbackPDF = this.createFallbackPDF(document);\n          documentStorage.set(documentId, fallbackPDF);\n          resolve(fallbackPDF);\n          return;\n        }\n\n        const pdfDoc = new PDFKit({\n          size: 'A4',\n          margin: 50,\n        });\n\n        const chunks: Buffer[] = [];\n\n        pdfDoc.on('data', (chunk: Buffer) => {\n          chunks.push(chunk);\n        });\n\n        pdfDoc.on('end', () => {\n          const pdfBuffer = Buffer.concat(chunks);\n          // Store PDF in memory storage\n          documentStorage.set(documentId, pdfBuffer);\n          resolve(pdfBuffer);\n        });\n\n        pdfDoc.on('error', (error: Error) => {\n          reject(error);\n        });\n\n        // Add content to PDF\n        this.addContentToPDF(pdfDoc, document);\n\n        pdfDoc.end();\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Generate document with custom styling\n   * Requirements: 3.2, 3.3\n   */\n  async generateStyledDocument(\n    businessId: string,\n    data: LegalDocumentRequest,\n    styling?: {\n      fontSize?: number;\n      fontFamily?: string;\n      margins?: { top: number; bottom: number; left: number; right: number };\n      headerText?: string;\n      footerText?: string;\n    }\n  ): Promise<LegalDocument> {\n    const document = await this.generateDocument(businessId, data, '');\n\n    // Apply styling (would be used in PDF generation)\n    if (styling) {\n      document.content = this.applyStyleToContent(document.content, styling);\n      generatedDocuments.set(document.id, document);\n    }\n\n    return document;\n  }\n\n  /**\n   * Generate batch documents\n   * Requirements: 3.2, 3.3\n   */\n  async generateBatchDocuments(\n    businessId: string,\n    documents: Array<{\n      templateId: string;\n      data: Record<string, any>;\n    }>,\n    userId: string\n  ): Promise<LegalDocument[]> {\n    const results: LegalDocument[] = [];\n\n    for (const doc of documents) {\n      try {\n        const generated = await this.generateDocument(\n          businessId,\n          {\n            templateId: doc.templateId,\n            data: doc.data,\n          },\n          userId\n        );\n        results.push(generated);\n      } catch (error) {\n        console.error(`Failed to generate document from template ${doc.templateId}:`, error);\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * Get generated document\n   * Requirements: 3.2, 3.3\n   */\n  async getGeneratedDocument(documentId: string, userId: string): Promise<LegalDocument> {\n    return legalService.getDocumentById(documentId, userId);\n  }\n\n  /**\n   * Update generated document\n   * Requirements: 3.2, 3.3\n   */\n  async updateGeneratedDocument(\n    documentId: string,\n    userId: string,\n    updates: {\n      content?: string;\n      status?: 'draft' | 'signed' | 'archived';\n    }\n  ): Promise<LegalDocument> {\n    const document = await legalService.getDocumentById(documentId, userId);\n\n    // Store current version before update\n    if (documentVersions.has(documentId)) {\n      documentVersions.get(documentId)!.push({ ...document });\n    }\n\n    return legalService.updateDocument(documentId, userId, updates);\n  }\n\n  /**\n   * Export document as text\n   * Requirements: 3.2, 3.3\n   */\n  async exportAsText(documentId: string, userId: string): Promise<string> {\n    const document = await legalService.getDocumentById(documentId, userId);\n    return document.content;\n  }\n\n  /**\n   * Export document as JSON\n   * Requirements: 3.2, 3.3\n   */\n  async exportAsJSON(documentId: string, userId: string): Promise<Record<string, any>> {\n    const document = await legalService.getDocumentById(documentId, userId);\n\n    return {\n      id: document.id,\n      businessId: document.businessId,\n      templateId: document.templateId,\n      templateVersion: document.templateVersion,\n      status: document.status,\n      content: document.content,\n      signedAt: document.signedAt,\n      signerId: document.signerId,\n      createdAt: document.createdAt,\n      updatedAt: document.updatedAt,\n    };\n  }\n\n  /**\n   * Get document generation history\n   * Requirements: 3.2, 3.3\n   */\n  async getGenerationHistory(businessId: string): Promise<\n    Array<{\n      documentId: string;\n      templateId: string;\n      generatedAt: Date;\n      status: string;\n    }>\n  > {\n    const docs = Array.from(generatedDocuments.values()).filter((d) => d.businessId === businessId);\n\n    return docs.map((d) => ({\n      documentId: d.id,\n      templateId: d.templateId,\n      generatedAt: d.createdAt,\n      status: d.status,\n    }));\n  }\n\n  /**\n   * Get document version history\n   * Requirements: 3.2, 3.3\n   */\n  async getDocumentVersions(documentId: string, userId: string): Promise<\n    Array<{\n      version: number;\n      content: string;\n      status: string;\n      updatedAt: Date;\n    }>\n  > {\n    // Verify user has access\n    await legalService.getDocumentById(documentId, userId);\n\n    const versions = documentVersions.get(documentId) || [];\n\n    return versions.map((v, index) => ({\n      version: index + 1,\n      content: v.content,\n      status: v.status,\n      updatedAt: v.updatedAt,\n    }));\n  }\n\n  /**\n   * Restore document to previous version\n   * Requirements: 3.2, 3.3\n   */\n  async restoreDocumentVersion(\n    documentId: string,\n    userId: string,\n    versionNumber: number\n  ): Promise<LegalDocument> {\n    const document = await legalService.getDocumentById(documentId, userId);\n    const versions = documentVersions.get(documentId) || [];\n\n    if (versionNumber < 1 || versionNumber > versions.length) {\n      throw new AppError(400, `Invalid version number: ${versionNumber}`);\n    }\n\n    const targetVersion = versions[versionNumber - 1];\n\n    // Update document to target version\n    const updated = await legalService.updateDocument(documentId, userId, {\n      content: targetVersion.content,\n      status: targetVersion.status,\n    });\n\n    // Add restoration to version history\n    documentVersions.get(documentId)!.push({ ...updated });\n\n    return updated;\n  }\n\n  /**\n   * Store document PDF\n   * Requirements: 3.2, 3.3\n   */\n  async storePDF(documentId: string, pdfBuffer: Buffer): Promise<void> {\n    documentStorage.set(documentId, pdfBuffer);\n  }\n\n  /**\n   * Retrieve stored PDF\n   * Requirements: 3.2, 3.3\n   */\n  async retrievePDF(documentId: string, userId: string): Promise<Buffer> {\n    // Verify user has access\n    await legalService.getDocumentById(documentId, userId);\n\n    const pdf = documentStorage.get(documentId);\n    if (!pdf) {\n      throw new AppError(404, 'PDF not found for document');\n    }\n\n    return pdf;\n  }\n\n  /**\n   * Validate document before generation\n   * Requirements: 3.2, 3.3\n   */\n  async validateDocumentData(\n    templateId: string,\n    data: Record<string, any>\n  ): Promise<{\n    valid: boolean;\n    errors: string[];\n    warnings: string[];\n  }> {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    try {\n      await legalService.getTemplateById(templateId);\n\n      // Check for required fields\n      const validation = await legalService.validateTemplatePlaceholders(templateId, data);\n      if (!validation.valid) {\n        errors.push(`Missing required fields: ${validation.missingFields.join(', ')}`);\n      }\n\n      // Check for empty values\n      Object.entries(data).forEach(([key, value]) => {\n        if (typeof value === 'string' && value.trim().length === 0) {\n          warnings.push(`Field \"${key}\" is empty`);\n        }\n      });\n\n      return {\n        valid: errors.length === 0,\n        errors,\n        warnings,\n      };\n    } catch (error) {\n      return {\n        valid: false,\n        errors: [`Template not found: ${templateId}`],\n        warnings: [],\n      };\n    }\n  }\n\n  /**\n   * Get document generation statistics\n   * Requirements: 3.2, 3.3\n   */\n  async getGenerationStats(businessId: string): Promise<{\n    totalGenerated: number;\n    byStatus: Record<string, number>;\n    byTemplate: Record<string, number>;\n  }> {\n    const docs = Array.from(generatedDocuments.values()).filter((d) => d.businessId === businessId);\n\n    const byStatus: Record<string, number> = {};\n    const byTemplate: Record<string, number> = {};\n\n    docs.forEach((d) => {\n      byStatus[d.status] = (byStatus[d.status] || 0) + 1;\n      byTemplate[d.templateId] = (byTemplate[d.templateId] || 0) + 1;\n    });\n\n    return {\n      totalGenerated: docs.length,\n      byStatus,\n      byTemplate,\n    };\n  }\n\n  /**\n   * Create fallback PDF when pdfkit is not available\n   * Requirements: 3.2, 3.3\n   */\n  private createFallbackPDF(document: LegalDocument): Buffer {\n    // Create a simple text-based PDF representation\n    const pdfContent = `%PDF-1.4\n1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n2 0 obj\n<< /Type /Pages /Kids [3 0 R] /Count 1 >>\nendobj\n3 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 4 0 R >>\nendobj\n4 0 obj\n<< /Length ${document.content.length + 100} >>\nstream\nBT\n/F1 12 Tf\n50 750 Td\n(Legal Document) Tj\n0 -20 Td\n(Document ID: ${document.id}) Tj\n0 -20 Td\n(Status: ${document.status}) Tj\n0 -20 Td\n(Created: ${document.createdAt.toLocaleDateString()}) Tj\n0 -40 Td\n(${document.content.substring(0, 200)}) Tj\nET\nendstream\nendobj\nxref\n0 5\n0000000000 65535 f\n0000000009 00000 n\n0000000058 00000 n\n0000000115 00000 n\n0000000214 00000 n\ntrailer\n<< /Size 5 /Root 1 0 R >>\nstartxref\n${document.content.length + 400}\n%%EOF`;\n\n    return Buffer.from(pdfContent, 'utf-8');\n  }\n\n  /**\n   * Add content to PDF document\n   * Requirements: 3.2, 3.3\n   */\n  private addContentToPDF(pdfDoc: any, document: LegalDocument): void {\n    // Add title\n    pdfDoc.fontSize(16).font('Helvetica-Bold').text('Legal Document', { align: 'center' });\n    pdfDoc.moveDown();\n\n    // Add metadata\n    pdfDoc.fontSize(10).font('Helvetica').text(`Document ID: ${document.id}`);\n    pdfDoc.text(`Status: ${document.status}`);\n    pdfDoc.text(`Created: ${document.createdAt.toLocaleDateString()}`);\n    pdfDoc.moveDown();\n\n    // Add content\n    pdfDoc.fontSize(11).text(document.content, {\n      align: 'left',\n      width: 500,\n    });\n\n    // Add footer\n    pdfDoc.moveDown();\n    pdfDoc.fontSize(9).text('This is an automatically generated document.', {\n      align: 'center',\n    });\n  }\n\n  /**\n   * Apply styling to document content\n   * Requirements: 3.2, 3.3\n   */\n  private applyStyleToContent(\n    content: string,\n    styling: {\n      fontSize?: number;\n      fontFamily?: string;\n      margins?: { top: number; bottom: number; left: number; right: number };\n      headerText?: string;\n      footerText?: string;\n    }\n  ): string {\n    let styledContent = content;\n\n    if (styling.headerText) {\n      styledContent = `${styling.headerText}\\n\\n${styledContent}`;\n    }\n\n    if (styling.footerText) {\n      styledContent = `${styledContent}\\n\\n${styling.footerText}`;\n    }\n\n    return styledContent;\n  }\n}\n\nexport const documentGenerationService = new DocumentGenerationService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}