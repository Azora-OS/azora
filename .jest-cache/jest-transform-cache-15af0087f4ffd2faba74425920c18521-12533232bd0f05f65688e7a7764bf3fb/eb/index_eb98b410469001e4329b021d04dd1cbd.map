{"version":3,"names":["cov_hvqgm4mr","actualCoverage","express","s","require","PrismaClient","helmet","compression","cors","config","prisma","app","PORT","b","process","env","SERVICE_NAME","use","json","limit","urlencoded","extended","req","res","next","f","console","log","Date","toISOString","method","path","get","$queryRaw","status","service","db","timestamp","uptime","error","message","version","description","endpoints","err","success","listen","module","exports"],"sources":["index.js"],"sourcesContent":["const express = require('express');\nconst { PrismaClient } = require('@prisma/client');\nconst helmet = require('helmet');\nconst compression = require('compression');\nconst cors = require('cors');\nrequire('dotenv').config();\n\nconst prisma = new PrismaClient();\nconst app = express();\nconst PORT = process.env.PORT || 3013;\nconst SERVICE_NAME = process.env.SERVICE_NAME || 'azora-pricing';\n\n// Middleware\napp.use(helmet());\napp.use(cors());\napp.use(compression());\napp.use(express.json({ limit: '10mb' }));\napp.use(express.urlencoded({ extended: true }));\n\n// Request logging\napp.use((req, res, next) => {\n  console.log(`[${new Date().toISOString()}] ${req.method} ${req.path}`);\n  next();\n});\n\n// Health check\napp.get('/health', async (req, res) => {\n  try {\n    await prisma.$queryRaw`SELECT 1`;\n    res.json({ \n      status: 'healthy', \n      service: SERVICE_NAME,\n      db: 'connected',\n      timestamp: new Date().toISOString(),\n      uptime: process.uptime()\n    });\n  } catch (error) {\n    res.status(503).json({ \n      status: 'unhealthy', \n      error: error.message,\n      service: SERVICE_NAME\n    });\n  }\n});\n\n// API Documentation\napp.get('/', (req, res) => {\n  res.json({ \n    service: SERVICE_NAME,\n    version: '1.0.0',\n    description: 'Azora Pricing Service - Dynamic pricing engine',\n    endpoints: {\n      'GET /health': 'Service health check',\n      'POST /api/pricing/calculate': 'Calculate price for product/service',\n      'POST /api/pricing/rules': 'Create a new pricing rule',\n      'GET /api/pricing/rules': 'Get all pricing rules',\n      'GET /api/pricing/rules/:id': 'Get pricing rule by ID',\n      'PUT /api/pricing/rules/:id': 'Update pricing rule',\n      'DELETE /api/pricing/rules/:id': 'Delete pricing rule',\n      'POST /api/discounts': 'Create a new discount',\n      'GET /api/discounts': 'Get all discounts',\n      'GET /api/discounts/:id': 'Get discount by ID',\n      'PUT /api/discounts/:id': 'Update discount',\n      'DELETE /api/discounts/:id': 'Delete discount',\n      'POST /api/promotions': 'Create a new promotion',\n      'GET /api/promotions': 'Get all promotions'\n    }\n  });\n});\n\n// Error handling middleware\napp.use((err, req, res, next) => {\n  console.error('Error:', err);\n  res.status(500).json({ \n    success: false,\n    error: 'Internal server error',\n    message: err.message \n  });\n});\n\n// 404 handler\napp.use((req, res) => {\n  res.status(404).json({ \n    success: false,\n    error: 'Endpoint not found' \n  });\n});\n\n// Start server\napp.listen(PORT, () => {\n  console.log(`‚úÖ ${SERVICE_NAME} running on port ${PORT}`);\n  console.log(`üåç Health check: http://localhost:${PORT}/health`);\n});\n\nmodule.exports = app;"],"mappings":"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","ignoreList":[]}