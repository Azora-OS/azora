{"version":3,"names":["cov_jil5dtpob","actualCoverage","Redis","s","require","Pool","redis","b","process","env","REDIS_URL","db","connectionString","DATABASE_URL","AI_TREASURY_WALLET","STUDENT_POOL_WALLET","ENTERPRISE_POOL_WALLET","BUSINESS_POOL_WALLET","STUDENT_TOTAL_CAP","ENTERPRISE_TOTAL_CAP","AITreasury","processEarning","earningData","f","id","userId","amount","source","userType","amountNum","parseFloat","isNaN","console","warn","reinvest","Number","toFixed","netAmount","client","connect","query","rows","poolStats","studentMinted","student_minted","enterpriseMinted","enterprise_minted","Error","JSON","stringify","reason","originalAmount","log","err","error","lpush","message","timestamp","Date","now","release","getPoolStatistics","stats","student","allocated","minted","remaining","percentage","enterprise","aiTreasury","accumulated","forEach","row","pool_type","total_minted","treasury","total","getValueProjection","targetPricePerAZR","currentSupply","targetMarketCap","pools","value","formatted","note","startWorker","raw","brpop","parse","Promise","r","setTimeout","express","app","use","json","get","req","res","success","status","projection","post","body","PORT","AI_TREASURY_PORT","listen","main","module","catch","exit","exports"],"sources":["ai-reinvestment.js"],"sourcesContent":["/*\nAZORA PROPRIETARY LICENSE\n\nCopyright Â© 2025 Azora ES (Pty) Ltd. All Rights Reserved.\n\nSee LICENSE file for details.\n*/\n\n// filepath: /workspaces/azora-os/services/ai-treasury/ai-reinvestment.js\n/**\n * AI Treasury & Reinvestment System\n * \n * ENTERPRISE-FIRST MODEL:\n * â€¢ 1% of all AI earnings go to AI Treasury\n * â€¢ Students receive earnings from their 10% allocation pool\n * â€¢ Enterprises get priority allocation and higher rewards\n * â€¢ AI reinvestment funds R&D and ecosystem growth\n * \n * EARNING TIERS:\n * â€¢ Enterprise Partners: 1,000-100,000 AZR per contract\n * â€¢ Business Clients: 100-10,000 AZR per engagement\n * â€¢ Students: 0.1-100 AZR per task (from student pool)\n */\n\nconst Redis = require('ioredis');\nconst { Pool } = require('pg');\n\nconst redis = new Redis(process.env.REDIS_URL || 'redis://localhost:6379');\nconst db = new Pool({ connectionString: process.env.DATABASE_URL || 'postgres://postgres@localhost:5432/azora' });\n\n// Treasury wallets (different pools)\nconst AI_TREASURY_WALLET = process.env.AI_TREASURY_WALLET || 'wallet-ai-treasury';\nconst STUDENT_POOL_WALLET = 'wallet-student-pool';\nconst ENTERPRISE_POOL_WALLET = 'wallet-enterprise-pool';\nconst BUSINESS_POOL_WALLET = 'wallet-business-pool';\n\n// Allocation caps (in AZR)\nconst STUDENT_TOTAL_CAP = 100000; // 100,000 AZR total for students\nconst ENTERPRISE_TOTAL_CAP = 600000; // 600,000 AZR for enterprises\n\nclass AITreasury {\n  static async processEarning(earningData) {\n    const { id, userId, amount, source, userType } = earningData;\n    const amountNum = parseFloat(amount);\n    \n    if (isNaN(amountNum) || amountNum <= 0) {\n      console.warn('Invalid amount:', amount);\n      return;\n    }\n\n    // Calculate 1% reinvestment\n    const reinvest = Number((amountNum * 0.01).toFixed(6));\n    const netAmount = Number((amountNum - reinvest).toFixed(6));\n\n    const client = await db.connect();\n    try {\n      await client.query('BEGIN');\n\n      // Check allocation caps\n      const { rows: [poolStats] } = await client.query(\n        `SELECT \n          SUM(CASE WHEN user_type = 'student' THEN amount ELSE 0 END) as student_minted,\n          SUM(CASE WHEN user_type = 'enterprise' THEN amount ELSE 0 END) as enterprise_minted,\n          SUM(CASE WHEN user_type = 'business' THEN amount ELSE 0 END) as business_minted\n         FROM earnings_ledger`\n      );\n\n      const studentMinted = parseFloat(poolStats.student_minted || 0);\n      const enterpriseMinted = parseFloat(poolStats.enterprise_minted || 0);\n\n      // Enforce allocation caps\n      if (userType === 'student') {\n        if (studentMinted + netAmount > STUDENT_TOTAL_CAP) {\n          throw new Error(`Student pool exhausted. Total cap: ${STUDENT_TOTAL_CAP} AZR`);\n        }\n      } else if (userType === 'enterprise') {\n        if (enterpriseMinted + netAmount > ENTERPRISE_TOTAL_CAP) {\n          throw new Error(`Enterprise pool exhausted. Total cap: ${ENTERPRISE_TOTAL_CAP} AZR`);\n        }\n      }\n\n      // 1. Credit AI Treasury (1% reinvestment)\n      await client.query(\n        `INSERT INTO transactions (id, wallet_id, type, amount, meta, created_at)\n         VALUES ($1, $2, 'credit', $3, $4, NOW())`,\n        [\n          `tx-ai-reinvest-${id}`,\n          AI_TREASURY_WALLET,\n          reinvest,\n          JSON.stringify({ source, reason: 'ai-reinvestment', originalAmount: amountNum })\n        ]\n      );\n\n      // 2. Credit user wallet (99%)\n      await client.query(\n        `UPDATE wallets \n         SET balance = balance + $1,\n             total_earned = total_earned + $2,\n             updated_at = NOW()\n         WHERE user_id = $3`,\n        [netAmount, amountNum, userId]\n      );\n\n      // 3. Record in earnings ledger (for cap enforcement)\n      await client.query(\n        `INSERT INTO earnings_ledger (\n          id, user_id, user_type, amount, net_amount, reinvest_amount, \n          source, created_at\n         )\n         VALUES ($1, $2, $3, $4, $5, $6, $7, NOW())`,\n        [\n          `earning-${id}`,\n          userId,\n          userType,\n          amountNum,\n          netAmount,\n          reinvest,\n          source\n        ]\n      );\n\n      // 4. Update pool statistics\n      await client.query(\n        `INSERT INTO pool_statistics (\n          pool_type, total_minted, last_mint_amount, last_mint_user, updated_at\n         )\n         VALUES ($1, $2, $3, $4, NOW())\n         ON CONFLICT (pool_type) \n         DO UPDATE SET \n           total_minted = pool_statistics.total_minted + EXCLUDED.total_minted,\n           last_mint_amount = EXCLUDED.last_mint_amount,\n           last_mint_user = EXCLUDED.last_mint_user,\n           updated_at = NOW()`,\n        [userType, netAmount, netAmount, userId]\n      );\n\n      // 5. Audit trail\n      await client.query(\n        `INSERT INTO audit_log (\n          id, action, user_id, details, created_at\n         )\n         VALUES ($1, $2, $3, $4, NOW())`,\n        [\n          `audit-${id}`,\n          'ai_earning_processed',\n          userId,\n          JSON.stringify({\n            amount: amountNum,\n            netAmount,\n            reinvest,\n            source,\n            userType,\n            poolStats: {\n              studentMinted: studentMinted + (userType === 'student' ? netAmount : 0),\n              enterpriseMinted: enterpriseMinted + (userType === 'enterprise' ? netAmount : 0),\n            }\n          })\n        ]\n      );\n\n      await client.query('COMMIT');\n\n      console.log(`âœ… AI Earning processed: ${userId} received ${netAmount} AZR (${reinvest} AZR to treasury)`);\n\n    } catch (err) {\n      await client.query('ROLLBACK');\n      console.error('âŒ AI earning processing failed:', err);\n      \n      // Log failure for retry\n      await redis.lpush('queue:failed-earnings', JSON.stringify({\n        earningData,\n        error: err.message,\n        timestamp: Date.now()\n      }));\n      \n      throw err;\n    } finally {\n      client.release();\n    }\n  }\n\n  static async getPoolStatistics() {\n    const { rows } = await db.query(\n      `SELECT * FROM pool_statistics ORDER BY pool_type`\n    );\n\n    const stats = {\n      student: {\n        allocated: STUDENT_TOTAL_CAP,\n        minted: 0,\n        remaining: STUDENT_TOTAL_CAP,\n        percentage: 10\n      },\n      enterprise: {\n        allocated: ENTERPRISE_TOTAL_CAP,\n        minted: 0,\n        remaining: ENTERPRISE_TOTAL_CAP,\n        percentage: 60\n      },\n      aiTreasury: {\n        accumulated: 0\n      }\n    };\n\n    rows.forEach(row => {\n      if (row.pool_type === 'student') {\n        stats.student.minted = parseFloat(row.total_minted);\n        stats.student.remaining = STUDENT_TOTAL_CAP - stats.student.minted;\n      } else if (row.pool_type === 'enterprise') {\n        stats.enterprise.minted = parseFloat(row.total_minted);\n        stats.enterprise.remaining = ENTERPRISE_TOTAL_CAP - stats.enterprise.minted;\n      }\n    });\n\n    // Get AI Treasury balance\n    const { rows: [treasury] } = await db.query(\n      `SELECT SUM(amount) as total FROM transactions WHERE wallet_id = $1`,\n      [AI_TREASURY_WALLET]\n    );\n    stats.aiTreasury.accumulated = parseFloat(treasury?.total || 0);\n\n    return stats;\n  }\n\n  static async getValueProjection() {\n    const stats = await this.getPoolStatistics();\n    \n    // Target: $1M per AZR = $1 Trillion market cap\n    const targetPricePerAZR = 1000000; // $1M\n    const currentSupply = 1000000; // Fixed supply\n    \n    return {\n      targetMarketCap: currentSupply * targetPricePerAZR,\n      targetPricePerAZR,\n      currentSupply,\n      pools: {\n        enterprise: {\n          value: stats.enterprise.allocated * targetPricePerAZR,\n          formatted: `$${(stats.enterprise.allocated * targetPricePerAZR / 1e9).toFixed(2)}B`\n        },\n        student: {\n          value: stats.student.allocated * targetPricePerAZR,\n          formatted: `$${(stats.student.allocated * targetPricePerAZR / 1e9).toFixed(2)}B`,\n          note: 'Even 1 AZR = $1M for students at target'\n        }\n      }\n    };\n  }\n}\n\n// Worker: Listen to Redis queue for earnings\nasync function startWorker() {\n  console.log('ðŸ¤– Starting AI Treasury & Reinvestment Worker...');\n  console.log('');\n  console.log('ðŸ“Š Tokenomics:');\n  console.log('   â€¢ Enterprise Pool: 600,000 AZR (60%)');\n  console.log('   â€¢ Business Pool: 200,000 AZR (20%)');\n  console.log('   â€¢ Student Pool: 100,000 AZR (10%)');\n  console.log('   â€¢ AI Treasury: 1% of all earnings');\n  console.log('');\n\n  while (true) {\n    try {\n      const raw = await redis.brpop('queue:ai-earnings', 0);\n      if (!raw) continue;\n\n      const earningData = JSON.parse(raw[1]);\n      await AITreasury.processEarning(earningData);\n\n    } catch (err) {\n      console.error('Worker error:', err);\n      await new Promise(r => setTimeout(r, 2000));\n    }\n  }\n}\n\n// Express API\nconst express = require('express');\nconst app = express();\napp.use(express.json());\n\napp.get('/treasury/stats', async (req, res) => {\n  try {\n    const stats = await AITreasury.getPoolStatistics();\n    res.json({ success: true, stats });\n  } catch (err) {\n    res.status(500).json({ error: err.message });\n  }\n});\n\napp.get('/treasury/projection', async (req, res) => {\n  try {\n    const projection = await AITreasury.getValueProjection();\n    res.json({ success: true, projection });\n  } catch (err) {\n    res.status(500).json({ error: err.message });\n  }\n});\n\napp.post('/treasury/simulate-earning', async (req, res) => {\n  try {\n    const { userId, amount, source, userType } = req.body;\n    \n    // Push to queue for processing\n    await redis.lpush('queue:ai-earnings', JSON.stringify({\n      id: `sim-${Date.now()}`,\n      userId,\n      amount: parseFloat(amount),\n      source: source || 'simulation',\n      userType: userType || 'student'\n    }));\n\n    res.json({ success: true, message: 'Earning queued for processing' });\n  } catch (err) {\n    res.status(500).json({ error: err.message });\n  }\n});\n\nconst PORT = process.env.AI_TREASURY_PORT || 5006;\napp.listen(PORT, () => {\n  console.log(`ðŸ’° AI Treasury API running on port ${PORT}`);\n});\n\n// Start worker if run directly\nif (require.main === module) {\n  startWorker().catch(err => {\n    console.error(err);\n    process.exit(1);\n  });\n}\n\nmodule.exports = { AITreasury, startWorker };\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAfZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAME,KAAK;AAAA;AAAA,CAAAF,aAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,SAAS,CAAC;AAChC,MAAM;EAAEC;AAAK,CAAC;AAAA;AAAA,CAAAL,aAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,IAAI,CAAC;AAE9B,MAAME,KAAK;AAAA;AAAA,CAAAN,aAAA,GAAAG,CAAA,OAAG,IAAID,KAAK;AAAC;AAAA,CAAAF,aAAA,GAAAO,CAAA,UAAAC,OAAO,CAACC,GAAG,CAACC,SAAS;AAAA;AAAA,CAAAV,aAAA,GAAAO,CAAA,UAAI,wBAAwB,EAAC;AAC1E,MAAMI,EAAE;AAAA;AAAA,CAAAX,aAAA,GAAAG,CAAA,OAAG,IAAIE,IAAI,CAAC;EAAEO,gBAAgB;EAAE;EAAA,CAAAZ,aAAA,GAAAO,CAAA,UAAAC,OAAO,CAACC,GAAG,CAACI,YAAY;EAAA;EAAA,CAAAb,aAAA,GAAAO,CAAA,UAAI,0CAA0C;AAAC,CAAC,CAAC;;AAEjH;AACA,MAAMO,kBAAkB;AAAA;AAAA,CAAAd,aAAA,GAAAG,CAAA;AAAG;AAAA,CAAAH,aAAA,GAAAO,CAAA,UAAAC,OAAO,CAACC,GAAG,CAACK,kBAAkB;AAAA;AAAA,CAAAd,aAAA,GAAAO,CAAA,UAAI,oBAAoB;AACjF,MAAMQ,mBAAmB;AAAA;AAAA,CAAAf,aAAA,GAAAG,CAAA,OAAG,qBAAqB;AACjD,MAAMa,sBAAsB;AAAA;AAAA,CAAAhB,aAAA,GAAAG,CAAA,OAAG,wBAAwB;AACvD,MAAMc,oBAAoB;AAAA;AAAA,CAAAjB,aAAA,GAAAG,CAAA,OAAG,sBAAsB;;AAEnD;AACA,MAAMe,iBAAiB;AAAA;AAAA,CAAAlB,aAAA,GAAAG,CAAA,OAAG,MAAM,EAAC,CAAC;AAClC,MAAMgB,oBAAoB;AAAA;AAAA,CAAAnB,aAAA,GAAAG,CAAA,OAAG,MAAM,EAAC,CAAC;;AAErC,MAAMiB,UAAU,CAAC;EACf,aAAaC,cAAcA,CAACC,WAAW,EAAE;IAAA;IAAAtB,aAAA,GAAAuB,CAAA;IACvC,MAAM;MAAEC,EAAE;MAAEC,MAAM;MAAEC,MAAM;MAAEC,MAAM;MAAEC;IAAS,CAAC;IAAA;IAAA,CAAA5B,aAAA,GAAAG,CAAA,QAAGmB,WAAW;IAC5D,MAAMO,SAAS;IAAA;IAAA,CAAA7B,aAAA,GAAAG,CAAA,QAAG2B,UAAU,CAACJ,MAAM,CAAC;IAAC;IAAA1B,aAAA,GAAAG,CAAA;IAErC;IAAI;IAAA,CAAAH,aAAA,GAAAO,CAAA,UAAAwB,KAAK,CAACF,SAAS,CAAC;IAAA;IAAA,CAAA7B,aAAA,GAAAO,CAAA,UAAIsB,SAAS,IAAI,CAAC,GAAE;MAAA;MAAA7B,aAAA,GAAAO,CAAA;MAAAP,aAAA,GAAAG,CAAA;MACtC6B,OAAO,CAACC,IAAI,CAAC,iBAAiB,EAAEP,MAAM,CAAC;MAAC;MAAA1B,aAAA,GAAAG,CAAA;MACxC;IACF,CAAC;IAAA;IAAA;MAAAH,aAAA,GAAAO,CAAA;IAAA;;IAED;IACA,MAAM2B,QAAQ;IAAA;IAAA,CAAAlC,aAAA,GAAAG,CAAA,QAAGgC,MAAM,CAAC,CAACN,SAAS,GAAG,IAAI,EAAEO,OAAO,CAAC,CAAC,CAAC,CAAC;IACtD,MAAMC,SAAS;IAAA;IAAA,CAAArC,aAAA,GAAAG,CAAA,QAAGgC,MAAM,CAAC,CAACN,SAAS,GAAGK,QAAQ,EAAEE,OAAO,CAAC,CAAC,CAAC,CAAC;IAE3D,MAAME,MAAM;IAAA;IAAA,CAAAtC,aAAA,GAAAG,CAAA,QAAG,MAAMQ,EAAE,CAAC4B,OAAO,CAAC,CAAC;IAAC;IAAAvC,aAAA,GAAAG,CAAA;IAClC,IAAI;MAAA;MAAAH,aAAA,GAAAG,CAAA;MACF,MAAMmC,MAAM,CAACE,KAAK,CAAC,OAAO,CAAC;;MAE3B;MACA,MAAM;QAAEC,IAAI,EAAE,CAACC,SAAS;MAAE,CAAC;MAAA;MAAA,CAAA1C,aAAA,GAAAG,CAAA,QAAG,MAAMmC,MAAM,CAACE,KAAK,CAC9C;AACR;AACA;AACA;AACA,8BACM,CAAC;MAED,MAAMG,aAAa;MAAA;MAAA,CAAA3C,aAAA,GAAAG,CAAA,QAAG2B,UAAU;MAAC;MAAA,CAAA9B,aAAA,GAAAO,CAAA,UAAAmC,SAAS,CAACE,cAAc;MAAA;MAAA,CAAA5C,aAAA,GAAAO,CAAA,UAAI,CAAC,EAAC;MAC/D,MAAMsC,gBAAgB;MAAA;MAAA,CAAA7C,aAAA,GAAAG,CAAA,QAAG2B,UAAU;MAAC;MAAA,CAAA9B,aAAA,GAAAO,CAAA,UAAAmC,SAAS,CAACI,iBAAiB;MAAA;MAAA,CAAA9C,aAAA,GAAAO,CAAA,UAAI,CAAC,EAAC;;MAErE;MAAA;MAAAP,aAAA,GAAAG,CAAA;MACA,IAAIyB,QAAQ,KAAK,SAAS,EAAE;QAAA;QAAA5B,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAG,CAAA;QAC1B,IAAIwC,aAAa,GAAGN,SAAS,GAAGnB,iBAAiB,EAAE;UAAA;UAAAlB,aAAA,GAAAO,CAAA;UAAAP,aAAA,GAAAG,CAAA;UACjD,MAAM,IAAI4C,KAAK,CAAC,sCAAsC7B,iBAAiB,MAAM,CAAC;QAChF,CAAC;QAAA;QAAA;UAAAlB,aAAA,GAAAO,CAAA;QAAA;MACH,CAAC,MAAM;QAAA;QAAAP,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAG,CAAA;QAAA,IAAIyB,QAAQ,KAAK,YAAY,EAAE;UAAA;UAAA5B,aAAA,GAAAO,CAAA;UAAAP,aAAA,GAAAG,CAAA;UACpC,IAAI0C,gBAAgB,GAAGR,SAAS,GAAGlB,oBAAoB,EAAE;YAAA;YAAAnB,aAAA,GAAAO,CAAA;YAAAP,aAAA,GAAAG,CAAA;YACvD,MAAM,IAAI4C,KAAK,CAAC,yCAAyC5B,oBAAoB,MAAM,CAAC;UACtF,CAAC;UAAA;UAAA;YAAAnB,aAAA,GAAAO,CAAA;UAAA;QACH,CAAC;QAAA;QAAA;UAAAP,aAAA,GAAAO,CAAA;QAAA;MAAD;;MAEA;MAAA;MAAAP,aAAA,GAAAG,CAAA;MACA,MAAMmC,MAAM,CAACE,KAAK,CAChB;AACR,kDAAkD,EAC1C,CACE,kBAAkBhB,EAAE,EAAE,EACtBV,kBAAkB,EAClBoB,QAAQ,EACRc,IAAI,CAACC,SAAS,CAAC;QAAEtB,MAAM;QAAEuB,MAAM,EAAE,iBAAiB;QAAEC,cAAc,EAAEtB;MAAU,CAAC,CAAC,CAEpF,CAAC;;MAED;MAAA;MAAA7B,aAAA,GAAAG,CAAA;MACA,MAAMmC,MAAM,CAACE,KAAK,CAChB;AACR;AACA;AACA;AACA,4BAA4B,EACpB,CAACH,SAAS,EAAER,SAAS,EAAEJ,MAAM,CAC/B,CAAC;;MAED;MAAA;MAAAzB,aAAA,GAAAG,CAAA;MACA,MAAMmC,MAAM,CAACE,KAAK,CAChB;AACR;AACA;AACA;AACA,oDAAoD,EAC5C,CACE,WAAWhB,EAAE,EAAE,EACfC,MAAM,EACNG,QAAQ,EACRC,SAAS,EACTQ,SAAS,EACTH,QAAQ,EACRP,MAAM,CAEV,CAAC;;MAED;MAAA;MAAA3B,aAAA,GAAAG,CAAA;MACA,MAAMmC,MAAM,CAACE,KAAK,CAChB;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,EACtB,CAACZ,QAAQ,EAAES,SAAS,EAAEA,SAAS,EAAEZ,MAAM,CACzC,CAAC;;MAED;MAAA;MAAAzB,aAAA,GAAAG,CAAA;MACA,MAAMmC,MAAM,CAACE,KAAK,CAChB;AACR;AACA;AACA,wCAAwC,EAChC,CACE,SAAShB,EAAE,EAAE,EACb,sBAAsB,EACtBC,MAAM,EACNuB,IAAI,CAACC,SAAS,CAAC;QACbvB,MAAM,EAAEG,SAAS;QACjBQ,SAAS;QACTH,QAAQ;QACRP,MAAM;QACNC,QAAQ;QACRc,SAAS,EAAE;UACTC,aAAa,EAAEA,aAAa,IAAIf,QAAQ,KAAK,SAAS;UAAA;UAAA,CAAA5B,aAAA,GAAAO,CAAA,WAAG8B,SAAS;UAAA;UAAA,CAAArC,aAAA,GAAAO,CAAA,WAAG,CAAC,EAAC;UACvEsC,gBAAgB,EAAEA,gBAAgB,IAAIjB,QAAQ,KAAK,YAAY;UAAA;UAAA,CAAA5B,aAAA,GAAAO,CAAA,WAAG8B,SAAS;UAAA;UAAA,CAAArC,aAAA,GAAAO,CAAA,WAAG,CAAC;QACjF;MACF,CAAC,CAAC,CAEN,CAAC;MAAC;MAAAP,aAAA,GAAAG,CAAA;MAEF,MAAMmC,MAAM,CAACE,KAAK,CAAC,QAAQ,CAAC;MAAC;MAAAxC,aAAA,GAAAG,CAAA;MAE7B6B,OAAO,CAACoB,GAAG,CAAC,2BAA2B3B,MAAM,aAAaY,SAAS,SAASH,QAAQ,mBAAmB,CAAC;IAE1G,CAAC,CAAC,OAAOmB,GAAG,EAAE;MAAA;MAAArD,aAAA,GAAAG,CAAA;MACZ,MAAMmC,MAAM,CAACE,KAAK,CAAC,UAAU,CAAC;MAAC;MAAAxC,aAAA,GAAAG,CAAA;MAC/B6B,OAAO,CAACsB,KAAK,CAAC,iCAAiC,EAAED,GAAG,CAAC;;MAErD;MAAA;MAAArD,aAAA,GAAAG,CAAA;MACA,MAAMG,KAAK,CAACiD,KAAK,CAAC,uBAAuB,EAAEP,IAAI,CAACC,SAAS,CAAC;QACxD3B,WAAW;QACXgC,KAAK,EAAED,GAAG,CAACG,OAAO;QAClBC,SAAS,EAAEC,IAAI,CAACC,GAAG,CAAC;MACtB,CAAC,CAAC,CAAC;MAAC;MAAA3D,aAAA,GAAAG,CAAA;MAEJ,MAAMkD,GAAG;IACX,CAAC,SAAS;MAAA;MAAArD,aAAA,GAAAG,CAAA;MACRmC,MAAM,CAACsB,OAAO,CAAC,CAAC;IAClB;EACF;EAEA,aAAaC,iBAAiBA,CAAA,EAAG;IAAA;IAAA7D,aAAA,GAAAuB,CAAA;IAC/B,MAAM;MAAEkB;IAAK,CAAC;IAAA;IAAA,CAAAzC,aAAA,GAAAG,CAAA,QAAG,MAAMQ,EAAE,CAAC6B,KAAK,CAC7B,kDACF,CAAC;IAED,MAAMsB,KAAK;IAAA;IAAA,CAAA9D,aAAA,GAAAG,CAAA,QAAG;MACZ4D,OAAO,EAAE;QACPC,SAAS,EAAE9C,iBAAiB;QAC5B+C,MAAM,EAAE,CAAC;QACTC,SAAS,EAAEhD,iBAAiB;QAC5BiD,UAAU,EAAE;MACd,CAAC;MACDC,UAAU,EAAE;QACVJ,SAAS,EAAE7C,oBAAoB;QAC/B8C,MAAM,EAAE,CAAC;QACTC,SAAS,EAAE/C,oBAAoB;QAC/BgD,UAAU,EAAE;MACd,CAAC;MACDE,UAAU,EAAE;QACVC,WAAW,EAAE;MACf;IACF,CAAC;IAAC;IAAAtE,aAAA,GAAAG,CAAA;IAEFsC,IAAI,CAAC8B,OAAO,CAACC,GAAG,IAAI;MAAA;MAAAxE,aAAA,GAAAuB,CAAA;MAAAvB,aAAA,GAAAG,CAAA;MAClB,IAAIqE,GAAG,CAACC,SAAS,KAAK,SAAS,EAAE;QAAA;QAAAzE,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAG,CAAA;QAC/B2D,KAAK,CAACC,OAAO,CAACE,MAAM,GAAGnC,UAAU,CAAC0C,GAAG,CAACE,YAAY,CAAC;QAAC;QAAA1E,aAAA,GAAAG,CAAA;QACpD2D,KAAK,CAACC,OAAO,CAACG,SAAS,GAAGhD,iBAAiB,GAAG4C,KAAK,CAACC,OAAO,CAACE,MAAM;MACpE,CAAC,MAAM;QAAA;QAAAjE,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAG,CAAA;QAAA,IAAIqE,GAAG,CAACC,SAAS,KAAK,YAAY,EAAE;UAAA;UAAAzE,aAAA,GAAAO,CAAA;UAAAP,aAAA,GAAAG,CAAA;UACzC2D,KAAK,CAACM,UAAU,CAACH,MAAM,GAAGnC,UAAU,CAAC0C,GAAG,CAACE,YAAY,CAAC;UAAC;UAAA1E,aAAA,GAAAG,CAAA;UACvD2D,KAAK,CAACM,UAAU,CAACF,SAAS,GAAG/C,oBAAoB,GAAG2C,KAAK,CAACM,UAAU,CAACH,MAAM;QAC7E,CAAC;QAAA;QAAA;UAAAjE,aAAA,GAAAO,CAAA;QAAA;MAAD;IACF,CAAC,CAAC;;IAEF;IACA,MAAM;MAAEkC,IAAI,EAAE,CAACkC,QAAQ;IAAE,CAAC;IAAA;IAAA,CAAA3E,aAAA,GAAAG,CAAA,QAAG,MAAMQ,EAAE,CAAC6B,KAAK,CACzC,oEAAoE,EACpE,CAAC1B,kBAAkB,CACrB,CAAC;IAAC;IAAAd,aAAA,GAAAG,CAAA;IACF2D,KAAK,CAACO,UAAU,CAACC,WAAW,GAAGxC,UAAU;IAAC;IAAA,CAAA9B,aAAA,GAAAO,CAAA,WAAAoE,QAAQ,EAAEC,KAAK;IAAA;IAAA,CAAA5E,aAAA,GAAAO,CAAA,WAAI,CAAC,EAAC;IAAC;IAAAP,aAAA,GAAAG,CAAA;IAEhE,OAAO2D,KAAK;EACd;EAEA,aAAae,kBAAkBA,CAAA,EAAG;IAAA;IAAA7E,aAAA,GAAAuB,CAAA;IAChC,MAAMuC,KAAK;IAAA;IAAA,CAAA9D,aAAA,GAAAG,CAAA,QAAG,MAAM,IAAI,CAAC0D,iBAAiB,CAAC,CAAC;;IAE5C;IACA,MAAMiB,iBAAiB;IAAA;IAAA,CAAA9E,aAAA,GAAAG,CAAA,QAAG,OAAO,EAAC,CAAC;IACnC,MAAM4E,aAAa;IAAA;IAAA,CAAA/E,aAAA,GAAAG,CAAA,QAAG,OAAO,EAAC,CAAC;IAAA;IAAAH,aAAA,GAAAG,CAAA;IAE/B,OAAO;MACL6E,eAAe,EAAED,aAAa,GAAGD,iBAAiB;MAClDA,iBAAiB;MACjBC,aAAa;MACbE,KAAK,EAAE;QACLb,UAAU,EAAE;UACVc,KAAK,EAAEpB,KAAK,CAACM,UAAU,CAACJ,SAAS,GAAGc,iBAAiB;UACrDK,SAAS,EAAE,IAAI,CAACrB,KAAK,CAACM,UAAU,CAACJ,SAAS,GAAGc,iBAAiB,GAAG,GAAG,EAAE1C,OAAO,CAAC,CAAC,CAAC;QAClF,CAAC;QACD2B,OAAO,EAAE;UACPmB,KAAK,EAAEpB,KAAK,CAACC,OAAO,CAACC,SAAS,GAAGc,iBAAiB;UAClDK,SAAS,EAAE,IAAI,CAACrB,KAAK,CAACC,OAAO,CAACC,SAAS,GAAGc,iBAAiB,GAAG,GAAG,EAAE1C,OAAO,CAAC,CAAC,CAAC,GAAG;UAChFgD,IAAI,EAAE;QACR;MACF;IACF,CAAC;EACH;AACF;;AAEA;AACA,eAAeC,WAAWA,CAAA,EAAG;EAAA;EAAArF,aAAA,GAAAuB,CAAA;EAAAvB,aAAA,GAAAG,CAAA;EAC3B6B,OAAO,CAACoB,GAAG,CAAC,kDAAkD,CAAC;EAAC;EAAApD,aAAA,GAAAG,CAAA;EAChE6B,OAAO,CAACoB,GAAG,CAAC,EAAE,CAAC;EAAC;EAAApD,aAAA,GAAAG,CAAA;EAChB6B,OAAO,CAACoB,GAAG,CAAC,gBAAgB,CAAC;EAAC;EAAApD,aAAA,GAAAG,CAAA;EAC9B6B,OAAO,CAACoB,GAAG,CAAC,yCAAyC,CAAC;EAAC;EAAApD,aAAA,GAAAG,CAAA;EACvD6B,OAAO,CAACoB,GAAG,CAAC,uCAAuC,CAAC;EAAC;EAAApD,aAAA,GAAAG,CAAA;EACrD6B,OAAO,CAACoB,GAAG,CAAC,sCAAsC,CAAC;EAAC;EAAApD,aAAA,GAAAG,CAAA;EACpD6B,OAAO,CAACoB,GAAG,CAAC,sCAAsC,CAAC;EAAC;EAAApD,aAAA,GAAAG,CAAA;EACpD6B,OAAO,CAACoB,GAAG,CAAC,EAAE,CAAC;EAAC;EAAApD,aAAA,GAAAG,CAAA;EAEhB,OAAO,IAAI,EAAE;IAAA;IAAAH,aAAA,GAAAG,CAAA;IACX,IAAI;MACF,MAAMmF,GAAG;MAAA;MAAA,CAAAtF,aAAA,GAAAG,CAAA,QAAG,MAAMG,KAAK,CAACiF,KAAK,CAAC,mBAAmB,EAAE,CAAC,CAAC;MAAC;MAAAvF,aAAA,GAAAG,CAAA;MACtD,IAAI,CAACmF,GAAG,EAAE;QAAA;QAAAtF,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAG,CAAA;QAAA;MAAQ,CAAC;MAAA;MAAA;QAAAH,aAAA,GAAAO,CAAA;MAAA;MAEnB,MAAMe,WAAW;MAAA;MAAA,CAAAtB,aAAA,GAAAG,CAAA,QAAG6C,IAAI,CAACwC,KAAK,CAACF,GAAG,CAAC,CAAC,CAAC,CAAC;MAAC;MAAAtF,aAAA,GAAAG,CAAA;MACvC,MAAMiB,UAAU,CAACC,cAAc,CAACC,WAAW,CAAC;IAE9C,CAAC,CAAC,OAAO+B,GAAG,EAAE;MAAA;MAAArD,aAAA,GAAAG,CAAA;MACZ6B,OAAO,CAACsB,KAAK,CAAC,eAAe,EAAED,GAAG,CAAC;MAAC;MAAArD,aAAA,GAAAG,CAAA;MACpC,MAAM,IAAIsF,OAAO,CAACC,CAAC,IAAI;QAAA;QAAA1F,aAAA,GAAAuB,CAAA;QAAAvB,aAAA,GAAAG,CAAA;QAAA,OAAAwF,UAAU,CAACD,CAAC,EAAE,IAAI,CAAC;MAAD,CAAC,CAAC;IAC7C;EACF;AACF;;AAEA;AACA,MAAME,OAAO;AAAA;AAAA,CAAA5F,aAAA,GAAAG,CAAA,QAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMyF,GAAG;AAAA;AAAA,CAAA7F,aAAA,GAAAG,CAAA,QAAGyF,OAAO,CAAC,CAAC;AAAC;AAAA5F,aAAA,GAAAG,CAAA;AACtB0F,GAAG,CAACC,GAAG,CAACF,OAAO,CAACG,IAAI,CAAC,CAAC,CAAC;AAAC;AAAA/F,aAAA,GAAAG,CAAA;AAExB0F,GAAG,CAACG,GAAG,CAAC,iBAAiB,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAAA;EAAAlG,aAAA,GAAAuB,CAAA;EAAAvB,aAAA,GAAAG,CAAA;EAC7C,IAAI;IACF,MAAM2D,KAAK;IAAA;IAAA,CAAA9D,aAAA,GAAAG,CAAA,QAAG,MAAMiB,UAAU,CAACyC,iBAAiB,CAAC,CAAC;IAAC;IAAA7D,aAAA,GAAAG,CAAA;IACnD+F,GAAG,CAACH,IAAI,CAAC;MAAEI,OAAO,EAAE,IAAI;MAAErC;IAAM,CAAC,CAAC;EACpC,CAAC,CAAC,OAAOT,GAAG,EAAE;IAAA;IAAArD,aAAA,GAAAG,CAAA;IACZ+F,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAAC;MAAEzC,KAAK,EAAED,GAAG,CAACG;IAAQ,CAAC,CAAC;EAC9C;AACF,CAAC,CAAC;AAAC;AAAAxD,aAAA,GAAAG,CAAA;AAEH0F,GAAG,CAACG,GAAG,CAAC,sBAAsB,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAAA;EAAAlG,aAAA,GAAAuB,CAAA;EAAAvB,aAAA,GAAAG,CAAA;EAClD,IAAI;IACF,MAAMkG,UAAU;IAAA;IAAA,CAAArG,aAAA,GAAAG,CAAA,QAAG,MAAMiB,UAAU,CAACyD,kBAAkB,CAAC,CAAC;IAAC;IAAA7E,aAAA,GAAAG,CAAA;IACzD+F,GAAG,CAACH,IAAI,CAAC;MAAEI,OAAO,EAAE,IAAI;MAAEE;IAAW,CAAC,CAAC;EACzC,CAAC,CAAC,OAAOhD,GAAG,EAAE;IAAA;IAAArD,aAAA,GAAAG,CAAA;IACZ+F,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAAC;MAAEzC,KAAK,EAAED,GAAG,CAACG;IAAQ,CAAC,CAAC;EAC9C;AACF,CAAC,CAAC;AAAC;AAAAxD,aAAA,GAAAG,CAAA;AAEH0F,GAAG,CAACS,IAAI,CAAC,4BAA4B,EAAE,OAAOL,GAAG,EAAEC,GAAG,KAAK;EAAA;EAAAlG,aAAA,GAAAuB,CAAA;EAAAvB,aAAA,GAAAG,CAAA;EACzD,IAAI;IACF,MAAM;MAAEsB,MAAM;MAAEC,MAAM;MAAEC,MAAM;MAAEC;IAAS,CAAC;IAAA;IAAA,CAAA5B,aAAA,GAAAG,CAAA,QAAG8F,GAAG,CAACM,IAAI;;IAErD;IAAA;IAAAvG,aAAA,GAAAG,CAAA;IACA,MAAMG,KAAK,CAACiD,KAAK,CAAC,mBAAmB,EAAEP,IAAI,CAACC,SAAS,CAAC;MACpDzB,EAAE,EAAE,OAAOkC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;MACvBlC,MAAM;MACNC,MAAM,EAAEI,UAAU,CAACJ,MAAM,CAAC;MAC1BC,MAAM;MAAE;MAAA,CAAA3B,aAAA,GAAAO,CAAA,WAAAoB,MAAM;MAAA;MAAA,CAAA3B,aAAA,GAAAO,CAAA,WAAI,YAAY;MAC9BqB,QAAQ;MAAE;MAAA,CAAA5B,aAAA,GAAAO,CAAA,WAAAqB,QAAQ;MAAA;MAAA,CAAA5B,aAAA,GAAAO,CAAA,WAAI,SAAS;IACjC,CAAC,CAAC,CAAC;IAAC;IAAAP,aAAA,GAAAG,CAAA;IAEJ+F,GAAG,CAACH,IAAI,CAAC;MAAEI,OAAO,EAAE,IAAI;MAAE3C,OAAO,EAAE;IAAgC,CAAC,CAAC;EACvE,CAAC,CAAC,OAAOH,GAAG,EAAE;IAAA;IAAArD,aAAA,GAAAG,CAAA;IACZ+F,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAAC;MAAEzC,KAAK,EAAED,GAAG,CAACG;IAAQ,CAAC,CAAC;EAC9C;AACF,CAAC,CAAC;AAEF,MAAMgD,IAAI;AAAA;AAAA,CAAAxG,aAAA,GAAAG,CAAA;AAAG;AAAA,CAAAH,aAAA,GAAAO,CAAA,WAAAC,OAAO,CAACC,GAAG,CAACgG,gBAAgB;AAAA;AAAA,CAAAzG,aAAA,GAAAO,CAAA,WAAI,IAAI;AAAC;AAAAP,aAAA,GAAAG,CAAA;AAClD0F,GAAG,CAACa,MAAM,CAACF,IAAI,EAAE,MAAM;EAAA;EAAAxG,aAAA,GAAAuB,CAAA;EAAAvB,aAAA,GAAAG,CAAA;EACrB6B,OAAO,CAACoB,GAAG,CAAC,sCAAsCoD,IAAI,EAAE,CAAC;AAC3D,CAAC,CAAC;;AAEF;AAAA;AAAAxG,aAAA,GAAAG,CAAA;AACA,IAAIC,OAAO,CAACuG,IAAI,KAAKC,MAAM,EAAE;EAAA;EAAA5G,aAAA,GAAAO,CAAA;EAAAP,aAAA,GAAAG,CAAA;EAC3BkF,WAAW,CAAC,CAAC,CAACwB,KAAK,CAACxD,GAAG,IAAI;IAAA;IAAArD,aAAA,GAAAuB,CAAA;IAAAvB,aAAA,GAAAG,CAAA;IACzB6B,OAAO,CAACsB,KAAK,CAACD,GAAG,CAAC;IAAC;IAAArD,aAAA,GAAAG,CAAA;IACnBK,OAAO,CAACsG,IAAI,CAAC,CAAC,CAAC;EACjB,CAAC,CAAC;AACJ,CAAC;AAAA;AAAA;EAAA9G,aAAA,GAAAO,CAAA;AAAA;AAAAP,aAAA,GAAAG,CAAA;AAEDyG,MAAM,CAACG,OAAO,GAAG;EAAE3F,UAAU;EAAEiE;AAAY,CAAC","ignoreList":[]}