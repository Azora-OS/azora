{"version":3,"names":["cov_26v3xhfq4h","actualCoverage","axios","prisma","logger","Joi","tutoringQuestionSchema","s","object","studentId","string","required","enrollmentId","courseId","moduleId","question","min","context","optional","TutoringService","constructor","f","elaraUrl","b","process","env","ELARA_ORCHESTRATOR_URL","elaraClient","create","baseURL","timeout","responseCache","Map","cacheExpiry","askQuestion","data","error","value","validate","Error","message","enrollment","findUnique","where","id","include","course","student","module","outcomes","learningOutcome","findMany","orderBy","completedAt","take","studentName","firstName","courseName","title","moduleName","studentTier","tier","previousOutcomes","map","o","score","assessmentScore","mastery","conceptMastery","cacheKey","generateCacheKey","cachedResponse","get","info","response","post","tutoringResponse","Date","now","answer","confidence","sources","timestamp","set","setTimeout","delete","getTutoringHistory","enrollments","length","totalQuestions","responses","averageConfidence","history","reduce","sum","r","getRecommendations","strugglingAreas","filter","command","params","a","averageScore","recommendations","result","toLowerCase","replace","clearCache","clear","tutoringService"],"sources":["elara-integration.ts"],"sourcesContent":["import axios, { AxiosInstance } from 'axios';\nimport { prisma } from '../index';\nimport { logger } from '../utils/logger';\nimport Joi from 'joi';\n\nconst tutoringQuestionSchema = Joi.object({\n  studentId: Joi.string().required(),\n  enrollmentId: Joi.string().required(),\n  courseId: Joi.string().required(),\n  moduleId: Joi.string().required(),\n  question: Joi.string().required().min(5),\n  context: Joi.object().optional(),\n});\n\ninterface TutoringResponse {\n  id: string;\n  studentId: string;\n  question: string;\n  answer: string;\n  confidence: number;\n  sources: string[];\n  timestamp: Date;\n}\n\ninterface TutoringHistory {\n  studentId: string;\n  totalQuestions: number;\n  responses: TutoringResponse[];\n  averageConfidence: number;\n}\n\nexport class TutoringService {\n  private elaraClient: AxiosInstance;\n  private elaraUrl: string;\n  private responseCache: Map<string, TutoringResponse>;\n  private cacheExpiry: number;\n\n  constructor() {\n    this.elaraUrl = process.env.ELARA_ORCHESTRATOR_URL || 'http://localhost:3009';\n    this.elaraClient = axios.create({\n      baseURL: this.elaraUrl,\n      timeout: 10000,\n    });\n    this.responseCache = new Map();\n    this.cacheExpiry = 3600000; // 1 hour\n  }\n\n  /**\n   * Ask a tutoring question\n   */\n  async askQuestion(data: any): Promise<TutoringResponse> {\n    try {\n      const { error, value } = tutoringQuestionSchema.validate(data);\n      if (error) {\n        throw new Error(`Validation error: ${error.message}`);\n      }\n\n      // Get enrollment and course context\n      const enrollment = await prisma.enrollment.findUnique({\n        where: { id: value.enrollmentId },\n        include: { course: true, student: true },\n      });\n\n      if (!enrollment) {\n        throw new Error('Enrollment not found');\n      }\n\n      const module = await prisma.module.findUnique({\n        where: { id: value.moduleId },\n      });\n\n      if (!module) {\n        throw new Error('Module not found');\n      }\n\n      // Get student's previous learning outcomes for context\n      const outcomes = await prisma.learningOutcome.findMany({\n        where: { enrollmentId: value.enrollmentId },\n        orderBy: { completedAt: 'desc' },\n        take: 5,\n      });\n\n      // Build context for Elara\n      const context = {\n        studentName: enrollment.student.firstName,\n        courseName: enrollment.course.title,\n        moduleName: module.title,\n        studentTier: enrollment.tier,\n        previousOutcomes: outcomes.map((o: any) => ({\n          score: o.assessmentScore,\n          mastery: o.conceptMastery,\n        })),\n        ...value.context,\n      };\n\n      // Check cache first\n      const cacheKey = this.generateCacheKey(value.question, value.courseId);\n      const cachedResponse = this.responseCache.get(cacheKey);\n      if (cachedResponse) {\n        logger.info(`Cache hit for tutoring question: ${value.question}`);\n        return cachedResponse;\n      }\n\n      // Call Elara Orchestrator\n      const response = await this.elaraClient.post('/api/elara/ask', {\n        question: value.question,\n        context,\n      });\n\n      const tutoringResponse: TutoringResponse = {\n        id: `tutoring-${Date.now()}`,\n        studentId: value.studentId,\n        question: value.question,\n        answer: response.data.answer,\n        confidence: response.data.confidence || 0.85,\n        sources: response.data.sources || [],\n        timestamp: new Date(),\n      };\n\n      // Cache the response\n      this.responseCache.set(cacheKey, tutoringResponse);\n      setTimeout(() => this.responseCache.delete(cacheKey), this.cacheExpiry);\n\n      logger.info(`Tutoring question answered for student ${value.studentId}`);\n\n      return tutoringResponse;\n    } catch (error) {\n      logger.error('Error asking tutoring question:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get tutoring history for a student\n   */\n  async getTutoringHistory(studentId: string): Promise<TutoringHistory> {\n    try {\n      // Get all enrollments for the student\n      const enrollments = await prisma.enrollment.findMany({\n        where: { studentId },\n      });\n\n      if (enrollments.length === 0) {\n        return {\n          studentId,\n          totalQuestions: 0,\n          responses: [],\n          averageConfidence: 0,\n        };\n      }\n\n      // In a real implementation, we would store tutoring responses in the database\n      // For now, we'll return a structure that can be extended\n      const responses: TutoringResponse[] = [];\n\n      const history: TutoringHistory = {\n        studentId,\n        totalQuestions: responses.length,\n        responses,\n        averageConfidence:\n          responses.length > 0\n            ? responses.reduce((sum, r) => sum + r.confidence, 0) / responses.length\n            : 0,\n      };\n\n      logger.info(`Retrieved tutoring history for student ${studentId}`);\n\n      return history;\n    } catch (error) {\n      logger.error('Error getting tutoring history:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get personalized tutoring recommendations\n   */\n  async getRecommendations(studentId: string, enrollmentId: string): Promise<any> {\n    try {\n      const enrollment = await prisma.enrollment.findUnique({\n        where: { id: enrollmentId },\n        include: { course: true },\n      });\n\n      if (!enrollment) {\n        throw new Error('Enrollment not found');\n      }\n\n      // Get learning outcomes to identify struggling areas\n      const outcomes = await prisma.learningOutcome.findMany({\n        where: { enrollmentId },\n        orderBy: { completedAt: 'desc' },\n        take: 10,\n      });\n\n      // Identify areas where student is struggling (mastery < 70%)\n      const strugglingAreas = outcomes.filter((o: any) => o.conceptMastery < 70);\n\n      // Call Elara for personalized recommendations\n      const response = await this.elaraClient.post('/api/elara/execute', {\n        command: 'generate-tutoring-recommendations',\n        params: {\n          studentId,\n          courseId: enrollment.courseId,\n          strugglingAreas: strugglingAreas.map((a: any) => ({\n            moduleId: a.moduleId,\n            mastery: a.conceptMastery,\n          })),\n          averageScore:\n            outcomes.length > 0\n              ? outcomes.reduce((sum: number, o: any) => sum + o.assessmentScore, 0) / outcomes.length\n              : 0,\n        },\n      });\n\n      logger.info(`Generated tutoring recommendations for student ${studentId}`);\n\n      return {\n        studentId,\n        enrollmentId,\n        recommendations: response.data.result || [],\n        strugglingAreas: strugglingAreas.length,\n        timestamp: new Date(),\n      };\n    } catch (error) {\n      logger.error('Error getting recommendations:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Generate cache key for tutoring responses\n   */\n  private generateCacheKey(question: string, courseId: string): string {\n    return `tutoring-${courseId}-${question.toLowerCase().replace(/\\s+/g, '-')}`;\n  }\n\n  /**\n   * Clear cache\n   */\n  clearCache(): void {\n    this.responseCache.clear();\n    logger.info('Tutoring response cache cleared');\n  }\n}\n\nexport const tutoringService = new TutoringService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}