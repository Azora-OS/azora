{"version":3,"names":["cov_pkhunzps4","actualCoverage","Redis","createHash","RedisCacheManager","constructor","redisUrl","b","keyPrefix","defaultTTL","f","s","redis","generateQueryHash","query","update","digest","getCacheKey","queryHash","getStatsKey","get","key","data","hincrby","entry","JSON","parse","hitCount","set","stringify","ttl","error","console","delete","deleted","del","clear","pattern","keys","length","getStats","stats","hgetall","hits","parseInt","misses","size","cacheRoutingDecision","response","tier","cost","id","Date","now","routingTier","expiresAt","getCacheHitRate","total","cleanup","cleaned","close","quit"],"sources":["redis-cache-manager.ts"],"sourcesContent":["/**\n * Redis Cache Manager for AI Routing\n * Manages caching of routing decisions and responses\n */\n\nimport Redis from 'ioredis';\nimport { createHash } from 'crypto';\nimport { CacheEntry, ICacheManager, RoutingTier } from './types';\n\nexport class RedisCacheManager implements ICacheManager {\n  private redis: Redis;\n  private keyPrefix: string;\n  private defaultTTL: number; // seconds\n\n  constructor(redisUrl: string = 'redis://localhost:6379', keyPrefix: string = 'ai-routing:', defaultTTL: number = 3600) {\n    this.redis = new Redis(redisUrl);\n    this.keyPrefix = keyPrefix;\n    this.defaultTTL = defaultTTL;\n  }\n\n  /**\n   * Generate hash for query to use as cache key\n   */\n  private generateQueryHash(query: string): string {\n    return createHash('sha256').update(query).digest('hex');\n  }\n\n  /**\n   * Get cache key with prefix\n   */\n  private getCacheKey(queryHash: string): string {\n    return `${this.keyPrefix}cache:${queryHash}`;\n  }\n\n  /**\n   * Get stats key\n   */\n  private getStatsKey(): string {\n    return `${this.keyPrefix}stats`;\n  }\n\n  /**\n   * Retrieve cached entry by query hash\n   */\n  async get(queryHash: string): Promise<CacheEntry | null> {\n    try {\n      const key = this.getCacheKey(queryHash);\n      const data = await this.redis.get(key);\n\n      if (!data) {\n        // Record cache miss\n        await this.redis.hincrby(this.getStatsKey(), 'misses', 1);\n        return null;\n      }\n\n      // Record cache hit\n      await this.redis.hincrby(this.getStatsKey(), 'hits', 1);\n\n      // Increment hit count\n      const entry = JSON.parse(data) as CacheEntry;\n      entry.hitCount += 1;\n      await this.redis.set(key, JSON.stringify(entry), 'EX', entry.ttl);\n\n      return entry;\n    } catch (error) {\n      console.error('Error retrieving from cache:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Store entry in cache\n   */\n  async set(entry: CacheEntry): Promise<void> {\n    try {\n      const key = this.getCacheKey(entry.queryHash);\n      const ttl = entry.ttl || this.defaultTTL;\n\n      await this.redis.set(\n        key,\n        JSON.stringify(entry),\n        'EX',\n        ttl\n      );\n\n      // Update cache size\n      await this.redis.hincrby(this.getStatsKey(), 'size', 1);\n    } catch (error) {\n      console.error('Error storing in cache:', error);\n    }\n  }\n\n  /**\n   * Delete entry from cache\n   */\n  async delete(queryHash: string): Promise<void> {\n    try {\n      const key = this.getCacheKey(queryHash);\n      const deleted = await this.redis.del(key);\n\n      if (deleted > 0) {\n        await this.redis.hincrby(this.getStatsKey(), 'size', -1);\n      }\n    } catch (error) {\n      console.error('Error deleting from cache:', error);\n    }\n  }\n\n  /**\n   * Clear all cache entries\n   */\n  async clear(): Promise<void> {\n    try {\n      const pattern = `${this.keyPrefix}cache:*`;\n      const keys = await this.redis.keys(pattern);\n\n      if (keys.length > 0) {\n        await this.redis.del(...keys);\n      }\n\n      // Reset stats\n      await this.redis.del(this.getStatsKey());\n    } catch (error) {\n      console.error('Error clearing cache:', error);\n    }\n  }\n\n  /**\n   * Get cache statistics\n   */\n  async getStats(): Promise<{ hits: number; misses: number; size: number }> {\n    try {\n      const stats = await this.redis.hgetall(this.getStatsKey());\n\n      return {\n        hits: parseInt(stats.hits || '0', 10),\n        misses: parseInt(stats.misses || '0', 10),\n        size: parseInt(stats.size || '0', 10)\n      };\n    } catch (error) {\n      console.error('Error getting cache stats:', error);\n      return { hits: 0, misses: 0, size: 0 };\n    }\n  }\n\n  /**\n   * Store routing decision in cache\n   */\n  async cacheRoutingDecision(\n    query: string,\n    response: string,\n    tier: RoutingTier,\n    cost: number,\n    ttl?: number\n  ): Promise<string> {\n    const queryHash = this.generateQueryHash(query);\n    const entry: CacheEntry = {\n      id: `cache-${Date.now()}`,\n      queryHash,\n      query,\n      response,\n      routingTier: tier,\n      cost,\n      ttl: ttl || this.defaultTTL,\n      expiresAt: new Date(Date.now() + (ttl || this.defaultTTL) * 1000),\n      hitCount: 0\n    };\n\n    await this.set(entry);\n    return queryHash;\n  }\n\n  /**\n   * Get cache hit rate\n   */\n  async getCacheHitRate(): Promise<number> {\n    try {\n      const stats = await this.getStats();\n      const total = stats.hits + stats.misses;\n\n      if (total === 0) {return 0;}\n      return (stats.hits / total) * 100;\n    } catch (error) {\n      console.error('Error calculating cache hit rate:', error);\n      return 0;\n    }\n  }\n\n  /**\n   * Cleanup expired entries (optional maintenance)\n   */\n  async cleanup(): Promise<number> {\n    try {\n      const pattern = `${this.keyPrefix}cache:*`;\n      const keys = await this.redis.keys(pattern);\n      let cleaned = 0;\n\n      for (const key of keys) {\n        const ttl = await this.redis.ttl(key);\n        if (ttl === -1) {\n          // Key has no expiration, delete it\n          await this.redis.del(key);\n          cleaned++;\n        }\n      }\n\n      return cleaned;\n    } catch (error) {\n      console.error('Error during cache cleanup:', error);\n      return 0;\n    }\n  }\n\n  /**\n   * Close Redis connection\n   */\n  async close(): Promise<void> {\n    try {\n      await this.redis.quit();\n    } catch (error) {\n      console.error('Error closing Redis connection:', error);\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAfZ;AACA;AACA;AACA;;AAEA,OAAOE,KAAK,MAAM,SAAS;AAC3B,SAASC,UAAU,QAAQ,QAAQ;AAGnC,OAAO,MAAMC,iBAAiB,CAA0B;EAG1B;;EAE5BC,WAAWA,CAACC,QAAgB;EAAA;EAAA,CAAAN,aAAA,GAAAO,CAAA,UAAG,wBAAwB,GAAEC,SAAiB;EAAA;EAAA,CAAAR,aAAA,GAAAO,CAAA,UAAG,aAAa,GAAEE,UAAkB;EAAA;EAAA,CAAAT,aAAA,GAAAO,CAAA,UAAG,IAAI,GAAE;IAAA;IAAAP,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IACrH,IAAI,CAACC,KAAK,GAAG,IAAIV,KAAK,CAACI,QAAQ,CAAC;IAAC;IAAAN,aAAA,GAAAW,CAAA;IACjC,IAAI,CAACH,SAAS,GAAGA,SAAS;IAAC;IAAAR,aAAA,GAAAW,CAAA;IAC3B,IAAI,CAACF,UAAU,GAAGA,UAAU;EAC9B;;EAEA;AACF;AACA;EACUI,iBAAiBA,CAACC,KAAa,EAAU;IAAA;IAAAd,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IAC/C,OAAOR,UAAU,CAAC,QAAQ,CAAC,CAACY,MAAM,CAACD,KAAK,CAAC,CAACE,MAAM,CAAC,KAAK,CAAC;EACzD;;EAEA;AACF;AACA;EACUC,WAAWA,CAACC,SAAiB,EAAU;IAAA;IAAAlB,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IAC7C,OAAO,GAAG,IAAI,CAACH,SAAS,SAASU,SAAS,EAAE;EAC9C;;EAEA;AACF;AACA;EACUC,WAAWA,CAAA,EAAW;IAAA;IAAAnB,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IAC5B,OAAO,GAAG,IAAI,CAACH,SAAS,OAAO;EACjC;;EAEA;AACF;AACA;EACE,MAAMY,GAAGA,CAACF,SAAiB,EAA8B;IAAA;IAAAlB,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IACvD,IAAI;MACF,MAAMU,GAAG;MAAA;MAAA,CAAArB,aAAA,GAAAW,CAAA,OAAG,IAAI,CAACM,WAAW,CAACC,SAAS,CAAC;MACvC,MAAMI,IAAI;MAAA;MAAA,CAAAtB,aAAA,GAAAW,CAAA,OAAG,MAAM,IAAI,CAACC,KAAK,CAACQ,GAAG,CAACC,GAAG,CAAC;MAAC;MAAArB,aAAA,GAAAW,CAAA;MAEvC,IAAI,CAACW,IAAI,EAAE;QAAA;QAAAtB,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAW,CAAA;QACT;QACA,MAAM,IAAI,CAACC,KAAK,CAACW,OAAO,CAAC,IAAI,CAACJ,WAAW,CAAC,CAAC,EAAE,QAAQ,EAAE,CAAC,CAAC;QAAC;QAAAnB,aAAA,GAAAW,CAAA;QAC1D,OAAO,IAAI;MACb,CAAC;MAAA;MAAA;QAAAX,aAAA,GAAAO,CAAA;MAAA;;MAED;MAAAP,aAAA,GAAAW,CAAA;MACA,MAAM,IAAI,CAACC,KAAK,CAACW,OAAO,CAAC,IAAI,CAACJ,WAAW,CAAC,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;;MAEvD;MACA,MAAMK,KAAK;MAAA;MAAA,CAAAxB,aAAA,GAAAW,CAAA,QAAGc,IAAI,CAACC,KAAK,CAACJ,IAAI,CAAC,CAAc;MAAC;MAAAtB,aAAA,GAAAW,CAAA;MAC7Ca,KAAK,CAACG,QAAQ,IAAI,CAAC;MAAC;MAAA3B,aAAA,GAAAW,CAAA;MACpB,MAAM,IAAI,CAACC,KAAK,CAACgB,GAAG,CAACP,GAAG,EAAEI,IAAI,CAACI,SAAS,CAACL,KAAK,CAAC,EAAE,IAAI,EAAEA,KAAK,CAACM,GAAG,CAAC;MAAC;MAAA9B,aAAA,GAAAW,CAAA;MAElE,OAAOa,KAAK;IACd,CAAC,CAAC,OAAOO,KAAK,EAAE;MAAA;MAAA/B,aAAA,GAAAW,CAAA;MACdqB,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MAAC;MAAA/B,aAAA,GAAAW,CAAA;MACrD,OAAO,IAAI;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMiB,GAAGA,CAACJ,KAAiB,EAAiB;IAAA;IAAAxB,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IAC1C,IAAI;MACF,MAAMU,GAAG;MAAA;MAAA,CAAArB,aAAA,GAAAW,CAAA,QAAG,IAAI,CAACM,WAAW,CAACO,KAAK,CAACN,SAAS,CAAC;MAC7C,MAAMY,GAAG;MAAA;MAAA,CAAA9B,aAAA,GAAAW,CAAA;MAAG;MAAA,CAAAX,aAAA,GAAAO,CAAA,UAAAiB,KAAK,CAACM,GAAG;MAAA;MAAA,CAAA9B,aAAA,GAAAO,CAAA,UAAI,IAAI,CAACE,UAAU;MAAC;MAAAT,aAAA,GAAAW,CAAA;MAEzC,MAAM,IAAI,CAACC,KAAK,CAACgB,GAAG,CAClBP,GAAG,EACHI,IAAI,CAACI,SAAS,CAACL,KAAK,CAAC,EACrB,IAAI,EACJM,GACF,CAAC;;MAED;MAAA;MAAA9B,aAAA,GAAAW,CAAA;MACA,MAAM,IAAI,CAACC,KAAK,CAACW,OAAO,CAAC,IAAI,CAACJ,WAAW,CAAC,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;IACzD,CAAC,CAAC,OAAOY,KAAK,EAAE;MAAA;MAAA/B,aAAA,GAAAW,CAAA;MACdqB,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IACjD;EACF;;EAEA;AACF;AACA;EACE,MAAME,MAAMA,CAACf,SAAiB,EAAiB;IAAA;IAAAlB,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IAC7C,IAAI;MACF,MAAMU,GAAG;MAAA;MAAA,CAAArB,aAAA,GAAAW,CAAA,QAAG,IAAI,CAACM,WAAW,CAACC,SAAS,CAAC;MACvC,MAAMgB,OAAO;MAAA;MAAA,CAAAlC,aAAA,GAAAW,CAAA,QAAG,MAAM,IAAI,CAACC,KAAK,CAACuB,GAAG,CAACd,GAAG,CAAC;MAAC;MAAArB,aAAA,GAAAW,CAAA;MAE1C,IAAIuB,OAAO,GAAG,CAAC,EAAE;QAAA;QAAAlC,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAW,CAAA;QACf,MAAM,IAAI,CAACC,KAAK,CAACW,OAAO,CAAC,IAAI,CAACJ,WAAW,CAAC,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC;MAC1D,CAAC;MAAA;MAAA;QAAAnB,aAAA,GAAAO,CAAA;MAAA;IACH,CAAC,CAAC,OAAOwB,KAAK,EAAE;MAAA;MAAA/B,aAAA,GAAAW,CAAA;MACdqB,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;IACpD;EACF;;EAEA;AACF;AACA;EACE,MAAMK,KAAKA,CAAA,EAAkB;IAAA;IAAApC,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IAC3B,IAAI;MACF,MAAM0B,OAAO;MAAA;MAAA,CAAArC,aAAA,GAAAW,CAAA,QAAG,GAAG,IAAI,CAACH,SAAS,SAAS;MAC1C,MAAM8B,IAAI;MAAA;MAAA,CAAAtC,aAAA,GAAAW,CAAA,QAAG,MAAM,IAAI,CAACC,KAAK,CAAC0B,IAAI,CAACD,OAAO,CAAC;MAAC;MAAArC,aAAA,GAAAW,CAAA;MAE5C,IAAI2B,IAAI,CAACC,MAAM,GAAG,CAAC,EAAE;QAAA;QAAAvC,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAW,CAAA;QACnB,MAAM,IAAI,CAACC,KAAK,CAACuB,GAAG,CAAC,GAAGG,IAAI,CAAC;MAC/B,CAAC;MAAA;MAAA;QAAAtC,aAAA,GAAAO,CAAA;MAAA;;MAED;MAAAP,aAAA,GAAAW,CAAA;MACA,MAAM,IAAI,CAACC,KAAK,CAACuB,GAAG,CAAC,IAAI,CAAChB,WAAW,CAAC,CAAC,CAAC;IAC1C,CAAC,CAAC,OAAOY,KAAK,EAAE;MAAA;MAAA/B,aAAA,GAAAW,CAAA;MACdqB,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;IAC/C;EACF;;EAEA;AACF;AACA;EACE,MAAMS,QAAQA,CAAA,EAA4D;IAAA;IAAAxC,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IACxE,IAAI;MACF,MAAM8B,KAAK;MAAA;MAAA,CAAAzC,aAAA,GAAAW,CAAA,QAAG,MAAM,IAAI,CAACC,KAAK,CAAC8B,OAAO,CAAC,IAAI,CAACvB,WAAW,CAAC,CAAC,CAAC;MAAC;MAAAnB,aAAA,GAAAW,CAAA;MAE3D,OAAO;QACLgC,IAAI,EAAEC,QAAQ;QAAC;QAAA,CAAA5C,aAAA,GAAAO,CAAA,UAAAkC,KAAK,CAACE,IAAI;QAAA;QAAA,CAAA3C,aAAA,GAAAO,CAAA,UAAI,GAAG,GAAE,EAAE,CAAC;QACrCsC,MAAM,EAAED,QAAQ;QAAC;QAAA,CAAA5C,aAAA,GAAAO,CAAA,UAAAkC,KAAK,CAACI,MAAM;QAAA;QAAA,CAAA7C,aAAA,GAAAO,CAAA,UAAI,GAAG,GAAE,EAAE,CAAC;QACzCuC,IAAI,EAAEF,QAAQ;QAAC;QAAA,CAAA5C,aAAA,GAAAO,CAAA,UAAAkC,KAAK,CAACK,IAAI;QAAA;QAAA,CAAA9C,aAAA,GAAAO,CAAA,UAAI,GAAG,GAAE,EAAE;MACtC,CAAC;IACH,CAAC,CAAC,OAAOwB,KAAK,EAAE;MAAA;MAAA/B,aAAA,GAAAW,CAAA;MACdqB,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAAC;MAAA/B,aAAA,GAAAW,CAAA;MACnD,OAAO;QAAEgC,IAAI,EAAE,CAAC;QAAEE,MAAM,EAAE,CAAC;QAAEC,IAAI,EAAE;MAAE,CAAC;IACxC;EACF;;EAEA;AACF;AACA;EACE,MAAMC,oBAAoBA,CACxBjC,KAAa,EACbkC,QAAgB,EAChBC,IAAiB,EACjBC,IAAY,EACZpB,GAAY,EACK;IAAA;IAAA9B,aAAA,GAAAU,CAAA;IACjB,MAAMQ,SAAS;IAAA;IAAA,CAAAlB,aAAA,GAAAW,CAAA,QAAG,IAAI,CAACE,iBAAiB,CAACC,KAAK,CAAC;IAC/C,MAAMU,KAAiB;IAAA;IAAA,CAAAxB,aAAA,GAAAW,CAAA,QAAG;MACxBwC,EAAE,EAAE,SAASC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;MACzBnC,SAAS;MACTJ,KAAK;MACLkC,QAAQ;MACRM,WAAW,EAAEL,IAAI;MACjBC,IAAI;MACJpB,GAAG;MAAE;MAAA,CAAA9B,aAAA,GAAAO,CAAA,WAAAuB,GAAG;MAAA;MAAA,CAAA9B,aAAA,GAAAO,CAAA,WAAI,IAAI,CAACE,UAAU;MAC3B8C,SAAS,EAAE,IAAIH,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG;MAAC;MAAA,CAAArD,aAAA,GAAAO,CAAA,WAAAuB,GAAG;MAAA;MAAA,CAAA9B,aAAA,GAAAO,CAAA,WAAI,IAAI,CAACE,UAAU,KAAI,IAAI,CAAC;MACjEkB,QAAQ,EAAE;IACZ,CAAC;IAAC;IAAA3B,aAAA,GAAAW,CAAA;IAEF,MAAM,IAAI,CAACiB,GAAG,CAACJ,KAAK,CAAC;IAAC;IAAAxB,aAAA,GAAAW,CAAA;IACtB,OAAOO,SAAS;EAClB;;EAEA;AACF;AACA;EACE,MAAMsC,eAAeA,CAAA,EAAoB;IAAA;IAAAxD,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IACvC,IAAI;MACF,MAAM8B,KAAK;MAAA;MAAA,CAAAzC,aAAA,GAAAW,CAAA,QAAG,MAAM,IAAI,CAAC6B,QAAQ,CAAC,CAAC;MACnC,MAAMiB,KAAK;MAAA;MAAA,CAAAzD,aAAA,GAAAW,CAAA,QAAG8B,KAAK,CAACE,IAAI,GAAGF,KAAK,CAACI,MAAM;MAAC;MAAA7C,aAAA,GAAAW,CAAA;MAExC,IAAI8C,KAAK,KAAK,CAAC,EAAE;QAAA;QAAAzD,aAAA,GAAAO,CAAA;QAAAP,aAAA,GAAAW,CAAA;QAAC,OAAO,CAAC;MAAC,CAAC;MAAA;MAAA;QAAAX,aAAA,GAAAO,CAAA;MAAA;MAAAP,aAAA,GAAAW,CAAA;MAC5B,OAAQ8B,KAAK,CAACE,IAAI,GAAGc,KAAK,GAAI,GAAG;IACnC,CAAC,CAAC,OAAO1B,KAAK,EAAE;MAAA;MAAA/B,aAAA,GAAAW,CAAA;MACdqB,OAAO,CAACD,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;MAAC;MAAA/B,aAAA,GAAAW,CAAA;MAC1D,OAAO,CAAC;IACV;EACF;;EAEA;AACF;AACA;EACE,MAAM+C,OAAOA,CAAA,EAAoB;IAAA;IAAA1D,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IAC/B,IAAI;MACF,MAAM0B,OAAO;MAAA;MAAA,CAAArC,aAAA,GAAAW,CAAA,QAAG,GAAG,IAAI,CAACH,SAAS,SAAS;MAC1C,MAAM8B,IAAI;MAAA;MAAA,CAAAtC,aAAA,GAAAW,CAAA,QAAG,MAAM,IAAI,CAACC,KAAK,CAAC0B,IAAI,CAACD,OAAO,CAAC;MAC3C,IAAIsB,OAAO;MAAA;MAAA,CAAA3D,aAAA,GAAAW,CAAA,QAAG,CAAC;MAAC;MAAAX,aAAA,GAAAW,CAAA;MAEhB,KAAK,MAAMU,GAAG,IAAIiB,IAAI,EAAE;QACtB,MAAMR,GAAG;QAAA;QAAA,CAAA9B,aAAA,GAAAW,CAAA,QAAG,MAAM,IAAI,CAACC,KAAK,CAACkB,GAAG,CAACT,GAAG,CAAC;QAAC;QAAArB,aAAA,GAAAW,CAAA;QACtC,IAAImB,GAAG,KAAK,CAAC,CAAC,EAAE;UAAA;UAAA9B,aAAA,GAAAO,CAAA;UAAAP,aAAA,GAAAW,CAAA;UACd;UACA,MAAM,IAAI,CAACC,KAAK,CAACuB,GAAG,CAACd,GAAG,CAAC;UAAC;UAAArB,aAAA,GAAAW,CAAA;UAC1BgD,OAAO,EAAE;QACX,CAAC;QAAA;QAAA;UAAA3D,aAAA,GAAAO,CAAA;QAAA;MACH;MAAC;MAAAP,aAAA,GAAAW,CAAA;MAED,OAAOgD,OAAO;IAChB,CAAC,CAAC,OAAO5B,KAAK,EAAE;MAAA;MAAA/B,aAAA,GAAAW,CAAA;MACdqB,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MAAC;MAAA/B,aAAA,GAAAW,CAAA;MACpD,OAAO,CAAC;IACV;EACF;;EAEA;AACF;AACA;EACE,MAAMiD,KAAKA,CAAA,EAAkB;IAAA;IAAA5D,aAAA,GAAAU,CAAA;IAAAV,aAAA,GAAAW,CAAA;IAC3B,IAAI;MAAA;MAAAX,aAAA,GAAAW,CAAA;MACF,MAAM,IAAI,CAACC,KAAK,CAACiD,IAAI,CAAC,CAAC;IACzB,CAAC,CAAC,OAAO9B,KAAK,EAAE;MAAA;MAAA/B,aAAA,GAAAW,CAAA;MACdqB,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;IACzD;EACF;AACF","ignoreList":[]}