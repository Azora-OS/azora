{"version":3,"names":["cov_imnz1ticc","actualCoverage","ConstitutionalValidator","rules","s","constructor","f","initializeRules","push","id","name","principle","condition","context","errorMessage","validatePre","request","violations","warnings","rule","passes","b","error","console","valid","length","validatePost","compliant","auditRecord","userId","action","timestamp","Date","toISOString","resultHash","hashResult","result","getRules","JSON","stringify","substring"],"sources":["validator.ts"],"sourcesContent":["/**\n * Constitutional Validator\n * Enforces DIVINE LAW principles and Constitutional rules\n * \n * DIVINE LAW PRINCIPLES:\n * 1. Transparency: All decisions must be auditable\n * 2. Accountability: Actions must have clear ownership\n * 3. Fairness: Treat all users equitably\n * 4. Safety: Reject harmful or dangerous actions\n * 5. Respect: Honor user autonomy and privacy\n * 6. Growth: Enable learning and improvement\n */\n\ninterface ValidationRule {\n  id: string;\n  name: string;\n  principle: 'transparency' | 'accountability' | 'fairness' | 'safety' | 'respect' | 'growth';\n  condition: (context: Record<string, unknown>) => boolean;\n  errorMessage: string;\n}\n\ninterface PreValidationRequest {\n  action: string;\n  context?: Record<string, unknown>;\n  userId?: string;\n}\n\ninterface PreValidationResult {\n  valid: boolean;\n  violations: string[];\n  warnings: string[];\n}\n\ninterface PostValidationRequest {\n  action: string;\n  result: Record<string, unknown>;\n  userId?: string;\n}\n\ninterface PostValidationResult {\n  compliant: boolean;\n  violations: string[];\n  auditRecord: Record<string, unknown>;\n}\n\nexport class ConstitutionalValidator {\n  private rules: ValidationRule[] = [];\n\n  constructor() {\n    this.initializeRules();\n  }\n\n  /**\n   * Initialize constitutional rules (stub)\n   */\n  private initializeRules() {\n    // TODO: Load rules from CONSTITUTION.md and AZORA_CONSTITUTION.md\n    // For now, add placeholder rules\n    this.rules.push({\n      id: 'safety-1',\n      name: 'No harmful actions',\n      principle: 'safety',\n      condition: (context) => {\n        // Check if action is harmful\n        return true;\n      },\n      errorMessage: 'Action violates safety principle'\n    });\n  }\n\n  /**\n   * Validate action BEFORE execution\n   */\n  async validatePre(request: PreValidationRequest): Promise<PreValidationResult> {\n    const violations: string[] = [];\n    const warnings: string[] = [];\n\n    // Check each rule\n    for (const rule of this.rules) {\n      try {\n        const passes = rule.condition(request.context || {});\n        if (!passes) {\n          if (rule.principle === 'safety') {\n            violations.push(rule.errorMessage);\n          } else {\n            warnings.push(rule.errorMessage);\n          }\n        }\n      } catch (error) {\n        console.error(`Rule ${rule.id} failed:`, error);\n      }\n    }\n\n    return {\n      valid: violations.length === 0,\n      violations,\n      warnings\n    };\n  }\n\n  /**\n   * Validate action AFTER execution\n   */\n  async validatePost(request: PostValidationRequest): Promise<PostValidationResult> {\n    const violations: string[] = [];\n\n    // TODO: Verify result matches expected constitutional constraints\n    // Check audit trail, permissions, etc.\n\n    return {\n      compliant: violations.length === 0,\n      violations,\n      auditRecord: {\n        userId: request.userId,\n        action: request.action,\n        timestamp: new Date().toISOString(),\n        resultHash: this.hashResult(request.result)\n      }\n    };\n  }\n\n  /**\n   * Get all active rules\n   */\n  getRules(): ValidationRule[] {\n    return this.rules;\n  }\n\n  /**\n   * Hash result for audit trail\n   */\n  private hashResult(result: Record<string, unknown>): string {\n    // TODO: Implement proper hash (SHA-256)\n    return JSON.stringify(result).substring(0, 8);\n  }\n}\n"],"mappings":"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","ignoreList":[]}