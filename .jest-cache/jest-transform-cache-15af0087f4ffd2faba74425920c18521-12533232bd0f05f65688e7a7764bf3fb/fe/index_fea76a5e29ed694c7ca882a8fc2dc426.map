{"version":3,"names":["cov_14eqjcx8c2","actualCoverage","express","cors","helmet","dotenv","ChaosScheduler","s","config","app","PORT","b","process","env","use","json","chaosConfig","enabled","CHAOS_ENABLED","intensity","CHAOS_INTENSITY","targetServices","excludeServices","schedule","frequency","CHAOS_SCHEDULE","duration","parseInt","CHAOS_DURATION","requireApproval","CHAOS_REQUIRE_APPROVAL","chaosScheduler","get","req","res","f","status","service","timestamp","Date","toISOString","history","getHistory","success","data","count","length","error","message","activeEvents","getActiveEvents","post","start","console","log","listen"],"sources":["index.ts"],"sourcesContent":["import express from 'express';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport dotenv from 'dotenv';\nimport { ChaosScheduler } from './src/chaos-scheduler';\nimport { ChaosConfig } from './src/failure-types';\n\ndotenv.config();\n\nconst app = express();\nconst PORT = process.env.PORT || 3050;\n\napp.use(helmet());\napp.use(cors());\napp.use(express.json());\n\n// Chaos configuration\nconst chaosConfig: ChaosConfig = {\n    enabled: process.env.CHAOS_ENABLED === 'true',\n    intensity: (process.env.CHAOS_INTENSITY as 'low' | 'medium' | 'high') || 'low',\n    targetServices: [\n        'azora-education',\n        'azora-sapiens',\n        'azora-marketplace',\n        'azora-assessment'\n    ],\n    excludeServices: [\n        'azora-auth',           // Never crash auth\n        'azora-pay',            // Never crash payments\n        'azora-mint',           // Never crash blockchain\n        'constitutional-ai',    // Never crash the superego\n        'phoenix-server'        // Never crash the recovery system\n    ],\n    schedule: {\n        frequency: process.env.CHAOS_SCHEDULE || '0 2 * * *', // 2 AM daily\n        duration: parseInt(process.env.CHAOS_DURATION || '30') // 30 minutes\n    },\n    requireApproval: process.env.CHAOS_REQUIRE_APPROVAL !== 'false'\n};\n\nconst chaosScheduler = new ChaosScheduler(chaosConfig);\n\n// Health check\napp.get('/health', (req, res) => {\n    res.json({\n        status: 'healthy',\n        service: 'chaos-monkey',\n        enabled: chaosConfig.enabled,\n        intensity: chaosConfig.intensity,\n        timestamp: new Date().toISOString()\n    });\n});\n\n// Get chaos history\napp.get('/api/chaos/history', (req, res) => {\n    try {\n        const history = chaosScheduler.getHistory();\n        res.json({\n            success: true,\n            data: history,\n            count: history.length\n        });\n    } catch (error) {\n        res.status(500).json({ error: error.message });\n    }\n});\n\n// Get active chaos events\napp.get('/api/chaos/active', (req, res) => {\n    try {\n        const activeEvents = chaosScheduler.getActiveEvents();\n        res.json({\n            success: true,\n            data: activeEvents,\n            count: activeEvents.length\n        });\n    } catch (error) {\n        res.status(500).json({ error: error.message });\n    }\n});\n\n// Manually trigger chaos (requires approval)\napp.post('/api/chaos/trigger', async (req, res) => {\n    try {\n        if (!chaosConfig.enabled) {\n            return res.status(403).json({ error: 'Chaos Monkey is disabled' });\n        }\n\n        // This would trigger a single chaos event\n        res.json({\n            success: true,\n            message: 'Manual chaos trigger not yet implemented'\n        });\n    } catch (error) {\n        res.status(500).json({ error: error.message });\n    }\n});\n\n// Start chaos scheduler if enabled\nif (chaosConfig.enabled) {\n    chaosScheduler.start();\n    console.log('üêµ ChaosMonkey scheduler started');\n} else {\n    console.log('üêµ ChaosMonkey is DISABLED (set CHAOS_ENABLED=true to enable)');\n}\n\napp.listen(PORT, () => {\n    console.log(`üêµ ChaosMonkey service running on port ${PORT}`);\n});\n\nexport default app;\n"],"mappings":"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","ignoreList":[]}