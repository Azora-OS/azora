{"version":3,"names":["cov_1x2ljflh0","actualCoverage","PrincipleCategory","VerdictType","CritiqueEngine","evaluate","request","f","violations","s","promptLower","prompt","toLowerCase","b","includes","push","ruleId","category","SECURITY","reasoning","suggestion","FAIRNESS","PRIVACY","verdict","ALLOW","some","v","REJECT","length","FLAG","confidence","timestamp","Date","toISOString","critiqueEngine"],"sources":["engine.ts"],"sourcesContent":["import { AZORA_CONSTITUTION, PrincipleCategory } from '../constitution/rules';\nimport { CritiqueRequest, CritiqueVerdict, VerdictType, CritiqueViolation } from './types';\n\nexport class CritiqueEngine {\n\n    /**\n     * Evaluates a request against the Azora Constitution.\n     * In a production environment, this would call an LLM (Elara) to perform semantic analysis.\n     * For now, we use a heuristic keyword-based approach to simulate the Constitutional Guardrails.\n     */\n    async evaluate(request: CritiqueRequest): Promise<CritiqueVerdict> {\n        const violations: CritiqueViolation[] = [];\n        const promptLower = request.prompt.toLowerCase();\n\n        // 1. Check for Security Violations (S1, S2)\n        if (promptLower.includes('hack') || promptLower.includes('exploit') || promptLower.includes('malware') || promptLower.includes('ddos')) {\n            violations.push({\n                ruleId: 'S1',\n                category: PrincipleCategory.SECURITY,\n                reasoning: 'Request contains keywords associated with malicious activity or security vulnerabilities.',\n                suggestion: 'Refrain from generating code or content intended to compromise systems.'\n            });\n        }\n\n        // 2. Check for Fairness/Bias (F1)\n        if (promptLower.includes('racist') || promptLower.includes('hate') || promptLower.includes('discrimination')) {\n            violations.push({\n                ruleId: 'F1',\n                category: PrincipleCategory.FAIRNESS,\n                reasoning: 'Request contains content that may violate fairness and non-discrimination principles.',\n                suggestion: 'Ensure content is inclusive and free from harmful bias.'\n            });\n        }\n\n        // 3. Check for Privacy (P1)\n        if (promptLower.includes('ssn') || promptLower.includes('credit card') || promptLower.includes('password')) {\n            violations.push({\n                ruleId: 'P1',\n                category: PrincipleCategory.PRIVACY,\n                reasoning: 'Request appears to involve Personally Identifiable Information (PII) or sensitive credentials.',\n                suggestion: 'Do not process or store PII without explicit consent and encryption.'\n            });\n        }\n\n        // Determine Verdict\n        let verdict = VerdictType.ALLOW;\n        if (violations.some(v => v.category === PrincipleCategory.SECURITY || v.category === PrincipleCategory.PRIVACY)) {\n            verdict = VerdictType.REJECT;\n        } else if (violations.length > 0) {\n            verdict = VerdictType.FLAG; // Flag for review but maybe allow with warning\n        }\n\n        return {\n            verdict,\n            violations,\n            confidence: 0.95, // High confidence in keyword match\n            timestamp: new Date().toISOString()\n        };\n    }\n}\n\nexport const critiqueEngine = new CritiqueEngine();\n"],"mappings":"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","ignoreList":[]}