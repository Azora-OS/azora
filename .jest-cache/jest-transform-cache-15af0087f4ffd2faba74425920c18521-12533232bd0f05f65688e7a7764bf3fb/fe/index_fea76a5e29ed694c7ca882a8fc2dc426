12509c971b516e0a820671b1e0286fa9
/* istanbul ignore next */
function cov_14eqjcx8c2() {
  var path = "/workspaces/azora/services/chaos-monkey/index.ts";
  var hash = "6a144c222390ced9aced537a580551baa3c8194a";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/chaos-monkey/index.ts",
    statementMap: {
      "0": {
        start: {
          line: 8,
          column: 0
        },
        end: {
          line: 8,
          column: 16
        }
      },
      "1": {
        start: {
          line: 10,
          column: 12
        },
        end: {
          line: 10,
          column: 21
        }
      },
      "2": {
        start: {
          line: 11,
          column: 13
        },
        end: {
          line: 11,
          column: 37
        }
      },
      "3": {
        start: {
          line: 13,
          column: 0
        },
        end: {
          line: 13,
          column: 18
        }
      },
      "4": {
        start: {
          line: 14,
          column: 0
        },
        end: {
          line: 14,
          column: 16
        }
      },
      "5": {
        start: {
          line: 15,
          column: 0
        },
        end: {
          line: 15,
          column: 24
        }
      },
      "6": {
        start: {
          line: 18,
          column: 33
        },
        end: {
          line: 39,
          column: 1
        }
      },
      "7": {
        start: {
          line: 41,
          column: 23
        },
        end: {
          line: 41,
          column: 54
        }
      },
      "8": {
        start: {
          line: 44,
          column: 0
        },
        end: {
          line: 52,
          column: 3
        }
      },
      "9": {
        start: {
          line: 45,
          column: 4
        },
        end: {
          line: 51,
          column: 7
        }
      },
      "10": {
        start: {
          line: 55,
          column: 0
        },
        end: {
          line: 66,
          column: 3
        }
      },
      "11": {
        start: {
          line: 56,
          column: 4
        },
        end: {
          line: 65,
          column: 5
        }
      },
      "12": {
        start: {
          line: 57,
          column: 24
        },
        end: {
          line: 57,
          column: 51
        }
      },
      "13": {
        start: {
          line: 58,
          column: 8
        },
        end: {
          line: 62,
          column: 11
        }
      },
      "14": {
        start: {
          line: 64,
          column: 8
        },
        end: {
          line: 64,
          column: 55
        }
      },
      "15": {
        start: {
          line: 69,
          column: 0
        },
        end: {
          line: 80,
          column: 3
        }
      },
      "16": {
        start: {
          line: 70,
          column: 4
        },
        end: {
          line: 79,
          column: 5
        }
      },
      "17": {
        start: {
          line: 71,
          column: 29
        },
        end: {
          line: 71,
          column: 61
        }
      },
      "18": {
        start: {
          line: 72,
          column: 8
        },
        end: {
          line: 76,
          column: 11
        }
      },
      "19": {
        start: {
          line: 78,
          column: 8
        },
        end: {
          line: 78,
          column: 55
        }
      },
      "20": {
        start: {
          line: 83,
          column: 0
        },
        end: {
          line: 97,
          column: 3
        }
      },
      "21": {
        start: {
          line: 84,
          column: 4
        },
        end: {
          line: 96,
          column: 5
        }
      },
      "22": {
        start: {
          line: 85,
          column: 8
        },
        end: {
          line: 87,
          column: 9
        }
      },
      "23": {
        start: {
          line: 86,
          column: 12
        },
        end: {
          line: 86,
          column: 79
        }
      },
      "24": {
        start: {
          line: 90,
          column: 8
        },
        end: {
          line: 93,
          column: 11
        }
      },
      "25": {
        start: {
          line: 95,
          column: 8
        },
        end: {
          line: 95,
          column: 55
        }
      },
      "26": {
        start: {
          line: 100,
          column: 0
        },
        end: {
          line: 105,
          column: 1
        }
      },
      "27": {
        start: {
          line: 101,
          column: 4
        },
        end: {
          line: 101,
          column: 27
        }
      },
      "28": {
        start: {
          line: 102,
          column: 4
        },
        end: {
          line: 102,
          column: 52
        }
      },
      "29": {
        start: {
          line: 104,
          column: 4
        },
        end: {
          line: 104,
          column: 81
        }
      },
      "30": {
        start: {
          line: 107,
          column: 0
        },
        end: {
          line: 109,
          column: 3
        }
      },
      "31": {
        start: {
          line: 108,
          column: 4
        },
        end: {
          line: 108,
          column: 66
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 44,
            column: 19
          },
          end: {
            line: 44,
            column: 20
          }
        },
        loc: {
          start: {
            line: 44,
            column: 33
          },
          end: {
            line: 52,
            column: 1
          }
        },
        line: 44
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 55,
            column: 30
          },
          end: {
            line: 55,
            column: 31
          }
        },
        loc: {
          start: {
            line: 55,
            column: 44
          },
          end: {
            line: 66,
            column: 1
          }
        },
        line: 55
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 69,
            column: 29
          },
          end: {
            line: 69,
            column: 30
          }
        },
        loc: {
          start: {
            line: 69,
            column: 43
          },
          end: {
            line: 80,
            column: 1
          }
        },
        line: 69
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 83,
            column: 31
          },
          end: {
            line: 83,
            column: 32
          }
        },
        loc: {
          start: {
            line: 83,
            column: 51
          },
          end: {
            line: 97,
            column: 1
          }
        },
        line: 83
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 107,
            column: 17
          },
          end: {
            line: 107,
            column: 18
          }
        },
        loc: {
          start: {
            line: 107,
            column: 23
          },
          end: {
            line: 109,
            column: 1
          }
        },
        line: 107
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 11,
            column: 13
          },
          end: {
            line: 11,
            column: 37
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 11,
            column: 13
          },
          end: {
            line: 11,
            column: 29
          }
        }, {
          start: {
            line: 11,
            column: 33
          },
          end: {
            line: 11,
            column: 37
          }
        }],
        line: 11
      },
      "1": {
        loc: {
          start: {
            line: 20,
            column: 15
          },
          end: {
            line: 20,
            column: 82
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 20,
            column: 16
          },
          end: {
            line: 20,
            column: 72
          }
        }, {
          start: {
            line: 20,
            column: 77
          },
          end: {
            line: 20,
            column: 82
          }
        }],
        line: 20
      },
      "2": {
        loc: {
          start: {
            line: 35,
            column: 19
          },
          end: {
            line: 35,
            column: 60
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 35,
            column: 19
          },
          end: {
            line: 35,
            column: 45
          }
        }, {
          start: {
            line: 35,
            column: 49
          },
          end: {
            line: 35,
            column: 60
          }
        }],
        line: 35
      },
      "3": {
        loc: {
          start: {
            line: 36,
            column: 27
          },
          end: {
            line: 36,
            column: 61
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 36,
            column: 27
          },
          end: {
            line: 36,
            column: 53
          }
        }, {
          start: {
            line: 36,
            column: 57
          },
          end: {
            line: 36,
            column: 61
          }
        }],
        line: 36
      },
      "4": {
        loc: {
          start: {
            line: 85,
            column: 8
          },
          end: {
            line: 87,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 85,
            column: 8
          },
          end: {
            line: 87,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 85
      },
      "5": {
        loc: {
          start: {
            line: 100,
            column: 0
          },
          end: {
            line: 105,
            column: 1
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 100,
            column: 0
          },
          end: {
            line: 105,
            column: 1
          }
        }, {
          start: {
            line: 103,
            column: 7
          },
          end: {
            line: 105,
            column: 1
          }
        }],
        line: 100
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "6a144c222390ced9aced537a580551baa3c8194a"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_14eqjcx8c2 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_14eqjcx8c2();
import express from 'express';
import cors from 'cors';
import helmet from 'helmet';
import dotenv from 'dotenv';
import { ChaosScheduler } from './src/chaos-scheduler';
/* istanbul ignore next */
cov_14eqjcx8c2().s[0]++;
dotenv.config();
const app =
/* istanbul ignore next */
(cov_14eqjcx8c2().s[1]++, express());
const PORT =
/* istanbul ignore next */
(cov_14eqjcx8c2().s[2]++,
/* istanbul ignore next */
(cov_14eqjcx8c2().b[0][0]++, process.env.PORT) ||
/* istanbul ignore next */
(cov_14eqjcx8c2().b[0][1]++, 3050));
/* istanbul ignore next */
cov_14eqjcx8c2().s[3]++;
app.use(helmet());
/* istanbul ignore next */
cov_14eqjcx8c2().s[4]++;
app.use(cors());
/* istanbul ignore next */
cov_14eqjcx8c2().s[5]++;
app.use(express.json());

// Chaos configuration
const chaosConfig =
/* istanbul ignore next */
(cov_14eqjcx8c2().s[6]++, {
  enabled: process.env.CHAOS_ENABLED === 'true',
  intensity:
  /* istanbul ignore next */
  (cov_14eqjcx8c2().b[1][0]++, process.env.CHAOS_INTENSITY) ||
  /* istanbul ignore next */
  (cov_14eqjcx8c2().b[1][1]++, 'low'),
  targetServices: ['azora-education', 'azora-sapiens', 'azora-marketplace', 'azora-assessment'],
  excludeServices: ['azora-auth',
  // Never crash auth
  'azora-pay',
  // Never crash payments
  'azora-mint',
  // Never crash blockchain
  'constitutional-ai',
  // Never crash the superego
  'phoenix-server' // Never crash the recovery system
  ],
  schedule: {
    frequency:
    /* istanbul ignore next */
    (cov_14eqjcx8c2().b[2][0]++, process.env.CHAOS_SCHEDULE) ||
    /* istanbul ignore next */
    (cov_14eqjcx8c2().b[2][1]++, '0 2 * * *'),
    // 2 AM daily
    duration: parseInt(
    /* istanbul ignore next */
    (cov_14eqjcx8c2().b[3][0]++, process.env.CHAOS_DURATION) ||
    /* istanbul ignore next */
    (cov_14eqjcx8c2().b[3][1]++, '30')) // 30 minutes
  },
  requireApproval: process.env.CHAOS_REQUIRE_APPROVAL !== 'false'
});
const chaosScheduler =
/* istanbul ignore next */
(cov_14eqjcx8c2().s[7]++, new ChaosScheduler(chaosConfig));

// Health check
/* istanbul ignore next */
cov_14eqjcx8c2().s[8]++;
app.get('/health', (req, res) => {
  /* istanbul ignore next */
  cov_14eqjcx8c2().f[0]++;
  cov_14eqjcx8c2().s[9]++;
  res.json({
    status: 'healthy',
    service: 'chaos-monkey',
    enabled: chaosConfig.enabled,
    intensity: chaosConfig.intensity,
    timestamp: new Date().toISOString()
  });
});

// Get chaos history
/* istanbul ignore next */
cov_14eqjcx8c2().s[10]++;
app.get('/api/chaos/history', (req, res) => {
  /* istanbul ignore next */
  cov_14eqjcx8c2().f[1]++;
  cov_14eqjcx8c2().s[11]++;
  try {
    const history =
    /* istanbul ignore next */
    (cov_14eqjcx8c2().s[12]++, chaosScheduler.getHistory());
    /* istanbul ignore next */
    cov_14eqjcx8c2().s[13]++;
    res.json({
      success: true,
      data: history,
      count: history.length
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_14eqjcx8c2().s[14]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Get active chaos events
/* istanbul ignore next */
cov_14eqjcx8c2().s[15]++;
app.get('/api/chaos/active', (req, res) => {
  /* istanbul ignore next */
  cov_14eqjcx8c2().f[2]++;
  cov_14eqjcx8c2().s[16]++;
  try {
    const activeEvents =
    /* istanbul ignore next */
    (cov_14eqjcx8c2().s[17]++, chaosScheduler.getActiveEvents());
    /* istanbul ignore next */
    cov_14eqjcx8c2().s[18]++;
    res.json({
      success: true,
      data: activeEvents,
      count: activeEvents.length
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_14eqjcx8c2().s[19]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Manually trigger chaos (requires approval)
/* istanbul ignore next */
cov_14eqjcx8c2().s[20]++;
app.post('/api/chaos/trigger', async (req, res) => {
  /* istanbul ignore next */
  cov_14eqjcx8c2().f[3]++;
  cov_14eqjcx8c2().s[21]++;
  try {
    /* istanbul ignore next */
    cov_14eqjcx8c2().s[22]++;
    if (!chaosConfig.enabled) {
      /* istanbul ignore next */
      cov_14eqjcx8c2().b[4][0]++;
      cov_14eqjcx8c2().s[23]++;
      return res.status(403).json({
        error: 'Chaos Monkey is disabled'
      });
    } else
    /* istanbul ignore next */
    {
      cov_14eqjcx8c2().b[4][1]++;
    }

    // This would trigger a single chaos event
    cov_14eqjcx8c2().s[24]++;
    res.json({
      success: true,
      message: 'Manual chaos trigger not yet implemented'
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_14eqjcx8c2().s[25]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Start chaos scheduler if enabled
/* istanbul ignore next */
cov_14eqjcx8c2().s[26]++;
if (chaosConfig.enabled) {
  /* istanbul ignore next */
  cov_14eqjcx8c2().b[5][0]++;
  cov_14eqjcx8c2().s[27]++;
  chaosScheduler.start();
  /* istanbul ignore next */
  cov_14eqjcx8c2().s[28]++;
  console.log('üêµ ChaosMonkey scheduler started');
} else {
  /* istanbul ignore next */
  cov_14eqjcx8c2().b[5][1]++;
  cov_14eqjcx8c2().s[29]++;
  console.log('üêµ ChaosMonkey is DISABLED (set CHAOS_ENABLED=true to enable)');
}
/* istanbul ignore next */
cov_14eqjcx8c2().s[30]++;
app.listen(PORT, () => {
  /* istanbul ignore next */
  cov_14eqjcx8c2().f[4]++;
  cov_14eqjcx8c2().s[31]++;
  console.log(`üêµ ChaosMonkey service running on port ${PORT}`);
});
export default app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTRlcWpjeDhjMiIsImFjdHVhbENvdmVyYWdlIiwiZXhwcmVzcyIsImNvcnMiLCJoZWxtZXQiLCJkb3RlbnYiLCJDaGFvc1NjaGVkdWxlciIsInMiLCJjb25maWciLCJhcHAiLCJQT1JUIiwiYiIsInByb2Nlc3MiLCJlbnYiLCJ1c2UiLCJqc29uIiwiY2hhb3NDb25maWciLCJlbmFibGVkIiwiQ0hBT1NfRU5BQkxFRCIsImludGVuc2l0eSIsIkNIQU9TX0lOVEVOU0lUWSIsInRhcmdldFNlcnZpY2VzIiwiZXhjbHVkZVNlcnZpY2VzIiwic2NoZWR1bGUiLCJmcmVxdWVuY3kiLCJDSEFPU19TQ0hFRFVMRSIsImR1cmF0aW9uIiwicGFyc2VJbnQiLCJDSEFPU19EVVJBVElPTiIsInJlcXVpcmVBcHByb3ZhbCIsIkNIQU9TX1JFUVVJUkVfQVBQUk9WQUwiLCJjaGFvc1NjaGVkdWxlciIsImdldCIsInJlcSIsInJlcyIsImYiLCJzdGF0dXMiLCJzZXJ2aWNlIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiaGlzdG9yeSIsImdldEhpc3RvcnkiLCJzdWNjZXNzIiwiZGF0YSIsImNvdW50IiwibGVuZ3RoIiwiZXJyb3IiLCJtZXNzYWdlIiwiYWN0aXZlRXZlbnRzIiwiZ2V0QWN0aXZlRXZlbnRzIiwicG9zdCIsInN0YXJ0IiwiY29uc29sZSIsImxvZyIsImxpc3RlbiJdLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IGNvcnMgZnJvbSAnY29ycyc7XG5pbXBvcnQgaGVsbWV0IGZyb20gJ2hlbG1ldCc7XG5pbXBvcnQgZG90ZW52IGZyb20gJ2RvdGVudic7XG5pbXBvcnQgeyBDaGFvc1NjaGVkdWxlciB9IGZyb20gJy4vc3JjL2NoYW9zLXNjaGVkdWxlcic7XG5pbXBvcnQgeyBDaGFvc0NvbmZpZyB9IGZyb20gJy4vc3JjL2ZhaWx1cmUtdHlwZXMnO1xuXG5kb3RlbnYuY29uZmlnKCk7XG5cbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcbmNvbnN0IFBPUlQgPSBwcm9jZXNzLmVudi5QT1JUIHx8IDMwNTA7XG5cbmFwcC51c2UoaGVsbWV0KCkpO1xuYXBwLnVzZShjb3JzKCkpO1xuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XG5cbi8vIENoYW9zIGNvbmZpZ3VyYXRpb25cbmNvbnN0IGNoYW9zQ29uZmlnOiBDaGFvc0NvbmZpZyA9IHtcbiAgICBlbmFibGVkOiBwcm9jZXNzLmVudi5DSEFPU19FTkFCTEVEID09PSAndHJ1ZScsXG4gICAgaW50ZW5zaXR5OiAocHJvY2Vzcy5lbnYuQ0hBT1NfSU5URU5TSVRZIGFzICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcpIHx8ICdsb3cnLFxuICAgIHRhcmdldFNlcnZpY2VzOiBbXG4gICAgICAgICdhem9yYS1lZHVjYXRpb24nLFxuICAgICAgICAnYXpvcmEtc2FwaWVucycsXG4gICAgICAgICdhem9yYS1tYXJrZXRwbGFjZScsXG4gICAgICAgICdhem9yYS1hc3Nlc3NtZW50J1xuICAgIF0sXG4gICAgZXhjbHVkZVNlcnZpY2VzOiBbXG4gICAgICAgICdhem9yYS1hdXRoJywgICAgICAgICAgIC8vIE5ldmVyIGNyYXNoIGF1dGhcbiAgICAgICAgJ2F6b3JhLXBheScsICAgICAgICAgICAgLy8gTmV2ZXIgY3Jhc2ggcGF5bWVudHNcbiAgICAgICAgJ2F6b3JhLW1pbnQnLCAgICAgICAgICAgLy8gTmV2ZXIgY3Jhc2ggYmxvY2tjaGFpblxuICAgICAgICAnY29uc3RpdHV0aW9uYWwtYWknLCAgICAvLyBOZXZlciBjcmFzaCB0aGUgc3VwZXJlZ29cbiAgICAgICAgJ3Bob2VuaXgtc2VydmVyJyAgICAgICAgLy8gTmV2ZXIgY3Jhc2ggdGhlIHJlY292ZXJ5IHN5c3RlbVxuICAgIF0sXG4gICAgc2NoZWR1bGU6IHtcbiAgICAgICAgZnJlcXVlbmN5OiBwcm9jZXNzLmVudi5DSEFPU19TQ0hFRFVMRSB8fCAnMCAyICogKiAqJywgLy8gMiBBTSBkYWlseVxuICAgICAgICBkdXJhdGlvbjogcGFyc2VJbnQocHJvY2Vzcy5lbnYuQ0hBT1NfRFVSQVRJT04gfHwgJzMwJykgLy8gMzAgbWludXRlc1xuICAgIH0sXG4gICAgcmVxdWlyZUFwcHJvdmFsOiBwcm9jZXNzLmVudi5DSEFPU19SRVFVSVJFX0FQUFJPVkFMICE9PSAnZmFsc2UnXG59O1xuXG5jb25zdCBjaGFvc1NjaGVkdWxlciA9IG5ldyBDaGFvc1NjaGVkdWxlcihjaGFvc0NvbmZpZyk7XG5cbi8vIEhlYWx0aCBjaGVja1xuYXBwLmdldCgnL2hlYWx0aCcsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5qc29uKHtcbiAgICAgICAgc3RhdHVzOiAnaGVhbHRoeScsXG4gICAgICAgIHNlcnZpY2U6ICdjaGFvcy1tb25rZXknLFxuICAgICAgICBlbmFibGVkOiBjaGFvc0NvbmZpZy5lbmFibGVkLFxuICAgICAgICBpbnRlbnNpdHk6IGNoYW9zQ29uZmlnLmludGVuc2l0eSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KTtcbn0pO1xuXG4vLyBHZXQgY2hhb3MgaGlzdG9yeVxuYXBwLmdldCgnL2FwaS9jaGFvcy9oaXN0b3J5JywgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGNoYW9zU2NoZWR1bGVyLmdldEhpc3RvcnkoKTtcbiAgICAgICAgcmVzLmpzb24oe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IGhpc3RvcnksXG4gICAgICAgICAgICBjb3VudDogaGlzdG9yeS5sZW5ndGhcbiAgICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcbiAgICB9XG59KTtcblxuLy8gR2V0IGFjdGl2ZSBjaGFvcyBldmVudHNcbmFwcC5nZXQoJy9hcGkvY2hhb3MvYWN0aXZlJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYWN0aXZlRXZlbnRzID0gY2hhb3NTY2hlZHVsZXIuZ2V0QWN0aXZlRXZlbnRzKCk7XG4gICAgICAgIHJlcy5qc29uKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBhY3RpdmVFdmVudHMsXG4gICAgICAgICAgICBjb3VudDogYWN0aXZlRXZlbnRzLmxlbmd0aFxuICAgICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgIH1cbn0pO1xuXG4vLyBNYW51YWxseSB0cmlnZ2VyIGNoYW9zIChyZXF1aXJlcyBhcHByb3ZhbClcbmFwcC5wb3N0KCcvYXBpL2NoYW9zL3RyaWdnZXInLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBpZiAoIWNoYW9zQ29uZmlnLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7IGVycm9yOiAnQ2hhb3MgTW9ua2V5IGlzIGRpc2FibGVkJyB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRoaXMgd291bGQgdHJpZ2dlciBhIHNpbmdsZSBjaGFvcyBldmVudFxuICAgICAgICByZXMuanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgbWVzc2FnZTogJ01hbnVhbCBjaGFvcyB0cmlnZ2VyIG5vdCB5ZXQgaW1wbGVtZW50ZWQnXG4gICAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgfVxufSk7XG5cbi8vIFN0YXJ0IGNoYW9zIHNjaGVkdWxlciBpZiBlbmFibGVkXG5pZiAoY2hhb3NDb25maWcuZW5hYmxlZCkge1xuICAgIGNoYW9zU2NoZWR1bGVyLnN0YXJ0KCk7XG4gICAgY29uc29sZS5sb2coJ/CfkLUgQ2hhb3NNb25rZXkgc2NoZWR1bGVyIHN0YXJ0ZWQnKTtcbn0gZWxzZSB7XG4gICAgY29uc29sZS5sb2coJ/CfkLUgQ2hhb3NNb25rZXkgaXMgRElTQUJMRUQgKHNldCBDSEFPU19FTkFCTEVEPXRydWUgdG8gZW5hYmxlKScpO1xufVxuXG5hcHAubGlzdGVuKFBPUlQsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhg8J+QtSBDaGFvc01vbmtleSBzZXJ2aWNlIHJ1bm5pbmcgb24gcG9ydCAke1BPUlR9YCk7XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgYXBwO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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