3801afad1d6eb0f86b8685d0fcfd1f1f
/* istanbul ignore next */
function cov_1f38giglv8() {
  var path = "/workspaces/azora/services/azora-forge/src/middleware/rateLimiter.ts";
  var hash = "9c51bd9cf3a75aa0f7df0cdc273a703183c1845a";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/azora-forge/src/middleware/rateLimiter.ts",
    statementMap: {
      "0": {
        start: {
          line: 12,
          column: 27
        },
        end: {
          line: 21,
          column: 2
        }
      },
      "1": {
        start: {
          line: 24,
          column: 29
        },
        end: {
          line: 28,
          column: 2
        }
      },
      "2": {
        start: {
          line: 31,
          column: 34
        },
        end: {
          line: 35,
          column: 2
        }
      },
      "3": {
        start: {
          line: 38,
          column: 36
        },
        end: {
          line: 42,
          column: 2
        }
      },
      "4": {
        start: {
          line: 45,
          column: 39
        },
        end: {
          line: 49,
          column: 2
        }
      }
    },
    fnMap: {},
    branchMap: {},
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0
    },
    f: {},
    b: {},
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "9c51bd9cf3a75aa0f7df0cdc273a703183c1845a"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_1f38giglv8 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_1f38giglv8();
/*
AZORA PROPRIETARY LICENSE

Copyright Â© 2025 Azora ES (Pty) Ltd. All Rights Reserved.

See LICENSE file for details.
*/

import rateLimit from 'express-rate-limit';
import { RateLimiterMemory } from 'rate-limiter-flexible';
export const rateLimiter =
/* istanbul ignore next */
(cov_1f38giglv8().s[0]++, rateLimit({
  windowMs: 15 * 60 * 1000,
  // 15 minutes
  max: 100,
  // limit each IP to 100 requests per windowMs
  message: {
    success: false,
    error: 'Too many requests from this IP, please try again later.'
  },
  standardHeaders: true,
  legacyHeaders: false
}));

// AI-specific rate limiter for marketplace operations
export const aiRateLimiter =
/* istanbul ignore next */
(cov_1f38giglv8().s[1]++, new RateLimiterMemory({
  keyPrefix: 'ai_marketplace',
  points: 10,
  // Number of requests
  duration: 60 // Per 60 seconds
}));

// Bidding rate limiter
export const biddingRateLimiter =
/* istanbul ignore next */
(cov_1f38giglv8().s[2]++, new RateLimiterMemory({
  keyPrefix: 'bidding',
  points: 5,
  // Number of bids
  duration: 60 // Per 60 seconds
}));

// Watchlist rate limiter
export const watchlistRateLimiter =
/* istanbul ignore next */
(cov_1f38giglv8().s[3]++, new RateLimiterMemory({
  keyPrefix: 'watchlist',
  points: 10,
  // Number of watchlist additions
  duration: 60 // Per 60 seconds
}));

// Registration rate limiter
export const registrationRateLimiter =
/* istanbul ignore next */
(cov_1f38giglv8().s[4]++, new RateLimiterMemory({
  keyPrefix: 'registration',
  points: 3,
  // Number of registrations
  duration: 3600 // Per hour
}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMWYzOGdpZ2x2OCIsImFjdHVhbENvdmVyYWdlIiwicmF0ZUxpbWl0IiwiUmF0ZUxpbWl0ZXJNZW1vcnkiLCJyYXRlTGltaXRlciIsInMiLCJ3aW5kb3dNcyIsIm1heCIsIm1lc3NhZ2UiLCJzdWNjZXNzIiwiZXJyb3IiLCJzdGFuZGFyZEhlYWRlcnMiLCJsZWdhY3lIZWFkZXJzIiwiYWlSYXRlTGltaXRlciIsImtleVByZWZpeCIsInBvaW50cyIsImR1cmF0aW9uIiwiYmlkZGluZ1JhdGVMaW1pdGVyIiwid2F0Y2hsaXN0UmF0ZUxpbWl0ZXIiLCJyZWdpc3RyYXRpb25SYXRlTGltaXRlciJdLCJzb3VyY2VzIjpbInJhdGVMaW1pdGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5BWk9SQSBQUk9QUklFVEFSWSBMSUNFTlNFXG5cbkNvcHlyaWdodCDCqSAyMDI1IEF6b3JhIEVTIChQdHkpIEx0ZC4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cblxuU2VlIExJQ0VOU0UgZmlsZSBmb3IgZGV0YWlscy5cbiovXG5cbmltcG9ydCByYXRlTGltaXQgZnJvbSAnZXhwcmVzcy1yYXRlLWxpbWl0JztcbmltcG9ydCB7IFJhdGVMaW1pdGVyTWVtb3J5IH0gZnJvbSAncmF0ZS1saW1pdGVyLWZsZXhpYmxlJztcblxuZXhwb3J0IGNvbnN0IHJhdGVMaW1pdGVyID0gcmF0ZUxpbWl0KHtcbiAgd2luZG93TXM6IDE1ICogNjAgKiAxMDAwLCAvLyAxNSBtaW51dGVzXG4gIG1heDogMTAwLCAvLyBsaW1pdCBlYWNoIElQIHRvIDEwMCByZXF1ZXN0cyBwZXIgd2luZG93TXNcbiAgbWVzc2FnZToge1xuICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgIGVycm9yOiAnVG9vIG1hbnkgcmVxdWVzdHMgZnJvbSB0aGlzIElQLCBwbGVhc2UgdHJ5IGFnYWluIGxhdGVyLicsXG4gIH0sXG4gIHN0YW5kYXJkSGVhZGVyczogdHJ1ZSxcbiAgbGVnYWN5SGVhZGVyczogZmFsc2UsXG59KTtcblxuLy8gQUktc3BlY2lmaWMgcmF0ZSBsaW1pdGVyIGZvciBtYXJrZXRwbGFjZSBvcGVyYXRpb25zXG5leHBvcnQgY29uc3QgYWlSYXRlTGltaXRlciA9IG5ldyBSYXRlTGltaXRlck1lbW9yeSh7XG4gIGtleVByZWZpeDogJ2FpX21hcmtldHBsYWNlJyxcbiAgcG9pbnRzOiAxMCwgLy8gTnVtYmVyIG9mIHJlcXVlc3RzXG4gIGR1cmF0aW9uOiA2MCwgLy8gUGVyIDYwIHNlY29uZHNcbn0pO1xuXG4vLyBCaWRkaW5nIHJhdGUgbGltaXRlclxuZXhwb3J0IGNvbnN0IGJpZGRpbmdSYXRlTGltaXRlciA9IG5ldyBSYXRlTGltaXRlck1lbW9yeSh7XG4gIGtleVByZWZpeDogJ2JpZGRpbmcnLFxuICBwb2ludHM6IDUsIC8vIE51bWJlciBvZiBiaWRzXG4gIGR1cmF0aW9uOiA2MCwgLy8gUGVyIDYwIHNlY29uZHNcbn0pO1xuXG4vLyBXYXRjaGxpc3QgcmF0ZSBsaW1pdGVyXG5leHBvcnQgY29uc3Qgd2F0Y2hsaXN0UmF0ZUxpbWl0ZXIgPSBuZXcgUmF0ZUxpbWl0ZXJNZW1vcnkoe1xuICBrZXlQcmVmaXg6ICd3YXRjaGxpc3QnLFxuICBwb2ludHM6IDEwLCAvLyBOdW1iZXIgb2Ygd2F0Y2hsaXN0IGFkZGl0aW9uc1xuICBkdXJhdGlvbjogNjAsIC8vIFBlciA2MCBzZWNvbmRzXG59KTtcblxuLy8gUmVnaXN0cmF0aW9uIHJhdGUgbGltaXRlclxuZXhwb3J0IGNvbnN0IHJlZ2lzdHJhdGlvblJhdGVMaW1pdGVyID0gbmV3IFJhdGVMaW1pdGVyTWVtb3J5KHtcbiAga2V5UHJlZml4OiAncmVnaXN0cmF0aW9uJyxcbiAgcG9pbnRzOiAzLCAvLyBOdW1iZXIgb2YgcmVnaXN0cmF0aW9uc1xuICBkdXJhdGlvbjogMzYwMCwgLy8gUGVyIGhvdXJcbn0pOyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFlWTtJQUFBQSxjQUFBLFlBQUFBLENBQUE7TUFBQSxPQUFBQyxjQUFBO0lBQUE7RUFBQTtFQUFBLE9BQUFBLGNBQUE7QUFBQTtBQUFBRCxjQUFBO0FBZlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0UsU0FBUyxNQUFNLG9CQUFvQjtBQUMxQyxTQUFTQyxpQkFBaUIsUUFBUSx1QkFBdUI7QUFFekQsT0FBTyxNQUFNQyxXQUFXO0FBQUE7QUFBQSxDQUFBSixjQUFBLEdBQUFLLENBQUEsT0FBR0gsU0FBUyxDQUFDO0VBQ25DSSxRQUFRLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJO0VBQUU7RUFDMUJDLEdBQUcsRUFBRSxHQUFHO0VBQUU7RUFDVkMsT0FBTyxFQUFFO0lBQ1BDLE9BQU8sRUFBRSxLQUFLO0lBQ2RDLEtBQUssRUFBRTtFQUNULENBQUM7RUFDREMsZUFBZSxFQUFFLElBQUk7RUFDckJDLGFBQWEsRUFBRTtBQUNqQixDQUFDLENBQUM7O0FBRUY7QUFDQSxPQUFPLE1BQU1DLGFBQWE7QUFBQTtBQUFBLENBQUFiLGNBQUEsR0FBQUssQ0FBQSxPQUFHLElBQUlGLGlCQUFpQixDQUFDO0VBQ2pEVyxTQUFTLEVBQUUsZ0JBQWdCO0VBQzNCQyxNQUFNLEVBQUUsRUFBRTtFQUFFO0VBQ1pDLFFBQVEsRUFBRSxFQUFFLENBQUU7QUFDaEIsQ0FBQyxDQUFDOztBQUVGO0FBQ0EsT0FBTyxNQUFNQyxrQkFBa0I7QUFBQTtBQUFBLENBQUFqQixjQUFBLEdBQUFLLENBQUEsT0FBRyxJQUFJRixpQkFBaUIsQ0FBQztFQUN0RFcsU0FBUyxFQUFFLFNBQVM7RUFDcEJDLE1BQU0sRUFBRSxDQUFDO0VBQUU7RUFDWEMsUUFBUSxFQUFFLEVBQUUsQ0FBRTtBQUNoQixDQUFDLENBQUM7O0FBRUY7QUFDQSxPQUFPLE1BQU1FLG9CQUFvQjtBQUFBO0FBQUEsQ0FBQWxCLGNBQUEsR0FBQUssQ0FBQSxPQUFHLElBQUlGLGlCQUFpQixDQUFDO0VBQ3hEVyxTQUFTLEVBQUUsV0FBVztFQUN0QkMsTUFBTSxFQUFFLEVBQUU7RUFBRTtFQUNaQyxRQUFRLEVBQUUsRUFBRSxDQUFFO0FBQ2hCLENBQUMsQ0FBQzs7QUFFRjtBQUNBLE9BQU8sTUFBTUcsdUJBQXVCO0FBQUE7QUFBQSxDQUFBbkIsY0FBQSxHQUFBSyxDQUFBLE9BQUcsSUFBSUYsaUJBQWlCLENBQUM7RUFDM0RXLFNBQVMsRUFBRSxjQUFjO0VBQ3pCQyxNQUFNLEVBQUUsQ0FBQztFQUFFO0VBQ1hDLFFBQVEsRUFBRSxJQUFJLENBQUU7QUFDbEIsQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119