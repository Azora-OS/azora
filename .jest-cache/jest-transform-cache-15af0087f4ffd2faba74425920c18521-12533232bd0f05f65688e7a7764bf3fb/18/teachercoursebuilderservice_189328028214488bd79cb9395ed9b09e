a2ea2c1291d27ad7c1be591d05ca74cc
/* istanbul ignore next */
function cov_6re5584yd() {
  var path = "/workspaces/azora/services/education-revenue-engine/src/services/teacher-course-builder.service.ts";
  var hash = "fd104a6b94259a9b8be000a4b46b7bad50067a59";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/education-revenue-engine/src/services/teacher-course-builder.service.ts",
    statementMap: {
      "0": {
        start: {
          line: 4,
          column: 15
        },
        end: {
          line: 4,
          column: 33
        }
      },
      "1": {
        start: {
          line: 25,
          column: 4
        },
        end: {
          line: 44,
          column: 5
        }
      },
      "2": {
        start: {
          line: 26,
          column: 21
        },
        end: {
          line: 37,
          column: 8
        }
      },
      "3": {
        start: {
          line: 39,
          column: 6
        },
        end: {
          line: 39,
          column: 75
        }
      },
      "4": {
        start: {
          line: 40,
          column: 6
        },
        end: {
          line: 40,
          column: 163
        }
      },
      "5": {
        start: {
          line: 42,
          column: 6
        },
        end: {
          line: 42,
          column: 69
        }
      },
      "6": {
        start: {
          line: 43,
          column: 6
        },
        end: {
          line: 43,
          column: 18
        }
      },
      "7": {
        start: {
          line: 48,
          column: 4
        },
        end: {
          line: 65,
          column: 5
        }
      },
      "8": {
        start: {
          line: 49,
          column: 21
        },
        end: {
          line: 58,
          column: 8
        }
      },
      "9": {
        start: {
          line: 60,
          column: 6
        },
        end: {
          line: 60,
          column: 50
        }
      },
      "10": {
        start: {
          line: 61,
          column: 6
        },
        end: {
          line: 61,
          column: 163
        }
      },
      "11": {
        start: {
          line: 63,
          column: 6
        },
        end: {
          line: 63,
          column: 65
        }
      },
      "12": {
        start: {
          line: 64,
          column: 6
        },
        end: {
          line: 64,
          column: 18
        }
      },
      "13": {
        start: {
          line: 69,
          column: 4
        },
        end: {
          line: 75,
          column: 5
        }
      },
      "14": {
        start: {
          line: 70,
          column: 6
        },
        end: {
          line: 70,
          column: 62
        }
      },
      "15": {
        start: {
          line: 71,
          column: 6
        },
        end: {
          line: 71,
          column: 50
        }
      },
      "16": {
        start: {
          line: 73,
          column: 6
        },
        end: {
          line: 73,
          column: 65
        }
      },
      "17": {
        start: {
          line: 74,
          column: 6
        },
        end: {
          line: 74,
          column: 18
        }
      },
      "18": {
        start: {
          line: 79,
          column: 4
        },
        end: {
          line: 95,
          column: 5
        }
      },
      "19": {
        start: {
          line: 80,
          column: 24
        },
        end: {
          line: 88,
          column: 8
        }
      },
      "20": {
        start: {
          line: 90,
          column: 6
        },
        end: {
          line: 90,
          column: 72
        }
      },
      "21": {
        start: {
          line: 91,
          column: 6
        },
        end: {
          line: 91,
          column: 30
        }
      },
      "22": {
        start: {
          line: 93,
          column: 6
        },
        end: {
          line: 93,
          column: 63
        }
      },
      "23": {
        start: {
          line: 94,
          column: 6
        },
        end: {
          line: 94,
          column: 18
        }
      },
      "24": {
        start: {
          line: 99,
          column: 4
        },
        end: {
          line: 108,
          column: 5
        }
      },
      "25": {
        start: {
          line: 100,
          column: 21
        },
        end: {
          line: 100,
          column: 80
        }
      },
      "26": {
        start: {
          line: 101,
          column: 6
        },
        end: {
          line: 101,
          column: 57
        }
      },
      "27": {
        start: {
          line: 101,
          column: 20
        },
        end: {
          line: 101,
          column: 56
        }
      },
      "28": {
        start: {
          line: 103,
          column: 6
        },
        end: {
          line: 103,
          column: 52
        }
      },
      "29": {
        start: {
          line: 104,
          column: 6
        },
        end: {
          line: 104,
          column: 73
        }
      },
      "30": {
        start: {
          line: 106,
          column: 6
        },
        end: {
          line: 106,
          column: 67
        }
      },
      "31": {
        start: {
          line: 107,
          column: 6
        },
        end: {
          line: 107,
          column: 18
        }
      },
      "32": {
        start: {
          line: 112,
          column: 43
        },
        end: {
          line: 112,
          column: 76
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 24,
            column: 2
          },
          end: {
            line: 24,
            column: 3
          }
        },
        loc: {
          start: {
            line: 24,
            column: 103
          },
          end: {
            line: 45,
            column: 3
          }
        },
        line: 24
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 47,
            column: 2
          },
          end: {
            line: 47,
            column: 3
          }
        },
        loc: {
          start: {
            line: 47,
            column: 99
          },
          end: {
            line: 66,
            column: 3
          }
        },
        line: 47
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 68,
            column: 2
          },
          end: {
            line: 68,
            column: 3
          }
        },
        loc: {
          start: {
            line: 68,
            column: 54
          },
          end: {
            line: 76,
            column: 3
          }
        },
        line: 68
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 78,
            column: 2
          },
          end: {
            line: 78,
            column: 3
          }
        },
        loc: {
          start: {
            line: 78,
            column: 81
          },
          end: {
            line: 96,
            column: 3
          }
        },
        line: 78
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 98,
            column: 2
          },
          end: {
            line: 98,
            column: 3
          }
        },
        loc: {
          start: {
            line: 98,
            column: 88
          },
          end: {
            line: 109,
            column: 3
          }
        },
        line: 98
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 28,
            column: 17
          },
          end: {
            line: 28,
            column: 54
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 28,
            column: 17
          },
          end: {
            line: 28,
            column: 33
          }
        }, {
          start: {
            line: 28,
            column: 37
          },
          end: {
            line: 28,
            column: 54
          }
        }],
        line: 28
      },
      "1": {
        loc: {
          start: {
            line: 29,
            column: 23
          },
          end: {
            line: 29,
            column: 51
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 29,
            column: 23
          },
          end: {
            line: 29,
            column: 45
          }
        }, {
          start: {
            line: 29,
            column: 49
          },
          end: {
            line: 29,
            column: 51
          }
        }],
        line: 29
      },
      "2": {
        loc: {
          start: {
            line: 31,
            column: 16
          },
          end: {
            line: 31,
            column: 41
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 31,
            column: 16
          },
          end: {
            line: 31,
            column: 31
          }
        }, {
          start: {
            line: 31,
            column: 35
          },
          end: {
            line: 31,
            column: 41
          }
        }],
        line: 31
      },
      "3": {
        loc: {
          start: {
            line: 32,
            column: 20
          },
          end: {
            line: 32,
            column: 47
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 32,
            column: 20
          },
          end: {
            line: 32,
            column: 39
          }
        }, {
          start: {
            line: 32,
            column: 43
          },
          end: {
            line: 32,
            column: 47
          }
        }],
        line: 32
      },
      "4": {
        loc: {
          start: {
            line: 33,
            column: 29
          },
          end: {
            line: 33,
            column: 53
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 33,
            column: 29
          },
          end: {
            line: 33,
            column: 47
          }
        }, {
          start: {
            line: 33,
            column: 51
          },
          end: {
            line: 33,
            column: 53
          }
        }],
        line: 33
      },
      "5": {
        loc: {
          start: {
            line: 101,
            column: 6
          },
          end: {
            line: 101,
            column: 57
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 101,
            column: 6
          },
          end: {
            line: 101,
            column: 57
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 101
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "fd104a6b94259a9b8be000a4b46b7bad50067a59"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_6re5584yd = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_6re5584yd();
import { PrismaClient } from '@prisma/client';
import { logger } from '../utils/logger';
const prisma =
/* istanbul ignore next */
(cov_6re5584yd().s[0]++, new PrismaClient());
export class TeacherCourseBuilderService {
  async createCourse(instructorId, courseData) {
    /* istanbul ignore next */
    cov_6re5584yd().f[0]++;
    cov_6re5584yd().s[1]++;
    try {
      const course =
      /* istanbul ignore next */
      (cov_6re5584yd().s[2]++, await prisma.course.create({
        data: {
          title:
          /* istanbul ignore next */
          (cov_6re5584yd().b[0][0]++, courseData.title) ||
          /* istanbul ignore next */
          (cov_6re5584yd().b[0][1]++, 'Untitled Course'),
          description:
          /* istanbul ignore next */
          (cov_6re5584yd().b[1][0]++, courseData.description) ||
          /* istanbul ignore next */
          (cov_6re5584yd().b[1][1]++, ''),
          instructorId,
          tier:
          /* istanbul ignore next */
          (cov_6re5584yd().b[2][0]++, courseData.tier) ||
          /* istanbul ignore next */
          (cov_6re5584yd().b[2][1]++, 'free'),
          language:
          /* istanbul ignore next */
          (cov_6re5584yd().b[3][0]++, courseData.language) ||
          /* istanbul ignore next */
          (cov_6re5584yd().b[3][1]++, 'en'),
          modules: {
            create:
            /* istanbul ignore next */
            (cov_6re5584yd().b[4][0]++, courseData.modules) ||
            /* istanbul ignore next */
            (cov_6re5584yd().b[4][1]++, [])
          },
          prerequisites: []
        },
        include: {
          modules: true
        }
      }));
      /* istanbul ignore next */
      cov_6re5584yd().s[3]++;
      logger.info('Course created', {
        courseId: course.id,
        instructorId
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[4]++;
      return {
        id: course.id,
        title: course.title,
        description: course.description,
        modules: course.modules,
        tier: course.tier,
        language: course.language
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_6re5584yd().s[5]++;
      logger.error('Error creating course', {
        error,
        instructorId
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[6]++;
      throw error;
    }
  }
  async updateCourse(courseId, courseData) {
    /* istanbul ignore next */
    cov_6re5584yd().f[1]++;
    cov_6re5584yd().s[7]++;
    try {
      const course =
      /* istanbul ignore next */
      (cov_6re5584yd().s[8]++, await prisma.course.update({
        where: {
          id: courseId
        },
        data: {
          title: courseData.title,
          description: courseData.description,
          tier: courseData.tier,
          language: courseData.language
        },
        include: {
          modules: true
        }
      }));
      /* istanbul ignore next */
      cov_6re5584yd().s[9]++;
      logger.info('Course updated', {
        courseId
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[10]++;
      return {
        id: course.id,
        title: course.title,
        description: course.description,
        modules: course.modules,
        tier: course.tier,
        language: course.language
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_6re5584yd().s[11]++;
      logger.error('Error updating course', {
        error,
        courseId
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[12]++;
      throw error;
    }
  }
  async deleteCourse(courseId) {
    /* istanbul ignore next */
    cov_6re5584yd().f[2]++;
    cov_6re5584yd().s[13]++;
    try {
      /* istanbul ignore next */
      cov_6re5584yd().s[14]++;
      await prisma.course.delete({
        where: {
          id: courseId
        }
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[15]++;
      logger.info('Course deleted', {
        courseId
      });
    } catch (error) {
      /* istanbul ignore next */
      cov_6re5584yd().s[16]++;
      logger.error('Error deleting course', {
        error,
        courseId
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[17]++;
      throw error;
    }
  }
  async addModule(courseId, module) {
    /* istanbul ignore next */
    cov_6re5584yd().f[3]++;
    cov_6re5584yd().s[18]++;
    try {
      const newModule =
      /* istanbul ignore next */
      (cov_6re5584yd().s[19]++, await prisma.module.create({
        data: {
          courseId,
          title: module.title,
          content: module.content,
          order: module.order,
          estimatedTime: module.estimatedTime
        }
      }));
      /* istanbul ignore next */
      cov_6re5584yd().s[20]++;
      logger.info('Module added', {
        courseId,
        moduleId: newModule.id
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[21]++;
      return newModule;
    } catch (error) {
      /* istanbul ignore next */
      cov_6re5584yd().s[22]++;
      logger.error('Error adding module', {
        error,
        courseId
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[23]++;
      throw error;
    }
  }
  async publishCourse(courseId) {
    /* istanbul ignore next */
    cov_6re5584yd().f[4]++;
    cov_6re5584yd().s[24]++;
    try {
      const course =
      /* istanbul ignore next */
      (cov_6re5584yd().s[25]++, await prisma.course.findUnique({
        where: {
          id: courseId
        }
      }));
      /* istanbul ignore next */
      cov_6re5584yd().s[26]++;
      if (!course) {
        /* istanbul ignore next */
        cov_6re5584yd().b[5][0]++;
        cov_6re5584yd().s[27]++;
        throw new Error('Course not found');
      } else
      /* istanbul ignore next */
      {
        cov_6re5584yd().b[5][1]++;
      }
      cov_6re5584yd().s[28]++;
      logger.info('Course published', {
        courseId
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[29]++;
      return {
        success: true,
        message: 'Course published successfully'
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_6re5584yd().s[30]++;
      logger.error('Error publishing course', {
        error,
        courseId
      });
      /* istanbul ignore next */
      cov_6re5584yd().s[31]++;
      throw error;
    }
  }
}
export const teacherCourseBuilderService =
/* istanbul ignore next */
(cov_6re5584yd().s[32]++, new TeacherCourseBuilderService());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfNnJlNTU4NHlkIiwiYWN0dWFsQ292ZXJhZ2UiLCJQcmlzbWFDbGllbnQiLCJsb2dnZXIiLCJwcmlzbWEiLCJzIiwiVGVhY2hlckNvdXJzZUJ1aWxkZXJTZXJ2aWNlIiwiY3JlYXRlQ291cnNlIiwiaW5zdHJ1Y3RvcklkIiwiY291cnNlRGF0YSIsImYiLCJjb3Vyc2UiLCJjcmVhdGUiLCJkYXRhIiwidGl0bGUiLCJiIiwiZGVzY3JpcHRpb24iLCJ0aWVyIiwibGFuZ3VhZ2UiLCJtb2R1bGVzIiwicHJlcmVxdWlzaXRlcyIsImluY2x1ZGUiLCJpbmZvIiwiY291cnNlSWQiLCJpZCIsImVycm9yIiwidXBkYXRlQ291cnNlIiwidXBkYXRlIiwid2hlcmUiLCJkZWxldGVDb3Vyc2UiLCJkZWxldGUiLCJhZGRNb2R1bGUiLCJtb2R1bGUiLCJuZXdNb2R1bGUiLCJjb250ZW50Iiwib3JkZXIiLCJlc3RpbWF0ZWRUaW1lIiwibW9kdWxlSWQiLCJwdWJsaXNoQ291cnNlIiwiZmluZFVuaXF1ZSIsIkVycm9yIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJ0ZWFjaGVyQ291cnNlQnVpbGRlclNlcnZpY2UiXSwic291cmNlcyI6WyJ0ZWFjaGVyLWNvdXJzZS1idWlsZGVyLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvbG9nZ2VyJztcblxuY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvdXJzZU1vZHVsZSB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgb3JkZXI6IG51bWJlcjtcbiAgZXN0aW1hdGVkVGltZTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvdXJzZUNvbnRlbnQge1xuICBpZDogc3RyaW5nO1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBtb2R1bGVzOiBDb3Vyc2VNb2R1bGVbXTtcbiAgdGllcjogJ2ZyZWUnIHwgJ3ByZW1pdW0nIHwgJ3Bybyc7XG4gIGxhbmd1YWdlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBUZWFjaGVyQ291cnNlQnVpbGRlclNlcnZpY2Uge1xuICBhc3luYyBjcmVhdGVDb3Vyc2UoaW5zdHJ1Y3RvcklkOiBzdHJpbmcsIGNvdXJzZURhdGE6IFBhcnRpYWw8Q291cnNlQ29udGVudD4pOiBQcm9taXNlPENvdXJzZUNvbnRlbnQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY291cnNlID0gYXdhaXQgcHJpc21hLmNvdXJzZS5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdGl0bGU6IGNvdXJzZURhdGEudGl0bGUgfHwgJ1VudGl0bGVkIENvdXJzZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGNvdXJzZURhdGEuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgICAgaW5zdHJ1Y3RvcklkLFxuICAgICAgICAgIHRpZXI6IGNvdXJzZURhdGEudGllciB8fCAnZnJlZScsXG4gICAgICAgICAgbGFuZ3VhZ2U6IGNvdXJzZURhdGEubGFuZ3VhZ2UgfHwgJ2VuJyxcbiAgICAgICAgICBtb2R1bGVzOiB7IGNyZWF0ZTogY291cnNlRGF0YS5tb2R1bGVzIHx8IFtdIH0sXG4gICAgICAgICAgcHJlcmVxdWlzaXRlczogW10sXG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgbW9kdWxlczogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdDb3Vyc2UgY3JlYXRlZCcsIHsgY291cnNlSWQ6IGNvdXJzZS5pZCwgaW5zdHJ1Y3RvcklkIH0pO1xuICAgICAgcmV0dXJuIHsgaWQ6IGNvdXJzZS5pZCwgdGl0bGU6IGNvdXJzZS50aXRsZSwgZGVzY3JpcHRpb246IGNvdXJzZS5kZXNjcmlwdGlvbiwgbW9kdWxlczogY291cnNlLm1vZHVsZXMsIHRpZXI6IGNvdXJzZS50aWVyIGFzIGFueSwgbGFuZ3VhZ2U6IGNvdXJzZS5sYW5ndWFnZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNvdXJzZScsIHsgZXJyb3IsIGluc3RydWN0b3JJZCB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUNvdXJzZShjb3Vyc2VJZDogc3RyaW5nLCBjb3Vyc2VEYXRhOiBQYXJ0aWFsPENvdXJzZUNvbnRlbnQ+KTogUHJvbWlzZTxDb3Vyc2VDb250ZW50PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvdXJzZSA9IGF3YWl0IHByaXNtYS5jb3Vyc2UudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGNvdXJzZUlkIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0aXRsZTogY291cnNlRGF0YS50aXRsZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogY291cnNlRGF0YS5kZXNjcmlwdGlvbixcbiAgICAgICAgICB0aWVyOiBjb3Vyc2VEYXRhLnRpZXIsXG4gICAgICAgICAgbGFuZ3VhZ2U6IGNvdXJzZURhdGEubGFuZ3VhZ2UsXG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgbW9kdWxlczogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdDb3Vyc2UgdXBkYXRlZCcsIHsgY291cnNlSWQgfSk7XG4gICAgICByZXR1cm4geyBpZDogY291cnNlLmlkLCB0aXRsZTogY291cnNlLnRpdGxlLCBkZXNjcmlwdGlvbjogY291cnNlLmRlc2NyaXB0aW9uLCBtb2R1bGVzOiBjb3Vyc2UubW9kdWxlcywgdGllcjogY291cnNlLnRpZXIgYXMgYW55LCBsYW5ndWFnZTogY291cnNlLmxhbmd1YWdlIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgdXBkYXRpbmcgY291cnNlJywgeyBlcnJvciwgY291cnNlSWQgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBkZWxldGVDb3Vyc2UoY291cnNlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBwcmlzbWEuY291cnNlLmRlbGV0ZSh7IHdoZXJlOiB7IGlkOiBjb3Vyc2VJZCB9IH0pO1xuICAgICAgbG9nZ2VyLmluZm8oJ0NvdXJzZSBkZWxldGVkJywgeyBjb3Vyc2VJZCB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBkZWxldGluZyBjb3Vyc2UnLCB7IGVycm9yLCBjb3Vyc2VJZCB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGFkZE1vZHVsZShjb3Vyc2VJZDogc3RyaW5nLCBtb2R1bGU6IENvdXJzZU1vZHVsZSk6IFByb21pc2U8Q291cnNlTW9kdWxlPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG5ld01vZHVsZSA9IGF3YWl0IHByaXNtYS5tb2R1bGUuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGNvdXJzZUlkLFxuICAgICAgICAgIHRpdGxlOiBtb2R1bGUudGl0bGUsXG4gICAgICAgICAgY29udGVudDogbW9kdWxlLmNvbnRlbnQsXG4gICAgICAgICAgb3JkZXI6IG1vZHVsZS5vcmRlcixcbiAgICAgICAgICBlc3RpbWF0ZWRUaW1lOiBtb2R1bGUuZXN0aW1hdGVkVGltZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBsb2dnZXIuaW5mbygnTW9kdWxlIGFkZGVkJywgeyBjb3Vyc2VJZCwgbW9kdWxlSWQ6IG5ld01vZHVsZS5pZCB9KTtcbiAgICAgIHJldHVybiBuZXdNb2R1bGUgYXMgYW55O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGFkZGluZyBtb2R1bGUnLCB7IGVycm9yLCBjb3Vyc2VJZCB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHB1Ymxpc2hDb3Vyc2UoY291cnNlSWQ6IHN0cmluZyk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBtZXNzYWdlOiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb3Vyc2UgPSBhd2FpdCBwcmlzbWEuY291cnNlLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogY291cnNlSWQgfSB9KTtcbiAgICAgIGlmICghY291cnNlKSB7dGhyb3cgbmV3IEVycm9yKCdDb3Vyc2Ugbm90IGZvdW5kJyk7fVxuXG4gICAgICBsb2dnZXIuaW5mbygnQ291cnNlIHB1Ymxpc2hlZCcsIHsgY291cnNlSWQgfSk7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiAnQ291cnNlIHB1Ymxpc2hlZCBzdWNjZXNzZnVsbHknIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgcHVibGlzaGluZyBjb3Vyc2UnLCB7IGVycm9yLCBjb3Vyc2VJZCB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgdGVhY2hlckNvdXJzZUJ1aWxkZXJTZXJ2aWNlID0gbmV3IFRlYWNoZXJDb3Vyc2VCdWlsZGVyU2VydmljZSgpO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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