{"version":3,"names":["request","require","express","createTestApp","app","use","json","get","req","res","status","service","timestamp","Date","toISOString","post","familyMember","message","body","error","response_data","conversationId","now","response","selectedMember","members","id","name","specialty","count","topic","consultation","consultationId","responses","describe","beforeEach","it","expect","toBe","send","toHaveProperty","Array","isArray","length","toBeGreaterThan"],"sources":["ai-family.test.js"],"sourcesContent":["const request = require('supertest');\nconst express = require('express');\n\nfunction createTestApp() {\n  const app = express();\n  app.use(express.json());\n\n  app.get('/api/health', (req, res) => {\n    res.json({\n      status: 'OK',\n      service: 'AI Family Service',\n      timestamp: new Date().toISOString()\n    });\n  });\n\n  app.post('/api/chat/chat', (req, res) => {\n    const { familyMember, message } = req.body;\n\n    if (!familyMember || !message) {\n      return res.status(400).json({ error: 'Family member and message are required' });\n    }\n\n    const response_data = {\n      conversationId: `conv_${Date.now()}`,\n      familyMember,\n      message,\n      response: `Response from ${familyMember}`,\n      timestamp: new Date().toISOString()\n    };\n\n    res.json(response_data);\n  });\n\n  app.post('/api/chat/auto-chat', (req, res) => {\n    const { message } = req.body;\n\n    if (!message) {\n      return res.status(400).json({ error: 'Message is required' });\n    }\n\n    const response_data = {\n      conversationId: `conv_${Date.now()}`,\n      selectedMember: 'elara',\n      message,\n      response: 'Auto-selected response',\n      timestamp: new Date().toISOString()\n    };\n\n    res.json(response_data);\n  });\n\n  app.get('/api/chat/family-config', (req, res) => {\n    res.json({\n      members: [\n        { id: 'elara', name: 'Elara', specialty: 'education' },\n        { id: 'sage', name: 'Sage', specialty: 'wisdom' }\n      ],\n      count: 2\n    });\n  });\n\n  app.post('/api/chat/consult-family', (req, res) => {\n    const { topic, members } = req.body;\n\n    if (!topic) {\n      return res.status(400).json({ error: 'Topic is required' });\n    }\n\n    const consultation = {\n      consultationId: `consult_${Date.now()}`,\n      topic,\n      responses: [],\n      timestamp: new Date().toISOString()\n    };\n\n    res.json(consultation);\n  });\n\n  return app;\n}\n\ndescribe('AI Family Service - AI Family Tests', () => {\n  let app;\n\n  beforeEach(() => {\n    app = createTestApp();\n  });\n\n  describe('GET /api/health', () => {\n    it('should return health status', async () => {\n      const response = await request(app)\n        .get('/api/health');\n\n      expect(response.status).toBe(200);\n      expect(response.body.status).toBe('OK');\n      expect(response.body.service).toBe('AI Family Service');\n    });\n  });\n\n  describe('POST /api/chat/chat', () => {\n    it('should chat with specific family member', async () => {\n      const response = await request(app)\n        .post('/api/chat/chat')\n        .send({\n          familyMember: 'elara',\n          message: 'Hello, how can you help me?'\n        });\n\n      expect(response.status).toBe(200);\n      expect(response.body).toHaveProperty('conversationId');\n      expect(response.body.familyMember).toBe('elara');\n      expect(response.body).toHaveProperty('response');\n    });\n\n    it('should return error when family member is missing', async () => {\n      const response = await request(app)\n        .post('/api/chat/chat')\n        .send({ message: 'Hello' });\n\n      expect(response.status).toBe(400);\n      expect(response.body.error).toBe('Family member and message are required');\n    });\n\n    it('should return error when message is missing', async () => {\n      const response = await request(app)\n        .post('/api/chat/chat')\n        .send({ familyMember: 'elara' });\n\n      expect(response.status).toBe(400);\n      expect(response.body.error).toBe('Family member and message are required');\n    });\n  });\n\n  describe('POST /api/chat/auto-chat', () => {\n    it('should auto-select family member for message', async () => {\n      const response = await request(app)\n        .post('/api/chat/auto-chat')\n        .send({ message: 'I need help with education' });\n\n      expect(response.status).toBe(200);\n      expect(response.body).toHaveProperty('conversationId');\n      expect(response.body).toHaveProperty('selectedMember');\n      expect(response.body).toHaveProperty('response');\n    });\n\n    it('should return error when message is missing', async () => {\n      const response = await request(app)\n        .post('/api/chat/auto-chat')\n        .send({});\n\n      expect(response.status).toBe(400);\n      expect(response.body.error).toBe('Message is required');\n    });\n  });\n\n  describe('GET /api/chat/family-config', () => {\n    it('should return family member configuration', async () => {\n      const response = await request(app)\n        .get('/api/chat/family-config');\n\n      expect(response.status).toBe(200);\n      expect(response.body).toHaveProperty('members');\n      expect(Array.isArray(response.body.members)).toBe(true);\n      expect(response.body.members.length).toBeGreaterThan(0);\n    });\n\n    it('should include member details', async () => {\n      const response = await request(app)\n        .get('/api/chat/family-config');\n\n      expect(response.status).toBe(200);\n      expect(response.body.members[0]).toHaveProperty('id');\n      expect(response.body.members[0]).toHaveProperty('name');\n      expect(response.body.members[0]).toHaveProperty('specialty');\n    });\n  });\n\n  describe('POST /api/chat/consult-family', () => {\n    it('should consult multiple family members', async () => {\n      const response = await request(app)\n        .post('/api/chat/consult-family')\n        .send({\n          topic: 'Career guidance',\n          members: ['elara', 'sage']\n        });\n\n      expect(response.status).toBe(200);\n      expect(response.body).toHaveProperty('consultationId');\n      expect(response.body.topic).toBe('Career guidance');\n      expect(response.body).toHaveProperty('responses');\n    });\n\n    it('should return error when topic is missing', async () => {\n      const response = await request(app)\n        .post('/api/chat/consult-family')\n        .send({ members: ['elara'] });\n\n      expect(response.status).toBe(400);\n      expect(response.body.error).toBe('Topic is required');\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}