{"version":3,"names":["cov_tkvorv85q","actualCoverage","EventEmitter","v4","uuidv4","EducationBillingIntegration","accounts","s","Map","payments","familySavings","paymentPlans","paymentCounter","constructor","config","f","initializeService","console","log","startBackgroundJobs","setInterval","checkOverduePayments","processAutoPayments","applyMiningEarnings","disburseFinancialAid","createEducationAccount","data","accountId","additionalFees","registration","b","technology","library","sports","insurance","other","totalAdditional","Object","values","reduce","a","totalDue","tuitionFees","account","id","studentNumber","studentName","institution","program","academicYear","totalTuitionFees","totalPaid","balance","preferredPaymentMethod","autoPayEnabled","autoPaySource","miningEarningsAutoApply","miningEarningsApplied","financialAid","scholarships","linkedWallets","parentWallets","accountStatus","holds","createdAt","Date","updatedAt","set","createStudentWallet","emit","linkWallet","walletId","walletType","get","Error","studentWallet","push","wallet","mintWalletService","createWallet","userId","userName","autoStakingEnabled","miningEnabled","processPayment","payment","paymentId","paymentNumber","tuitionPayment","amount","currency","method","source","appliedTo","status","fromMiningEarnings","processWalletPayment","processCryptoPayment","processBankTransfer","releaseAllHolds","processedAt","sendPaymentReceipt","error","deductFunds","purpose","reference","tx","fromAddress","transactionHash","hash","processBankDeposit","accountNumber","earnings","miningService","getUnclaimedEarnings","totalAZR","zarAmount","Math","min","miningSessionId","sessionId","notificationService","send","to","type","title","message","toFixed","createPaymentPlan","request","planId","remainingBalance","depositAmount","installmentCount","getInstallmentCount","installmentAmount","installments","startDate","i","dueDate","calculateDueDate","installmentNumber","plan","totalAmount","depositRequired","depositPaid","paymentPlan","due","setMonth","getMonth","setFullYear","getFullYear","nextInstallment","find","today","toDateString","sourceWallet","familySavingsAccount","warn","paidDate","applyHold","hold","newHold","appliedDate","releasedDate","overdueInstallments","filter","length","installment","reason","amountOwed","aid","disbursement","disbursementSchedule","date","attachments","filename","content","generateReceiptPDF","Buffer","from","getAccountSummary","Array","p","statistics","percentagePaid","activeHolds","h"],"sources":["education-billing-integration.ts"],"sourcesContent":["/**\n * Azora Mint - Education Billing Integration\n * Connects Sapiens University tuition payments to Azora Mint financial system\n * \n * Features:\n * - Tuition invoice generation\n * - Payment plan management (monthly, quarterly, annual)\n * - Financial aid integration\n * - Scholarship management\n * - Parent wallet linking\n * - Auto-payment from Mint wallets\n * - Crypto payment acceptance (AZR, BTC, ETH, USDC)\n * - Mining earnings auto-apply to tuition\n * - Family education savings accounts\n */\n\nimport { EventEmitter } from 'events';\nimport { v4 as uuidv4 } from 'uuid';\n\n// ==================== INTERFACES ====================\n\nexport interface EducationAccount {\n  id: string;\n  studentNumber: string;\n  studentName: string;\n  institution: string; // 'primary', 'secondary', 'university', 'skills', etc.\n  program: string;\n  academicYear: string;\n  \n  // Financial\n  totalTuitionFees: number; // Annual tuition\n  additionalFees: {\n    registration: number;\n    technology: number;\n    library: number;\n    sports: number;\n    insurance: number;\n    other: number;\n  };\n  totalDue: number; // Total for year\n  totalPaid: number;\n  balance: number; // Outstanding\n  \n  // Payment methods\n  preferredPaymentMethod: 'mint-wallet' | 'bank-transfer' | 'crypto' | 'card';\n  autoPayEnabled: boolean;\n  autoPaySource: 'student-wallet' | 'parent-wallet' | 'family-savings';\n  \n  // Mining integration\n  miningEarningsAutoApply: boolean; // Auto-apply mining earnings to balance\n  miningEarningsApplied: number; // Total mining earnings applied\n  \n  // Financial aid\n  financialAid: FinancialAid[];\n  scholarships: Scholarship[];\n  \n  // Payment plan\n  paymentPlan?: PaymentPlan;\n  \n  // Linked accounts\n  linkedWallets: {\n    studentWallet?: string; // Mint wallet ID\n    parentWallets: string[]; // Parent Mint wallet IDs\n    familySavingsAccount?: string;\n  };\n  \n  // Status\n  accountStatus: 'active' | 'hold' | 'suspended' | 'graduated';\n  holds: FinancialHold[];\n  \n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface FinancialAid {\n  id: string;\n  type: 'bursary' | 'loan' | 'work-study' | 'grant';\n  provider: string; // 'azora-fund' | 'nsfas' | 'government' | 'private'\n  amount: number;\n  status: 'applied' | 'approved' | 'disbursed' | 'rejected';\n  disbursementSchedule: {\n    date: Date;\n    amount: number;\n    status: 'pending' | 'disbursed';\n  }[];\n  conditions?: string; // e.g., \"Maintain 65% average\"\n  applicationDate: Date;\n  approvalDate?: Date;\n}\n\nexport interface Scholarship {\n  id: string;\n  name: string;\n  provider: string;\n  amount: number; // Can be partial or full\n  coverageType: 'full-tuition' | 'partial-tuition' | 'living-expenses' | 'books';\n  percentage?: number; // If partial, e.g., 50% = half tuition\n  duration: string; // 'semester' | 'year' | 'degree'\n  renewable: boolean;\n  renewalConditions?: string;\n  awardedDate: Date;\n}\n\nexport interface PaymentPlan {\n  id: string;\n  accountId: string;\n  type: 'monthly' | 'quarterly' | 'semesterly' | 'annual';\n  totalAmount: number;\n  installments: Installment[];\n  depositRequired: number; // Upfront deposit\n  depositPaid: boolean;\n  status: 'active' | 'completed' | 'defaulted';\n  createdAt: Date;\n}\n\nexport interface Installment {\n  id: string;\n  installmentNumber: number;\n  dueDate: Date;\n  amount: number;\n  status: 'pending' | 'paid' | 'overdue' | 'waived';\n  paidDate?: Date;\n  paidAmount?: number;\n  paymentMethod?: string;\n  transactionId?: string;\n}\n\nexport interface FinancialHold {\n  id: string;\n  accountId: string;\n  type: 'registration' | 'transcript' | 'certificate' | 'graduation';\n  reason: string;\n  amountOwed: number;\n  appliedDate: Date;\n  status: 'active' | 'released';\n  releasedDate?: Date;\n}\n\nexport interface TuitionPayment {\n  id: string;\n  paymentNumber: string;\n  accountId: string;\n  studentNumber: string;\n  \n  amount: number;\n  currency: 'ZAR' | 'USD' | 'AZR' | 'BTC' | 'ETH' | 'USDC';\n  \n  method: 'mint-wallet' | 'bank-transfer' | 'crypto' | 'card' | 'mining-earnings';\n  source: string; // Wallet ID or bank account\n  \n  appliedTo: 'tuition' | 'registration' | 'library' | 'technology' | 'installment';\n  installmentId?: string;\n  \n  status: 'pending' | 'processing' | 'completed' | 'failed' | 'refunded';\n  \n  // Mining integration\n  fromMiningEarnings: boolean;\n  miningSessionId?: string;\n  \n  // Transaction details\n  transactionHash?: string; // If crypto\n  receiptUrl?: string;\n  \n  processedAt?: Date;\n  createdAt: Date;\n}\n\nexport interface FamilyEducationSavings {\n  id: string;\n  familyId: string;\n  accountName: string;\n  \n  // Linked accounts\n  parentWallets: string[];\n  studentAccounts: string[]; // Multiple kids\n  \n  // Balance\n  balance: number;\n  currency: 'ZAR' | 'USD' | 'AZR';\n  \n  // Contributions\n  monthlyContribution?: number;\n  autoContribute: boolean;\n  \n  // Investment\n  investInDefi: boolean; // Earn yield on savings\n  currentAPY?: number;\n  totalEarnings: number;\n  \n  // Mining integration\n  familyMiningEnabled: boolean; // All family devices mine together\n  miningEarnings: number;\n  \n  // Disbursement rules\n  disbursementRules: {\n    studentId: string;\n    maxPerSemester: number;\n    requiresApproval: boolean;\n  }[];\n  \n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// ==================== SERVICE ====================\n\nexport class EducationBillingIntegration extends EventEmitter {\n  private accounts: Map<string, EducationAccount> = new Map();\n  private payments: Map<string, TuitionPayment> = new Map();\n  private familySavings: Map<string, FamilyEducationSavings> = new Map();\n  private paymentPlans: Map<string, PaymentPlan> = new Map();\n  \n  private paymentCounter: number = 100000;\n\n  constructor(\n    private config: {\n      mintWalletService: any; // MintWalletService\n      miningService: any; // MiningService\n      defiService: any; // DefiService\n      notificationService: any;\n    }\n  ) {\n    super();\n    this.initializeService();\n  }\n\n  private initializeService(): void {\n    console.log('üéìüí∞ Education Billing Integration initialized');\n    this.startBackgroundJobs();\n  }\n\n  private startBackgroundJobs(): void {\n    // Check overdue payments daily\n    setInterval(() => this.checkOverduePayments(), 24 * 60 * 60 * 1000);\n    \n    // Process auto-payments daily\n    setInterval(() => this.processAutoPayments(), 24 * 60 * 60 * 1000);\n    \n    // Apply mining earnings hourly\n    setInterval(() => this.applyMiningEarnings(), 60 * 60 * 1000);\n    \n    // Disburse financial aid monthly\n    setInterval(() => this.disburseFinancialAid(), 30 * 24 * 60 * 60 * 1000);\n  }\n\n  // ==================== ACCOUNT MANAGEMENT ====================\n\n  async createEducationAccount(data: {\n    studentNumber: string;\n    studentName: string;\n    institution: string;\n    program: string;\n    academicYear: string;\n    tuitionFees: number;\n    additionalFees?: Partial<EducationAccount['additionalFees']>;\n  }): Promise<EducationAccount> {\n    const accountId = uuidv4();\n    \n    const additionalFees = {\n      registration: data.additionalFees?.registration || 0,\n      technology: data.additionalFees?.technology || 0,\n      library: data.additionalFees?.library || 0,\n      sports: data.additionalFees?.sports || 0,\n      insurance: data.additionalFees?.insurance || 0,\n      other: data.additionalFees?.other || 0,\n    };\n    \n    const totalAdditional = Object.values(additionalFees).reduce((a, b) => a + b, 0);\n    const totalDue = data.tuitionFees + totalAdditional;\n    \n    const account: EducationAccount = {\n      id: accountId,\n      studentNumber: data.studentNumber,\n      studentName: data.studentName,\n      institution: data.institution,\n      program: data.program,\n      academicYear: data.academicYear,\n      totalTuitionFees: data.tuitionFees,\n      additionalFees,\n      totalDue,\n      totalPaid: 0,\n      balance: totalDue,\n      preferredPaymentMethod: 'mint-wallet',\n      autoPayEnabled: false,\n      autoPaySource: 'student-wallet',\n      miningEarningsAutoApply: true,\n      miningEarningsApplied: 0,\n      financialAid: [],\n      scholarships: [],\n      linkedWallets: {\n        parentWallets: [],\n      },\n      accountStatus: 'active',\n      holds: [],\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    \n    this.accounts.set(accountId, account);\n    \n    // Auto-create student Mint wallet if not exists\n    await this.createStudentWallet(data.studentNumber, data.studentName);\n    \n    this.emit('account-created', account);\n    return account;\n  }\n\n  async linkWallet(\n    accountId: string,\n    walletId: string,\n    walletType: 'student' | 'parent'\n  ): Promise<void> {\n    const account = this.accounts.get(accountId);\n    if (!account) {throw new Error('Account not found');}\n    \n    if (walletType === 'student') {\n      account.linkedWallets.studentWallet = walletId;\n    } else {\n      account.linkedWallets.parentWallets.push(walletId);\n    }\n    \n    account.updatedAt = new Date();\n    this.emit('wallet-linked', { accountId, walletId, walletType });\n  }\n\n  private async createStudentWallet(\n    studentNumber: string,\n    studentName: string\n  ): Promise<string> {\n    // Create Mint wallet via MintWalletService\n    const wallet = await this.config.mintWalletService.createWallet({\n      userId: studentNumber,\n      userName: studentName,\n      walletType: 'student',\n      autoStakingEnabled: true,\n      miningEnabled: true,\n    });\n    \n    return wallet.id;\n  }\n\n  // ==================== PAYMENT PROCESSING ====================\n\n  async processPayment(payment: {\n    accountId: string;\n    amount: number;\n    currency: 'ZAR' | 'USD' | 'AZR' | 'BTC' | 'ETH' | 'USDC';\n    method: TuitionPayment['method'];\n    source: string;\n    appliedTo: TuitionPayment['appliedTo'];\n  }): Promise<TuitionPayment> {\n    const account = this.accounts.get(payment.accountId);\n    if (!account) {throw new Error('Account not found');}\n    \n    const paymentId = uuidv4();\n    const paymentNumber = `PAY-EDU-${this.paymentCounter++}`;\n    \n    const tuitionPayment: TuitionPayment = {\n      id: paymentId,\n      paymentNumber,\n      accountId: payment.accountId,\n      studentNumber: account.studentNumber,\n      amount: payment.amount,\n      currency: payment.currency,\n      method: payment.method,\n      source: payment.source,\n      appliedTo: payment.appliedTo,\n      status: 'pending',\n      fromMiningEarnings: false,\n      createdAt: new Date(),\n    };\n    \n    this.payments.set(paymentId, tuitionPayment);\n    \n    // Process payment based on method\n    try {\n      if (payment.method === 'mint-wallet') {\n        await this.processWalletPayment(tuitionPayment);\n      } else if (payment.method === 'crypto') {\n        await this.processCryptoPayment(tuitionPayment);\n      } else if (payment.method === 'bank-transfer') {\n        await this.processBankTransfer(tuitionPayment);\n      }\n      \n      // Update account balance\n      account.totalPaid += payment.amount;\n      account.balance -= payment.amount;\n      account.updatedAt = new Date();\n      \n      // Check if balance is cleared, release holds\n      if (account.balance <= 0) {\n        await this.releaseAllHolds(payment.accountId);\n      }\n      \n      tuitionPayment.status = 'completed';\n      tuitionPayment.processedAt = new Date();\n      \n      this.emit('payment-completed', tuitionPayment);\n      \n      // Send receipt\n      await this.sendPaymentReceipt(tuitionPayment, account);\n      \n    } catch (error) {\n      tuitionPayment.status = 'failed';\n      this.emit('payment-failed', { payment: tuitionPayment, error });\n      throw error;\n    }\n    \n    return tuitionPayment;\n  }\n\n  private async processWalletPayment(payment: TuitionPayment): Promise<void> {\n    // Deduct from Mint wallet\n    await this.config.mintWalletService.deductFunds({\n      walletId: payment.source,\n      amount: payment.amount,\n      currency: payment.currency,\n      purpose: 'tuition-payment',\n      reference: payment.paymentNumber,\n    });\n  }\n\n  private async processCryptoPayment(payment: TuitionPayment): Promise<void> {\n    // Process crypto payment (already handled by Mint crypto service)\n    const tx = await this.config.mintWalletService.processCryptoPayment({\n      fromAddress: payment.source,\n      amount: payment.amount,\n      currency: payment.currency,\n      purpose: 'tuition',\n    });\n    \n    payment.transactionHash = tx.hash;\n  }\n\n  private async processBankTransfer(payment: TuitionPayment): Promise<void> {\n    // Process bank transfer (via Luno integration)\n    await this.config.mintWalletService.processBankDeposit({\n      accountNumber: payment.source,\n      amount: payment.amount,\n      reference: payment.paymentNumber,\n    });\n  }\n\n  // ==================== MINING INTEGRATION ====================\n\n  async applyMiningEarnings(): Promise<void> {\n    console.log('‚õèÔ∏è Applying mining earnings to tuition balances...');\n    \n    for (const [accountId, account] of this.accounts) {\n      if (!account.miningEarningsAutoApply) {continue;}\n      if (account.balance <= 0) {continue;}\n      if (!account.linkedWallets.studentWallet) {continue;}\n      \n      try {\n        // Get student's mining earnings\n        const earnings = await this.config.miningService.getUnclaimedEarnings(\n          account.studentNumber\n        );\n        \n        if (earnings.totalAZR > 0) {\n          // Convert to ZAR\n          const zarAmount = earnings.totalAZR * 50; // Assume 1 AZR = R50\n          \n          // Apply to tuition\n          const paymentId = uuidv4();\n          const payment: TuitionPayment = {\n            id: paymentId,\n            paymentNumber: `MINING-${this.paymentCounter++}`,\n            accountId,\n            studentNumber: account.studentNumber,\n            amount: Math.min(zarAmount, account.balance),\n            currency: 'AZR',\n            method: 'mining-earnings',\n            source: account.linkedWallets.studentWallet,\n            appliedTo: 'tuition',\n            status: 'completed',\n            fromMiningEarnings: true,\n            miningSessionId: earnings.sessionId,\n            processedAt: new Date(),\n            createdAt: new Date(),\n          };\n          \n          this.payments.set(paymentId, payment);\n          \n          // Update account\n          account.totalPaid += payment.amount;\n          account.balance -= payment.amount;\n          account.miningEarningsApplied += payment.amount;\n          account.updatedAt = new Date();\n          \n          this.emit('mining-earnings-applied', { account, payment });\n          \n          // Notify student\n          await this.config.notificationService.send({\n            to: account.studentNumber,\n            type: 'mining-earnings-applied',\n            title: '‚õèÔ∏è Mining Earnings Applied to Tuition!',\n            message: `R${payment.amount.toFixed(2)} from mining has been applied to your tuition. New balance: R${account.balance.toFixed(2)}`,\n          });\n        }\n      } catch (error) {\n        console.error(`Failed to apply mining earnings for ${account.studentNumber}:`, error);\n      }\n    }\n  }\n\n  // ==================== PAYMENT PLANS ====================\n\n  async createPaymentPlan(request: {\n    accountId: string;\n    type: PaymentPlan['type'];\n    depositAmount: number;\n  }): Promise<PaymentPlan> {\n    const account = this.accounts.get(request.accountId);\n    if (!account) {throw new Error('Account not found');}\n    \n    const planId = uuidv4();\n    const remainingBalance = account.balance - request.depositAmount;\n    \n    const installmentCount = this.getInstallmentCount(request.type);\n    const installmentAmount = remainingBalance / installmentCount;\n    \n    const installments: Installment[] = [];\n    const startDate = new Date();\n    \n    for (let i = 0; i < installmentCount; i++) {\n      const dueDate = this.calculateDueDate(startDate, request.type, i + 1);\n      \n      installments.push({\n        id: uuidv4(),\n        installmentNumber: i + 1,\n        dueDate,\n        amount: installmentAmount,\n        status: 'pending',\n      });\n    }\n    \n    const plan: PaymentPlan = {\n      id: planId,\n      accountId: request.accountId,\n      type: request.type,\n      totalAmount: account.balance,\n      installments,\n      depositRequired: request.depositAmount,\n      depositPaid: false,\n      status: 'active',\n      createdAt: new Date(),\n    };\n    \n    this.paymentPlans.set(planId, plan);\n    account.paymentPlan = plan;\n    \n    this.emit('payment-plan-created', plan);\n    return plan;\n  }\n\n  private getInstallmentCount(type: PaymentPlan['type']): number {\n    switch (type) {\n      case 'monthly': return 10; // 10 months\n      case 'quarterly': return 4;\n      case 'semesterly': return 2;\n      case 'annual': return 1;\n    }\n  }\n\n  private calculateDueDate(\n    startDate: Date,\n    type: PaymentPlan['type'],\n    installmentNumber: number\n  ): Date {\n    const due = new Date(startDate);\n    \n    switch (type) {\n      case 'monthly':\n        due.setMonth(due.getMonth() + installmentNumber);\n        break;\n      case 'quarterly':\n        due.setMonth(due.getMonth() + (installmentNumber * 3));\n        break;\n      case 'semesterly':\n        due.setMonth(due.getMonth() + (installmentNumber * 6));\n        break;\n      case 'annual':\n        due.setFullYear(due.getFullYear() + installmentNumber);\n        break;\n    }\n    \n    return due;\n  }\n\n  // ==================== AUTO-PAYMENTS ====================\n\n  private async processAutoPayments(): Promise<void> {\n    console.log('ü§ñ Processing auto-payments...');\n    \n    for (const [accountId, account] of this.accounts) {\n      if (!account.autoPayEnabled) {continue;}\n      if (account.balance <= 0) {continue;}\n      if (!account.paymentPlan) {continue;}\n      \n      const plan = account.paymentPlan;\n      const nextInstallment = plan.installments.find(i => i.status === 'pending');\n      \n      if (!nextInstallment) {continue;}\n      \n      // Check if due today\n      const today = new Date();\n      if (nextInstallment.dueDate.toDateString() === today.toDateString()) {\n        try {\n          let sourceWallet: string | undefined;\n          \n          if (account.autoPaySource === 'student-wallet') {\n            sourceWallet = account.linkedWallets.studentWallet;\n          } else if (account.autoPaySource === 'parent-wallet') {\n            sourceWallet = account.linkedWallets.parentWallets[0];\n          } else if (account.autoPaySource === 'family-savings') {\n            sourceWallet = account.linkedWallets.familySavingsAccount;\n          }\n          \n          if (!sourceWallet) {\n            console.warn(`No source wallet for auto-payment: ${accountId}`);\n            continue;\n          }\n          \n          await this.processPayment({\n            accountId,\n            amount: nextInstallment.amount,\n            currency: 'ZAR',\n            method: 'mint-wallet',\n            source: sourceWallet,\n            appliedTo: 'installment',\n          });\n          \n          nextInstallment.status = 'paid';\n          nextInstallment.paidDate = new Date();\n          \n        } catch (error) {\n          console.error(`Auto-payment failed for ${accountId}:`, error);\n          \n          // Notify student\n          await this.config.notificationService.send({\n            to: account.studentNumber,\n            type: 'auto-payment-failed',\n            title: '‚ö†Ô∏è Auto-Payment Failed',\n            message: `Your auto-payment of R${nextInstallment.amount.toFixed(2)} failed. Please check your wallet balance.`,\n          });\n        }\n      }\n    }\n  }\n\n  // ==================== FINANCIAL HOLDS ====================\n\n  async applyHold(\n    accountId: string,\n    hold: Omit<FinancialHold, 'id' | 'accountId' | 'appliedDate' | 'status'>\n  ): Promise<void> {\n    const account = this.accounts.get(accountId);\n    if (!account) {throw new Error('Account not found');}\n    \n    const newHold: FinancialHold = {\n      id: uuidv4(),\n      accountId,\n      ...hold,\n      appliedDate: new Date(),\n      status: 'active',\n    };\n    \n    account.holds.push(newHold);\n    account.accountStatus = 'hold';\n    account.updatedAt = new Date();\n    \n    this.emit('hold-applied', newHold);\n  }\n\n  async releaseAllHolds(accountId: string): Promise<void> {\n    const account = this.accounts.get(accountId);\n    if (!account) {throw new Error('Account not found');}\n    \n    for (const hold of account.holds) {\n      if (hold.status === 'active') {\n        hold.status = 'released';\n        hold.releasedDate = new Date();\n      }\n    }\n    \n    account.accountStatus = 'active';\n    account.updatedAt = new Date();\n    \n    this.emit('holds-released', accountId);\n  }\n\n  // ==================== UTILITIES ====================\n\n  private async checkOverduePayments(): Promise<void> {\n    const today = new Date();\n    \n    for (const [accountId, account] of this.accounts) {\n      if (!account.paymentPlan) {continue;}\n      \n      const overdueInstallments = account.paymentPlan.installments.filter(\n        i => i.status === 'pending' && i.dueDate < today\n      );\n      \n      if (overdueInstallments.length > 0) {\n        for (const installment of overdueInstallments) {\n          installment.status = 'overdue';\n        }\n        \n        // Apply hold\n        await this.applyHold(accountId, {\n          type: 'registration',\n          reason: 'Overdue payment',\n          amountOwed: account.balance,\n        });\n        \n        // Notify student\n        await this.config.notificationService.send({\n          to: account.studentNumber,\n          type: 'payment-overdue',\n          title: 'üö® Payment Overdue',\n          message: `You have ${overdueInstallments.length} overdue payment(s). Total owed: R${account.balance.toFixed(2)}`,\n        });\n      }\n    }\n  }\n\n  private async disburseFinancialAid(): Promise<void> {\n    console.log('üí∞ Disbursing financial aid...');\n    \n    const today = new Date();\n    \n    for (const [accountId, account] of this.accounts) {\n      for (const aid of account.financialAid) {\n        if (aid.status !== 'approved') {continue;}\n        \n        for (const disbursement of aid.disbursementSchedule) {\n          if (disbursement.status !== 'pending') {continue;}\n          if (disbursement.date > today) {continue;}\n          \n          try {\n            // Apply to account balance\n            account.totalPaid += disbursement.amount;\n            account.balance -= disbursement.amount;\n            \n            disbursement.status = 'disbursed';\n            \n            this.emit('financial-aid-disbursed', { account, aid, disbursement });\n            \n          } catch (error) {\n            console.error(`Failed to disburse aid for ${account.studentNumber}:`, error);\n          }\n        }\n      }\n    }\n  }\n\n  private async sendPaymentReceipt(\n    payment: TuitionPayment,\n    account: EducationAccount\n  ): Promise<void> {\n    // Generate PDF receipt and email to student\n    await this.config.notificationService.send({\n      to: account.studentNumber,\n      type: 'payment-receipt',\n      title: '‚úÖ Payment Received',\n      message: `Your payment of R${payment.amount.toFixed(2)} has been received. New balance: R${account.balance.toFixed(2)}`,\n      attachments: [\n        {\n          filename: `receipt-${payment.paymentNumber}.pdf`,\n          content: await this.generateReceiptPDF(payment, account),\n        },\n      ],\n    });\n  }\n\n  private async generateReceiptPDF(\n    payment: TuitionPayment,\n    account: EducationAccount\n  ): Promise<Buffer> {\n    // Generate PDF receipt (mock for now)\n    return Buffer.from('PDF receipt');\n  }\n\n  // ==================== ANALYTICS ====================\n\n  async getAccountSummary(accountId: string): Promise<any> {\n    const account = this.accounts.get(accountId);\n    if (!account) {throw new Error('Account not found');}\n    \n    const payments = Array.from(this.payments.values())\n      .filter(p => p.accountId === accountId);\n    \n    return {\n      account,\n      payments,\n      statistics: {\n        totalPaid: account.totalPaid,\n        balance: account.balance,\n        percentagePaid: (account.totalPaid / account.totalDue) * 100,\n        miningEarningsApplied: account.miningEarningsApplied,\n        activeHolds: account.holds.filter(h => h.status === 'active').length,\n      },\n    };\n  }\n}\n\n// ==================== EXPORT ====================\n\nexport default EducationBillingIntegration;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}