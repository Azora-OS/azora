{"version":3,"names":["cov_17ki00nwrh","actualCoverage","express","s","require","cors","helmet","compression","rateLimit","jwt","app","use","origin","b","process","env","ALLOWED_ORIGINS","split","credentials","optionsSuccessStatus","validateInput","req","res","next","f","body","Object","keys","forEach","key","replace","json","limit","console","log","proposals","Map","votes","policies","get","status","service","ubuntu","size","timestamp","Date","toISOString","post","title","description","proposerId","type","proposal","id","now","votesFor","votesAgainst","createdAt","set","success","message","data","error","params","userId","vote","voteRecord","proposalId","PORT","listen","module","exports"],"sources":["server.js"],"sourcesContent":["const express = require('express');\nconst cors = require('cors');\nconst helmet = require('helmet');\nconst compression = require('compression');\nconst rateLimit = require('express-rate-limit');\nconst jwt = require('jsonwebtoken');\n\nconst app = express();\n\napp.use(helmet());\napp.use(cors({\n  origin: process.env.ALLOWED_ORIGINS?.split(',') || ['http://localhost:3000'],\n  credentials: true,\n  optionsSuccessStatus: 200\n}));\napp.use(compression());\n\n// Input validation middleware\nconst validateInput = (req, res, next) => {\n  if (req.body) {\n    Object.keys(req.body).forEach(key => {\n      if (typeof req.body[key] === 'string') {\n        req.body[key] = req.body[key].replace(/<script[^>]*>.*?<\\/script>/gi, '');\n        req.body[key] = req.body[key].replace(/javascript:/gi, '');\n      }\n    });\n  }\n  next();\n};\napp.use(validateInput);\n\napp.use(express.json({ limit: '10mb' }));\n\n// ðŸ›ï¸ AZORA GOVERNANCE - CONSTITUTIONAL AI\nconsole.log('ðŸŒŸ Azora Governance Service - Initializing...');\n\nconst proposals = new Map();\nconst votes = new Map();\nconst policies = new Map();\n\n// ðŸŽ¯ API ROUTES\napp.get('/api/health', (req, res) => {\n  res.json({\n    status: 'healthy',\n    service: 'governance-service',\n    ubuntu: 'I govern because we decide together',\n    proposals: proposals.size,\n    timestamp: new Date().toISOString()\n  });\n});\n\n// Create governance proposal\napp.post('/api/proposals', (req, res) => {\n  try {\n    const { title, description, proposerId, type } = req.body;\n    \n    const proposal = {\n      id: `prop_${Date.now()}`,\n      title,\n      description,\n      proposerId,\n      type: type || 'POLICY',\n      status: 'ACTIVE',\n      votesFor: 0,\n      votesAgainst: 0,\n      createdAt: new Date().toISOString()\n    };\n    \n    proposals.set(proposal.id, proposal);\n    \n    res.status(201).json({\n      success: true,\n      message: 'Proposal created successfully',\n      data: proposal\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to create proposal' });\n  }\n});\n\n// Vote on proposal\napp.post('/api/proposals/:id/vote', (req, res) => {\n  try {\n    const { id } = req.params;\n    const { userId, vote } = req.body;\n    \n    const proposal = proposals.get(id);\n    if (!proposal) {\n      return res.status(404).json({ error: 'Proposal not found' });\n    }\n    \n    const voteRecord = {\n      id: `vote_${Date.now()}`,\n      proposalId: id,\n      userId,\n      vote: vote, // 'FOR' or 'AGAINST'\n      timestamp: new Date().toISOString()\n    };\n    \n    votes.set(voteRecord.id, voteRecord);\n    \n    // Update proposal vote counts\n    if (vote === 'FOR') {\n      proposal.votesFor++;\n    } else {\n      proposal.votesAgainst++;\n    }\n    \n    proposals.set(id, proposal);\n    \n    res.json({\n      success: true,\n      message: 'Vote recorded successfully',\n      data: voteRecord\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to record vote' });\n  }\n});\n\nconst PORT = process.env.PORT || 3026;\napp.listen(PORT, () => {\n  console.log('ðŸŒŸ Azora Governance Service running on port', PORT);\n});\n\nmodule.exports = app;"],"mappings":"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","ignoreList":[]}