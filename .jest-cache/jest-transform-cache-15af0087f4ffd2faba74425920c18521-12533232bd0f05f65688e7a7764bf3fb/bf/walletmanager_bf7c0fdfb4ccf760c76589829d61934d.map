{"version":3,"names":["cov_rf87ke4hw","actualCoverage","WalletManager","constructor","f","s","wallets","Map","createWallet","userId","has","b","success","reason","wallet","balances","AZR","BTC","ETH","USD","transactions","createdAt","Date","address","generateAddress","set","getWallet","get","result","updateBalance","currency","amount","hasOwnProperty","transaction","txId","generateTxId","type","balance","timestamp","push","newBalance","transfer","fromUserId","toUserId","fromWallet","from","to","getBalance","getTransactionHistory","limit","slice","reverse","crypto","require","createHash","update","now","toString","digest","substring","randomBytes","module","exports"],"sources":["wallet-manager.js"],"sourcesContent":["class WalletManager {\n  constructor() {\n    this.wallets = new Map();\n  }\n\n  createWallet(userId) {\n    if (this.wallets.has(userId)) {\n      return { success: false, reason: 'Wallet already exists' };\n    }\n\n    const wallet = {\n      userId,\n      balances: { AZR: 0, BTC: 0, ETH: 0, USD: 0 },\n      transactions: [],\n      createdAt: new Date(),\n      address: this.generateAddress(userId)\n    };\n\n    this.wallets.set(userId, wallet);\n    return { success: true, wallet };\n  }\n\n  getWallet(userId) {\n    let wallet = this.wallets.get(userId);\n    if (!wallet) {\n      const result = this.createWallet(userId);\n      wallet = result.wallet;\n    }\n    return wallet;\n  }\n\n  updateBalance(userId, currency, amount) {\n    const wallet = this.getWallet(userId);\n    \n    if (!wallet.balances.hasOwnProperty(currency)) {\n      wallet.balances[currency] = 0;\n    }\n\n    wallet.balances[currency] += amount;\n\n    const transaction = {\n      txId: this.generateTxId(),\n      currency,\n      amount,\n      type: amount > 0 ? 'credit' : 'debit',\n      balance: wallet.balances[currency],\n      timestamp: new Date()\n    };\n\n    wallet.transactions.push(transaction);\n    return { success: true, transaction, newBalance: wallet.balances[currency] };\n  }\n\n  transfer(fromUserId, toUserId, currency, amount) {\n    const fromWallet = this.getWallet(fromUserId);\n    \n    if (!fromWallet.balances[currency] || fromWallet.balances[currency] < amount) {\n      return { success: false, reason: 'Insufficient balance' };\n    }\n\n    this.updateBalance(fromUserId, currency, -amount);\n    this.updateBalance(toUserId, currency, amount);\n\n    return {\n      success: true,\n      from: fromUserId,\n      to: toUserId,\n      amount,\n      currency,\n      timestamp: new Date()\n    };\n  }\n\n  getBalance(userId, currency = null) {\n    const wallet = this.getWallet(userId);\n    return currency ? wallet.balances[currency] : wallet.balances;\n  }\n\n  getTransactionHistory(userId, limit = 50) {\n    const wallet = this.getWallet(userId);\n    return wallet.transactions.slice(-limit).reverse();\n  }\n\n  generateAddress(userId) {\n    const crypto = require('crypto');\n    return 'AZR' + crypto.createHash('sha256')\n      .update(userId + Date.now().toString())\n      .digest('hex')\n      .substring(0, 40);\n  }\n\n  generateTxId() {\n    const crypto = require('crypto');\n    return crypto.randomBytes(16).toString('hex');\n  }\n}\n\nmodule.exports = new WalletManager();\n"],"mappings":"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","ignoreList":[]}