{"version":3,"names":["cov_quez5eyt1","actualCoverage","axios","FormData","fs","IpfsService","constructor","f","s","pinataApiKey","b","process","env","PINATA_API_KEY","pinataSecretApiKey","PINATA_SECRET_API_KEY","gatewayUrl","IPFS_GATEWAY_URL","uploadJSON","data","console","warn","mockCid","Math","random","toString","substring","success","cid","url","response","post","headers","IpfsHash","error","message","uploadFile","filePath","append","createReadStream","maxBodyLength","Infinity","getBoundary","getGatewayUrl"],"sources":["ipfs-service.ts"],"sourcesContent":["import axios from 'axios';\nimport FormData from 'form-data';\nimport fs from 'fs';\n\nexport interface IpfsResult {\n    success: boolean;\n    cid?: string;\n    url?: string;\n    error?: string;\n}\n\nexport class IpfsService {\n    private pinataApiKey: string;\n    private pinataSecretApiKey: string;\n    private gatewayUrl: string;\n\n    constructor() {\n        this.pinataApiKey = process.env.PINATA_API_KEY || '';\n        this.pinataSecretApiKey = process.env.PINATA_SECRET_API_KEY || '';\n        this.gatewayUrl = process.env.IPFS_GATEWAY_URL || 'https://gateway.pinata.cloud/ipfs';\n    }\n\n    async uploadJSON(data: any): Promise<IpfsResult> {\n        try {\n            // If no API keys, return a mock CID for development\n            if (!this.pinataApiKey) {\n                console.warn('⚠️ No Pinata API keys found. Using mock IPFS CID.');\n                const mockCid = 'QmMockHash' + Math.random().toString(36).substring(7);\n                return {\n                    success: true,\n                    cid: mockCid,\n                    url: `${this.gatewayUrl}/${mockCid}`\n                };\n            }\n\n            const url = `https://api.pinata.cloud/pinning/pinJSONToIPFS`;\n            const response = await axios.post(url, data, {\n                headers: {\n                    'pinata_api_key': this.pinataApiKey,\n                    'pinata_secret_api_key': this.pinataSecretApiKey\n                }\n            });\n\n            return {\n                success: true,\n                cid: response.data.IpfsHash,\n                url: `${this.gatewayUrl}/${response.data.IpfsHash}`\n            };\n        } catch (error: any) {\n            console.error('IPFS upload error:', error.message);\n            return {\n                success: false,\n                error: error.message\n            };\n        }\n    }\n\n    async uploadFile(filePath: string): Promise<IpfsResult> {\n        try {\n            if (!this.pinataApiKey) {\n                console.warn('⚠️ No Pinata API keys found. Using mock IPFS CID.');\n                const mockCid = 'QmMockFileHash' + Math.random().toString(36).substring(7);\n                return {\n                    success: true,\n                    cid: mockCid,\n                    url: `${this.gatewayUrl}/${mockCid}`\n                };\n            }\n\n            const url = `https://api.pinata.cloud/pinning/pinFileToIPFS`;\n            const data = new FormData();\n            data.append('file', fs.createReadStream(filePath));\n\n            const response = await axios.post(url, data, {\n                maxBodyLength: Infinity,\n                headers: {\n                    'Content-Type': `multipart/form-data; boundary=${data.getBoundary()}`,\n                    'pinata_api_key': this.pinataApiKey,\n                    'pinata_secret_api_key': this.pinataSecretApiKey\n                }\n            });\n\n            return {\n                success: true,\n                cid: response.data.IpfsHash,\n                url: `${this.gatewayUrl}/${response.data.IpfsHash}`\n            };\n        } catch (error: any) {\n            console.error('IPFS file upload error:', error.message);\n            return {\n                success: false,\n                error: error.message\n            };\n        }\n    }\n\n    getGatewayUrl(cid: string): string {\n        return `${this.gatewayUrl}/${cid}`;\n    }\n}\n"],"mappings":"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","ignoreList":[]}