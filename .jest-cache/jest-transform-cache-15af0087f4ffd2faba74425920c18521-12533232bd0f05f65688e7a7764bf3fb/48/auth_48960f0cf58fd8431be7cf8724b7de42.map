{"version":3,"names":["cov_1krmv5rwb5","actualCoverage","jwt","s","authMiddleware","req","res","next","f","token","headers","authorization","split","b","status","json","success","error","decoded","verify","process","env","JWT_SECRET","userId","user","optionalAuthMiddleware"],"sources":["auth.ts"],"sourcesContent":["import { Request, Response, NextFunction } from 'express';\nimport jwt from 'jsonwebtoken';\n\nexport interface AuthRequest extends Request {\n  userId?: string;\n  user?: any;\n}\n\nexport const authMiddleware = (req: AuthRequest, res: Response, next: NextFunction) => {\n  try {\n    const token = req.headers.authorization?.split(' ')[1];\n    \n    if (!token) {\n      return res.status(401).json({ success: false, error: 'No token provided' });\n    }\n\n    const decoded = jwt.verify(token, process.env.JWT_SECRET || 'secret');\n    req.userId = (decoded as any).userId;\n    req.user = decoded;\n    next();\n  } catch (error) {\n    return res.status(401).json({ success: false, error: 'Invalid token' });\n  }\n};\n\nexport const optionalAuthMiddleware = (req: AuthRequest, res: Response, next: NextFunction) => {\n  try {\n    const token = req.headers.authorization?.split(' ')[1];\n    \n    if (token) {\n      const decoded = jwt.verify(token, process.env.JWT_SECRET || 'secret');\n      req.userId = (decoded as any).userId;\n      req.user = decoded;\n    }\n    next();\n  } catch (error) {\n    // Continue without authentication\n    next();\n  }\n};\n"],"mappings":"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","ignoreList":[]}