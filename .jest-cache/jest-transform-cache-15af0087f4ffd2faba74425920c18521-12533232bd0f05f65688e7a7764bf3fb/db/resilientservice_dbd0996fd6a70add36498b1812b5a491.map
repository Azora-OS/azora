{"version":3,"names":["cov_2eai22tglk","actualCoverage","OfflineAdapter","ResilientEducationService","constructor","f","s","offlineAdapter","lessonTemplates","initializeTemplates","templates","Map","set","generateLesson","topic","level","cacheKey","response","fetch","method","headers","body","JSON","stringify","signal","AbortSignal","timeout","ok","b","lesson","json","cacheData","error","console","warn","cached","getCachedData","template","get","content","timestamp","Date","toISOString","submitAssignment","userId","assignmentId","answers","queueOperation","log","getOfflineStatus","getQueueStatus"],"sources":["resilient-service.ts"],"sourcesContent":["import { OfflineAdapter } from './offline-adapter';\n\nexport interface CachedLesson {\n    topic: string;\n    content: string;\n    level: string;\n    timestamp: string;\n}\n\nexport class ResilientEducationService {\n    private offlineAdapter: OfflineAdapter<CachedLesson>;\n    private lessonTemplates: Map<string, string>;\n\n    constructor() {\n        this.offlineAdapter = new OfflineAdapter<CachedLesson>();\n        this.lessonTemplates = this.initializeTemplates();\n    }\n\n    /**\n     * Initialize fallback lesson templates\n     */\n    private initializeTemplates(): Map<string, string> {\n        const templates = new Map();\n\n        templates.set('mathematics', `\n# Mathematics Lesson\n\n## Introduction\nThis lesson covers fundamental mathematical concepts.\n\n## Key Concepts\n- Problem solving\n- Logical thinking\n- Pattern recognition\n\n## Practice Exercises\n1. Solve basic equations\n2. Apply concepts to real-world problems\n    `);\n\n        templates.set('science', `\n# Science Lesson\n\n## Introduction\nExplore the wonders of science through observation and experimentation.\n\n## Key Concepts\n- Scientific method\n- Observation and hypothesis\n- Experimentation\n\n## Activities\n1. Conduct simple experiments\n2. Record observations\n    `);\n\n        return templates;\n    }\n\n    /**\n     * Generate lesson with offline fallback\n     */\n    async generateLesson(topic: string, level: string): Promise<CachedLesson> {\n        const cacheKey = `lesson-${topic}-${level}`;\n\n        try {\n            // Try online generation\n            const response = await fetch('http://localhost:3002/api/generate-lesson', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ topic, level }),\n                signal: AbortSignal.timeout(5000)\n            });\n\n            if (response.ok) {\n                const lesson = await response.json();\n\n                // Cache for offline use\n                this.offlineAdapter.cacheData(cacheKey, lesson, 1440); // 24 hours\n\n                return lesson;\n            }\n        } catch (error) {\n            console.warn('Online generation failed, using offline fallback');\n        }\n\n        // Try cached version\n        const cached = this.offlineAdapter.getCachedData(cacheKey);\n        if (cached) {\n            return cached;\n        }\n\n        // Use template as last resort\n        const template = this.lessonTemplates.get(topic) || this.lessonTemplates.get('mathematics')!;\n\n        return {\n            topic,\n            content: template,\n            level,\n            timestamp: new Date().toISOString()\n        };\n    }\n\n    /**\n     * Submit assignment with offline queue\n     */\n    async submitAssignment(userId: string, assignmentId: string, answers: any): Promise<void> {\n        try {\n            await fetch('http://localhost:3002/api/submit-assignment', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ userId, assignmentId, answers }),\n                signal: AbortSignal.timeout(5000)\n            });\n        } catch (error) {\n            // Queue for later submission\n            this.offlineAdapter.queueOperation('submit-assignment', {\n                userId,\n                assignmentId,\n                answers\n            });\n            console.log('ðŸ“¥ Assignment queued for submission when online');\n        }\n    }\n\n    /**\n     * Get offline status\n     */\n    getOfflineStatus() {\n        return this.offlineAdapter.getQueueStatus();\n    }\n}\n\nexport default ResilientEducationService;\n"],"mappings":"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","ignoreList":[]}