{"version":3,"names":["cov_2ccoajt5e8","actualCoverage","crypto","s","require","ALGORITHM","KEY_LENGTH","IV_LENGTH","AUTH_TAG_LENGTH","getEncryptionKey","f","key","process","env","ENCRYPTION_KEY","b","Error","Buffer","from","encrypt","text","iv","randomBytes","cipher","createCipheriv","encrypted","update","final","authTag","getAuthTag","toString","decrypt","decipher","createDecipheriv","setAuthTag","decrypted","hashPassword","password","pbkdf2Sync","SALT","module","exports"],"sources":["encryption.js"],"sourcesContent":["const crypto = require('crypto');\n\nconst ALGORITHM = 'aes-256-gcm';\nconst KEY_LENGTH = 32;\nconst IV_LENGTH = 16;\nconst AUTH_TAG_LENGTH = 16;\n\nfunction getEncryptionKey() {\n  const key = process.env.ENCRYPTION_KEY;\n  if (!key) throw new Error('ENCRYPTION_KEY not configured');\n  return Buffer.from(key, 'hex');\n}\n\nfunction encrypt(text) {\n  const key = getEncryptionKey();\n  const iv = crypto.randomBytes(IV_LENGTH);\n  const cipher = crypto.createCipheriv(ALGORITHM, key, iv);\n  \n  let encrypted = cipher.update(text, 'utf8', 'hex');\n  encrypted += cipher.final('hex');\n  \n  const authTag = cipher.getAuthTag();\n  \n  return {\n    encrypted,\n    iv: iv.toString('hex'),\n    authTag: authTag.toString('hex')\n  };\n}\n\nfunction decrypt(encrypted, iv, authTag) {\n  const key = getEncryptionKey();\n  const decipher = crypto.createDecipheriv(\n    ALGORITHM,\n    key,\n    Buffer.from(iv, 'hex')\n  );\n  \n  decipher.setAuthTag(Buffer.from(authTag, 'hex'));\n  \n  let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n  decrypted += decipher.final('utf8');\n  \n  return decrypted;\n}\n\nfunction hashPassword(password) {\n  return crypto.pbkdf2Sync(password, process.env.SALT || 'azora-salt', 100000, 64, 'sha512').toString('hex');\n}\n\nmodule.exports = { encrypt, decrypt, hashPassword };\n"],"mappings":"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","ignoreList":[]}