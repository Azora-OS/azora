{"version":3,"names":["cov_qnosfk3ci","actualCoverage","helmet","rateLimit","mongoSanitize","xss","hpp","securityHeaders","s","contentSecurityPolicy","directives","defaultSrc","scriptSrc","styleSrc","imgSrc","connectSrc","fontSrc","objectSrc","mediaSrc","frameSrc","crossOriginEmbedderPolicy","crossOriginOpenerPolicy","crossOriginResourcePolicy","policy","dnsPrefetchControl","frameguard","action","hidePoweredBy","hsts","maxAge","includeSubDomains","preload","ieNoOpen","noSniff","referrerPolicy","xssFilter","createRateLimiter","windowMs","b","max","f","message","standardHeaders","legacyHeaders","skip","req","path","authRateLimiter","skipSuccessfulRequests","inputSanitization","replaceWith","onSanitize","key","console","warn","whitelist","corsConfig","origin","process","env","ALLOWED_ORIGINS","split","credentials","methods","allowedHeaders","sqlInjectionPrevention","AuthenticationSecurity","validatePassword","password","errors","length","push","test","valid","getSessionConfig","secret","SESSION_SECRET","resave","saveUninitialized","cookie","secure","NODE_ENV","httpOnly","sameSite","regenerateSession","Promise","resolve","reject","session","regenerate","err","DataProtection","encryptField","value","Buffer","from","toString","decryptField","encrypted","maskSensitiveData","data","sensitiveFields","masked","JSON","parse","stringify","maskField","obj","some","field","toLowerCase","includes","AccessControl","verifyResourceOwnership","resourceOwnerId","userId","user","id","hasRole","requiredRoles","userRoles","roles","role","requireRole","res","next","status","json","error","SecurityLogging","logSecurityEvent","eventType","details","severity","event","timestamp","Date","ip","userAgent","log","logFailedAuth","email","reason","logSuccessfulAuth","logUnauthorizedAccess","resource","logDataAccess","dataType","ComplianceHelpers","deleteUserData","exportUserData","recordConsent","consentType","version","logAuditEvent","actor","changes","auditEvent"],"sources":["remediation.ts"],"sourcesContent":["/**\n * Security Remediation Implementation\n * Addresses identified vulnerabilities from penetration testing\n */\n\nimport helmet from 'helmet';\nimport rateLimit from 'express-rate-limit';\nimport mongoSanitize from 'express-mongo-sanitize';\nimport xss from 'xss-clean';\nimport hpp from 'hpp';\nimport { Request, Response, NextFunction } from 'express';\n\n/**\n * Security Headers Middleware\n * Implements OWASP recommended security headers\n */\nexport const securityHeaders = helmet({\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [\"'self'\"],\n      scriptSrc: [\"'self'\", \"'unsafe-inline'\"],\n      styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n      imgSrc: [\"'self'\", 'data:', 'https:'],\n      connectSrc: [\"'self'\"],\n      fontSrc: [\"'self'\"],\n      objectSrc: [\"'none'\"],\n      mediaSrc: [\"'self'\"],\n      frameSrc: [\"'none'\"],\n    },\n  },\n  crossOriginEmbedderPolicy: true,\n  crossOriginOpenerPolicy: true,\n  crossOriginResourcePolicy: { policy: 'cross-origin' },\n  dnsPrefetchControl: true,\n  frameguard: { action: 'deny' },\n  hidePoweredBy: true,\n  hsts: {\n    maxAge: 31536000,\n    includeSubDomains: true,\n    preload: true,\n  },\n  ieNoOpen: true,\n  noSniff: true,\n  referrerPolicy: { policy: 'strict-origin-when-cross-origin' },\n  xssFilter: true,\n});\n\n/**\n * Rate Limiting Middleware\n * Prevents brute force and DoS attacks\n */\nexport const createRateLimiter = (windowMs = 15 * 60 * 1000, max = 100) => {\n  return rateLimit({\n    windowMs,\n    max,\n    message: 'Too many requests from this IP, please try again later.',\n    standardHeaders: true,\n    legacyHeaders: false,\n    skip: (req: Request) => {\n      // Skip rate limiting for health checks\n      return req.path === '/health';\n    },\n  });\n};\n\n/**\n * Strict Rate Limiter for Authentication\n * Prevents brute force attacks on login endpoints\n */\nexport const authRateLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 5,\n  message: 'Too many login attempts, please try again later.',\n  skipSuccessfulRequests: true,\n});\n\n/**\n * Input Validation & Sanitization\n */\nexport const inputSanitization = [\n  mongoSanitize({\n    replaceWith: '_',\n    onSanitize: ({ req, key }) => {\n      console.warn(`Potential NoSQL injection detected in ${key}`);\n    },\n  }),\n  xss(),\n  hpp({\n    whitelist: ['sort', 'fields', 'filter', 'page', 'limit'],\n  }),\n];\n\n/**\n * CORS Configuration\n */\nexport const corsConfig = {\n  origin: process.env.ALLOWED_ORIGINS?.split(',') || ['http://localhost:3000'],\n  credentials: true,\n  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS'],\n  allowedHeaders: ['Content-Type', 'Authorization'],\n  maxAge: 86400,\n};\n\n/**\n * SQL Injection Prevention\n * Use parameterized queries (handled by ORM)\n */\nexport const sqlInjectionPrevention = {\n  // Always use parameterized queries\n  // Example: db.query('SELECT * FROM users WHERE id = ?', [userId])\n  // Never concatenate user input into queries\n};\n\n/**\n * Authentication Security\n */\nexport class AuthenticationSecurity {\n  /**\n   * Password validation rules\n   */\n  static validatePassword(password: string): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    if (password.length < 12) {\n      errors.push('Password must be at least 12 characters long');\n    }\n    if (!/[A-Z]/.test(password)) {\n      errors.push('Password must contain at least one uppercase letter');\n    }\n    if (!/[a-z]/.test(password)) {\n      errors.push('Password must contain at least one lowercase letter');\n    }\n    if (!/[0-9]/.test(password)) {\n      errors.push('Password must contain at least one number');\n    }\n    if (!/[!@#$%^&*]/.test(password)) {\n      errors.push('Password must contain at least one special character');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n\n  /**\n   * Session security\n   */\n  static getSessionConfig() {\n    return {\n      secret: process.env.SESSION_SECRET,\n      resave: false,\n      saveUninitialized: false,\n      cookie: {\n        secure: process.env.NODE_ENV === 'production',\n        httpOnly: true,\n        sameSite: 'strict' as const,\n        maxAge: 24 * 60 * 60 * 1000, // 24 hours\n      },\n    };\n  }\n\n  /**\n   * Regenerate session on login\n   */\n  static regenerateSession(req: Request): Promise<void> {\n    return new Promise((resolve, reject) => {\n      req.session.regenerate((err) => {\n        if (err) {reject(err);}\n        else {resolve();}\n      });\n    });\n  }\n}\n\n/**\n * Data Protection\n */\nexport class DataProtection {\n  /**\n   * Encrypt sensitive fields\n   */\n  static encryptField(value: string, key: string): string {\n    // Implementation would use crypto library\n    // This is a placeholder\n    return Buffer.from(value).toString('base64');\n  }\n\n  /**\n   * Decrypt sensitive fields\n   */\n  static decryptField(encrypted: string, key: string): string {\n    // Implementation would use crypto library\n    // This is a placeholder\n    return Buffer.from(encrypted, 'base64').toString('utf-8');\n  }\n\n  /**\n   * Mask sensitive data in logs\n   */\n  static maskSensitiveData(data: any): any {\n    const sensitiveFields = ['password', 'ssn', 'creditCard', 'apiKey', 'secret'];\n    const masked = JSON.parse(JSON.stringify(data));\n\n    const maskField = (obj: any) => {\n      for (const key in obj) {\n        if (sensitiveFields.some((field) => key.toLowerCase().includes(field.toLowerCase()))) {\n          obj[key] = '***MASKED***';\n        } else if (typeof obj[key] === 'object' && obj[key] !== null) {\n          maskField(obj[key]);\n        }\n      }\n    };\n\n    maskField(masked);\n    return masked;\n  }\n}\n\n/**\n * Access Control\n */\nexport class AccessControl {\n  /**\n   * Verify user owns resource\n   */\n  static verifyResourceOwnership(\n    req: Request,\n    resourceOwnerId: string\n  ): boolean {\n    const userId = (req as any).user?.id;\n    return userId === resourceOwnerId;\n  }\n\n  /**\n   * Check user role\n   */\n  static hasRole(req: Request, requiredRoles: string[]): boolean {\n    const userRoles = (req as any).user?.roles || [];\n    return requiredRoles.some((role) => userRoles.includes(role));\n  }\n\n  /**\n   * Role-based access control middleware\n   */\n  static requireRole(...roles: string[]) {\n    return (req: Request, res: Response, next: NextFunction) => {\n      if (!AccessControl.hasRole(req, roles)) {\n        return res.status(403).json({ error: 'Insufficient permissions' });\n      }\n      next();\n    };\n  }\n}\n\n/**\n * Logging & Monitoring\n */\nexport class SecurityLogging {\n  /**\n   * Log security events\n   */\n  static logSecurityEvent(\n    eventType: string,\n    userId: string,\n    details: any,\n    severity: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL'\n  ) {\n    const event = {\n      timestamp: new Date(),\n      eventType,\n      userId,\n      details: DataProtection.maskSensitiveData(details),\n      severity,\n      ip: details.ip,\n      userAgent: details.userAgent,\n    };\n\n    console.log(`[SECURITY] ${severity}: ${eventType}`, event);\n\n    // Send to monitoring system\n    if (severity === 'CRITICAL' || severity === 'HIGH') {\n      // Alert operations team\n      console.error(`[ALERT] ${eventType}:`, event);\n    }\n  }\n\n  /**\n   * Log failed authentication attempts\n   */\n  static logFailedAuth(email: string, ip: string, reason: string) {\n    this.logSecurityEvent('FAILED_AUTH', email, { ip, reason }, 'MEDIUM');\n  }\n\n  /**\n   * Log successful authentication\n   */\n  static logSuccessfulAuth(userId: string, ip: string) {\n    this.logSecurityEvent('SUCCESSFUL_AUTH', userId, { ip }, 'LOW');\n  }\n\n  /**\n   * Log unauthorized access attempts\n   */\n  static logUnauthorizedAccess(userId: string, resource: string, ip: string) {\n    this.logSecurityEvent('UNAUTHORIZED_ACCESS', userId, { resource, ip }, 'HIGH');\n  }\n\n  /**\n   * Log data access\n   */\n  static logDataAccess(userId: string, dataType: string, action: string) {\n    this.logSecurityEvent('DATA_ACCESS', userId, { dataType, action }, 'LOW');\n  }\n}\n\n/**\n * Compliance Helpers\n */\nexport class ComplianceHelpers {\n  /**\n   * GDPR: Right to be forgotten\n   */\n  static async deleteUserData(userId: string) {\n    // Implementation would delete all user data\n    console.log(`Deleting all data for user ${userId}`);\n  }\n\n  /**\n   * GDPR: Data portability\n   */\n  static async exportUserData(userId: string) {\n    // Implementation would export all user data\n    console.log(`Exporting all data for user ${userId}`);\n  }\n\n  /**\n   * GDPR: Consent management\n   */\n  static async recordConsent(userId: string, consentType: string, version: string) {\n    console.log(`Recording ${consentType} consent v${version} for user ${userId}`);\n  }\n\n  /**\n   * Audit trail\n   */\n  static async logAuditEvent(\n    action: string,\n    actor: string,\n    resource: string,\n    changes: any\n  ) {\n    const auditEvent = {\n      timestamp: new Date(),\n      action,\n      actor,\n      resource,\n      changes,\n    };\n\n    console.log('[AUDIT]', auditEvent);\n  }\n}\n\nexport default {\n  securityHeaders,\n  createRateLimiter,\n  authRateLimiter,\n  inputSanitization,\n  corsConfig,\n  AuthenticationSecurity,\n  DataProtection,\n  AccessControl,\n  SecurityLogging,\n  ComplianceHelpers,\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}