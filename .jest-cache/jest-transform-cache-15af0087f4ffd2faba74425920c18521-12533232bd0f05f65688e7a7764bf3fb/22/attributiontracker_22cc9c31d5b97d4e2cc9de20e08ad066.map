{"version":3,"names":["cov_prni2d6m3","actualCoverage","AttributionTracker","constructor","f","s","attributionHistory","Map","trackAttribution","creator","valueId","metadata","attribution","originalCreator","valueChain","royaltyPercentage","history","b","get","push","set","console","log","extendValueChain","newContributor","length","warn","original","extended","getAttribution","getAttributionHistory","calculateRoyaltyDistribution","totalAmount","distribution","royaltyAmount","intermediateShare","perContributor","Math","max","i","contributor","getStats","totalAttributions","Array","from","values","reduce","sum","uniqueCreators","Set","flatMap","map","a","size","trackedValues"],"sources":["attribution-tracker.ts"],"sourcesContent":["export interface Attribution {\n    originalCreator: string;\n    valueChain: string[]; // Chain of value creation\n    royaltyPercentage: number;\n    metadata?: Record<string, any>;\n}\n\nexport interface AttributedTransfer {\n    from: string;\n    to: string;\n    amount: number;\n    attribution: Attribution;\n    royaltyAmount: number;\n    timestamp: string;\n}\n\nexport class AttributionTracker {\n    private attributionHistory: Map<string, Attribution[]>;\n\n    constructor() {\n        this.attributionHistory = new Map();\n    }\n\n    /**\n     * Track attribution for a value creation event\n     */\n    trackAttribution(\n        creator: string,\n        valueId: string,\n        metadata?: Record<string, any>\n    ): Attribution {\n        const attribution: Attribution = {\n            originalCreator: creator,\n            valueChain: [creator],\n            royaltyPercentage: 5, // Default 5% royalty\n            metadata\n        };\n\n        // Store attribution\n        const history = this.attributionHistory.get(valueId) || [];\n        history.push(attribution);\n        this.attributionHistory.set(valueId, history);\n\n        console.log(`ðŸ”— Attribution tracked: ${creator} created ${valueId}`);\n\n        return attribution;\n    }\n\n    /**\n     * Extend value chain when value is built upon\n     */\n    extendValueChain(\n        valueId: string,\n        newContributor: string\n    ): Attribution | null {\n        const history = this.attributionHistory.get(valueId);\n\n        if (!history || history.length === 0) {\n            console.warn(`No attribution found for ${valueId}`);\n            return null;\n        }\n\n        const original = history[0];\n        const extended: Attribution = {\n            ...original,\n            valueChain: [...original.valueChain, newContributor]\n        };\n\n        history.push(extended);\n        this.attributionHistory.set(valueId, history);\n\n        console.log(`ðŸ”— Value chain extended: ${valueId} â†’ ${newContributor}`);\n\n        return extended;\n    }\n\n    /**\n     * Get attribution for a value\n     */\n    getAttribution(valueId: string): Attribution | null {\n        const history = this.attributionHistory.get(valueId);\n        return history && history.length > 0 ? history[history.length - 1] : null;\n    }\n\n    /**\n     * Get full attribution history\n     */\n    getAttributionHistory(valueId: string): Attribution[] {\n        return this.attributionHistory.get(valueId) || [];\n    }\n\n    /**\n     * Calculate royalty distribution\n     */\n    calculateRoyaltyDistribution(\n        attribution: Attribution,\n        totalAmount: number\n    ): Map<string, number> {\n        const distribution = new Map<string, number>();\n\n        // Original creator gets royalty percentage\n        const royaltyAmount = totalAmount * (attribution.royaltyPercentage / 100);\n        distribution.set(attribution.originalCreator, royaltyAmount);\n\n        // Intermediate contributors get smaller shares\n        const intermediateShare = royaltyAmount * 0.2; // 20% of royalty to intermediates\n        const perContributor = intermediateShare / Math.max(1, attribution.valueChain.length - 1);\n\n        for (let i = 1; i < attribution.valueChain.length; i++) {\n            const contributor = attribution.valueChain[i];\n            distribution.set(contributor, perContributor);\n        }\n\n        return distribution;\n    }\n\n    /**\n     * Get attribution statistics\n     */\n    getStats() {\n        const totalAttributions = Array.from(this.attributionHistory.values())\n            .reduce((sum, history) => sum + history.length, 0);\n\n        const uniqueCreators = new Set(\n            Array.from(this.attributionHistory.values())\n                .flatMap(history => history.map(a => a.originalCreator))\n        );\n\n        return {\n            totalAttributions,\n            uniqueCreators: uniqueCreators.size,\n            trackedValues: this.attributionHistory.size\n        };\n    }\n}\n\nexport default AttributionTracker;\n"],"mappings":"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","ignoreList":[]}