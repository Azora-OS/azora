{"version":3,"names":["cov_27b5byehhq","actualCoverage","generateUUID","auditLogs","s","Map","AuditService","logAction","action","details","userId","ipAddress","paymentId","f","logId","now","Date","log","id","createdAt","set","console","b","logPaymentAction","logBusinessAction","businessId","logDocumentAction","documentId","logFundAction","getLogById","get","getPaymentAuditTrail","Array","from","values","filter","getUserAuditTrail","page","pageSize","userLogs","sort","a","getTime","total","length","totalPages","Math","ceil","start","end","logs","slice","getLogsByAction","actionLogs","includes","getLogsByDateRange","startDate","endDate","rangeLogs","logDate","getAllLogs","allLogs","getAuditStats","byAction","byUser","forEach","lastLog","totalLogs","lastLogTime","generateComplianceReport","actionsByType","userActivity","suspiciousActivities","push","complianceScore","max","period","totalActions","exportAuditTrailAsCSV","headers","rows","map","toISOString","csv","row","cell","join","deleteOldLogs","daysToKeep","cutoffDate","setDate","getDate","deletedCount","entries","delete","logAllocationAction","allocationId","auditService"],"sources":["audit.service.ts"],"sourcesContent":["import { generateUUID } from '../utils/uuid.js';\nimport { AuditLog, AuditTrail } from '../types/index.js';\n\n// Mock database - replace with actual database calls\nconst auditLogs: Map<string, AuditLog> = new Map();\n\nexport class AuditService {\n  /**\n   * Log an action\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async logAction(\n    action: string,\n    details: string,\n    userId?: string,\n    ipAddress?: string,\n    paymentId?: string\n  ): Promise<AuditLog> {\n    const logId = generateUUID();\n    const now = new Date();\n\n    const log: AuditLog = {\n      id: logId,\n      paymentId,\n      action,\n      details,\n      userId,\n      ipAddress,\n      createdAt: now,\n    };\n\n    auditLogs.set(logId, log);\n\n    console.log(`[Audit] ${action} - ${details} (User: ${userId || 'system'}, IP: ${ipAddress || 'unknown'})`);\n\n    return log;\n  }\n\n  /**\n   * Log payment action\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async logPaymentAction(\n    paymentId: string,\n    action: string,\n    details: string,\n    userId?: string,\n    ipAddress?: string\n  ): Promise<AuditLog> {\n    return this.logAction(action, details, userId, ipAddress, paymentId);\n  }\n\n  /**\n   * Log business action\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async logBusinessAction(\n    businessId: string,\n    action: string,\n    details: string,\n    userId?: string,\n    ipAddress?: string\n  ): Promise<AuditLog> {\n    return this.logAction(`business:${businessId}:${action}`, details, userId, ipAddress);\n  }\n\n  /**\n   * Log document action\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async logDocumentAction(\n    documentId: string,\n    action: string,\n    details: string,\n    userId?: string,\n    ipAddress?: string\n  ): Promise<AuditLog> {\n    return this.logAction(`document:${documentId}:${action}`, details, userId, ipAddress);\n  }\n\n  /**\n   * Log fund action\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async logFundAction(\n    action: string,\n    details: string,\n    userId?: string,\n    ipAddress?: string\n  ): Promise<AuditLog> {\n    return this.logAction(`fund:${action}`, details, userId, ipAddress);\n  }\n\n  /**\n   * Get audit log by ID\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getLogById(logId: string): Promise<AuditLog | null> {\n    return auditLogs.get(logId) || null;\n  }\n\n  /**\n   * Get audit logs for a payment\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getPaymentAuditTrail(paymentId: string): Promise<AuditLog[]> {\n    return Array.from(auditLogs.values()).filter((log) => log.paymentId === paymentId);\n  }\n\n  /**\n   * Get audit logs by user\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getUserAuditTrail(userId: string, page: number = 1, pageSize: number = 10): Promise<{\n    logs: AuditLog[];\n    total: number;\n    page: number;\n    pageSize: number;\n    totalPages: number;\n  }> {\n    const userLogs = Array.from(auditLogs.values())\n      .filter((log) => log.userId === userId)\n      .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n\n    const total = userLogs.length;\n    const totalPages = Math.ceil(total / pageSize);\n    const start = (page - 1) * pageSize;\n    const end = start + pageSize;\n\n    return {\n      logs: userLogs.slice(start, end),\n      total,\n      page,\n      pageSize,\n      totalPages,\n    };\n  }\n\n  /**\n   * Get audit logs by action\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getLogsByAction(action: string, page: number = 1, pageSize: number = 10): Promise<{\n    logs: AuditLog[];\n    total: number;\n    page: number;\n    pageSize: number;\n    totalPages: number;\n  }> {\n    const actionLogs = Array.from(auditLogs.values())\n      .filter((log) => log.action.includes(action))\n      .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n\n    const total = actionLogs.length;\n    const totalPages = Math.ceil(total / pageSize);\n    const start = (page - 1) * pageSize;\n    const end = start + pageSize;\n\n    return {\n      logs: actionLogs.slice(start, end),\n      total,\n      page,\n      pageSize,\n      totalPages,\n    };\n  }\n\n  /**\n   * Get audit logs by date range\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getLogsByDateRange(\n    startDate: Date,\n    endDate: Date,\n    page: number = 1,\n    pageSize: number = 10\n  ): Promise<{\n    logs: AuditLog[];\n    total: number;\n    page: number;\n    pageSize: number;\n    totalPages: number;\n  }> {\n    const rangeLogs = Array.from(auditLogs.values())\n      .filter((log) => {\n        const logDate = new Date(log.createdAt);\n        return logDate >= startDate && logDate <= endDate;\n      })\n      .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n\n    const total = rangeLogs.length;\n    const totalPages = Math.ceil(total / pageSize);\n    const start = (page - 1) * pageSize;\n    const end = start + pageSize;\n\n    return {\n      logs: rangeLogs.slice(start, end),\n      total,\n      page,\n      pageSize,\n      totalPages,\n    };\n  }\n\n  /**\n   * Get all audit logs\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getAllLogs(page: number = 1, pageSize: number = 10): Promise<{\n    logs: AuditLog[];\n    total: number;\n    page: number;\n    pageSize: number;\n    totalPages: number;\n  }> {\n    const allLogs = Array.from(auditLogs.values()).sort(\n      (a, b) => b.createdAt.getTime() - a.createdAt.getTime()\n    );\n\n    const total = allLogs.length;\n    const totalPages = Math.ceil(total / pageSize);\n    const start = (page - 1) * pageSize;\n    const end = start + pageSize;\n\n    return {\n      logs: allLogs.slice(start, end),\n      total,\n      page,\n      pageSize,\n      totalPages,\n    };\n  }\n\n  /**\n   * Get audit statistics\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getAuditStats(): Promise<{\n    totalLogs: number;\n    byAction: Record<string, number>;\n    byUser: Record<string, number>;\n    lastLogTime: Date | null;\n  }> {\n    const allLogs = Array.from(auditLogs.values());\n\n    const byAction: Record<string, number> = {};\n    const byUser: Record<string, number> = {};\n\n    allLogs.forEach((log) => {\n      byAction[log.action] = (byAction[log.action] || 0) + 1;\n      if (log.userId) {\n        byUser[log.userId] = (byUser[log.userId] || 0) + 1;\n      }\n    });\n\n    const lastLog = allLogs.sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime())[0];\n\n    return {\n      totalLogs: allLogs.length,\n      byAction,\n      byUser,\n      lastLogTime: lastLog?.createdAt || null,\n    };\n  }\n\n  /**\n   * Generate compliance report\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async generateComplianceReport(startDate: Date, endDate: Date): Promise<{\n    period: { startDate: Date; endDate: Date };\n    totalActions: number;\n    actionsByType: Record<string, number>;\n    userActivity: Record<string, number>;\n    suspiciousActivities: AuditLog[];\n    complianceScore: number;\n  }> {\n    const logs = await this.getLogsByDateRange(startDate, endDate, 1, 10000);\n\n    const actionsByType: Record<string, number> = {};\n    const userActivity: Record<string, number> = {};\n    const suspiciousActivities: AuditLog[] = [];\n\n    logs.logs.forEach((log) => {\n      actionsByType[log.action] = (actionsByType[log.action] || 0) + 1;\n      if (log.userId) {\n        userActivity[log.userId] = (userActivity[log.userId] || 0) + 1;\n      }\n\n      // Flag suspicious activities (e.g., multiple failed attempts)\n      if (log.action.includes('failed') || log.action.includes('error')) {\n        suspiciousActivities.push(log);\n      }\n    });\n\n    // Calculate compliance score (0-100)\n    const complianceScore = Math.max(0, 100 - suspiciousActivities.length * 5);\n\n    return {\n      period: { startDate, endDate },\n      totalActions: logs.total,\n      actionsByType,\n      userActivity,\n      suspiciousActivities: suspiciousActivities.slice(0, 10),\n      complianceScore,\n    };\n  }\n\n  /**\n   * Export audit trail as CSV\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async exportAuditTrailAsCSV(startDate: Date, endDate: Date): Promise<string> {\n    const logs = await this.getLogsByDateRange(startDate, endDate, 1, 100000);\n\n    const headers = ['ID', 'Action', 'Details', 'User ID', 'IP Address', 'Created At'];\n    const rows = logs.logs.map((log) => [\n      log.id,\n      log.action,\n      log.details,\n      log.userId || 'N/A',\n      log.ipAddress || 'N/A',\n      log.createdAt.toISOString(),\n    ]);\n\n    const csv = [headers, ...rows].map((row) => row.map((cell) => `\"${cell}\"`).join(',')).join('\\n');\n\n    return csv;\n  }\n\n  /**\n   * Delete old audit logs (retention policy)\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async deleteOldLogs(daysToKeep: number = 90): Promise<number> {\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() - daysToKeep);\n\n    let deletedCount = 0;\n\n    for (const [id, log] of auditLogs.entries()) {\n      if (log.createdAt < cutoffDate) {\n        auditLogs.delete(id);\n        deletedCount++;\n      }\n    }\n\n    console.log(`[Audit] Deleted ${deletedCount} old audit logs`);\n\n    return deletedCount;\n  }\n\n  /**\n   * Log allocation action\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async logAllocationAction(\n    allocationId: string,\n    action: string,\n    details: string,\n    userId?: string,\n    ipAddress?: string\n  ): Promise<AuditLog> {\n    return this.logAction(`allocation:${allocationId}:${action}`, details, userId, ipAddress);\n  }\n}\n\nexport const auditService = new AuditService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}