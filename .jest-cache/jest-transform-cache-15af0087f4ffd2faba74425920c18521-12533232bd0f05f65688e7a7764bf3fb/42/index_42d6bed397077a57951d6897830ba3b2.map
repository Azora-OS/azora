{"version":3,"names":["cov_179xzx19n4","actualCoverage","express","cors","helmet","dotenv","HealthMonitor","RecoveryStrategies","s","config","app","PORT","b","process","env","use","json","healthMonitor","recoveryStrategies","services","name","port","forEach","service","f","registerService","start","setInterval","unhealthyServices","getUnhealthyServices","console","log","status","attemptRecovery","on","incident","get","req","res","monitoring","getAllHealth","length","timestamp","Date","toISOString","success","data","count","error","message","unhealthy","incidents","getIncidents","stats","getStats","listen"],"sources":["index.ts"],"sourcesContent":["import express from 'express';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport dotenv from 'dotenv';\nimport { HealthMonitor } from './src/health-monitor';\nimport { RecoveryStrategies } from './src/recovery-strategies';\n\ndotenv.config();\n\nconst app = express();\nconst PORT = process.env.PORT || 3051;\n\napp.use(helmet());\napp.use(cors());\napp.use(express.json());\n\n// Initialize health monitor and recovery\nconst healthMonitor = new HealthMonitor(30000); // Check every 30 seconds\nconst recoveryStrategies = new RecoveryStrategies();\n\n// Register all 58 services for monitoring\nconst services = [\n    { name: 'ai-orchestrator', port: 3014 },\n    { name: 'azora-auth', port: 4001 },\n    { name: 'azora-pay', port: 3010 },\n    { name: 'azora-mint', port: 3011 },\n    { name: 'azora-education', port: 3002 },\n    { name: 'azora-sapiens', port: 3003 },\n    { name: 'azora-marketplace', port: 3004 },\n    { name: 'azora-assessment', port: 3005 },\n    { name: 'constitutional-ai', port: 3015 },\n    { name: 'chaos-monkey', port: 3050 }\n    // Add all other services...\n];\n\nservices.forEach(service => {\n    healthMonitor.registerService(service.name, `http://localhost:${service.port}`);\n});\n\n// Start health monitoring\nhealthMonitor.start();\n\n// Auto-recovery loop\nsetInterval(async () => {\n    const unhealthyServices = healthMonitor.getUnhealthyServices();\n\n    for (const service of unhealthyServices) {\n        console.log(`ðŸ”¥ Phoenix: Detected unhealthy service: ${service.name} (${service.status})`);\n        await recoveryStrategies.attemptRecovery(service);\n    }\n}, 60000); // Check for recovery every minute\n\n// Listen to recovery events\nrecoveryStrategies.on('recovery-attempted', (incident) => {\n    console.log(`ðŸ”¥ Phoenix Recovery:`, incident);\n});\n\n// Health check\napp.get('/health', (req, res) => {\n    res.json({\n        status: 'healthy',\n        service: 'phoenix-server',\n        monitoring: healthMonitor.getAllHealth().length,\n        timestamp: new Date().toISOString()\n    });\n});\n\n// Get all service health\napp.get('/api/phoenix/services', (req, res) => {\n    try {\n        const services = healthMonitor.getAllHealth();\n        res.json({\n            success: true,\n            data: services,\n            count: services.length\n        });\n    } catch (error) {\n        res.status(500).json({ error: error.message });\n    }\n});\n\n// Get unhealthy services\napp.get('/api/phoenix/unhealthy', (req, res) => {\n    try {\n        const unhealthy = healthMonitor.getUnhealthyServices();\n        res.json({\n            success: true,\n            data: unhealthy,\n            count: unhealthy.length\n        });\n    } catch (error) {\n        res.status(500).json({ error: error.message });\n    }\n});\n\n// Get recovery incidents\napp.get('/api/phoenix/incidents', (req, res) => {\n    try {\n        const incidents = recoveryStrategies.getIncidents();\n        res.json({\n            success: true,\n            data: incidents,\n            count: incidents.length\n        });\n    } catch (error) {\n        res.status(500).json({ error: error.message });\n    }\n});\n\n// Get recovery statistics\napp.get('/api/phoenix/stats', (req, res) => {\n    try {\n        const stats = recoveryStrategies.getStats();\n        res.json({\n            success: true,\n            data: stats\n        });\n    } catch (error) {\n        res.status(500).json({ error: error.message });\n    }\n});\n\napp.listen(PORT, () => {\n    console.log(`ðŸ”¥ PhoenixServer running on port ${PORT}`);\n    console.log(`   Monitoring ${services.length} services`);\n    console.log(`   Auto-recovery: ACTIVE`);\n});\n\nexport default app;\n"],"mappings":"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","ignoreList":[]}