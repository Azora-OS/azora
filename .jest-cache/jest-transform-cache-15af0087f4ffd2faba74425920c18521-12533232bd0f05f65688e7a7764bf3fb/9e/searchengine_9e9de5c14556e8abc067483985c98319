95904c71e542d4440a11e8ed4dabc7e0
/* istanbul ignore next */
function cov_22fyoktcdz() {
  var path = "/workspaces/azora/services/azora-sapiens/src/search-engine.ts";
  var hash = "25d4b0e154d339fbb4c5bdf9f6db7ad20d7a333a";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/azora-sapiens/src/search-engine.ts",
    statementMap: {
      "0": {
        start: {
          line: 20,
          column: 51
        },
        end: {
          line: 20,
          column: 60
        }
      },
      "1": {
        start: {
          line: 23,
          column: 4
        },
        end: {
          line: 23,
          column: 45
        }
      },
      "2": {
        start: {
          line: 24,
          column: 4
        },
        end: {
          line: 24,
          column: 39
        }
      },
      "3": {
        start: {
          line: 34,
          column: 51
        },
        end: {
          line: 34,
          column: 58
        }
      },
      "4": {
        start: {
          line: 36,
          column: 4
        },
        end: {
          line: 54,
          column: 5
        }
      },
      "5": {
        start: {
          line: 38,
          column: 29
        },
        end: {
          line: 38,
          column: 81
        }
      },
      "6": {
        start: {
          line: 41,
          column: 22
        },
        end: {
          line: 41,
          column: 96
        }
      },
      "7": {
        start: {
          line: 44,
          column: 6
        },
        end: {
          line: 50,
          column: 12
        }
      },
      "8": {
        start: {
          line: 45,
          column: 28
        },
        end: {
          line: 45,
          column: 52
        }
      },
      "9": {
        start: {
          line: 47,
          column: 26
        },
        end: {
          line: 50,
          column: 9
        }
      },
      "10": {
        start: {
          line: 52,
          column: 6
        },
        end: {
          line: 52,
          column: 56
        }
      },
      "11": {
        start: {
          line: 53,
          column: 6
        },
        end: {
          line: 53,
          column: 18
        }
      },
      "12": {
        start: {
          line: 61,
          column: 42
        },
        end: {
          line: 61,
          column: 49
        }
      },
      "13": {
        start: {
          line: 62,
          column: 23
        },
        end: {
          line: 62,
          column: 43
        }
      },
      "14": {
        start: {
          line: 63,
          column: 41
        },
        end: {
          line: 63,
          column: 50
        }
      },
      "15": {
        start: {
          line: 66,
          column: 4
        },
        end: {
          line: 72,
          column: 5
        }
      },
      "16": {
        start: {
          line: 67,
          column: 21
        },
        end: {
          line: 67,
          column: 61
        }
      },
      "17": {
        start: {
          line: 68,
          column: 6
        },
        end: {
          line: 71,
          column: 7
        }
      },
      "18": {
        start: {
          line: 69,
          column: 29
        },
        end: {
          line: 69,
          column: 52
        }
      },
      "19": {
        start: {
          line: 70,
          column: 8
        },
        end: {
          line: 70,
          column: 45
        }
      },
      "20": {
        start: {
          line: 75,
          column: 26
        },
        end: {
          line: 84,
          column: 21
        }
      },
      "21": {
        start: {
          line: 76,
          column: 29
        },
        end: {
          line: 81,
          column: 7
        }
      },
      "22": {
        start: {
          line: 82,
          column: 26
        },
        end: {
          line: 82,
          column: 50
        }
      },
      "23": {
        start: {
          line: 83,
          column: 22
        },
        end: {
          line: 83,
          column: 39
        }
      },
      "24": {
        start: {
          line: 86,
          column: 4
        },
        end: {
          line: 86,
          column: 25
        }
      },
      "25": {
        start: {
          line: 96,
          column: 26
        },
        end: {
          line: 96,
          column: 33
        }
      },
      "26": {
        start: {
          line: 98,
          column: 4
        },
        end: {
          line: 136,
          column: 5
        }
      },
      "27": {
        start: {
          line: 100,
          column: 48
        },
        end: {
          line: 103,
          column: 8
        }
      },
      "28": {
        start: {
          line: 106,
          column: 23
        },
        end: {
          line: 106,
          column: 65
        }
      },
      "29": {
        start: {
          line: 109,
          column: 6
        },
        end: {
          line: 114,
          column: 7
        }
      },
      "30": {
        start: {
          line: 110,
          column: 8
        },
        end: {
          line: 113,
          column: 11
        }
      },
      "31": {
        start: {
          line: 117,
          column: 6
        },
        end: {
          line: 127,
          column: 7
        }
      },
      "32": {
        start: {
          line: 118,
          column: 8
        },
        end: {
          line: 126,
          column: 9
        }
      },
      "33": {
        start: {
          line: 119,
          column: 27
        },
        end: {
          line: 119,
          column: 51
        }
      },
      "34": {
        start: {
          line: 120,
          column: 10
        },
        end: {
          line: 120,
          column: 65
        }
      },
      "35": {
        start: {
          line: 122,
          column: 10
        },
        end: {
          line: 125,
          column: 13
        }
      },
      "36": {
        start: {
          line: 130,
          column: 6
        },
        end: {
          line: 132,
          column: 24
        }
      },
      "37": {
        start: {
          line: 131,
          column: 24
        },
        end: {
          line: 131,
          column: 59
        }
      },
      "38": {
        start: {
          line: 134,
          column: 6
        },
        end: {
          line: 134,
          column: 54
        }
      },
      "39": {
        start: {
          line: 135,
          column: 6
        },
        end: {
          line: 135,
          column: 18
        }
      },
      "40": {
        start: {
          line: 143,
          column: 18
        },
        end: {
          line: 143,
          column: 40
        }
      },
      "41": {
        start: {
          line: 144,
          column: 4
        },
        end: {
          line: 149,
          column: 5
        }
      },
      "42": {
        start: {
          line: 145,
          column: 6
        },
        end: {
          line: 147,
          column: 7
        }
      },
      "43": {
        start: {
          line: 146,
          column: 8
        },
        end: {
          line: 146,
          column: 47
        }
      },
      "44": {
        start: {
          line: 148,
          column: 6
        },
        end: {
          line: 148,
          column: 46
        }
      },
      "45": {
        start: {
          line: 156,
          column: 4
        },
        end: {
          line: 158,
          column: 5
        }
      },
      "46": {
        start: {
          line: 157,
          column: 6
        },
        end: {
          line: 157,
          column: 27
        }
      },
      "47": {
        start: {
          line: 165,
          column: 4
        },
        end: {
          line: 169,
          column: 51
        }
      },
      "48": {
        start: {
          line: 168,
          column: 25
        },
        end: {
          line: 168,
          column: 41
        }
      },
      "49": {
        start: {
          line: 169,
          column: 22
        },
        end: {
          line: 169,
          column: 49
        }
      },
      "50": {
        start: {
          line: 179,
          column: 59
        },
        end: {
          line: 179,
          column: 66
        }
      },
      "51": {
        start: {
          line: 181,
          column: 4
        },
        end: {
          line: 192,
          column: 59
        }
      },
      "52": {
        start: {
          line: 183,
          column: 29
        },
        end: {
          line: 183,
          column: 77
        }
      },
      "53": {
        start: {
          line: 185,
          column: 10
        },
        end: {
          line: 185,
          column: 80
        }
      },
      "54": {
        start: {
          line: 187,
          column: 8
        },
        end: {
          line: 190,
          column: 10
        }
      },
      "55": {
        start: {
          line: 192,
          column: 22
        },
        end: {
          line: 192,
          column: 57
        }
      },
      "56": {
        start: {
          line: 199,
          column: 17
        },
        end: {
          line: 199,
          column: 37
        }
      },
      "57": {
        start: {
          line: 200,
          column: 16
        },
        end: {
          line: 200,
          column: 26
        }
      },
      "58": {
        start: {
          line: 201,
          column: 21
        },
        end: {
          line: 201,
          column: 77
        }
      },
      "59": {
        start: {
          line: 204,
          column: 4
        },
        end: {
          line: 204,
          column: 36
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 22,
            column: 2
          },
          end: {
            line: 22,
            column: 3
          }
        },
        loc: {
          start: {
            line: 22,
            column: 87
          },
          end: {
            line: 25,
            column: 3
          }
        },
        line: 22
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 30,
            column: 2
          },
          end: {
            line: 30,
            column: 3
          }
        },
        loc: {
          start: {
            line: 33,
            column: 40
          },
          end: {
            line: 55,
            column: 3
          }
        },
        line: 33
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 45,
            column: 16
          },
          end: {
            line: 45,
            column: 17
          }
        },
        loc: {
          start: {
            line: 45,
            column: 28
          },
          end: {
            line: 45,
            column: 52
          }
        },
        line: 45
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 47,
            column: 13
          },
          end: {
            line: 47,
            column: 14
          }
        },
        loc: {
          start: {
            line: 47,
            column: 26
          },
          end: {
            line: 50,
            column: 9
          }
        },
        line: 47
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 60,
            column: 2
          },
          end: {
            line: 60,
            column: 3
          }
        },
        loc: {
          start: {
            line: 60,
            column: 87
          },
          end: {
            line: 87,
            column: 3
          }
        },
        line: 60
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 76,
            column: 11
          },
          end: {
            line: 76,
            column: 12
          }
        },
        loc: {
          start: {
            line: 76,
            column: 29
          },
          end: {
            line: 81,
            column: 7
          }
        },
        line: 76
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 82,
            column: 14
          },
          end: {
            line: 82,
            column: 15
          }
        },
        loc: {
          start: {
            line: 82,
            column: 26
          },
          end: {
            line: 82,
            column: 50
          }
        },
        line: 82
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 83,
            column: 12
          },
          end: {
            line: 83,
            column: 13
          }
        },
        loc: {
          start: {
            line: 83,
            column: 22
          },
          end: {
            line: 83,
            column: 39
          }
        },
        line: 83
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 92,
            column: 2
          },
          end: {
            line: 92,
            column: 3
          }
        },
        loc: {
          start: {
            line: 95,
            column: 40
          },
          end: {
            line: 137,
            column: 3
          }
        },
        line: 95
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 131,
            column: 14
          },
          end: {
            line: 131,
            column: 15
          }
        },
        loc: {
          start: {
            line: 131,
            column: 24
          },
          end: {
            line: 131,
            column: 59
          }
        },
        line: 131
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 142,
            column: 2
          },
          end: {
            line: 142,
            column: 3
          }
        },
        loc: {
          start: {
            line: 142,
            column: 54
          },
          end: {
            line: 150,
            column: 3
          }
        },
        line: 142
      },
      "11": {
        name: "(anonymous_11)",
        decl: {
          start: {
            line: 155,
            column: 2
          },
          end: {
            line: 155,
            column: 3
          }
        },
        loc: {
          start: {
            line: 155,
            column: 47
          },
          end: {
            line: 159,
            column: 3
          }
        },
        line: 155
      },
      "12": {
        name: "(anonymous_12)",
        decl: {
          start: {
            line: 164,
            column: 2
          },
          end: {
            line: 164,
            column: 3
          }
        },
        loc: {
          start: {
            line: 164,
            column: 43
          },
          end: {
            line: 170,
            column: 3
          }
        },
        line: 164
      },
      "13": {
        name: "(anonymous_13)",
        decl: {
          start: {
            line: 168,
            column: 14
          },
          end: {
            line: 168,
            column: 15
          }
        },
        loc: {
          start: {
            line: 168,
            column: 25
          },
          end: {
            line: 168,
            column: 41
          }
        },
        line: 168
      },
      "14": {
        name: "(anonymous_14)",
        decl: {
          start: {
            line: 169,
            column: 11
          },
          end: {
            line: 169,
            column: 12
          }
        },
        loc: {
          start: {
            line: 169,
            column: 22
          },
          end: {
            line: 169,
            column: 49
          }
        },
        line: 169
      },
      "15": {
        name: "(anonymous_15)",
        decl: {
          start: {
            line: 175,
            column: 2
          },
          end: {
            line: 175,
            column: 3
          }
        },
        loc: {
          start: {
            line: 178,
            column: 31
          },
          end: {
            line: 193,
            column: 3
          }
        },
        line: 178
      },
      "16": {
        name: "(anonymous_16)",
        decl: {
          start: {
            line: 182,
            column: 11
          },
          end: {
            line: 182,
            column: 12
          }
        },
        loc: {
          start: {
            line: 182,
            column: 23
          },
          end: {
            line: 191,
            column: 7
          }
        },
        line: 182
      },
      "17": {
        name: "(anonymous_17)",
        decl: {
          start: {
            line: 192,
            column: 12
          },
          end: {
            line: 192,
            column: 13
          }
        },
        loc: {
          start: {
            line: 192,
            column: 22
          },
          end: {
            line: 192,
            column: 57
          }
        },
        line: 192
      },
      "18": {
        name: "(anonymous_18)",
        decl: {
          start: {
            line: 198,
            column: 2
          },
          end: {
            line: 198,
            column: 3
          }
        },
        loc: {
          start: {
            line: 198,
            column: 60
          },
          end: {
            line: 205,
            column: 3
          }
        },
        line: 198
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 32,
            column: 4
          },
          end: {
            line: 32,
            column: 31
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 32,
            column: 29
          },
          end: {
            line: 32,
            column: 31
          }
        }],
        line: 32
      },
      "1": {
        loc: {
          start: {
            line: 34,
            column: 12
          },
          end: {
            line: 34,
            column: 21
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 34,
            column: 19
          },
          end: {
            line: 34,
            column: 21
          }
        }],
        line: 34
      },
      "2": {
        loc: {
          start: {
            line: 34,
            column: 32
          },
          end: {
            line: 34,
            column: 46
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 34,
            column: 43
          },
          end: {
            line: 34,
            column: 46
          }
        }],
        line: 34
      },
      "3": {
        loc: {
          start: {
            line: 60,
            column: 31
          },
          end: {
            line: 60,
            column: 58
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 60,
            column: 56
          },
          end: {
            line: 60,
            column: 58
          }
        }],
        line: 60
      },
      "4": {
        loc: {
          start: {
            line: 61,
            column: 12
          },
          end: {
            line: 61,
            column: 21
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 61,
            column: 19
          },
          end: {
            line: 61,
            column: 21
          }
        }],
        line: 61
      },
      "5": {
        loc: {
          start: {
            line: 61,
            column: 23
          },
          end: {
            line: 61,
            column: 37
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 61,
            column: 34
          },
          end: {
            line: 61,
            column: 37
          }
        }],
        line: 61
      },
      "6": {
        loc: {
          start: {
            line: 67,
            column: 21
          },
          end: {
            line: 67,
            column: 61
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 67,
            column: 21
          },
          end: {
            line: 67,
            column: 48
          }
        }, {
          start: {
            line: 67,
            column: 52
          },
          end: {
            line: 67,
            column: 61
          }
        }],
        line: 67
      },
      "7": {
        loc: {
          start: {
            line: 69,
            column: 29
          },
          end: {
            line: 69,
            column: 52
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 69,
            column: 29
          },
          end: {
            line: 69,
            column: 47
          }
        }, {
          start: {
            line: 69,
            column: 51
          },
          end: {
            line: 69,
            column: 52
          }
        }],
        line: 69
      },
      "8": {
        loc: {
          start: {
            line: 94,
            column: 4
          },
          end: {
            line: 94,
            column: 31
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 94,
            column: 29
          },
          end: {
            line: 94,
            column: 31
          }
        }],
        line: 94
      },
      "9": {
        loc: {
          start: {
            line: 96,
            column: 12
          },
          end: {
            line: 96,
            column: 21
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 96,
            column: 19
          },
          end: {
            line: 96,
            column: 21
          }
        }],
        line: 96
      },
      "10": {
        loc: {
          start: {
            line: 118,
            column: 8
          },
          end: {
            line: 126,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 118,
            column: 8
          },
          end: {
            line: 126,
            column: 9
          }
        }, {
          start: {
            line: 121,
            column: 15
          },
          end: {
            line: 126,
            column: 9
          }
        }],
        line: 118
      },
      "11": {
        loc: {
          start: {
            line: 145,
            column: 6
          },
          end: {
            line: 147,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 145,
            column: 6
          },
          end: {
            line: 147,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 145
      },
      "12": {
        loc: {
          start: {
            line: 177,
            column: 4
          },
          end: {
            line: 177,
            column: 70
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 177,
            column: 68
          },
          end: {
            line: 177,
            column: 70
          }
        }],
        line: 177
      },
      "13": {
        loc: {
          start: {
            line: 179,
            column: 12
          },
          end: {
            line: 179,
            column: 31
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 179,
            column: 28
          },
          end: {
            line: 179,
            column: 31
          }
        }],
        line: 179
      },
      "14": {
        loc: {
          start: {
            line: 179,
            column: 33
          },
          end: {
            line: 179,
            column: 54
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 179,
            column: 51
          },
          end: {
            line: 179,
            column: 54
          }
        }],
        line: 179
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0
    },
    b: {
      "0": [0],
      "1": [0],
      "2": [0],
      "3": [0],
      "4": [0],
      "5": [0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0],
      "9": [0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0],
      "13": [0],
      "14": [0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "25d4b0e154d339fbb4c5bdf9f6db7ad20d7a333a"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_22fyoktcdz = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_22fyoktcdz();
export class SearchEngine {
  keywordIndex =
  /* istanbul ignore next */
  (cov_22fyoktcdz().s[0]++, new Map());
  constructor(embeddingService, vectorStorage) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[0]++;
    cov_22fyoktcdz().s[1]++;
    this.embeddingService = embeddingService;
    /* istanbul ignore next */
    cov_22fyoktcdz().s[2]++;
    this.vectorStorage = vectorStorage;
  }

  /**
   * Perform semantic search using vector similarity
   */
  async semanticSearch(query, options =
  /* istanbul ignore next */
  (cov_22fyoktcdz().b[0][0]++, {})) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[1]++;
    const {
      topK =
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[1][0]++, 10),
      filters,
      minScore =
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[2][0]++, 0.5)
    } =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[3]++, options);
    /* istanbul ignore next */
    cov_22fyoktcdz().s[4]++;
    try {
      // Generate query embedding
      const queryEmbedding =
      /* istanbul ignore next */
      (cov_22fyoktcdz().s[5]++, await this.embeddingService.generateEmbedding(query));

      // Search vector database
      const results =
      /* istanbul ignore next */
      (cov_22fyoktcdz().s[6]++, await this.vectorStorage.semanticSearch(queryEmbedding, topK * 2, filters));

      // Filter by minimum score and format results
      /* istanbul ignore next */
      cov_22fyoktcdz().s[7]++;
      return results.filter(result => {
        /* istanbul ignore next */
        cov_22fyoktcdz().f[2]++;
        cov_22fyoktcdz().s[8]++;
        return result.score >= minScore;
      }).slice(0, topK).map(result => {
        /* istanbul ignore next */
        cov_22fyoktcdz().f[3]++;
        cov_22fyoktcdz().s[9]++;
        return {
          ...result,
          relevanceScore: result.score
        };
      });
    } catch (error) {
      /* istanbul ignore next */
      cov_22fyoktcdz().s[10]++;
      console.error('Error in semantic search:', error);
      /* istanbul ignore next */
      cov_22fyoktcdz().s[11]++;
      throw error;
    }
  }

  /**
   * Perform keyword search using BM25-like algorithm
   */
  keywordSearch(query, options =
  /* istanbul ignore next */
  (cov_22fyoktcdz().b[3][0]++, {})) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[4]++;
    const {
      topK =
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[4][0]++, 10),
      minScore =
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[5][0]++, 0.3)
    } =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[12]++, options);
    const queryTerms =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[13]++, this.tokenize(query));
    const results =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[14]++, new Map());

    // Simple BM25-like scoring
    /* istanbul ignore next */
    cov_22fyoktcdz().s[15]++;
    for (const term of queryTerms) {
      const docIds =
      /* istanbul ignore next */
      (cov_22fyoktcdz().s[16]++,
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[6][0]++, this.keywordIndex.get(term)) ||
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[6][1]++, new Set()));
      /* istanbul ignore next */
      cov_22fyoktcdz().s[17]++;
      for (const docId of docIds) {
        const currentScore =
        /* istanbul ignore next */
        (cov_22fyoktcdz().s[18]++,
        /* istanbul ignore next */
        (cov_22fyoktcdz().b[7][0]++, results.get(docId)) ||
        /* istanbul ignore next */
        (cov_22fyoktcdz().b[7][1]++, 0));
        /* istanbul ignore next */
        cov_22fyoktcdz().s[19]++;
        results.set(docId, currentScore + 1);
      }
    }

    // Convert to array and sort by score
    const sortedResults =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[20]++, Array.from(results.entries()).map(([id, score]) => {
      /* istanbul ignore next */
      cov_22fyoktcdz().f[5]++;
      cov_22fyoktcdz().s[21]++;
      return {
        id,
        score: score / queryTerms.length,
        metadata: {},
        relevanceScore: score / queryTerms.length
      };
    }).filter(result => {
      /* istanbul ignore next */
      cov_22fyoktcdz().f[6]++;
      cov_22fyoktcdz().s[22]++;
      return result.score >= minScore;
    }).sort((a, b) => {
      /* istanbul ignore next */
      cov_22fyoktcdz().f[7]++;
      cov_22fyoktcdz().s[23]++;
      return b.score - a.score;
    }).slice(0, topK));
    /* istanbul ignore next */
    cov_22fyoktcdz().s[24]++;
    return sortedResults;
  }

  /**
   * Perform hybrid search combining semantic and keyword search
   */
  async hybridSearch(query, options =
  /* istanbul ignore next */
  (cov_22fyoktcdz().b[8][0]++, {})) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[8]++;
    const {
      topK =
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[9][0]++, 10)
    } =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[25]++, options);
    /* istanbul ignore next */
    cov_22fyoktcdz().s[26]++;
    try {
      // Run both searches in parallel
      const [semanticResults, keywordResults] =
      /* istanbul ignore next */
      (cov_22fyoktcdz().s[27]++, await Promise.all([this.semanticSearch(query, {
        ...options,
        topK: topK * 2
      }), Promise.resolve(this.keywordSearch(query, {
        ...options,
        topK: topK * 2
      }))]));

      // Combine and deduplicate results
      const combined =
      /* istanbul ignore next */
      (cov_22fyoktcdz().s[28]++, new Map());

      // Add semantic results with weight 0.7
      /* istanbul ignore next */
      cov_22fyoktcdz().s[29]++;
      for (const result of semanticResults) {
        /* istanbul ignore next */
        cov_22fyoktcdz().s[30]++;
        combined.set(result.id, {
          ...result,
          relevanceScore: result.relevanceScore * 0.7
        });
      }

      // Add keyword results with weight 0.3
      /* istanbul ignore next */
      cov_22fyoktcdz().s[31]++;
      for (const result of keywordResults) {
        /* istanbul ignore next */
        cov_22fyoktcdz().s[32]++;
        if (combined.has(result.id)) {
          /* istanbul ignore next */
          cov_22fyoktcdz().b[10][0]++;
          const existing =
          /* istanbul ignore next */
          (cov_22fyoktcdz().s[33]++, combined.get(result.id));
          /* istanbul ignore next */
          cov_22fyoktcdz().s[34]++;
          existing.relevanceScore += result.relevanceScore * 0.3;
        } else {
          /* istanbul ignore next */
          cov_22fyoktcdz().b[10][1]++;
          cov_22fyoktcdz().s[35]++;
          combined.set(result.id, {
            ...result,
            relevanceScore: result.relevanceScore * 0.3
          });
        }
      }

      // Sort by combined score and return top K
      /* istanbul ignore next */
      cov_22fyoktcdz().s[36]++;
      return Array.from(combined.values()).sort((a, b) => {
        /* istanbul ignore next */
        cov_22fyoktcdz().f[9]++;
        cov_22fyoktcdz().s[37]++;
        return b.relevanceScore - a.relevanceScore;
      }).slice(0, topK);
    } catch (error) {
      /* istanbul ignore next */
      cov_22fyoktcdz().s[38]++;
      console.error('Error in hybrid search:', error);
      /* istanbul ignore next */
      cov_22fyoktcdz().s[39]++;
      throw error;
    }
  }

  /**
   * Index a document for keyword search
   */
  indexDocument(docId, content) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[10]++;
    const terms =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[40]++, this.tokenize(content));
    /* istanbul ignore next */
    cov_22fyoktcdz().s[41]++;
    for (const term of terms) {
      /* istanbul ignore next */
      cov_22fyoktcdz().s[42]++;
      if (!this.keywordIndex.has(term)) {
        /* istanbul ignore next */
        cov_22fyoktcdz().b[11][0]++;
        cov_22fyoktcdz().s[43]++;
        this.keywordIndex.set(term, new Set());
      } else
      /* istanbul ignore next */
      {
        cov_22fyoktcdz().b[11][1]++;
      }
      cov_22fyoktcdz().s[44]++;
      this.keywordIndex.get(term).add(docId);
    }
  }

  /**
   * Remove document from keyword index
   */
  removeDocumentFromIndex(docId) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[11]++;
    cov_22fyoktcdz().s[45]++;
    for (const [, docIds] of this.keywordIndex) {
      /* istanbul ignore next */
      cov_22fyoktcdz().s[46]++;
      docIds.delete(docId);
    }
  }

  /**
   * Tokenize text for keyword search
   */
  tokenize(text) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[12]++;
    cov_22fyoktcdz().s[47]++;
    return text.toLowerCase().split(/\s+/).filter(token => {
      /* istanbul ignore next */
      cov_22fyoktcdz().f[13]++;
      cov_22fyoktcdz().s[48]++;
      return token.length > 2;
    }).map(token => {
      /* istanbul ignore next */
      cov_22fyoktcdz().f[14]++;
      cov_22fyoktcdz().s[49]++;
      return token.replace(/[^\w]/g, '');
    });
  }

  /**
   * Rank results by relevance and recency
   */
  rankResults(results, options =
  /* istanbul ignore next */
  (cov_22fyoktcdz().b[12][0]++, {})) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[15]++;
    const {
      recencyWeight =
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[13][0]++, 0.3),
      relevanceWeight =
      /* istanbul ignore next */
      (cov_22fyoktcdz().b[14][0]++, 0.7)
    } =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[50]++, options);
    /* istanbul ignore next */
    cov_22fyoktcdz().s[51]++;
    return results.map(result => {
      /* istanbul ignore next */
      cov_22fyoktcdz().f[16]++;
      const recencyScore =
      /* istanbul ignore next */
      (cov_22fyoktcdz().s[52]++, this.calculateRecencyScore(result.metadata.date));
      const finalScore =
      /* istanbul ignore next */
      (cov_22fyoktcdz().s[53]++, result.relevanceScore * relevanceWeight + recencyScore * recencyWeight);
      /* istanbul ignore next */
      cov_22fyoktcdz().s[54]++;
      return {
        ...result,
        relevanceScore: finalScore
      };
    }).sort((a, b) => {
      /* istanbul ignore next */
      cov_22fyoktcdz().f[17]++;
      cov_22fyoktcdz().s[55]++;
      return b.relevanceScore - a.relevanceScore;
    });
  }

  /**
   * Calculate recency score (0-1, where 1 is today)
   */
  calculateRecencyScore(dateString) {
    /* istanbul ignore next */
    cov_22fyoktcdz().f[18]++;
    const date =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[56]++, new Date(dateString));
    const now =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[57]++, new Date());
    const daysDiff =
    /* istanbul ignore next */
    (cov_22fyoktcdz().s[58]++, (now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24));

    // Decay score over time (half-life of 30 days)
    /* istanbul ignore next */
    cov_22fyoktcdz().s[59]++;
    return Math.exp(-daysDiff / 30);
  }
}
export default SearchEngine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMjJmeW9rdGNkeiIsImFjdHVhbENvdmVyYWdlIiwiU2VhcmNoRW5naW5lIiwia2V5d29yZEluZGV4IiwicyIsIk1hcCIsImNvbnN0cnVjdG9yIiwiZW1iZWRkaW5nU2VydmljZSIsInZlY3RvclN0b3JhZ2UiLCJmIiwic2VtYW50aWNTZWFyY2giLCJxdWVyeSIsIm9wdGlvbnMiLCJiIiwidG9wSyIsImZpbHRlcnMiLCJtaW5TY29yZSIsInF1ZXJ5RW1iZWRkaW5nIiwiZ2VuZXJhdGVFbWJlZGRpbmciLCJyZXN1bHRzIiwiZmlsdGVyIiwicmVzdWx0Iiwic2NvcmUiLCJzbGljZSIsIm1hcCIsInJlbGV2YW5jZVNjb3JlIiwiZXJyb3IiLCJjb25zb2xlIiwia2V5d29yZFNlYXJjaCIsInF1ZXJ5VGVybXMiLCJ0b2tlbml6ZSIsInRlcm0iLCJkb2NJZHMiLCJnZXQiLCJTZXQiLCJkb2NJZCIsImN1cnJlbnRTY29yZSIsInNldCIsInNvcnRlZFJlc3VsdHMiLCJBcnJheSIsImZyb20iLCJlbnRyaWVzIiwiaWQiLCJsZW5ndGgiLCJtZXRhZGF0YSIsInNvcnQiLCJhIiwiaHlicmlkU2VhcmNoIiwic2VtYW50aWNSZXN1bHRzIiwia2V5d29yZFJlc3VsdHMiLCJQcm9taXNlIiwiYWxsIiwicmVzb2x2ZSIsImNvbWJpbmVkIiwiaGFzIiwiZXhpc3RpbmciLCJ2YWx1ZXMiLCJpbmRleERvY3VtZW50IiwiY29udGVudCIsInRlcm1zIiwiYWRkIiwicmVtb3ZlRG9jdW1lbnRGcm9tSW5kZXgiLCJkZWxldGUiLCJ0ZXh0IiwidG9Mb3dlckNhc2UiLCJzcGxpdCIsInRva2VuIiwicmVwbGFjZSIsInJhbmtSZXN1bHRzIiwicmVjZW5jeVdlaWdodCIsInJlbGV2YW5jZVdlaWdodCIsInJlY2VuY3lTY29yZSIsImNhbGN1bGF0ZVJlY2VuY3lTY29yZSIsImRhdGUiLCJmaW5hbFNjb3JlIiwiZGF0ZVN0cmluZyIsIkRhdGUiLCJub3ciLCJkYXlzRGlmZiIsImdldFRpbWUiLCJNYXRoIiwiZXhwIl0sInNvdXJjZXMiOlsic2VhcmNoLWVuZ2luZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRW1iZWRkaW5nU2VydmljZSBmcm9tICcuL2VtYmVkZGluZ3MnO1xuaW1wb3J0IFZlY3RvclN0b3JhZ2VTZXJ2aWNlLCB7IFNlYXJjaFJlc3VsdCwgS25vd2xlZGdlTWV0YWRhdGEgfSBmcm9tICcuL3ZlY3Rvci1zdG9yYWdlJztcblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hPcHRpb25zIHtcbiAgdG9wSz86IG51bWJlcjtcbiAgZmlsdGVycz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICB1c2VTZW1hbnRpY1NlYXJjaD86IGJvb2xlYW47XG4gIHVzZUtleXdvcmRTZWFyY2g/OiBib29sZWFuO1xuICBtaW5TY29yZT86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hSZXN1bHRXaXRoQ29udGVudCBleHRlbmRzIFNlYXJjaFJlc3VsdCB7XG4gIGNvbnRlbnQ/OiBzdHJpbmc7XG4gIHJlbGV2YW5jZVNjb3JlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBTZWFyY2hFbmdpbmUge1xuICBwcml2YXRlIGVtYmVkZGluZ1NlcnZpY2U6IEVtYmVkZGluZ1NlcnZpY2U7XG4gIHByaXZhdGUgdmVjdG9yU3RvcmFnZTogVmVjdG9yU3RvcmFnZVNlcnZpY2U7XG4gIHByaXZhdGUga2V5d29yZEluZGV4OiBNYXA8c3RyaW5nLCBTZXQ8c3RyaW5nPj4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3IoZW1iZWRkaW5nU2VydmljZTogRW1iZWRkaW5nU2VydmljZSwgdmVjdG9yU3RvcmFnZTogVmVjdG9yU3RvcmFnZVNlcnZpY2UpIHtcbiAgICB0aGlzLmVtYmVkZGluZ1NlcnZpY2UgPSBlbWJlZGRpbmdTZXJ2aWNlO1xuICAgIHRoaXMudmVjdG9yU3RvcmFnZSA9IHZlY3RvclN0b3JhZ2U7XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBzZW1hbnRpYyBzZWFyY2ggdXNpbmcgdmVjdG9yIHNpbWlsYXJpdHlcbiAgICovXG4gIGFzeW5jIHNlbWFudGljU2VhcmNoKFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgb3B0aW9uczogU2VhcmNoT3B0aW9ucyA9IHt9XG4gICk6IFByb21pc2U8U2VhcmNoUmVzdWx0V2l0aENvbnRlbnRbXT4ge1xuICAgIGNvbnN0IHsgdG9wSyA9IDEwLCBmaWx0ZXJzLCBtaW5TY29yZSA9IDAuNSB9ID0gb3B0aW9ucztcblxuICAgIHRyeSB7XG4gICAgICAvLyBHZW5lcmF0ZSBxdWVyeSBlbWJlZGRpbmdcbiAgICAgIGNvbnN0IHF1ZXJ5RW1iZWRkaW5nID0gYXdhaXQgdGhpcy5lbWJlZGRpbmdTZXJ2aWNlLmdlbmVyYXRlRW1iZWRkaW5nKHF1ZXJ5KTtcblxuICAgICAgLy8gU2VhcmNoIHZlY3RvciBkYXRhYmFzZVxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHRoaXMudmVjdG9yU3RvcmFnZS5zZW1hbnRpY1NlYXJjaChxdWVyeUVtYmVkZGluZywgdG9wSyAqIDIsIGZpbHRlcnMpO1xuXG4gICAgICAvLyBGaWx0ZXIgYnkgbWluaW11bSBzY29yZSBhbmQgZm9ybWF0IHJlc3VsdHNcbiAgICAgIHJldHVybiByZXN1bHRzXG4gICAgICAgIC5maWx0ZXIoKHJlc3VsdCkgPT4gcmVzdWx0LnNjb3JlID49IG1pblNjb3JlKVxuICAgICAgICAuc2xpY2UoMCwgdG9wSylcbiAgICAgICAgLm1hcCgocmVzdWx0KSA9PiAoe1xuICAgICAgICAgIC4uLnJlc3VsdCxcbiAgICAgICAgICByZWxldmFuY2VTY29yZTogcmVzdWx0LnNjb3JlLFxuICAgICAgICB9KSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHNlbWFudGljIHNlYXJjaDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBrZXl3b3JkIHNlYXJjaCB1c2luZyBCTTI1LWxpa2UgYWxnb3JpdGhtXG4gICAqL1xuICBrZXl3b3JkU2VhcmNoKHF1ZXJ5OiBzdHJpbmcsIG9wdGlvbnM6IFNlYXJjaE9wdGlvbnMgPSB7fSk6IFNlYXJjaFJlc3VsdFdpdGhDb250ZW50W10ge1xuICAgIGNvbnN0IHsgdG9wSyA9IDEwLCBtaW5TY29yZSA9IDAuMyB9ID0gb3B0aW9ucztcbiAgICBjb25zdCBxdWVyeVRlcm1zID0gdGhpcy50b2tlbml6ZShxdWVyeSk7XG4gICAgY29uc3QgcmVzdWx0czogTWFwPHN0cmluZywgbnVtYmVyPiA9IG5ldyBNYXAoKTtcblxuICAgIC8vIFNpbXBsZSBCTTI1LWxpa2Ugc2NvcmluZ1xuICAgIGZvciAoY29uc3QgdGVybSBvZiBxdWVyeVRlcm1zKSB7XG4gICAgICBjb25zdCBkb2NJZHMgPSB0aGlzLmtleXdvcmRJbmRleC5nZXQodGVybSkgfHwgbmV3IFNldCgpO1xuICAgICAgZm9yIChjb25zdCBkb2NJZCBvZiBkb2NJZHMpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFNjb3JlID0gcmVzdWx0cy5nZXQoZG9jSWQpIHx8IDA7XG4gICAgICAgIHJlc3VsdHMuc2V0KGRvY0lkLCBjdXJyZW50U2NvcmUgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDb252ZXJ0IHRvIGFycmF5IGFuZCBzb3J0IGJ5IHNjb3JlXG4gICAgY29uc3Qgc29ydGVkUmVzdWx0cyA9IEFycmF5LmZyb20ocmVzdWx0cy5lbnRyaWVzKCkpXG4gICAgICAubWFwKChbaWQsIHNjb3JlXSkgPT4gKHtcbiAgICAgICAgaWQsXG4gICAgICAgIHNjb3JlOiBzY29yZSAvIHF1ZXJ5VGVybXMubGVuZ3RoLFxuICAgICAgICBtZXRhZGF0YToge30gYXMgS25vd2xlZGdlTWV0YWRhdGEsXG4gICAgICAgIHJlbGV2YW5jZVNjb3JlOiBzY29yZSAvIHF1ZXJ5VGVybXMubGVuZ3RoLFxuICAgICAgfSkpXG4gICAgICAuZmlsdGVyKChyZXN1bHQpID0+IHJlc3VsdC5zY29yZSA+PSBtaW5TY29yZSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSlcbiAgICAgIC5zbGljZSgwLCB0b3BLKTtcblxuICAgIHJldHVybiBzb3J0ZWRSZXN1bHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm0gaHlicmlkIHNlYXJjaCBjb21iaW5pbmcgc2VtYW50aWMgYW5kIGtleXdvcmQgc2VhcmNoXG4gICAqL1xuICBhc3luYyBoeWJyaWRTZWFyY2goXG4gICAgcXVlcnk6IHN0cmluZyxcbiAgICBvcHRpb25zOiBTZWFyY2hPcHRpb25zID0ge31cbiAgKTogUHJvbWlzZTxTZWFyY2hSZXN1bHRXaXRoQ29udGVudFtdPiB7XG4gICAgY29uc3QgeyB0b3BLID0gMTAgfSA9IG9wdGlvbnM7XG5cbiAgICB0cnkge1xuICAgICAgLy8gUnVuIGJvdGggc2VhcmNoZXMgaW4gcGFyYWxsZWxcbiAgICAgIGNvbnN0IFtzZW1hbnRpY1Jlc3VsdHMsIGtleXdvcmRSZXN1bHRzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgdGhpcy5zZW1hbnRpY1NlYXJjaChxdWVyeSwgeyAuLi5vcHRpb25zLCB0b3BLOiB0b3BLICogMiB9KSxcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKHRoaXMua2V5d29yZFNlYXJjaChxdWVyeSwgeyAuLi5vcHRpb25zLCB0b3BLOiB0b3BLICogMiB9KSksXG4gICAgICBdKTtcblxuICAgICAgLy8gQ29tYmluZSBhbmQgZGVkdXBsaWNhdGUgcmVzdWx0c1xuICAgICAgY29uc3QgY29tYmluZWQgPSBuZXcgTWFwPHN0cmluZywgU2VhcmNoUmVzdWx0V2l0aENvbnRlbnQ+KCk7XG5cbiAgICAgIC8vIEFkZCBzZW1hbnRpYyByZXN1bHRzIHdpdGggd2VpZ2h0IDAuN1xuICAgICAgZm9yIChjb25zdCByZXN1bHQgb2Ygc2VtYW50aWNSZXN1bHRzKSB7XG4gICAgICAgIGNvbWJpbmVkLnNldChyZXN1bHQuaWQsIHtcbiAgICAgICAgICAuLi5yZXN1bHQsXG4gICAgICAgICAgcmVsZXZhbmNlU2NvcmU6IHJlc3VsdC5yZWxldmFuY2VTY29yZSAqIDAuNyxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCBrZXl3b3JkIHJlc3VsdHMgd2l0aCB3ZWlnaHQgMC4zXG4gICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiBrZXl3b3JkUmVzdWx0cykge1xuICAgICAgICBpZiAoY29tYmluZWQuaGFzKHJlc3VsdC5pZCkpIHtcbiAgICAgICAgICBjb25zdCBleGlzdGluZyA9IGNvbWJpbmVkLmdldChyZXN1bHQuaWQpITtcbiAgICAgICAgICBleGlzdGluZy5yZWxldmFuY2VTY29yZSArPSByZXN1bHQucmVsZXZhbmNlU2NvcmUgKiAwLjM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29tYmluZWQuc2V0KHJlc3VsdC5pZCwge1xuICAgICAgICAgICAgLi4ucmVzdWx0LFxuICAgICAgICAgICAgcmVsZXZhbmNlU2NvcmU6IHJlc3VsdC5yZWxldmFuY2VTY29yZSAqIDAuMyxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBTb3J0IGJ5IGNvbWJpbmVkIHNjb3JlIGFuZCByZXR1cm4gdG9wIEtcbiAgICAgIHJldHVybiBBcnJheS5mcm9tKGNvbWJpbmVkLnZhbHVlcygpKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5yZWxldmFuY2VTY29yZSAtIGEucmVsZXZhbmNlU2NvcmUpXG4gICAgICAgIC5zbGljZSgwLCB0b3BLKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gaHlicmlkIHNlYXJjaDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW5kZXggYSBkb2N1bWVudCBmb3Iga2V5d29yZCBzZWFyY2hcbiAgICovXG4gIGluZGV4RG9jdW1lbnQoZG9jSWQ6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgdGVybXMgPSB0aGlzLnRva2VuaXplKGNvbnRlbnQpO1xuICAgIGZvciAoY29uc3QgdGVybSBvZiB0ZXJtcykge1xuICAgICAgaWYgKCF0aGlzLmtleXdvcmRJbmRleC5oYXModGVybSkpIHtcbiAgICAgICAgdGhpcy5rZXl3b3JkSW5kZXguc2V0KHRlcm0sIG5ldyBTZXQoKSk7XG4gICAgICB9XG4gICAgICB0aGlzLmtleXdvcmRJbmRleC5nZXQodGVybSkhLmFkZChkb2NJZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBkb2N1bWVudCBmcm9tIGtleXdvcmQgaW5kZXhcbiAgICovXG4gIHJlbW92ZURvY3VtZW50RnJvbUluZGV4KGRvY0lkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IFssIGRvY0lkc10gb2YgdGhpcy5rZXl3b3JkSW5kZXgpIHtcbiAgICAgIGRvY0lkcy5kZWxldGUoZG9jSWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUb2tlbml6ZSB0ZXh0IGZvciBrZXl3b3JkIHNlYXJjaFxuICAgKi9cbiAgcHJpdmF0ZSB0b2tlbml6ZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRleHRcbiAgICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgICAuc3BsaXQoL1xccysvKVxuICAgICAgLmZpbHRlcigodG9rZW4pID0+IHRva2VuLmxlbmd0aCA+IDIpXG4gICAgICAubWFwKCh0b2tlbikgPT4gdG9rZW4ucmVwbGFjZSgvW15cXHddL2csICcnKSk7XG4gIH1cblxuICAvKipcbiAgICogUmFuayByZXN1bHRzIGJ5IHJlbGV2YW5jZSBhbmQgcmVjZW5jeVxuICAgKi9cbiAgcmFua1Jlc3VsdHMoXG4gICAgcmVzdWx0czogU2VhcmNoUmVzdWx0V2l0aENvbnRlbnRbXSxcbiAgICBvcHRpb25zOiB7IHJlY2VuY3lXZWlnaHQ/OiBudW1iZXI7IHJlbGV2YW5jZVdlaWdodD86IG51bWJlciB9ID0ge31cbiAgKTogU2VhcmNoUmVzdWx0V2l0aENvbnRlbnRbXSB7XG4gICAgY29uc3QgeyByZWNlbmN5V2VpZ2h0ID0gMC4zLCByZWxldmFuY2VXZWlnaHQgPSAwLjcgfSA9IG9wdGlvbnM7XG5cbiAgICByZXR1cm4gcmVzdWx0c1xuICAgICAgLm1hcCgocmVzdWx0KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlY2VuY3lTY29yZSA9IHRoaXMuY2FsY3VsYXRlUmVjZW5jeVNjb3JlKHJlc3VsdC5tZXRhZGF0YS5kYXRlKTtcbiAgICAgICAgY29uc3QgZmluYWxTY29yZSA9XG4gICAgICAgICAgcmVzdWx0LnJlbGV2YW5jZVNjb3JlICogcmVsZXZhbmNlV2VpZ2h0ICsgcmVjZW5jeVNjb3JlICogcmVjZW5jeVdlaWdodDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJlc3VsdCxcbiAgICAgICAgICByZWxldmFuY2VTY29yZTogZmluYWxTY29yZSxcbiAgICAgICAgfTtcbiAgICAgIH0pXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi5yZWxldmFuY2VTY29yZSAtIGEucmVsZXZhbmNlU2NvcmUpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSByZWNlbmN5IHNjb3JlICgwLTEsIHdoZXJlIDEgaXMgdG9kYXkpXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZVJlY2VuY3lTY29yZShkYXRlU3RyaW5nOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyaW5nKTtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRheXNEaWZmID0gKG5vdy5nZXRUaW1lKCkgLSBkYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCk7XG5cbiAgICAvLyBEZWNheSBzY29yZSBvdmVyIHRpbWUgKGhhbGYtbGlmZSBvZiAzMCBkYXlzKVxuICAgIHJldHVybiBNYXRoLmV4cCgtZGF5c0RpZmYgLyAzMCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VhcmNoRW5naW5lO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFlWTtJQUFBQSxjQUFBLFlBQUFBLENBQUE7TUFBQSxPQUFBQyxjQUFBO0lBQUE7RUFBQTtFQUFBLE9BQUFBLGNBQUE7QUFBQTtBQUFBRCxjQUFBO0FBQ1osT0FBTyxNQUFNRSxZQUFZLENBQUM7RUFHaEJDLFlBQVk7RUFBQTtFQUFBLENBQUFILGNBQUEsR0FBQUksQ0FBQSxPQUE2QixJQUFJQyxH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