{"version":3,"names":["cov_k7iqs99c2","actualCoverage","ElaraLogger","NotificationService","notifications","s","Map","templates","welcome","type","subject","body","progress","status","action_required","completion","kyc_pending","kyc_approved","contract_ready","contract_signed","constructor","f","logger","sendWelcomeEmail","userId","email","name","info","notification","sendEmail","error","sendProgressEmail","stepName","sendStatusEmail","sendActionRequiredEmail","action","sendCompletionEmail","sendKYCApprovedEmail","sendContractReadyEmail","sendContractSignedEmail","getNotification","notificationId","b","get","getUserNotifications","Array","from","values","filter","n","markAsDelivered","Error","deliveredAt","Date","set","markAsFailed","reason","failureReason","customSubject","now","template","id","createdAt","sendSuccess","simulateSendEmail","sentAt","warn","_email","Math","random"],"sources":["notification.service.ts"],"sourcesContent":["/**\n * Notification Service\n * \n * Manages email notifications and notification tracking\n */\n\nimport { ElaraLogger } from '../utils/logger';\n\nexport interface EmailNotification {\n  id: string;\n  userId: string;\n  email: string;\n  subject: string;\n  body: string;\n  type: 'welcome' | 'progress' | 'status' | 'action_required' | 'completion';\n  status: 'pending' | 'sent' | 'failed' | 'bounced';\n  sentAt?: Date;\n  deliveredAt?: Date;\n  failureReason?: string;\n  createdAt: Date;\n}\n\nexport interface NotificationTemplate {\n  type: string;\n  subject: string;\n  body: string;\n}\n\nexport class NotificationService {\n  private logger: ElaraLogger;\n  private notifications: Map<string, EmailNotification> = new Map();\n\n  private readonly templates: Record<string, NotificationTemplate> = {\n    welcome: {\n      type: 'welcome',\n      subject: 'Welcome to Azora - Your Onboarding Journey Begins',\n      body: 'Welcome to Azora! We\\'re excited to have you on board. Your personalized onboarding experience is ready to begin.',\n    },\n    progress: {\n      type: 'progress',\n      subject: 'Great Progress! You\\'re Making Headway',\n      body: 'You\\'ve completed another step in your onboarding. Keep going - you\\'re almost there!',\n    },\n    status: {\n      type: 'status',\n      subject: 'Your Onboarding Status Update',\n      body: 'Here\\'s an update on your onboarding progress and next steps.',\n    },\n    action_required: {\n      type: 'action_required',\n      subject: 'Action Required - Complete Your Onboarding',\n      body: 'We need some information from you to complete your onboarding. Please take action now.',\n    },\n    completion: {\n      type: 'completion',\n      subject: 'Congratulations! Your Onboarding is Complete',\n      body: 'Welcome to the Azora community! Your account is now fully activated and ready to use.',\n    },\n    kyc_pending: {\n      type: 'kyc_pending',\n      subject: 'KYC Verification in Progress',\n      body: 'Your identity verification is being processed. We\\'ll notify you once it\\'s complete.',\n    },\n    kyc_approved: {\n      type: 'kyc_approved',\n      subject: 'KYC Verification Approved',\n      body: 'Your identity has been verified successfully. You can now proceed with your onboarding.',\n    },\n    contract_ready: {\n      type: 'contract_ready',\n      subject: 'Contract Ready for Signature',\n      body: 'Your contract is ready for e-signature. Please review and sign to continue.',\n    },\n    contract_signed: {\n      type: 'contract_signed',\n      subject: 'Contract Successfully Signed',\n      body: 'Thank you for signing the contract. Your account is being finalized.',\n    },\n  };\n\n  constructor() {\n    this.logger = new ElaraLogger('NotificationService');\n  }\n\n  /**\n   * Send welcome email\n   */\n  async sendWelcomeEmail(userId: string, email: string, name: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Sending welcome email to: ${email}`);\n\n      const notification = await this.sendEmail(\n        userId,\n        email,\n        'welcome',\n        `Welcome ${name}!`\n      );\n\n      return notification;\n    } catch (error) {\n      this.logger.error('Error sending welcome email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Send progress email\n   */\n  async sendProgressEmail(userId: string, email: string, stepName: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Sending progress email to: ${email}`);\n\n      const notification = await this.sendEmail(\n        userId,\n        email,\n        'progress',\n        `Progress: ${stepName} completed`\n      );\n\n      return notification;\n    } catch (error) {\n      this.logger.error('Error sending progress email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Send status email\n   */\n  async sendStatusEmail(userId: string, email: string, status: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Sending status email to: ${email}`);\n\n      const notification = await this.sendEmail(\n        userId,\n        email,\n        'status',\n        `Status Update: ${status}`\n      );\n\n      return notification;\n    } catch (error) {\n      this.logger.error('Error sending status email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Send action required email\n   */\n  async sendActionRequiredEmail(userId: string, email: string, action: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Sending action required email to: ${email}`);\n\n      const notification = await this.sendEmail(\n        userId,\n        email,\n        'action_required',\n        `Action Required: ${action}`\n      );\n\n      return notification;\n    } catch (error) {\n      this.logger.error('Error sending action required email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Send completion email\n   */\n  async sendCompletionEmail(userId: string, email: string, name: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Sending completion email to: ${email}`);\n\n      const notification = await this.sendEmail(\n        userId,\n        email,\n        'completion',\n        `Congratulations ${name}!`\n      );\n\n      return notification;\n    } catch (error) {\n      this.logger.error('Error sending completion email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Send KYC approved email\n   */\n  async sendKYCApprovedEmail(userId: string, email: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Sending KYC approved email to: ${email}`);\n\n      const notification = await this.sendEmail(\n        userId,\n        email,\n        'kyc_approved',\n        'KYC Verification Approved'\n      );\n\n      return notification;\n    } catch (error) {\n      this.logger.error('Error sending KYC approved email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Send contract ready email\n   */\n  async sendContractReadyEmail(userId: string, email: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Sending contract ready email to: ${email}`);\n\n      const notification = await this.sendEmail(\n        userId,\n        email,\n        'contract_ready',\n        'Contract Ready for Signature'\n      );\n\n      return notification;\n    } catch (error) {\n      this.logger.error('Error sending contract ready email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Send contract signed email\n   */\n  async sendContractSignedEmail(userId: string, email: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Sending contract signed email to: ${email}`);\n\n      const notification = await this.sendEmail(\n        userId,\n        email,\n        'contract_signed',\n        'Contract Successfully Signed'\n      );\n\n      return notification;\n    } catch (error) {\n      this.logger.error('Error sending contract signed email:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get notification by ID\n   */\n  async getNotification(notificationId: string): Promise<EmailNotification | null> {\n    try {\n      this.logger.info(`Getting notification: ${notificationId}`);\n      return this.notifications.get(notificationId) || null;\n    } catch (error) {\n      this.logger.error('Error getting notification:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get user notifications\n   */\n  async getUserNotifications(userId: string): Promise<EmailNotification[]> {\n    try {\n      this.logger.info(`Getting notifications for user: ${userId}`);\n      return Array.from(this.notifications.values()).filter(n => n.userId === userId);\n    } catch (error) {\n      this.logger.error('Error getting user notifications:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Mark notification as delivered\n   */\n  async markAsDelivered(notificationId: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Marking notification as delivered: ${notificationId}`);\n\n      const notification = this.notifications.get(notificationId);\n      if (!notification) {\n        throw new Error(`Notification not found: ${notificationId}`);\n      }\n\n      notification.status = 'sent';\n      notification.deliveredAt = new Date();\n\n      this.notifications.set(notificationId, notification);\n      return notification;\n    } catch (error) {\n      this.logger.error('Error marking notification as delivered:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Mark notification as failed\n   */\n  async markAsFailed(notificationId: string, reason: string): Promise<EmailNotification> {\n    try {\n      this.logger.info(`Marking notification as failed: ${notificationId}`);\n\n      const notification = this.notifications.get(notificationId);\n      if (!notification) {\n        throw new Error(`Notification not found: ${notificationId}`);\n      }\n\n      notification.status = 'failed';\n      notification.failureReason = reason;\n\n      this.notifications.set(notificationId, notification);\n      return notification;\n    } catch (error) {\n      this.logger.error('Error marking notification as failed:', error);\n      throw error;\n    }\n  }\n\n  // Private helper methods\n\n  private async sendEmail(\n    userId: string,\n    email: string,\n    type: string,\n    customSubject?: string\n  ): Promise<EmailNotification> {\n    const notificationId = `notif_${userId}_${Date.now()}`;\n    const template = this.templates[type] || this.templates.status;\n\n    const notification: EmailNotification = {\n      id: notificationId,\n      userId,\n      email,\n      subject: customSubject || template.subject,\n      body: template.body,\n      type: type as any,\n      status: 'pending',\n      createdAt: new Date(),\n    };\n\n    // Simulate sending email\n    // In production, would call SendGrid or similar service\n    const sendSuccess = await this.simulateSendEmail(email);\n\n    if (sendSuccess) {\n      notification.status = 'sent';\n      notification.sentAt = new Date();\n      this.logger.info(`Email sent successfully to: ${email}`);\n    } else {\n      notification.status = 'failed';\n      notification.failureReason = 'Email service unavailable';\n      this.logger.warn(`Email failed to send to: ${email}`);\n    }\n\n    this.notifications.set(notificationId, notification);\n    return notification;\n  }\n\n  private async simulateSendEmail(_email: string): Promise<boolean> {\n    // Simulate email sending with 95% success rate\n    return Math.random() > 0.05;\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}