{"version":3,"names":["cov_3szg6vs63","actualCoverage","jwt","authHelper","s","generateToken","payload","expiresIn","b","f","sign","process","env","JWT_SECRET","generateAuthHeader","token","Authorization","decodeToken","verify","createTestUser","overrides","userId","email","role"],"sources":["auth.helper.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\n\nexport interface AuthTokenPayload {\n  userId: string;\n  email: string;\n  role: string;\n}\n\nexport const authHelper = {\n  generateToken: (payload: AuthTokenPayload, expiresIn = '1h'): string => {\n    return jwt.sign(payload, process.env.JWT_SECRET || 'test-secret', { expiresIn });\n  },\n\n  generateAuthHeader: (payload: AuthTokenPayload): { Authorization: string } => {\n    const token = authHelper.generateToken(payload);\n    return { Authorization: `Bearer ${token}` };\n  },\n\n  decodeToken: (token: string): AuthTokenPayload => {\n    return jwt.verify(token, process.env.JWT_SECRET || 'test-secret') as AuthTokenPayload;\n  },\n\n  createTestUser: (overrides: Partial<AuthTokenPayload> = {}): AuthTokenPayload => {\n    return {\n      userId: 'test-user-id',\n      email: 'test@azora.world',\n      role: 'student',\n      ...overrides,\n    };\n  },\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAfZ,OAAOE,GAAG,MAAM,cAAc;AAQ9B,OAAO,MAAMC,UAAU;AAAA;AAAA,CAAAH,aAAA,GAAAI,CAAA,OAAG;EACxBC,aAAa,EAAEA,CAACC,OAAyB,EAAEC,SAAS;EAAA;EAAA,CAAAP,aAAA,GAAAQ,CAAA,UAAG,IAAI,MAAa;IAAA;IAAAR,aAAA,GAAAS,CAAA;IAAAT,aAAA,GAAAI,CAAA;IACtE,OAAOF,GAAG,CAACQ,IAAI,CAACJ,OAAO;IAAE;IAAA,CAAAN,aAAA,GAAAQ,CAAA,UAAAG,OAAO,CAACC,GAAG,CAACC,UAAU;IAAA;IAAA,CAAAb,aAAA,GAAAQ,CAAA,UAAI,aAAa,GAAE;MAAED;IAAU,CAAC,CAAC;EAClF,CAAC;EAEDO,kBAAkB,EAAGR,OAAyB,IAAgC;IAAA;IAAAN,aAAA,GAAAS,CAAA;IAC5E,MAAMM,KAAK;IAAA;IAAA,CAAAf,aAAA,GAAAI,CAAA,OAAGD,UAAU,CAACE,aAAa,CAACC,OAAO,CAAC;IAAC;IAAAN,aAAA,GAAAI,CAAA;IAChD,OAAO;MAAEY,aAAa,EAAE,UAAUD,KAAK;IAAG,CAAC;EAC7C,CAAC;EAEDE,WAAW,EAAGF,KAAa,IAAuB;IAAA;IAAAf,aAAA,GAAAS,CAAA;IAAAT,aAAA,GAAAI,CAAA;IAChD,OAAOF,GAAG,CAACgB,MAAM,CAACH,KAAK;IAAE;IAAA,CAAAf,aAAA,GAAAQ,CAAA,UAAAG,OAAO,CAACC,GAAG,CAACC,UAAU;IAAA;IAAA,CAAAb,aAAA,GAAAQ,CAAA,UAAI,aAAa,EAAC;EACnE,CAAC;EAEDW,cAAc,EAAEA,CAACC,SAAoC;EAAA;EAAA,CAAApB,aAAA,GAAAQ,CAAA,UAAG,CAAC,CAAC,MAAuB;IAAA;IAAAR,aAAA,GAAAS,CAAA;IAAAT,aAAA,GAAAI,CAAA;IAC/E,OAAO;MACLiB,MAAM,EAAE,cAAc;MACtBC,KAAK,EAAE,kBAAkB;MACzBC,IAAI,EAAE,SAAS;MACf,GAAGH;IACL,CAAC;EACH;AACF,CAAC","ignoreList":[]}