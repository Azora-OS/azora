{"version":3,"names":["cov_10gwbec1rb","actualCoverage","EventEmitter","AzoraIDE","ElaraCore","AzoraWorkspaces","workspaces","s","Map","constructor","f","ide","getInstance","elara","instance","b","createWorkspace","owner","config","console","log","repository","workspace","id","Date","now","Math","random","toString","substr","name","split","pop","branch","machineType","status","createdAt","lastActivity","environment","os","cpu","memory","disk","type","setupWorkspace","url","set","emit","session","createSession","initializeWorkspaceContext","workspaceId","getWorkspace","get","listWorkspaces","Array","from","values","filter","w","stopWorkspace","Error","deleteWorkspace","delete","getStats","byType","ws","total","length","running","stopped"],"sources":["azora-workspaces.ts"],"sourcesContent":["/*\nAZORA PROPRIETARY LICENSE\nCopyright (c) 2025 Azora ES (Pty) Ltd. All Rights Reserved.\nSee LICENSE file for details.\n*/\n\n/**\n * Azora Workspaces\n *\n * Cloud-based development environments (like GitHub Codespaces)\n * but with our own name and enhanced features\n */\n\nimport { EventEmitter } from 'events';\nimport { AzoraIDE } from '../azora-ide/azora-ide-core';\nimport { ElaraCore } from '../system-core/agent-tools/elara-core';\n\nexport interface Workspace {\n  id: string;\n  name: string;\n  repository: string;\n  branch: string;\n  machineType: 'small' | 'medium' | 'large' | 'xlarge';\n  status: 'creating' | 'running' | 'stopped' | 'deleted';\n  url?: string;\n  createdAt: Date;\n  lastActivity: Date;\n  owner: string;\n  environment: {\n    os: 'linux' | 'windows' | 'macos';\n    cpu: number;\n    memory: number;\n    disk: number;\n  };\n  ide: {\n    type: 'azora-ide' | 'vscode' | 'custom';\n    config: any;\n  };\n}\n\nexport interface WorkspaceConfig {\n  repository: string;\n  branch?: string;\n  machineType?: 'small' | 'medium' | 'large' | 'xlarge';\n  environment?: {\n    os?: 'linux' | 'windows' | 'macos';\n    cpu?: number;\n    memory?: number;\n    disk?: number;\n  };\n  ide?: {\n    type?: 'azora-ide' | 'vscode' | 'custom';\n    config?: any;\n  };\n}\n\nexport class AzoraWorkspaces extends EventEmitter {\n  private static instance: AzoraWorkspaces;\n  private workspaces: Map<string, Workspace> = new Map();\n  private ide: AzoraIDE;\n  private elara: ElaraCore;\n\n  private constructor() {\n    super();\n    this.ide = AzoraIDE.getInstance();\n    this.elara = ElaraCore.getInstance();\n  }\n\n  public static getInstance(): AzoraWorkspaces {\n    if (!AzoraWorkspaces.instance) {\n      AzoraWorkspaces.instance = new AzoraWorkspaces();\n    }\n    return AzoraWorkspaces.instance;\n  }\n\n  /**\n   * Create new workspace\n   */\n  public async createWorkspace(\n    owner: string,\n    config: WorkspaceConfig\n  ): Promise<Workspace> {\n    console.log(`ðŸš€ Creating workspace for ${config.repository}...`);\n\n    const workspace: Workspace = {\n      id: `workspace-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      name: config.repository.split('/').pop() || 'workspace',\n      repository: config.repository,\n      branch: config.branch || 'main',\n      machineType: config.machineType || 'medium',\n      status: 'creating',\n      createdAt: new Date(),\n      lastActivity: new Date(),\n      owner,\n      environment: {\n        os: config.environment?.os || 'linux',\n        cpu: config.environment?.cpu || 4,\n        memory: config.environment?.memory || 8192,\n        disk: config.environment?.disk || 50\n      },\n      ide: {\n        type: config.ide?.type || 'azora-ide',\n        config: config.ide?.config || {}\n      }\n    };\n\n    // Create workspace environment\n    await this.setupWorkspace(workspace);\n\n    workspace.status = 'running';\n    workspace.url = `https://workspace.azora.dev/${workspace.id}`;\n    this.workspaces.set(workspace.id, workspace);\n\n    this.emit('workspace-created', workspace);\n    return workspace;\n  }\n\n  /**\n   * Setup workspace environment\n   */\n  private async setupWorkspace(workspace: Workspace): Promise<void> {\n    // Clone repository\n    console.log(`ðŸ“¦ Cloning ${workspace.repository}...`);\n\n    // Setup IDE session\n    const session = this.ide.createSession(`/workspaces/${workspace.id}`);\n\n    // Initialize Elara context\n    await this.elara.initializeWorkspaceContext({\n      workspaceId: workspace.id,\n      repository: workspace.repository,\n      branch: workspace.branch\n    });\n\n    console.log(`âœ… Workspace ${workspace.id} ready`);\n  }\n\n  /**\n   * Get workspace by ID\n   */\n  public getWorkspace(id: string): Workspace | undefined {\n    return this.workspaces.get(id);\n  }\n\n  /**\n   * List workspaces for user\n   */\n  public listWorkspaces(owner: string): Workspace[] {\n    return Array.from(this.workspaces.values()).filter(\n      w => w.owner === owner\n    );\n  }\n\n  /**\n   * Stop workspace\n   */\n  public async stopWorkspace(id: string): Promise<void> {\n    const workspace = this.workspaces.get(id);\n    if (!workspace) {throw new Error('Workspace not found');}\n\n    workspace.status = 'stopped';\n    this.emit('workspace-stopped', workspace);\n  }\n\n  /**\n   * Delete workspace\n   */\n  public async deleteWorkspace(id: string): Promise<void> {\n    const workspace = this.workspaces.get(id);\n    if (!workspace) {throw new Error('Workspace not found');}\n\n    workspace.status = 'deleted';\n    this.workspaces.delete(id);\n    this.emit('workspace-deleted', workspace);\n  }\n\n  /**\n   * Get workspace statistics\n   */\n  public getStats(): {\n    total: number;\n    running: number;\n    stopped: number;\n    byType: Record<string, number>;\n  } {\n    const workspaces = Array.from(this.workspaces.values());\n    const byType: Record<string, number> = {};\n\n    for (const ws of workspaces) {\n      byType[ws.machineType] = (byType[ws.machineType] || 0) + 1;\n    }\n\n    return {\n      total: workspaces.length,\n      running: workspaces.filter(w => w.status === 'running').length,\n      stopped: workspaces.filter(w => w.status === 'stopped').length,\n      byType\n    };\n  }\n}\n\nexport default AzoraWorkspaces;\n\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}