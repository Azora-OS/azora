{"version":3,"names":["cov_hb4oyzgm6","actualCoverage","express","s","require","cors","helmet","rateLimit","compression","config","app","PORT","b","process","env","use","origin","credentials","json","ubuntuLimiter","windowMs","max","message","error","ubuntu","get","req","res","f","service","status","timestamp","Date","toISOString","port","philosophy","principles","authRoutes","oauthRoutes","tokenRoutes","gdprRoutes","authenticateToken","requireRole","requirePermission","ROLES","auditMiddleware","user","ADMIN","next","console","listen","log"],"sources":["server.js"],"sourcesContent":["const express = require('express');\nconst cors = require('cors');\nconst helmet = require('helmet');\nconst rateLimit = require('express-rate-limit');\nconst compression = require('./src/middleware/compression');\nrequire('dotenv').config();\n\nconst app = express();\nconst PORT = process.env.PORT || 4004;\n\n// Ubuntu Middleware\napp.use(helmet());\napp.use(compression);\napp.use(cors({\n  origin: ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:3002', 'http://localhost:3003'],\n  credentials: true\n}));\napp.use(express.json());\n\n// Ubuntu Rate Limiting\nconst ubuntuLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 1000,\n  message: { error: 'Ubuntu rate limit exceeded', ubuntu: 'Please slow down for community harmony' }\n});\napp.use(ubuntuLimiter);\n\n// Ubuntu Health Check\napp.get('/health', (req, res) => {\n  res.json({\n    service: 'azora-auth',\n    status: 'healthy',\n    ubuntu: 'I serve because we prosper together',\n    timestamp: new Date().toISOString(),\n    port: PORT\n  });\n});\n\n// Ubuntu Philosophy Endpoint\napp.get('/api/ubuntu/philosophy', (req, res) => {\n  res.json({\n    philosophy: 'Ngiyakwazi ngoba sikwazi - I am because we are',\n    principles: [\n      'My success enables your success',\n      'My knowledge becomes our knowledge',\n      'My work strengthens our foundation',\n      'My security ensures our freedom'\n    ],\n    service: 'azora-auth',\n    ubuntu: 'Ubuntu service excellence'\n  });\n});\n\n// Service-specific routes\nconst authRoutes = require('./src/routes/auth');\nconst oauthRoutes = require('./src/routes/oauth');\nconst tokenRoutes = require('./src/routes/token');\nconst gdprRoutes = require('./src/routes/gdpr');\nconst { authenticateToken } = require('./src/middleware/jwt');\nconst { requireRole, requirePermission, ROLES } = require('./src/middleware/rbac');\nconst { auditMiddleware } = require('./src/middleware/audit');\n\napp.use(auditMiddleware);\napp.use('/api/auth', authRoutes);\napp.use('/api/oauth', oauthRoutes);\napp.use('/api/token', tokenRoutes);\napp.use('/api/gdpr', gdprRoutes);\n\n// Protected route examples\napp.get('/api/profile', authenticateToken, (req, res) => {\n  res.json({\n    user: req.user,\n    ubuntu: 'Ubuntu profile access'\n  });\n});\n\napp.get('/api/admin/users', authenticateToken, requireRole(ROLES.ADMIN), (req, res) => {\n  res.json({\n    message: 'Admin users endpoint',\n    ubuntu: 'Ubuntu admin access granted'\n  });\n});\n\napp.get('/api/courses', authenticateToken, requirePermission('courses:read'), (req, res) => {\n  res.json({\n    message: 'Courses endpoint',\n    ubuntu: 'Ubuntu course access granted'\n  });\n});\n\n// Ubuntu Error Handling\napp.use((error, req, res, next) => {\n  console.error('Ubuntu Service Error:', error);\n  res.status(500).json({\n    error: 'Ubuntu service error',\n    ubuntu: 'We handle errors with Ubuntu grace',\n    timestamp: new Date().toISOString()\n  });\n});\n\n// Start Ubuntu Service\napp.listen(PORT, () => {\n  console.log(`ðŸš€ azora-auth running on port ${PORT}`);\n  console.log('âš¡ Ubuntu: \"I serve because we prosper together!\"');\n});"],"mappings":"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","ignoreList":[]}