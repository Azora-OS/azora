{"version":3,"names":["cov_2a3hhbuuxz","actualCoverage","ethers","config","AZRTokenABI","NFTCertificateABI","BlockchainService","constructor","f","s","provider","providers","JsonRpcProvider","rpcUrl","wallet","Wallet","privateKey","getBlockNumber","getBalance","address","balance","utils","formatEther","getContract","abi","Contract","getAZRContract","contracts","azrToken","getNFTContract","nftCertificate","listenToTransfers","contractAddress","callback","contract","on","from","to","amount","getReputationScore","hash","keccak256","score","parseInt","slice","level","b","updateReputation","change","console","log"],"sources":["blockchain-service.ts"],"sourcesContent":["import { ethers } from 'ethers';\nimport { config } from './config';\nimport AZRTokenABI from './abis/AZRToken.json';\nimport NFTCertificateABI from './abis/NFTCertificate.json';\n\nexport class BlockchainService {\n  private provider: ethers.providers.JsonRpcProvider;\n  private wallet: ethers.Wallet;\n\n  constructor() {\n    this.provider = new ethers.providers.JsonRpcProvider(config.rpcUrl);\n    this.wallet = new ethers.Wallet(config.privateKey, this.provider);\n  }\n\n  async getBlockNumber(): Promise<number> {\n    return await this.provider.getBlockNumber();\n  }\n\n  async getBalance(address: string): Promise<string> {\n    const balance = await this.provider.getBalance(address);\n    return ethers.utils.formatEther(balance);\n  }\n\n  getContract(address: string, abi: any): ethers.Contract {\n    return new ethers.Contract(address, abi, this.wallet);\n  }\n\n  // AZR Token Contract\n  getAZRContract(): ethers.Contract {\n    return this.getContract(config.contracts.azrToken, AZRTokenABI);\n  }\n\n  // NFT Certificate Contract\n  getNFTContract(): ethers.Contract {\n    return this.getContract(config.contracts.nftCertificate, NFTCertificateABI);\n  }\n\n  // Listen to contract events\n  async listenToTransfers(contractAddress: string, callback: (from: string, to: string, amount: string) => void) {\n    const contract = this.getAZRContract();\n    contract.on('Transfer', (from, to, amount) => {\n      callback(from, to, ethers.utils.formatEther(amount));\n    });\n  }\n\n  // --- Reputation System (Simulated for now) ---\n\n  async getReputationScore(address: string): Promise<{ score: number; level: string }> {\n    // In a real app, this would call a Reputation Registry smart contract\n    // For now, we simulate a score based on the address hash\n    const hash = ethers.utils.keccak256(address);\n    const score = parseInt(hash.slice(-2), 16) % 100; // Random score 0-99\n\n    let level = 'Novice';\n    if (score > 80) level = 'Expert';\n    else if (score > 50) level = 'Intermediate';\n\n    return { score, level };\n  }\n\n  async updateReputation(address: string, change: number): Promise<boolean> {\n    // This would be an admin-only transaction to the smart contract\n    console.log(`[Blockchain] Updating reputation for ${address} by ${change}`);\n    return true;\n  }\n}\n"],"mappings":"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","ignoreList":[]}