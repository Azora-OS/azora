{"version":3,"names":["cov_fso7bd70c","actualCoverage","ethers","BlockchainService","UbuntuService","constructor","f","s","blockchainService","mintKnowledgeTokens","userAddress","knowledgeProof","contributionAmount","contract","getAZRContract","baseAmount","utils","parseEther","ubuntuBonus","b","mul","div","tx","ubuntuMining","wait","success","transactionHash","hash","amount","formatEther","ubuntu","error","message","getTokenBalance","balance","balanceOf","knowledgeScore","score","toString","e","transferTokens","fromAddress","toAddress","purpose","transferAmount","transfer","ubuntuContribution","createProposal","title","description","votingPeriod","healthCheck","blockNumber","getBlockNumber","status"],"sources":["ubuntu-service.ts"],"sourcesContent":["import { ethers } from 'ethers';\nimport { BlockchainService } from './blockchain-service';\nimport { config } from './config';\n\nexport interface MiningResult {\n    success: boolean;\n    transactionHash?: string;\n    amount?: string;\n    knowledgeProof?: string;\n    ubuntu: string;\n    error?: string;\n}\n\nexport interface TokenBalance {\n    balance: string;\n    knowledgeScore: string;\n    ubuntu: string;\n    error?: string;\n}\n\nexport interface ProposalResult {\n    success: boolean;\n    transactionHash?: string;\n    proposalId?: number;\n    ubuntu: string;\n    error?: string;\n}\n\nexport interface VoteResult {\n    success: boolean;\n    transactionHash?: string;\n    proposalId?: number;\n    support?: boolean;\n    ubuntu: string;\n    error?: string;\n}\n\nexport interface StakingResult {\n    success: boolean;\n    transactionHash?: string;\n    amount?: number;\n    duration?: number;\n    expectedRewards?: string;\n    ubuntu: string;\n    error?: string;\n}\n\nexport class UbuntuService {\n    private blockchainService: BlockchainService;\n\n    constructor() {\n        this.blockchainService = new BlockchainService();\n    }\n\n    // Mint AZR tokens for Proof-of-Knowledge mining\n    async mintKnowledgeTokens(userAddress: string, knowledgeProof: string, contributionAmount: number): Promise<MiningResult> {\n        try {\n            const contract = this.blockchainService.getAZRContract();\n            const baseAmount = ethers.utils.parseEther('10'); // 10 AZR base reward\n\n            // 1.5x bonus for high contribution\n            const ubuntuBonus = contributionAmount > 5\n                ? baseAmount.mul(150).div(100)\n                : baseAmount;\n\n            // Note: In a real scenario, this method would need to be called by a wallet with Minter role\n            // For now, we assume the service wallet has this role\n            const tx = await contract.ubuntuMining(userAddress, ubuntuBonus, knowledgeProof);\n            await tx.wait();\n\n            return {\n                success: true,\n                transactionHash: tx.hash,\n                amount: ethers.utils.formatEther(ubuntuBonus),\n                knowledgeProof,\n                ubuntu: 'Ubuntu knowledge rewarded - I learn because we grow'\n            };\n        } catch (error: any) {\n            return {\n                success: false,\n                ubuntu: 'Ubuntu handles challenges with collective wisdom',\n                error: error.message\n            };\n        }\n    }\n\n    // Get user's token balance\n    async getTokenBalance(userAddress: string): Promise<TokenBalance> {\n        try {\n            const contract = this.blockchainService.getAZRContract();\n            const balance = await contract.balanceOf(userAddress);\n\n            // Try to get knowledge score, default to 0 if method doesn't exist yet\n            let knowledgeScore = '0';\n            try {\n                const score = await contract.knowledgeScore(userAddress);\n                knowledgeScore = score.toString();\n            } catch (e) {\n                // Method might not exist in ABI yet\n            }\n\n            return {\n                balance: ethers.utils.formatEther(balance),\n                knowledgeScore,\n                ubuntu: 'Ubuntu prosperity measured in collective knowledge'\n            };\n        } catch (error: any) {\n            return {\n                balance: '0',\n                knowledgeScore: '0',\n                ubuntu: 'Error fetching balance',\n                error: error.message\n            };\n        }\n    }\n\n    // Transfer tokens with Ubuntu purpose\n    async transferTokens(fromAddress: string, toAddress: string, amount: number, purpose: string): Promise<any> {\n        try {\n            const contract = this.blockchainService.getAZRContract();\n            const transferAmount = ethers.utils.parseEther(amount.toString());\n\n            const tx = await contract.transfer(toAddress, transferAmount);\n            await tx.wait();\n\n            // Log Ubuntu contribution if method exists\n            try {\n                await contract.ubuntuContribution(fromAddress, transferAmount, purpose || 'Ubuntu sharing');\n            } catch (e) {\n                // Method might not exist\n            }\n\n            return {\n                success: true,\n                transactionHash: tx.hash,\n                amount,\n                purpose,\n                ubuntu: 'Ubuntu sharing strengthens our collective'\n            };\n        } catch (error: any) {\n            return {\n                success: false,\n                error: error.message,\n                ubuntu: 'Ubuntu transfers require collective harmony'\n            };\n        }\n    }\n\n    // Create governance proposal\n    async createProposal(title: string, description: string, votingPeriod: number = 7): Promise<ProposalResult> {\n        // Placeholder for Governance contract interaction\n        // In a real implementation, we would add getGovernanceContract() to BlockchainService\n        return {\n            success: false,\n            ubuntu: 'Governance contract not yet connected',\n            error: 'Governance contract not implemented'\n        };\n    }\n\n    // Health check\n    async healthCheck(): Promise<any> {\n        try {\n            const blockNumber = await this.blockchainService.getBlockNumber();\n            return {\n                status: 'healthy',\n                blockNumber,\n                ubuntu: 'Ubuntu blockchain integration operational'\n            };\n        } catch (error: any) {\n            return {\n                status: 'unhealthy',\n                error: error.message,\n                ubuntu: 'Ubuntu blockchain facing temporary challenges'\n            };\n        }\n    }\n}\n"],"mappings":"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","ignoreList":[]}