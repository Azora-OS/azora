{"version":3,"names":["cov_1heaqnpti6","actualCoverage","prisma","logger","Joi","pricingTierSchema","s","object","name","string","valid","required","monthlyPrice","number","min","studentDiscount","max","features","array","items","coursesPerMonth","aiQueriesPerMonth","storageGB","supportLevel","DEFAULT_TIERS","free","premium","pro","PricingService","initializeDefaultTiers","f","tierEntries","Object","values","tierData","existingTier","pricingTier","findUnique","where","b","create","data","info","error","getAllTiers","tiers","findMany","orderBy","map","tier","mapTierToInterface","getTierByName","tierName","createTier","value","validate","Error","message","updateTier","updateSchema","update","undefined","calculateStudentPrice","discountAmount","getTierLimits","canAccessCourse","studentTier","courseTier","tierHierarchy","studentLevel","courseLevel","getStudentPricing","studentPrice","Number","originalPrice","savings","limits","id","description","pricingService"],"sources":["pricing.service.ts"],"sourcesContent":["import { prisma } from '../index';\nimport { PricingTier, TierLimits } from '../types';\nimport { logger } from '../utils/logger';\nimport Joi from 'joi';\n\n// Validation schemas\nconst pricingTierSchema = Joi.object({\n  name: Joi.string().valid('free', 'premium', 'pro').required(),\n  monthlyPrice: Joi.number().min(0).required(),\n  studentDiscount: Joi.number().min(0).max(100).required(),\n  features: Joi.array().items(Joi.string()).required(),\n  coursesPerMonth: Joi.number().min(0).required(),\n  aiQueriesPerMonth: Joi.number().min(0).required(),\n  storageGB: Joi.number().min(0).required(),\n  supportLevel: Joi.string().valid('community', 'priority', 'dedicated').required(),\n});\n\n// Default tier configurations\nconst DEFAULT_TIERS = {\n  free: {\n    name: 'free',\n    monthlyPrice: 0,\n    studentDiscount: 0,\n    features: [\n      'Access to 3 foundational courses',\n      '10 AI queries per month',\n      '1GB storage',\n      'Community support',\n    ],\n    coursesPerMonth: 3,\n    aiQueriesPerMonth: 10,\n    storageGB: 1,\n    supportLevel: 'community',\n  },\n  premium: {\n    name: 'premium',\n    monthlyPrice: 29.99,\n    studentDiscount: 50,\n    features: [\n      'Unlimited courses',\n      'Unlimited AI queries',\n      '10GB storage',\n      'Priority support',\n      'Certification services',\n      'Advanced analytics',\n    ],\n    coursesPerMonth: 999999,\n    aiQueriesPerMonth: 999999,\n    storageGB: 10,\n    supportLevel: 'priority',\n  },\n  pro: {\n    name: 'pro',\n    monthlyPrice: 99.99,\n    studentDiscount: 30,\n    features: [\n      'All Premium features',\n      'API access',\n      'Advanced AI features',\n      'Development tools',\n      'Dedicated support',\n      'Custom integrations',\n    ],\n    coursesPerMonth: 999999,\n    aiQueriesPerMonth: 999999,\n    storageGB: 100,\n    supportLevel: 'dedicated',\n  },\n};\n\nexport class PricingService {\n  /**\n   * Initialize default pricing tiers in the database\n   */\n  async initializeDefaultTiers(): Promise<void> {\n    try {\n      const tierEntries = Object.values(DEFAULT_TIERS) as const;\n      for (const tierData of tierEntries) {\n        const existingTier = await prisma.pricingTier.findUnique({\n          where: { name: tierData.name },\n        });\n\n        if (!existingTier) {\n          await prisma.pricingTier.create({\n            data: {\n              name: tierData.name,\n              monthlyPrice: tierData.monthlyPrice,\n              studentDiscount: tierData.studentDiscount,\n              features: tierData.features,\n              coursesPerMonth: tierData.coursesPerMonth,\n              aiQueriesPerMonth: tierData.aiQueriesPerMonth,\n              storageGB: tierData.storageGB,\n              supportLevel: tierData.supportLevel,\n            },\n          });\n          logger.info(`Pricing tier initialized: ${tierData.name}`);\n        }\n      }\n    } catch (error) {\n      logger.error('Error initializing default pricing tiers:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get all pricing tiers\n   */\n  async getAllTiers(): Promise<PricingTier[]> {\n    try {\n      const tiers = await prisma.pricingTier.findMany({\n        orderBy: { monthlyPrice: 'asc' },\n      });\n\n      return tiers.map((tier: any) => this.mapTierToInterface(tier));\n    } catch (error) {\n      logger.error('Error getting all pricing tiers:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get a specific pricing tier by name\n   */\n  async getTierByName(tierName: string): Promise<PricingTier | null> {\n    try {\n      const tier = await prisma.pricingTier.findUnique({\n        where: { name: tierName },\n      });\n\n      return tier ? this.mapTierToInterface(tier) : null;\n    } catch (error) {\n      logger.error(`Error getting pricing tier ${tierName}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create a new pricing tier\n   */\n  async createTier(data: any): Promise<PricingTier> {\n    try {\n      const { error, value } = pricingTierSchema.validate(data);\n      if (error) {\n        throw new Error(`Validation error: ${error.message}`);\n      }\n\n      // Check if tier already exists\n      const existingTier = await prisma.pricingTier.findUnique({\n        where: { name: value.name },\n      });\n\n      if (existingTier) {\n        throw new Error(`Pricing tier ${value.name} already exists`);\n      }\n\n      const tier = await prisma.pricingTier.create({\n        data: {\n          name: value.name,\n          monthlyPrice: value.monthlyPrice,\n          studentDiscount: value.studentDiscount,\n          features: value.features,\n          coursesPerMonth: value.coursesPerMonth,\n          aiQueriesPerMonth: value.aiQueriesPerMonth,\n          storageGB: value.storageGB,\n          supportLevel: value.supportLevel,\n        },\n      });\n\n      logger.info(`Pricing tier created: ${tier.name}`);\n      return this.mapTierToInterface(tier);\n    } catch (error) {\n      logger.error('Error creating pricing tier:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update a pricing tier\n   */\n  async updateTier(tierName: string, data: any): Promise<PricingTier> {\n    try {\n      // Create a partial schema for updates\n      const updateSchema = Joi.object({\n        monthlyPrice: Joi.number().min(0),\n        studentDiscount: Joi.number().min(0).max(100),\n        features: Joi.array().items(Joi.string()),\n        coursesPerMonth: Joi.number().min(0),\n        aiQueriesPerMonth: Joi.number().min(0),\n        storageGB: Joi.number().min(0),\n        supportLevel: Joi.string().valid('community', 'priority', 'dedicated'),\n      });\n\n      const { error, value } = updateSchema.validate(data);\n      if (error) {\n        throw new Error(`Validation error: ${error.message}`);\n      }\n\n      const tier = await prisma.pricingTier.update({\n        where: { name: tierName },\n        data: {\n          ...(value.monthlyPrice !== undefined && { monthlyPrice: value.monthlyPrice }),\n          ...(value.studentDiscount !== undefined && { studentDiscount: value.studentDiscount }),\n          ...(value.features && { features: value.features }),\n          ...(value.coursesPerMonth !== undefined && { coursesPerMonth: value.coursesPerMonth }),\n          ...(value.aiQueriesPerMonth !== undefined && { aiQueriesPerMonth: value.aiQueriesPerMonth }),\n          ...(value.storageGB !== undefined && { storageGB: value.storageGB }),\n          ...(value.supportLevel && { supportLevel: value.supportLevel }),\n        },\n      });\n\n      logger.info(`Pricing tier updated: ${tierName}`);\n      return this.mapTierToInterface(tier);\n    } catch (error) {\n      logger.error(`Error updating pricing tier ${tierName}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Calculate the price for a student based on tier and discount\n   */\n  calculateStudentPrice(monthlyPrice: number, studentDiscount: number): number {\n    const discountAmount = (monthlyPrice * studentDiscount) / 100;\n    return monthlyPrice - discountAmount;\n  }\n\n  /**\n   * Get tier limits for a specific tier\n   */\n  async getTierLimits(tierName: string): Promise<TierLimits | null> {\n    try {\n      const tier = await prisma.pricingTier.findUnique({\n        where: { name: tierName },\n      });\n\n      if (!tier) {\n        return null;\n      }\n\n      return {\n        coursesPerMonth: tier.coursesPerMonth,\n        aiQueriesPerMonth: tier.aiQueriesPerMonth,\n        storageGB: tier.storageGB,\n        supportLevel: tier.supportLevel as 'community' | 'priority' | 'dedicated',\n      };\n    } catch (error) {\n      logger.error(`Error getting tier limits for ${tierName}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Check if a student can access a course based on their tier\n   */\n  async canAccessCourse(studentTier: string, courseTier: string): Promise<boolean> {\n    try {\n      const tierHierarchy = { free: 0, premium: 1, pro: 2 };\n      const studentLevel = tierHierarchy[studentTier as keyof typeof tierHierarchy] ?? -1;\n      const courseLevel = tierHierarchy[courseTier as keyof typeof tierHierarchy] ?? -1;\n\n      return studentLevel >= courseLevel;\n    } catch (error) {\n      logger.error('Error checking course access:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get pricing information for a student (with discount applied)\n   */\n  async getStudentPricing(tierName: string): Promise<any> {\n    try {\n      const tier = await prisma.pricingTier.findUnique({\n        where: { name: tierName },\n      });\n\n      if (!tier) {\n        throw new Error(`Pricing tier ${tierName} not found`);\n      }\n\n      const studentPrice = this.calculateStudentPrice(\n        Number(tier.monthlyPrice),\n        tier.studentDiscount\n      );\n\n      return {\n        tier: tier.name,\n        originalPrice: Number(tier.monthlyPrice),\n        studentDiscount: tier.studentDiscount,\n        studentPrice,\n        savings: Number(tier.monthlyPrice) - studentPrice,\n        features: tier.features,\n        limits: {\n          coursesPerMonth: tier.coursesPerMonth,\n          aiQueriesPerMonth: tier.aiQueriesPerMonth,\n          storageGB: tier.storageGB,\n          supportLevel: tier.supportLevel,\n        },\n      };\n    } catch (error) {\n      logger.error(`Error getting student pricing for ${tierName}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Map database tier to interface\n   */\n  private mapTierToInterface(tier: any): PricingTier {\n    return {\n      id: tier.id,\n      name: tier.name as 'free' | 'premium' | 'pro',\n      monthlyPrice: Number(tier.monthlyPrice),\n      studentDiscount: tier.studentDiscount,\n      features: tier.features.map((f: string) => ({\n        id: `${tier.name}-${f}`,\n        name: f,\n        description: f,\n        tier: tier.name,\n      })),\n      limits: {\n        coursesPerMonth: tier.coursesPerMonth,\n        aiQueriesPerMonth: tier.aiQueriesPerMonth,\n        storageGB: tier.storageGB,\n        supportLevel: tier.supportLevel as 'community' | 'priority' | 'dedicated',\n      },\n    };\n  }\n}\n\nexport const pricingService = new PricingService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}