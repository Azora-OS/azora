{"version":3,"names":["cov_38nwyotx8","actualCoverage","AzoraAI","s","require","ai","moderateContent","req","res","next","f","textFields","field","body","b","moderation","success","flagged","status","json","error","ubuntu","console","enhanceWithAI","content","enhancement","chat","aiEnhanced","message","module","exports"],"sources":["ai-middleware.js"],"sourcesContent":["const AzoraAI = require('./ai-client');\n\nconst ai = new AzoraAI();\n\n// Content moderation middleware\nconst moderateContent = async (req, res, next) => {\n  try {\n    const textFields = ['message', 'content', 'description', 'comment'];\n    \n    for (const field of textFields) {\n      if (req.body[field]) {\n        const moderation = await ai.moderateContent(req.body[field]);\n        \n        if (moderation.success && moderation.flagged) {\n          return res.status(400).json({\n            success: false,\n            error: 'Content violates community guidelines',\n            ubuntu: 'I protect because we care together'\n          });\n        }\n      }\n    }\n    \n    next();\n  } catch (error) {\n    console.error('Moderation error:', error);\n    next(); // Continue on moderation error\n  }\n};\n\n// AI enhancement middleware\nconst enhanceWithAI = async (req, res, next) => {\n  try {\n    if (req.body.enhanceWithAI && req.body.content) {\n      const enhancement = await ai.chat(\n        `Please enhance this content with Ubuntu philosophy: ${req.body.content}`\n      );\n      \n      if (enhancement.success) {\n        req.body.aiEnhanced = enhancement.message;\n      }\n    }\n    \n    next();\n  } catch (error) {\n    console.error('AI enhancement error:', error);\n    next(); // Continue on AI error\n  }\n};\n\nmodule.exports = {\n  moderateContent,\n  enhanceWithAI\n};"],"mappings":"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","ignoreList":[]}