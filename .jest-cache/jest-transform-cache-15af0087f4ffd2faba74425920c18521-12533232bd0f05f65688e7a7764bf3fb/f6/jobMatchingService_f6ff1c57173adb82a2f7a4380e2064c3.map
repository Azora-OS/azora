{"version":3,"names":["cov_19vyyp9nxj","actualCoverage","PrismaClient","prisma","s","JobMatchingService","matchFreelancersToJob","jobId","limit","b","f","job","findUnique","where","id","Error","freelancers","user","findMany","role","in","skills","hasSome","include","jobsAssigned","status","reviews","map","score","calculateScore","sort","a","slice","freelancer","skillMatch","filter","includes","length","rating","experience","Math","min","round"],"sources":["jobMatchingService.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst prisma = new PrismaClient();\n\nexport class JobMatchingService {\n  async matchFreelancersToJob(jobId: string, limit = 10) {\n    const job = await prisma.job.findUnique({ where: { id: jobId } });\n    if (!job) {throw new Error('Job not found');}\n\n    const freelancers = await prisma.user.findMany({\n      where: { role: { in: ['FREELANCER', 'BOTH'] }, skills: { hasSome: job.skills } },\n      include: { jobsAssigned: { where: { status: 'COMPLETED' } }, reviews: true }\n    });\n\n    return freelancers.map(f => ({\n      ...f,\n      score: this.calculateScore(f, job)\n    })).sort((a, b) => b.score - a.score).slice(0, limit);\n  }\n\n  private calculateScore(freelancer: any, job: any): number {\n    const skillMatch = freelancer.skills.filter((s: string) => job.skills.includes(s)).length / job.skills.length;\n    const rating = freelancer.rating / 5;\n    const experience = Math.min((freelancer.jobsAssigned?.length || 0) / 10, 1);\n    return Math.round(skillMatch * 40 + rating * 30 + experience * 30);\n  }\n}\n"],"mappings":"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","ignoreList":[]}