19a8211ee94c2eb677f31b0e1da430de
/* istanbul ignore next */
function cov_pf8hnhv6h() {
  var path = "/workspaces/azora/services/azora-sapiens/src/engines/progress-tracker.ts";
  var hash = "0c3a3ef7ba8f0948a1b86437f2c8bbec403e4340";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/azora-sapiens/src/engines/progress-tracker.ts",
    statementMap: {
      "0": {
        start: {
          line: 26,
          column: 4
        },
        end: {
          line: 32,
          column: 6
        }
      },
      "1": {
        start: {
          line: 36,
          column: 18
        },
        end: {
          line: 42,
          column: 5
        }
      },
      "2": {
        start: {
          line: 43,
          column: 4
        },
        end: {
          line: 43,
          column: 37
        }
      },
      "3": {
        start: {
          line: 47,
          column: 30
        },
        end: {
          line: 47,
          column: 79
        }
      },
      "4": {
        start: {
          line: 47,
          column: 53
        },
        end: {
          line: 47,
          column: 78
        }
      },
      "5": {
        start: {
          line: 49,
          column: 4
        },
        end: {
          line: 55,
          column: 6
        }
      },
      "6": {
        start: {
          line: 51,
          column: 53
        },
        end: {
          line: 51,
          column: 70
        }
      },
      "7": {
        start: {
          line: 59,
          column: 4
        },
        end: {
          line: 59,
          column: 44
        }
      },
      "8": {
        start: {
          line: 59,
          column: 34
        },
        end: {
          line: 59,
          column: 43
        }
      },
      "9": {
        start: {
          line: 60,
          column: 22
        },
        end: {
          line: 60,
          column: 69
        }
      },
      "10": {
        start: {
          line: 60,
          column: 45
        },
        end: {
          line: 60,
          column: 61
        }
      },
      "11": {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 61,
          column: 49
        }
      },
      "12": {
        start: {
          line: 65,
          column: 19
        },
        end: {
          line: 65,
          column: 96
        }
      },
      "13": {
        start: {
          line: 65,
          column: 50
        },
        end: {
          line: 65,
          column: 95
        }
      },
      "14": {
        start: {
          line: 66,
          column: 17
        },
        end: {
          line: 66,
          column: 18
        }
      },
      "15": {
        start: {
          line: 67,
          column: 19
        },
        end: {
          line: 67,
          column: 29
        }
      },
      "16": {
        start: {
          line: 69,
          column: 4
        },
        end: {
          line: 77,
          column: 5
        }
      },
      "17": {
        start: {
          line: 70,
          column: 23
        },
        end: {
          line: 70,
          column: 110
        }
      },
      "18": {
        start: {
          line: 71,
          column: 6
        },
        end: {
          line: 76,
          column: 7
        }
      },
      "19": {
        start: {
          line: 72,
          column: 8
        },
        end: {
          line: 72,
          column: 17
        }
      },
      "20": {
        start: {
          line: 73,
          column: 8
        },
        end: {
          line: 73,
          column: 38
        }
      },
      "21": {
        start: {
          line: 75,
          column: 8
        },
        end: {
          line: 75,
          column: 14
        }
      },
      "22": {
        start: {
          line: 79,
          column: 4
        },
        end: {
          line: 79,
          column: 18
        }
      },
      "23": {
        start: {
          line: 83,
          column: 21
        },
        end: {
          line: 83,
          column: 72
        }
      },
      "24": {
        start: {
          line: 83,
          column: 51
        },
        end: {
          line: 83,
          column: 68
        }
      },
      "25": {
        start: {
          line: 84,
          column: 4
        },
        end: {
          line: 84,
          column: 45
        }
      },
      "26": {
        start: {
          line: 84,
          column: 28
        },
        end: {
          line: 84,
          column: 44
        }
      },
      "27": {
        start: {
          line: 85,
          column: 4
        },
        end: {
          line: 85,
          column: 46
        }
      },
      "28": {
        start: {
          line: 85,
          column: 27
        },
        end: {
          line: 85,
          column: 45
        }
      },
      "29": {
        start: {
          line: 86,
          column: 4
        },
        end: {
          line: 86,
          column: 50
        }
      },
      "30": {
        start: {
          line: 86,
          column: 27
        },
        end: {
          line: 86,
          column: 49
        }
      },
      "31": {
        start: {
          line: 87,
          column: 4
        },
        end: {
          line: 87,
          column: 22
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 25,
            column: 2
          },
          end: {
            line: 25,
            column: 3
          }
        },
        loc: {
          start: {
            line: 25,
            column: 65
          },
          end: {
            line: 33,
            column: 3
          }
        },
        line: 25
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 35,
            column: 2
          },
          end: {
            line: 35,
            column: 3
          }
        },
        loc: {
          start: {
            line: 35,
            column: 43
          },
          end: {
            line: 44,
            column: 3
          }
        },
        line: 35
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 46,
            column: 2
          },
          end: {
            line: 46,
            column: 3
          }
        },
        loc: {
          start: {
            line: 46,
            column: 88
          },
          end: {
            line: 56,
            column: 3
          }
        },
        line: 46
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 47,
            column: 48
          },
          end: {
            line: 47,
            column: 49
          }
        },
        loc: {
          start: {
            line: 47,
            column: 53
          },
          end: {
            line: 47,
            column: 78
          }
        },
        line: 47
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 51,
            column: 41
          },
          end: {
            line: 51,
            column: 42
          }
        },
        loc: {
          start: {
            line: 51,
            column: 53
          },
          end: {
            line: 51,
            column: 70
          }
        },
        line: 51
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 58,
            column: 2
          },
          end: {
            line: 58,
            column: 3
          }
        },
        loc: {
          start: {
            line: 58,
            column: 58
          },
          end: {
            line: 62,
            column: 3
          }
        },
        line: 58
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 60,
            column: 40
          },
          end: {
            line: 60,
            column: 41
          }
        },
        loc: {
          start: {
            line: 60,
            column: 45
          },
          end: {
            line: 60,
            column: 61
          }
        },
        line: 60
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 64,
            column: 2
          },
          end: {
            line: 64,
            column: 3
          }
        },
        loc: {
          start: {
            line: 64,
            column: 50
          },
          end: {
            line: 80,
            column: 3
          }
        },
        line: 64
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 65,
            column: 40
          },
          end: {
            line: 65,
            column: 41
          }
        },
        loc: {
          start: {
            line: 65,
            column: 50
          },
          end: {
            line: 65,
            column: 95
          }
        },
        line: 65
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 82,
            column: 2
          },
          end: {
            line: 82,
            column: 3
          }
        },
        loc: {
          start: {
            line: 82,
            column: 94
          },
          end: {
            line: 88,
            column: 3
          }
        },
        line: 82
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 83,
            column: 39
          },
          end: {
            line: 83,
            column: 40
          }
        },
        loc: {
          start: {
            line: 83,
            column: 51
          },
          end: {
            line: 83,
            column: 68
          }
        },
        line: 83
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 43,
            column: 11
          },
          end: {
            line: 43,
            column: 36
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 43,
            column: 11
          },
          end: {
            line: 43,
            column: 31
          }
        }, {
          start: {
            line: 43,
            column: 35
          },
          end: {
            line: 43,
            column: 36
          }
        }],
        line: 43
      },
      "1": {
        loc: {
          start: {
            line: 59,
            column: 4
          },
          end: {
            line: 59,
            column: 44
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 59,
            column: 4
          },
          end: {
            line: 59,
            column: 44
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 59
      },
      "2": {
        loc: {
          start: {
            line: 71,
            column: 6
          },
          end: {
            line: 76,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 71,
            column: 6
          },
          end: {
            line: 76,
            column: 7
          }
        }, {
          start: {
            line: 74,
            column: 13
          },
          end: {
            line: 76,
            column: 7
          }
        }],
        line: 71
      },
      "3": {
        loc: {
          start: {
            line: 84,
            column: 4
          },
          end: {
            line: 84,
            column: 45
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 84,
            column: 4
          },
          end: {
            line: 84,
            column: 45
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 84
      },
      "4": {
        loc: {
          start: {
            line: 85,
            column: 4
          },
          end: {
            line: 85,
            column: 46
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 85,
            column: 4
          },
          end: {
            line: 85,
            column: 46
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 85
      },
      "5": {
        loc: {
          start: {
            line: 86,
            column: 4
          },
          end: {
            line: 86,
            column: 50
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 86,
            column: 4
          },
          end: {
            line: 86,
            column: 50
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 86
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "0c3a3ef7ba8f0948a1b86437f2c8bbec403e4340"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_pf8hnhv6h = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_pf8hnhv6h();
class ProgressTracker {
  trackProgress(studentId, activity) {
    /* istanbul ignore next */
    cov_pf8hnhv6h().f[0]++;
    cov_pf8hnhv6h().s[0]++;
    return {
      studentId,
      activity: activity.type,
      timestamp: new Date(),
      data: activity.data,
      azrEarned: this.calculateAZR(activity)
    };
  }
  calculateAZR(activity) {
    /* istanbul ignore next */
    cov_pf8hnhv6h().f[1]++;
    const rates =
    /* istanbul ignore next */
    (cov_pf8hnhv6h().s[1]++, {
      lesson_complete: 10,
      quiz_passed: 25,
      project_submitted: 50,
      assessment_passed: 100,
      help_peer: 15
    });
    /* istanbul ignore next */
    cov_pf8hnhv6h().s[2]++;
    return /* istanbul ignore next */(cov_pf8hnhv6h().b[0][0]++, rates[activity.type]) ||
    /* istanbul ignore next */
    (cov_pf8hnhv6h().b[0][1]++, 0);
  }
  getStudentProgress(studentId, activities) {
    /* istanbul ignore next */
    cov_pf8hnhv6h().f[2]++;
    const studentActivities =
    /* istanbul ignore next */
    (cov_pf8hnhv6h().s[3]++, activities.filter(a => {
      /* istanbul ignore next */
      cov_pf8hnhv6h().f[3]++;
      cov_pf8hnhv6h().s[4]++;
      return a.studentId === studentId;
    }));
    /* istanbul ignore next */
    cov_pf8hnhv6h().s[5]++;
    return {
      totalActivities: studentActivities.length,
      totalAZR: studentActivities.reduce((sum, a) => {
        /* istanbul ignore next */
        cov_pf8hnhv6h().f[4]++;
        cov_pf8hnhv6h().s[6]++;
        return sum + a.azrEarned;
      }, 0),
      completionRate: this.calculateCompletionRate(studentActivities),
      streak: this.calculateStreak(studentActivities),
      level: this.determineLevel(studentActivities)
    };
  }
  calculateCompletionRate(activities) {
    /* istanbul ignore next */
    cov_pf8hnhv6h().f[5]++;
    cov_pf8hnhv6h().s[7]++;
    if (activities.length === 0) {
      /* istanbul ignore next */
      cov_pf8hnhv6h().b[1][0]++;
      cov_pf8hnhv6h().s[8]++;
      return 0;
    } else
    /* istanbul ignore next */
    {
      cov_pf8hnhv6h().b[1][1]++;
    }
    const completed =
    /* istanbul ignore next */
    (cov_pf8hnhv6h().s[9]++, activities.filter(a => {
      /* istanbul ignore next */
      cov_pf8hnhv6h().f[6]++;
      cov_pf8hnhv6h().s[10]++;
      return a.data.completed;
    }).length);
    /* istanbul ignore next */
    cov_pf8hnhv6h().s[11]++;
    return completed / activities.length * 100;
  }
  calculateStreak(activities) {
    /* istanbul ignore next */
    cov_pf8hnhv6h().f[7]++;
    const sorted =
    /* istanbul ignore next */
    (cov_pf8hnhv6h().s[12]++, [...activities].sort((a, b) => {
      /* istanbul ignore next */
      cov_pf8hnhv6h().f[8]++;
      cov_pf8hnhv6h().s[13]++;
      return b.timestamp.getTime() - a.timestamp.getTime();
    }));
    let streak =
    /* istanbul ignore next */
    (cov_pf8hnhv6h().s[14]++, 0);
    let lastDate =
    /* istanbul ignore next */
    (cov_pf8hnhv6h().s[15]++, new Date());
    /* istanbul ignore next */
    cov_pf8hnhv6h().s[16]++;
    for (const activity of sorted) {
      const daysDiff =
      /* istanbul ignore next */
      (cov_pf8hnhv6h().s[17]++, Math.floor((lastDate.getTime() - activity.timestamp.getTime()) / (1000 * 60 * 60 * 24)));
      /* istanbul ignore next */
      cov_pf8hnhv6h().s[18]++;
      if (daysDiff <= 1) {
        /* istanbul ignore next */
        cov_pf8hnhv6h().b[2][0]++;
        cov_pf8hnhv6h().s[19]++;
        streak++;
        /* istanbul ignore next */
        cov_pf8hnhv6h().s[20]++;
        lastDate = activity.timestamp;
      } else {
        /* istanbul ignore next */
        cov_pf8hnhv6h().b[2][1]++;
        cov_pf8hnhv6h().s[21]++;
        break;
      }
    }
    /* istanbul ignore next */
    cov_pf8hnhv6h().s[22]++;
    return streak;
  }
  determineLevel(activities) {
    /* istanbul ignore next */
    cov_pf8hnhv6h().f[9]++;
    const totalAZR =
    /* istanbul ignore next */
    (cov_pf8hnhv6h().s[23]++, activities.reduce((sum, a) => {
      /* istanbul ignore next */
      cov_pf8hnhv6h().f[10]++;
      cov_pf8hnhv6h().s[24]++;
      return sum + a.azrEarned;
    }, 0));
    /* istanbul ignore next */
    cov_pf8hnhv6h().s[25]++;
    if (totalAZR >= 10000) {
      /* istanbul ignore next */
      cov_pf8hnhv6h().b[3][0]++;
      cov_pf8hnhv6h().s[26]++;
      return 'expert';
    } else
    /* istanbul ignore next */
    {
      cov_pf8hnhv6h().b[3][1]++;
    }
    cov_pf8hnhv6h().s[27]++;
    if (totalAZR >= 5000) {
      /* istanbul ignore next */
      cov_pf8hnhv6h().b[4][0]++;
      cov_pf8hnhv6h().s[28]++;
      return 'advanced';
    } else
    /* istanbul ignore next */
    {
      cov_pf8hnhv6h().b[4][1]++;
    }
    cov_pf8hnhv6h().s[29]++;
    if (totalAZR >= 1000) {
      /* istanbul ignore next */
      cov_pf8hnhv6h().b[5][0]++;
      cov_pf8hnhv6h().s[30]++;
      return 'intermediate';
    } else
    /* istanbul ignore next */
    {
      cov_pf8hnhv6h().b[5][1]++;
    }
    cov_pf8hnhv6h().s[31]++;
    return 'beginner';
  }
}
export default new ProgressTracker();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfcGY4aG5odjZoIiwiYWN0dWFsQ292ZXJhZ2UiLCJQcm9ncmVzc1RyYWNrZXIiLCJ0cmFja1Byb2dyZXNzIiwic3R1ZGVudElkIiwiYWN0aXZpdHkiLCJmIiwicyIsInR5cGUiLCJ0aW1lc3RhbXAiLCJEYXRlIiwiZGF0YSIsImF6ckVhcm5lZCIsImNhbGN1bGF0ZUFaUiIsInJhdGVzIiwibGVzc29uX2NvbXBsZXRlIiwicXVpel9wYXNzZWQiLCJwcm9qZWN0X3N1Ym1pdHRlZCIsImFzc2Vzc21lbnRfcGFzc2VkIiwiaGVscF9wZWVyIiwiYiIsImdldFN0dWRlbnRQcm9ncmVzcyIsImFjdGl2aXRpZXMiLCJzdHVkZW50QWN0aXZpdGllcyIsImZpbHRlciIsImEiLCJ0b3RhbEFjdGl2aXRpZXMiLCJsZW5ndGgiLCJ0b3RhbEFaUiIsInJlZHVjZSIsInN1bSIsImNvbXBsZXRpb25SYXRlIiwiY2FsY3VsYXRlQ29tcGxldGlvblJhdGUiLCJzdHJlYWsiLCJjYWxjdWxhdGVTdHJlYWsiLCJsZXZlbCIsImRldGVybWluZUxldmVsIiwiY29tcGxldGVkIiwic29ydGVkIiwic29ydCIsImdldFRpbWUiLCJsYXN0RGF0ZSIsImRheXNEaWZmIiwiTWF0aCIsImZsb29yIl0sInNvdXJjZXMiOlsicHJvZ3Jlc3MtdHJhY2tlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgQWN0aXZpdHkge1xuICB0eXBlOiAnbGVzc29uX2NvbXBsZXRlJyB8ICdxdWl6X3Bhc3NlZCcgfCAncHJvamVjdF9zdWJtaXR0ZWQnIHwgJ2Fzc2Vzc21lbnRfcGFzc2VkJyB8ICdoZWxwX3BlZXInO1xuICBkYXRhOiBhbnk7XG4gIHN0dWRlbnRJZDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmludGVyZmFjZSBQcm9ncmVzcyB7XG4gIHN0dWRlbnRJZDogc3RyaW5nO1xuICBhY3Rpdml0eTogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG4gIGRhdGE6IGFueTtcbiAgYXpyRWFybmVkOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBTdHVkZW50UHJvZ3Jlc3NTdW1tYXJ5IHtcbiAgdG90YWxBY3Rpdml0aWVzOiBudW1iZXI7XG4gIHRvdGFsQVpSOiBudW1iZXI7XG4gIGNvbXBsZXRpb25SYXRlOiBudW1iZXI7XG4gIHN0cmVhazogbnVtYmVyO1xuICBsZXZlbDogJ2JlZ2lubmVyJyB8ICdpbnRlcm1lZGlhdGUnIHwgJ2FkdmFuY2VkJyB8ICdleHBlcnQnO1xufVxuXG5jbGFzcyBQcm9ncmVzc1RyYWNrZXIge1xuICB0cmFja1Byb2dyZXNzKHN0dWRlbnRJZDogc3RyaW5nLCBhY3Rpdml0eTogQWN0aXZpdHkpOiBQcm9ncmVzcyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0dWRlbnRJZCxcbiAgICAgIGFjdGl2aXR5OiBhY3Rpdml0eS50eXBlLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgZGF0YTogYWN0aXZpdHkuZGF0YSxcbiAgICAgIGF6ckVhcm5lZDogdGhpcy5jYWxjdWxhdGVBWlIoYWN0aXZpdHkpLFxuICAgIH07XG4gIH1cblxuICBjYWxjdWxhdGVBWlIoYWN0aXZpdHk6IEFjdGl2aXR5KTogbnVtYmVyIHtcbiAgICBjb25zdCByYXRlcyA9IHtcbiAgICAgIGxlc3Nvbl9jb21wbGV0ZTogMTAsXG4gICAgICBxdWl6X3Bhc3NlZDogMjUsXG4gICAgICBwcm9qZWN0X3N1Ym1pdHRlZDogNTAsXG4gICAgICBhc3Nlc3NtZW50X3Bhc3NlZDogMTAwLFxuICAgICAgaGVscF9wZWVyOiAxNSxcbiAgICB9O1xuICAgIHJldHVybiByYXRlc1thY3Rpdml0eS50eXBlXSB8fCAwO1xuICB9XG5cbiAgZ2V0U3R1ZGVudFByb2dyZXNzKHN0dWRlbnRJZDogc3RyaW5nLCBhY3Rpdml0aWVzOiBQcm9ncmVzc1tdKTogU3R1ZGVudFByb2dyZXNzU3VtbWFyeSB7XG4gICAgY29uc3Qgc3R1ZGVudEFjdGl2aXRpZXMgPSBhY3Rpdml0aWVzLmZpbHRlcihhID0+IGEuc3R1ZGVudElkID09PSBzdHVkZW50SWQpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsQWN0aXZpdGllczogc3R1ZGVudEFjdGl2aXRpZXMubGVuZ3RoLFxuICAgICAgdG90YWxBWlI6IHN0dWRlbnRBY3Rpdml0aWVzLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyBhLmF6ckVhcm5lZCwgMCksXG4gICAgICBjb21wbGV0aW9uUmF0ZTogdGhpcy5jYWxjdWxhdGVDb21wbGV0aW9uUmF0ZShzdHVkZW50QWN0aXZpdGllcyksXG4gICAgICBzdHJlYWs6IHRoaXMuY2FsY3VsYXRlU3RyZWFrKHN0dWRlbnRBY3Rpdml0aWVzKSxcbiAgICAgIGxldmVsOiB0aGlzLmRldGVybWluZUxldmVsKHN0dWRlbnRBY3Rpdml0aWVzKSxcbiAgICB9O1xuICB9XG5cbiAgY2FsY3VsYXRlQ29tcGxldGlvblJhdGUoYWN0aXZpdGllczogUHJvZ3Jlc3NbXSk6IG51bWJlciB7XG4gICAgaWYgKGFjdGl2aXRpZXMubGVuZ3RoID09PSAwKSB7cmV0dXJuIDA7fVxuICAgIGNvbnN0IGNvbXBsZXRlZCA9IGFjdGl2aXRpZXMuZmlsdGVyKGEgPT4gYS5kYXRhLmNvbXBsZXRlZCkubGVuZ3RoO1xuICAgIHJldHVybiAoY29tcGxldGVkIC8gYWN0aXZpdGllcy5sZW5ndGgpICogMTAwO1xuICB9XG5cbiAgY2FsY3VsYXRlU3RyZWFrKGFjdGl2aXRpZXM6IFByb2dyZXNzW10pOiBudW1iZXIge1xuICAgIGNvbnN0IHNvcnRlZCA9IFsuLi5hY3Rpdml0aWVzXS5zb3J0KChhLCBiKSA9PiBiLnRpbWVzdGFtcC5nZXRUaW1lKCkgLSBhLnRpbWVzdGFtcC5nZXRUaW1lKCkpO1xuICAgIGxldCBzdHJlYWsgPSAwO1xuICAgIGxldCBsYXN0RGF0ZSA9IG5ldyBEYXRlKCk7XG5cbiAgICBmb3IgKGNvbnN0IGFjdGl2aXR5IG9mIHNvcnRlZCkge1xuICAgICAgY29uc3QgZGF5c0RpZmYgPSBNYXRoLmZsb29yKChsYXN0RGF0ZS5nZXRUaW1lKCkgLSBhY3Rpdml0eS50aW1lc3RhbXAuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG4gICAgICBpZiAoZGF5c0RpZmYgPD0gMSkge1xuICAgICAgICBzdHJlYWsrKztcbiAgICAgICAgbGFzdERhdGUgPSBhY3Rpdml0eS50aW1lc3RhbXA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3RyZWFrO1xuICB9XG5cbiAgZGV0ZXJtaW5lTGV2ZWwoYWN0aXZpdGllczogUHJvZ3Jlc3NbXSk6ICdiZWdpbm5lcicgfCAnaW50ZXJtZWRpYXRlJyB8ICdhZHZhbmNlZCcgfCAnZXhwZXJ0JyB7XG4gICAgY29uc3QgdG90YWxBWlIgPSBhY3Rpdml0aWVzLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyBhLmF6ckVhcm5lZCwgMCk7XG4gICAgaWYgKHRvdGFsQVpSID49IDEwMDAwKSB7cmV0dXJuICdleHBlcnQnO31cbiAgICBpZiAodG90YWxBWlIgPj0gNTAwMCkge3JldHVybiAnYWR2YW5jZWQnO31cbiAgICBpZiAodG90YWxBWlIgPj0gMTAwMCkge3JldHVybiAnaW50ZXJtZWRpYXRlJzt9XG4gICAgcmV0dXJuICdiZWdpbm5lcic7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IFByb2dyZXNzVHJhY2tlcigpO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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