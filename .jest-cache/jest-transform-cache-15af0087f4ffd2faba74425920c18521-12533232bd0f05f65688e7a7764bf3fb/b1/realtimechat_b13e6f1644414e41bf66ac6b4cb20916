5a365515a79b7d7730ff2432defb057c
/* istanbul ignore next */
function cov_ja22fz2f4() {
  var path = "/workspaces/azora/services/azora-sapiens/src/engines/real-time-chat.ts";
  var hash = "e56f5e1b96353da327e0f1273fb5c500e8818946";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/azora-sapiens/src/engines/real-time-chat.ts",
    statementMap: {
      "0": {
        start: {
          line: 26,
          column: 47
        },
        end: {
          line: 26,
          column: 56
        }
      },
      "1": {
        start: {
          line: 29,
          column: 4
        },
        end: {
          line: 29,
          column: 69
        }
      },
      "2": {
        start: {
          line: 33,
          column: 22
        },
        end: {
          line: 33,
          column: 55
        }
      },
      "3": {
        start: {
          line: 35,
          column: 4
        },
        end: {
          line: 46,
          column: 7
        }
      },
      "4": {
        start: {
          line: 48,
          column: 4
        },
        end: {
          line: 48,
          column: 21
        }
      },
      "5": {
        start: {
          line: 52,
          column: 20
        },
        end: {
          line: 52,
          column: 48
        }
      },
      "6": {
        start: {
          line: 53,
          column: 4
        },
        end: {
          line: 55,
          column: 5
        }
      },
      "7": {
        start: {
          line: 54,
          column: 6
        },
        end: {
          line: 54,
          column: 53
        }
      },
      "8": {
        start: {
          line: 57,
          column: 4
        },
        end: {
          line: 61,
          column: 7
        }
      },
      "9": {
        start: {
          line: 63,
          column: 75
        },
        end: {
          line: 66,
          column: 7
        }
      },
      "10": {
        start: {
          line: 63,
          column: 102
        },
        end: {
          line: 66,
          column: 5
        }
      },
      "11": {
        start: {
          line: 68,
          column: 21
        },
        end: {
          line: 73,
          column: 6
        }
      },
      "12": {
        start: {
          line: 75,
          column: 29
        },
        end: {
          line: 75,
          column: 115
        }
      },
      "13": {
        start: {
          line: 77,
          column: 4
        },
        end: {
          line: 81,
          column: 7
        }
      },
      "14": {
        start: {
          line: 83,
          column: 4
        },
        end: {
          line: 87,
          column: 6
        }
      },
      "15": {
        start: {
          line: 91,
          column: 20
        },
        end: {
          line: 91,
          column: 48
        }
      },
      "16": {
        start: {
          line: 92,
          column: 4
        },
        end: {
          line: 92,
          column: 76
        }
      },
      "17": {
        start: {
          line: 92,
          column: 50
        },
        end: {
          line: 92,
          column: 69
        }
      },
      "18": {
        start: {
          line: 96,
          column: 20
        },
        end: {
          line: 96,
          column: 48
        }
      },
      "19": {
        start: {
          line: 97,
          column: 4
        },
        end: {
          line: 99,
          column: 5
        }
      },
      "20": {
        start: {
          line: 98,
          column: 6
        },
        end: {
          line: 98,
          column: 29
        }
      },
      "21": {
        start: {
          line: 103,
          column: 24
        },
        end: {
          line: 108,
          column: 5
        }
      },
      "22": {
        start: {
          line: 109,
          column: 4
        },
        end: {
          line: 109,
          column: 35
        }
      },
      "23": {
        start: {
          line: 113,
          column: 4
        },
        end: {
          line: 117,
          column: 6
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 28,
            column: 2
          },
          end: {
            line: 28,
            column: 3
          }
        },
        loc: {
          start: {
            line: 28,
            column: 16
          },
          end: {
            line: 30,
            column: 3
          }
        },
        line: 28
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 32,
            column: 2
          },
          end: {
            line: 32,
            column: 3
          }
        },
        loc: {
          start: {
            line: 32,
            column: 74
          },
          end: {
            line: 49,
            column: 3
          }
        },
        line: 32
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 51,
            column: 2
          },
          end: {
            line: 51,
            column: 3
          }
        },
        loc: {
          start: {
            line: 51,
            column: 83
          },
          end: {
            line: 88,
            column: 3
          }
        },
        line: 51
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 63,
            column: 96
          },
          end: {
            line: 63,
            column: 97
          }
        },
        loc: {
          start: {
            line: 63,
            column: 102
          },
          end: {
            line: 66,
            column: 5
          }
        },
        line: 63
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 90,
            column: 2
          },
          end: {
            line: 90,
            column: 3
          }
        },
        loc: {
          start: {
            line: 90,
            column: 54
          },
          end: {
            line: 93,
            column: 3
          }
        },
        line: 90
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 92,
            column: 45
          },
          end: {
            line: 92,
            column: 46
          }
        },
        loc: {
          start: {
            line: 92,
            column: 50
          },
          end: {
            line: 92,
            column: 69
          }
        },
        line: 92
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 95,
            column: 2
          },
          end: {
            line: 95,
            column: 3
          }
        },
        loc: {
          start: {
            line: 95,
            column: 38
          },
          end: {
            line: 100,
            column: 3
          }
        },
        line: 95
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 102,
            column: 2
          },
          end: {
            line: 102,
            column: 3
          }
        },
        loc: {
          start: {
            line: 102,
            column: 74
          },
          end: {
            line: 110,
            column: 3
          }
        },
        line: 102
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 112,
            column: 2
          },
          end: {
            line: 112,
            column: 3
          }
        },
        loc: {
          start: {
            line: 112,
            column: 56
          },
          end: {
            line: 118,
            column: 3
          }
        },
        line: 112
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 53,
            column: 4
          },
          end: {
            line: 55,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 53,
            column: 4
          },
          end: {
            line: 55,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 53
      },
      "1": {
        loc: {
          start: {
            line: 53,
            column: 8
          },
          end: {
            line: 53,
            column: 35
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 53,
            column: 8
          },
          end: {
            line: 53,
            column: 16
          }
        }, {
          start: {
            line: 53,
            column: 20
          },
          end: {
            line: 53,
            column: 35
          }
        }],
        line: 53
      },
      "2": {
        loc: {
          start: {
            line: 75,
            column: 29
          },
          end: {
            line: 75,
            column: 115
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 75,
            column: 29
          },
          end: {
            line: 75,
            column: 64
          }
        }, {
          start: {
            line: 75,
            column: 68
          },
          end: {
            line: 75,
            column: 115
          }
        }],
        line: 75
      },
      "3": {
        loc: {
          start: {
            line: 92,
            column: 11
          },
          end: {
            line: 92,
            column: 75
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 92,
            column: 21
          },
          end: {
            line: 92,
            column: 70
          }
        }, {
          start: {
            line: 92,
            column: 73
          },
          end: {
            line: 92,
            column: 75
          }
        }],
        line: 92
      },
      "4": {
        loc: {
          start: {
            line: 97,
            column: 4
          },
          end: {
            line: 99,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 97,
            column: 4
          },
          end: {
            line: 99,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 97
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "e56f5e1b96353da327e0f1273fb5c500e8818946"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_ja22fz2f4 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_ja22fz2f4();
import OpenAI from 'openai';
class RealTimeChatEngine {
  sessions =
  /* istanbul ignore next */
  (cov_ja22fz2f4().s[0]++, new Map());
  constructor() {
    /* istanbul ignore next */
    cov_ja22fz2f4().f[0]++;
    cov_ja22fz2f4().s[1]++;
    this.openai = new OpenAI({
      apiKey: process.env.OPENAI_API_KEY
    });
  }
  async startSession(studentId, subject) {
    /* istanbul ignore next */
    cov_ja22fz2f4().f[1]++;
    const sessionId =
    /* istanbul ignore next */
    (cov_ja22fz2f4().s[2]++, `chat_${studentId}_${Date.now()}`);
    /* istanbul ignore next */
    cov_ja22fz2f4().s[3]++;
    this.sessions.set(sessionId, {
      sessionId,
      studentId,
      subject,
      messages: [{
        role: 'system',
        content: `You are Elara, an AI tutor specializing in ${subject}. Use Ubuntu philosophy: "I am because we are". Be encouraging, patient, and adaptive.`,
        timestamp: new Date()
      }],
      startTime: new Date(),
      active: true
    });
    /* istanbul ignore next */
    cov_ja22fz2f4().s[4]++;
    return sessionId;
  }
  async sendMessage(sessionId, userMessage) {
    /* istanbul ignore next */
    cov_ja22fz2f4().f[2]++;
    const session =
    /* istanbul ignore next */
    (cov_ja22fz2f4().s[5]++, this.sessions.get(sessionId));
    /* istanbul ignore next */
    cov_ja22fz2f4().s[6]++;
    if (
    /* istanbul ignore next */
    (cov_ja22fz2f4().b[1][0]++, !session) ||
    /* istanbul ignore next */
    (cov_ja22fz2f4().b[1][1]++, !session.active)) {
      /* istanbul ignore next */
      cov_ja22fz2f4().b[0][0]++;
      cov_ja22fz2f4().s[7]++;
      throw new Error('Invalid or inactive session');
    } else
    /* istanbul ignore next */
    {
      cov_ja22fz2f4().b[0][1]++;
    }
    cov_ja22fz2f4().s[8]++;
    session.messages.push({
      role: 'user',
      content: userMessage,
      timestamp: new Date()
    });
    const messages =
    /* istanbul ignore next */
    (cov_ja22fz2f4().s[9]++, session.messages.map(m => {
      /* istanbul ignore next */
      cov_ja22fz2f4().f[3]++;
      cov_ja22fz2f4().s[10]++;
      return {
        role: m.role,
        content: m.content
      };
    }));
    const response =
    /* istanbul ignore next */
    (cov_ja22fz2f4().s[11]++, await this.openai.chat.completions.create({
      model: 'gpt-4',
      messages,
      temperature: 0.7,
      max_tokens: 500
    }));
    const assistantMessage =
    /* istanbul ignore next */
    (cov_ja22fz2f4().s[12]++,
    /* istanbul ignore next */
    (cov_ja22fz2f4().b[2][0]++, response.choices[0].message.content) ||
    /* istanbul ignore next */
    (cov_ja22fz2f4().b[2][1]++, 'I apologize, I could not generate a response.'));
    /* istanbul ignore next */
    cov_ja22fz2f4().s[13]++;
    session.messages.push({
      role: 'assistant',
      content: assistantMessage,
      timestamp: new Date()
    });
    /* istanbul ignore next */
    cov_ja22fz2f4().s[14]++;
    return {
      message: assistantMessage,
      suggestions: this.generateSuggestions(userMessage, session.subject),
      resources: this.recommendResources(session.subject)
    };
  }
  getSessionHistory(sessionId) {
    /* istanbul ignore next */
    cov_ja22fz2f4().f[4]++;
    const session =
    /* istanbul ignore next */
    (cov_ja22fz2f4().s[15]++, this.sessions.get(sessionId));
    /* istanbul ignore next */
    cov_ja22fz2f4().s[16]++;
    return session ?
    /* istanbul ignore next */
    (cov_ja22fz2f4().b[3][0]++, session.messages.filter(m => {
      /* istanbul ignore next */
      cov_ja22fz2f4().f[5]++;
      cov_ja22fz2f4().s[17]++;
      return m.role !== 'system';
    })) :
    /* istanbul ignore next */
    (cov_ja22fz2f4().b[3][1]++, []);
  }
  endSession(sessionId) {
    /* istanbul ignore next */
    cov_ja22fz2f4().f[6]++;
    const session =
    /* istanbul ignore next */
    (cov_ja22fz2f4().s[18]++, this.sessions.get(sessionId));
    /* istanbul ignore next */
    cov_ja22fz2f4().s[19]++;
    if (session) {
      /* istanbul ignore next */
      cov_ja22fz2f4().b[4][0]++;
      cov_ja22fz2f4().s[20]++;
      session.active = false;
    } else
    /* istanbul ignore next */
    {
      cov_ja22fz2f4().b[4][1]++;
    }
  }
  generateSuggestions(message, subject) {
    /* istanbul ignore next */
    cov_ja22fz2f4().f[7]++;
    const suggestions =
    /* istanbul ignore next */
    (cov_ja22fz2f4().s[21]++, [`Can you explain more about ${subject}?`, 'Can you give me an example?', 'What are the key concepts I should focus on?', 'How can I practice this?']);
    /* istanbul ignore next */
    cov_ja22fz2f4().s[22]++;
    return suggestions.slice(0, 3);
  }
  recommendResources(subject) {
    /* istanbul ignore next */
    cov_ja22fz2f4().f[8]++;
    cov_ja22fz2f4().s[23]++;
    return [`${subject} fundamentals course`, `Interactive ${subject} exercises`, `${subject} practice problems`];
  }
}
export default new RealTimeChatEngine();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfamEyMmZ6MmY0IiwiYWN0dWFsQ292ZXJhZ2UiLCJPcGVuQUkiLCJSZWFsVGltZUNoYXRFbmdpbmUiLCJzZXNzaW9ucyIsInMiLCJNYXAiLCJjb25zdHJ1Y3RvciIsImYiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJzdGFydFNlc3Npb24iLCJzdHVkZW50SWQiLCJzdWJqZWN0Iiwic2Vzc2lvbklkIiwiRGF0ZSIsIm5vdyIsInNldCIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJ0aW1lc3RhbXAiLCJzdGFydFRpbWUiLCJhY3RpdmUiLCJzZW5kTWVzc2FnZSIsInVzZXJNZXNzYWdlIiwic2Vzc2lvbiIsImdldCIsImIiLCJFcnJvciIsInB1c2giLCJtYXAiLCJtIiwicmVzcG9uc2UiLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsImFzc2lzdGFudE1lc3NhZ2UiLCJjaG9pY2VzIiwibWVzc2FnZSIsInN1Z2dlc3Rpb25zIiwiZ2VuZXJhdGVTdWdnZXN0aW9ucyIsInJlc291cmNlcyIsInJlY29tbWVuZFJlc291cmNlcyIsImdldFNlc3Npb25IaXN0b3J5IiwiZmlsdGVyIiwiZW5kU2Vzc2lvbiIsInNsaWNlIl0sInNvdXJjZXMiOlsicmVhbC10aW1lLWNoYXQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9wZW5BSSBmcm9tICdvcGVuYWknO1xuXG5pbnRlcmZhY2UgQ2hhdE1lc3NhZ2Uge1xuICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogRGF0ZTtcbn1cblxuaW50ZXJmYWNlIENoYXRTZXNzaW9uIHtcbiAgc2Vzc2lvbklkOiBzdHJpbmc7XG4gIHN0dWRlbnRJZDogc3RyaW5nO1xuICBzdWJqZWN0OiBzdHJpbmc7XG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xuICBzdGFydFRpbWU6IERhdGU7XG4gIGFjdGl2ZTogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIENoYXRSZXNwb25zZSB7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdO1xuICByZXNvdXJjZXM6IHN0cmluZ1tdO1xufVxuXG5jbGFzcyBSZWFsVGltZUNoYXRFbmdpbmUge1xuICBwcml2YXRlIG9wZW5haTogT3BlbkFJO1xuICBwcml2YXRlIHNlc3Npb25zOiBNYXA8c3RyaW5nLCBDaGF0U2Vzc2lvbj4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5vcGVuYWkgPSBuZXcgT3BlbkFJKHsgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB9KTtcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0U2Vzc2lvbihzdHVkZW50SWQ6IHN0cmluZywgc3ViamVjdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBzZXNzaW9uSWQgPSBgY2hhdF8ke3N0dWRlbnRJZH1fJHtEYXRlLm5vdygpfWA7XG4gICAgXG4gICAgdGhpcy5zZXNzaW9ucy5zZXQoc2Vzc2lvbklkLCB7XG4gICAgICBzZXNzaW9uSWQsXG4gICAgICBzdHVkZW50SWQsXG4gICAgICBzdWJqZWN0LFxuICAgICAgbWVzc2FnZXM6IFt7XG4gICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICBjb250ZW50OiBgWW91IGFyZSBFbGFyYSwgYW4gQUkgdHV0b3Igc3BlY2lhbGl6aW5nIGluICR7c3ViamVjdH0uIFVzZSBVYnVudHUgcGhpbG9zb3BoeTogXCJJIGFtIGJlY2F1c2Ugd2UgYXJlXCIuIEJlIGVuY291cmFnaW5nLCBwYXRpZW50LCBhbmQgYWRhcHRpdmUuYCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgfV0sXG4gICAgICBzdGFydFRpbWU6IG5ldyBEYXRlKCksXG4gICAgICBhY3RpdmU6IHRydWUsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2Vzc2lvbklkO1xuICB9XG5cbiAgYXN5bmMgc2VuZE1lc3NhZ2Uoc2Vzc2lvbklkOiBzdHJpbmcsIHVzZXJNZXNzYWdlOiBzdHJpbmcpOiBQcm9taXNlPENoYXRSZXNwb25zZT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSB0aGlzLnNlc3Npb25zLmdldChzZXNzaW9uSWQpO1xuICAgIGlmICghc2Vzc2lvbiB8fCAhc2Vzc2lvbi5hY3RpdmUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBvciBpbmFjdGl2ZSBzZXNzaW9uJyk7XG4gICAgfVxuXG4gICAgc2Vzc2lvbi5tZXNzYWdlcy5wdXNoKHtcbiAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgIGNvbnRlbnQ6IHVzZXJNZXNzYWdlLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIH0pO1xuXG4gICAgY29uc3QgbWVzc2FnZXM6IE9wZW5BSS5DaGF0LkNvbXBsZXRpb25zLkNoYXRDb21wbGV0aW9uTWVzc2FnZVBhcmFtW10gPSBzZXNzaW9uLm1lc3NhZ2VzLm1hcChtID0+ICh7XG4gICAgICByb2xlOiBtLnJvbGUsXG4gICAgICBjb250ZW50OiBtLmNvbnRlbnQsXG4gICAgfSkpO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLm9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogJ2dwdC00JyxcbiAgICAgIG1lc3NhZ2VzLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgIG1heF90b2tlbnM6IDUwMCxcbiAgICB9KTtcblxuICAgIGNvbnN0IGFzc2lzdGFudE1lc3NhZ2UgPSByZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCB8fCAnSSBhcG9sb2dpemUsIEkgY291bGQgbm90IGdlbmVyYXRlIGEgcmVzcG9uc2UuJztcblxuICAgIHNlc3Npb24ubWVzc2FnZXMucHVzaCh7XG4gICAgICByb2xlOiAnYXNzaXN0YW50JyxcbiAgICAgIGNvbnRlbnQ6IGFzc2lzdGFudE1lc3NhZ2UsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgbWVzc2FnZTogYXNzaXN0YW50TWVzc2FnZSxcbiAgICAgIHN1Z2dlc3Rpb25zOiB0aGlzLmdlbmVyYXRlU3VnZ2VzdGlvbnModXNlck1lc3NhZ2UsIHNlc3Npb24uc3ViamVjdCksXG4gICAgICByZXNvdXJjZXM6IHRoaXMucmVjb21tZW5kUmVzb3VyY2VzKHNlc3Npb24uc3ViamVjdCksXG4gICAgfTtcbiAgfVxuXG4gIGdldFNlc3Npb25IaXN0b3J5KHNlc3Npb25JZDogc3RyaW5nKTogQ2hhdE1lc3NhZ2VbXSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuc2Vzc2lvbnMuZ2V0KHNlc3Npb25JZCk7XG4gICAgcmV0dXJuIHNlc3Npb24gPyBzZXNzaW9uLm1lc3NhZ2VzLmZpbHRlcihtID0+IG0ucm9sZSAhPT0gJ3N5c3RlbScpIDogW107XG4gIH1cblxuICBlbmRTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuc2Vzc2lvbnMuZ2V0KHNlc3Npb25JZCk7XG4gICAgaWYgKHNlc3Npb24pIHtcbiAgICAgIHNlc3Npb24uYWN0aXZlID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVN1Z2dlc3Rpb25zKG1lc3NhZ2U6IHN0cmluZywgc3ViamVjdDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gW1xuICAgICAgYENhbiB5b3UgZXhwbGFpbiBtb3JlIGFib3V0ICR7c3ViamVjdH0/YCxcbiAgICAgICdDYW4geW91IGdpdmUgbWUgYW4gZXhhbXBsZT8nLFxuICAgICAgJ1doYXQgYXJlIHRoZSBrZXkgY29uY2VwdHMgSSBzaG91bGQgZm9jdXMgb24/JyxcbiAgICAgICdIb3cgY2FuIEkgcHJhY3RpY2UgdGhpcz8nLFxuICAgIF07XG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDMpO1xuICB9XG5cbiAgcHJpdmF0ZSByZWNvbW1lbmRSZXNvdXJjZXMoc3ViamVjdDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBbXG4gICAgICBgJHtzdWJqZWN0fSBmdW5kYW1lbnRhbHMgY291cnNlYCxcbiAgICAgIGBJbnRlcmFjdGl2ZSAke3N1YmplY3R9IGV4ZXJjaXNlc2AsXG4gICAgICBgJHtzdWJqZWN0fSBwcmFjdGljZSBwcm9ibGVtc2AsXG4gICAgXTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgUmVhbFRpbWVDaGF0RW5naW5lKCk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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