{"version":3,"names":["cov_ja22fz2f4","actualCoverage","OpenAI","RealTimeChatEngine","sessions","s","Map","constructor","f","openai","apiKey","process","env","OPENAI_API_KEY","startSession","studentId","subject","sessionId","Date","now","set","messages","role","content","timestamp","startTime","active","sendMessage","userMessage","session","get","b","Error","push","map","m","response","chat","completions","create","model","temperature","max_tokens","assistantMessage","choices","message","suggestions","generateSuggestions","resources","recommendResources","getSessionHistory","filter","endSession","slice"],"sources":["real-time-chat.ts"],"sourcesContent":["import OpenAI from 'openai';\n\ninterface ChatMessage {\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  timestamp: Date;\n}\n\ninterface ChatSession {\n  sessionId: string;\n  studentId: string;\n  subject: string;\n  messages: ChatMessage[];\n  startTime: Date;\n  active: boolean;\n}\n\ninterface ChatResponse {\n  message: string;\n  suggestions: string[];\n  resources: string[];\n}\n\nclass RealTimeChatEngine {\n  private openai: OpenAI;\n  private sessions: Map<string, ChatSession> = new Map();\n\n  constructor() {\n    this.openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\n  }\n\n  async startSession(studentId: string, subject: string): Promise<string> {\n    const sessionId = `chat_${studentId}_${Date.now()}`;\n    \n    this.sessions.set(sessionId, {\n      sessionId,\n      studentId,\n      subject,\n      messages: [{\n        role: 'system',\n        content: `You are Elara, an AI tutor specializing in ${subject}. Use Ubuntu philosophy: \"I am because we are\". Be encouraging, patient, and adaptive.`,\n        timestamp: new Date(),\n      }],\n      startTime: new Date(),\n      active: true,\n    });\n\n    return sessionId;\n  }\n\n  async sendMessage(sessionId: string, userMessage: string): Promise<ChatResponse> {\n    const session = this.sessions.get(sessionId);\n    if (!session || !session.active) {\n      throw new Error('Invalid or inactive session');\n    }\n\n    session.messages.push({\n      role: 'user',\n      content: userMessage,\n      timestamp: new Date(),\n    });\n\n    const messages: OpenAI.Chat.Completions.ChatCompletionMessageParam[] = session.messages.map(m => ({\n      role: m.role,\n      content: m.content,\n    }));\n\n    const response = await this.openai.chat.completions.create({\n      model: 'gpt-4',\n      messages,\n      temperature: 0.7,\n      max_tokens: 500,\n    });\n\n    const assistantMessage = response.choices[0].message.content || 'I apologize, I could not generate a response.';\n\n    session.messages.push({\n      role: 'assistant',\n      content: assistantMessage,\n      timestamp: new Date(),\n    });\n\n    return {\n      message: assistantMessage,\n      suggestions: this.generateSuggestions(userMessage, session.subject),\n      resources: this.recommendResources(session.subject),\n    };\n  }\n\n  getSessionHistory(sessionId: string): ChatMessage[] {\n    const session = this.sessions.get(sessionId);\n    return session ? session.messages.filter(m => m.role !== 'system') : [];\n  }\n\n  endSession(sessionId: string): void {\n    const session = this.sessions.get(sessionId);\n    if (session) {\n      session.active = false;\n    }\n  }\n\n  private generateSuggestions(message: string, subject: string): string[] {\n    const suggestions = [\n      `Can you explain more about ${subject}?`,\n      'Can you give me an example?',\n      'What are the key concepts I should focus on?',\n      'How can I practice this?',\n    ];\n    return suggestions.slice(0, 3);\n  }\n\n  private recommendResources(subject: string): string[] {\n    return [\n      `${subject} fundamentals course`,\n      `Interactive ${subject} exercises`,\n      `${subject} practice problems`,\n    ];\n  }\n}\n\nexport default new RealTimeChatEngine();\n"],"mappings":"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","ignoreList":[]}