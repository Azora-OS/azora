bf139ea9907ea762a4f8c57a000d49bd
/* istanbul ignore next */
function cov_4jbwq9383() {
  var path = "/workspaces/azora/services/azora-cloud/azora-mint/stakingService.ts";
  var hash = "d317dbd1d6ca42741ee6e40a45ed76550b947e91";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/azora-cloud/azora-mint/stakingService.ts",
    statementMap: {
      "0": {
        start: {
          line: 10,
          column: 15
        },
        end: {
          line: 10,
          column: 33
        }
      },
      "1": {
        start: {
          line: 12,
          column: 31
        },
        end: {
          line: 12,
          column: 66
        }
      },
      "2": {
        start: {
          line: 16,
          column: 19
        },
        end: {
          line: 16,
          column: 72
        }
      },
      "3": {
        start: {
          line: 17,
          column: 4
        },
        end: {
          line: 17,
          column: 55
        }
      },
      "4": {
        start: {
          line: 17,
          column: 18
        },
        end: {
          line: 17,
          column: 54
        }
      },
      "5": {
        start: {
          line: 18,
          column: 4
        },
        end: {
          line: 18,
          column: 79
        }
      },
      "6": {
        start: {
          line: 18,
          column: 34
        },
        end: {
          line: 18,
          column: 78
        }
      },
      "7": {
        start: {
          line: 19,
          column: 16
        },
        end: {
          line: 19,
          column: 50
        }
      },
      "8": {
        start: {
          line: 21,
          column: 4
        },
        end: {
          line: 40,
          column: 7
        }
      },
      "9": {
        start: {
          line: 44,
          column: 18
        },
        end: {
          line: 44,
          column: 112
        }
      },
      "10": {
        start: {
          line: 45,
          column: 4
        },
        end: {
          line: 45,
          column: 117
        }
      },
      "11": {
        start: {
          line: 45,
          column: 51
        },
        end: {
          line: 45,
          column: 116
        }
      },
      "12": {
        start: {
          line: 46,
          column: 4
        },
        end: {
          line: 46,
          column: 79
        }
      },
      "13": {
        start: {
          line: 46,
          column: 33
        },
        end: {
          line: 46,
          column: 78
        }
      },
      "14": {
        start: {
          line: 47,
          column: 24
        },
        end: {
          line: 47,
          column: 100
        }
      },
      "15": {
        start: {
          line: 48,
          column: 4
        },
        end: {
          line: 48,
          column: 121
        }
      },
      "16": {
        start: {
          line: 48,
          column: 35
        },
        end: {
          line: 48,
          column: 120
        }
      },
      "17": {
        start: {
          line: 50,
          column: 4
        },
        end: {
          line: 64,
          column: 7
        }
      },
      "18": {
        start: {
          line: 68,
          column: 30
        },
        end: {
          line: 68,
          column: 103
        }
      },
      "19": {
        start: {
          line: 69,
          column: 22
        },
        end: {
          line: 69,
          column: 53
        }
      },
      "20": {
        start: {
          line: 70,
          column: 4
        },
        end: {
          line: 70,
          column: 33
        }
      },
      "21": {
        start: {
          line: 70,
          column: 25
        },
        end: {
          line: 70,
          column: 32
        }
      },
      "22": {
        start: {
          line: 71,
          column: 30
        },
        end: {
          line: 71,
          column: 113
        }
      },
      "23": {
        start: {
          line: 72,
          column: 24
        },
        end: {
          line: 72,
          column: 58
        }
      },
      "24": {
        start: {
          line: 73,
          column: 4
        },
        end: {
          line: 73,
          column: 36
        }
      },
      "25": {
        start: {
          line: 73,
          column: 28
        },
        end: {
          line: 73,
          column: 35
        }
      },
      "26": {
        start: {
          line: 74,
          column: 23
        },
        end: {
          line: 74,
          column: 46
        }
      },
      "27": {
        start: {
          line: 75,
          column: 22
        },
        end: {
          line: 75,
          column: 80
        }
      },
      "28": {
        start: {
          line: 76,
          column: 38
        },
        end: {
          line: 76,
          column: 40
        }
      },
      "29": {
        start: {
          line: 77,
          column: 4
        },
        end: {
          line: 90,
          column: 5
        }
      },
      "30": {
        start: {
          line: 78,
          column: 27
        },
        end: {
          line: 78,
          column: 52
        }
      },
      "31": {
        start: {
          line: 79,
          column: 6
        },
        end: {
          line: 89,
          column: 8
        }
      },
      "32": {
        start: {
          line: 91,
          column: 4
        },
        end: {
          line: 91,
          column: 115
        }
      },
      "33": {
        start: {
          line: 92,
          column: 4
        },
        end: {
          line: 92,
          column: 50
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 15,
            column: 2
          },
          end: {
            line: 15,
            column: 3
          }
        },
        loc: {
          start: {
            line: 15,
            column: 70
          },
          end: {
            line: 41,
            column: 3
          }
        },
        line: 15
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 43,
            column: 2
          },
          end: {
            line: 43,
            column: 3
          }
        },
        loc: {
          start: {
            line: 43,
            column: 57
          },
          end: {
            line: 65,
            column: 3
          }
        },
        line: 43
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 67,
            column: 2
          },
          end: {
            line: 67,
            column: 3
          }
        },
        loc: {
          start: {
            line: 67,
            column: 35
          },
          end: {
            line: 93,
            column: 3
          }
        },
        line: 67
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 17,
            column: 4
          },
          end: {
            line: 17,
            column: 55
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 17,
            column: 4
          },
          end: {
            line: 17,
            column: 55
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 17
      },
      "1": {
        loc: {
          start: {
            line: 18,
            column: 4
          },
          end: {
            line: 18,
            column: 79
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 18,
            column: 4
          },
          end: {
            line: 18,
            column: 79
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 18
      },
      "2": {
        loc: {
          start: {
            line: 19,
            column: 16
          },
          end: {
            line: 19,
            column: 50
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 19,
            column: 39
          },
          end: {
            line: 19,
            column: 43
          }
        }, {
          start: {
            line: 19,
            column: 46
          },
          end: {
            line: 19,
            column: 50
          }
        }],
        line: 19
      },
      "3": {
        loc: {
          start: {
            line: 45,
            column: 4
          },
          end: {
            line: 45,
            column: 117
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 45,
            column: 4
          },
          end: {
            line: 45,
            column: 117
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 45
      },
      "4": {
        loc: {
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 45,
            column: 48
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 45,
            column: 14
          }
        }, {
          start: {
            line: 45,
            column: 18
          },
          end: {
            line: 45,
            column: 48
          }
        }],
        line: 45
      },
      "5": {
        loc: {
          start: {
            line: 46,
            column: 4
          },
          end: {
            line: 46,
            column: 79
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 46,
            column: 4
          },
          end: {
            line: 46,
            column: 79
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 46
      },
      "6": {
        loc: {
          start: {
            line: 48,
            column: 4
          },
          end: {
            line: 48,
            column: 121
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 48,
            column: 4
          },
          end: {
            line: 48,
            column: 121
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 48
      },
      "7": {
        loc: {
          start: {
            line: 69,
            column: 22
          },
          end: {
            line: 69,
            column: 53
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 69,
            column: 22
          },
          end: {
            line: 69,
            column: 48
          }
        }, {
          start: {
            line: 69,
            column: 52
          },
          end: {
            line: 69,
            column: 53
          }
        }],
        line: 69
      },
      "8": {
        loc: {
          start: {
            line: 70,
            column: 4
          },
          end: {
            line: 70,
            column: 33
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 70,
            column: 4
          },
          end: {
            line: 70,
            column: 33
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 70
      },
      "9": {
        loc: {
          start: {
            line: 72,
            column: 24
          },
          end: {
            line: 72,
            column: 58
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 72,
            column: 24
          },
          end: {
            line: 72,
            column: 53
          }
        }, {
          start: {
            line: 72,
            column: 57
          },
          end: {
            line: 72,
            column: 58
          }
        }],
        line: 72
      },
      "10": {
        loc: {
          start: {
            line: 73,
            column: 4
          },
          end: {
            line: 73,
            column: 36
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 73,
            column: 4
          },
          end: {
            line: 73,
            column: 36
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 73
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "d317dbd1d6ca42741ee6e40a45ed76550b947e91"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_4jbwq9383 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_4jbwq9383();
/*
AZORA PROPRIETARY LICENSE

Copyright Â© 2025 Azora ES (Pty) Ltd. All Rights Reserved.

See LICENSE file for details.
*/

import { PrismaClient } from '@prisma/client';
const prisma =
/* istanbul ignore next */
(cov_4jbwq9383().s[0]++, new PrismaClient());
const STAKING_POOL_WALLET_ID =
/* istanbul ignore next */
(cov_4jbwq9383().s[1]++, process.env.STAKING_POOL_WALLET_ID);
class StakingService {
  async stake(userId, amount, lockPeriodDays) {
    /* istanbul ignore next */
    cov_4jbwq9383().f[0]++;
    const wallet =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[2]++, await prisma.wallet.findUnique({
      where: {
        userId
      }
    }));
    /* istanbul ignore next */
    cov_4jbwq9383().s[3]++;
    if (!wallet) {
      /* istanbul ignore next */
      cov_4jbwq9383().b[0][0]++;
      cov_4jbwq9383().s[4]++;
      throw new Error('Wallet not found');
    } else
    /* istanbul ignore next */
    {
      cov_4jbwq9383().b[0][1]++;
    }
    cov_4jbwq9383().s[5]++;
    if (wallet.balance < amount) {
      /* istanbul ignore next */
      cov_4jbwq9383().b[1][0]++;
      cov_4jbwq9383().s[6]++;
      throw new Error('Insufficient AZR balance');
    } else
    /* istanbul ignore next */
    {
      cov_4jbwq9383().b[1][1]++;
    }
    const apy =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[7]++, lockPeriodDays > 180 ?
    /* istanbul ignore next */
    (cov_4jbwq9383().b[2][0]++, 0.10) :
    /* istanbul ignore next */
    (cov_4jbwq9383().b[2][1]++, 0.05));
    /* istanbul ignore next */
    cov_4jbwq9383().s[8]++;
    return prisma.$transaction([prisma.wallet.update({
      where: {
        id: wallet.id
      },
      data: {
        balance: {
          decrement: amount
        },
        staked: {
          increment: amount
        }
      }
    }), prisma.staking.create({
      data: {
        walletId: wallet.id,
        amount,
        lockPeriod: lockPeriodDays,
        apy,
        active: true
      }
    }), prisma.transaction.create({
      data: {
        type: 'STAKE',
        status: 'COMPLETED',
        amount,
        coinType: 'AZR',
        usdEquivalent: amount,
        notes: `Staked for ${lockPeriodDays} days @ ${apy * 100}%`,
        senderId: wallet.id
      }
    })]);
  }
  async unstake(userId, stakingRecordId) {
    /* istanbul ignore next */
    cov_4jbwq9383().f[1]++;
    const stake =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[9]++, await prisma.staking.findUnique({
      where: {
        id: stakingRecordId
      },
      include: {
        wallet: true
      }
    }));
    /* istanbul ignore next */
    cov_4jbwq9383().s[10]++;
    if (
    /* istanbul ignore next */
    (cov_4jbwq9383().b[4][0]++, !stake) ||
    /* istanbul ignore next */
    (cov_4jbwq9383().b[4][1]++, stake.wallet.userId !== userId)) {
      /* istanbul ignore next */
      cov_4jbwq9383().b[3][0]++;
      cov_4jbwq9383().s[11]++;
      throw new Error('Staking record not found or permission denied');
    } else
    /* istanbul ignore next */
    {
      cov_4jbwq9383().b[3][1]++;
    }
    cov_4jbwq9383().s[12]++;
    if (stake.active === false) {
      /* istanbul ignore next */
      cov_4jbwq9383().b[5][0]++;
      cov_4jbwq9383().s[13]++;
      throw new Error('Stake is already inactive');
    } else
    /* istanbul ignore next */
    {
      cov_4jbwq9383().b[5][1]++;
    }
    const lockEndDate =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[14]++, new Date(stake.startDate.getTime() + stake.lockPeriod * 24 * 60 * 60 * 1000));
    /* istanbul ignore next */
    cov_4jbwq9383().s[15]++;
    if (new Date() < lockEndDate) {
      /* istanbul ignore next */
      cov_4jbwq9383().b[6][0]++;
      cov_4jbwq9383().s[16]++;
      throw new Error(`Lock period not over. Can unstake on ${lockEndDate.toISOString()}`);
    } else
    /* istanbul ignore next */
    {
      cov_4jbwq9383().b[6][1]++;
    }
    cov_4jbwq9383().s[17]++;
    return prisma.$transaction([prisma.wallet.update({
      where: {
        id: stake.walletId
      },
      data: {
        balance: {
          increment: stake.amount
        },
        staked: {
          decrement: stake.amount
        }
      }
    }), prisma.staking.update({
      where: {
        id: stakingRecordId
      },
      data: {
        active: false,
        endDate: new Date()
      }
    }), prisma.transaction.create({
      data: {
        type: 'UNSTAKE',
        status: 'COMPLETED',
        amount: stake.amount,
        coinType: 'AZR',
        usdEquivalent: stake.amount,
        notes: `Unstaked record ${stakingRecordId}`,
        recipientId: stake.walletId
      }
    })]);
  }
  async distributeStakingRewards() {
    /* istanbul ignore next */
    cov_4jbwq9383().f[2]++;
    const stakingPoolWallet =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[18]++, await prisma.wallet.findUnique({
      where: {
        id: STAKING_POOL_WALLET_ID
      }
    }));
    const rewardPie =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[19]++,
    /* istanbul ignore next */
    (cov_4jbwq9383().b[7][0]++, stakingPoolWallet?.balance) ||
    /* istanbul ignore next */
    (cov_4jbwq9383().b[7][1]++, 0));
    /* istanbul ignore next */
    cov_4jbwq9383().s[20]++;
    if (rewardPie <= 0) {
      /* istanbul ignore next */
      cov_4jbwq9383().b[8][0]++;
      cov_4jbwq9383().s[21]++;
      return;
    } else
    /* istanbul ignore next */
    {
      cov_4jbwq9383().b[8][1]++;
    }
    const totalStakedResult =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[22]++, await prisma.staking.aggregate({
      _sum: {
        amount: true
      },
      where: {
        active: true
      }
    }));
    const totalStaked =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[23]++,
    /* istanbul ignore next */
    (cov_4jbwq9383().b[9][0]++, totalStakedResult._sum.amount) ||
    /* istanbul ignore next */
    (cov_4jbwq9383().b[9][1]++, 0));
    /* istanbul ignore next */
    cov_4jbwq9383().s[24]++;
    if (totalStaked === 0) {
      /* istanbul ignore next */
      cov_4jbwq9383().b[10][0]++;
      cov_4jbwq9383().s[25]++;
      return;
    } else
    /* istanbul ignore next */
    {
      cov_4jbwq9383().b[10][1]++;
    }
    const rewardRate =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[26]++, rewardPie / totalStaked);
    const allStakes =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[27]++, await prisma.staking.findMany({
      where: {
        active: true
      }
    }));
    const rewardTransactions =
    /* istanbul ignore next */
    (cov_4jbwq9383().s[28]++, []);
    /* istanbul ignore next */
    cov_4jbwq9383().s[29]++;
    for (const stake of allStakes) {
      const rewardAmount =
      /* istanbul ignore next */
      (cov_4jbwq9383().s[30]++, stake.amount * rewardRate);
      /* istanbul ignore next */
      cov_4jbwq9383().s[31]++;
      rewardTransactions.push(prisma.wallet.update({
        where: {
          id: stake.walletId
        },
        data: {
          balance: {
            increment: rewardAmount
          }
        }
      }), prisma.transaction.create({
        data: {
          type: 'REWARD',
          status: 'COMPLETED',
          amount: rewardAmount,
          coinType: 'AZR',
          usdEquivalent: rewardAmount,
          notes: `Staking reward for stake ${stake.id} @ rate ${rewardRate}`,
          senderId: STAKING_POOL_WALLET_ID,
          recipientId: stake.walletId
        }
      }), prisma.staking.update({
        where: {
          id: stake.id
        },
        data: {
          rewardsPaid: {
            increment: rewardAmount
          }
        }
      }));
    }
    /* istanbul ignore next */
    cov_4jbwq9383().s[32]++;
    rewardTransactions.push(prisma.wallet.update({
      where: {
        id: STAKING_POOL_WALLET_ID
      },
      data: {
        balance: 0
      }
    }));
    /* istanbul ignore next */
    cov_4jbwq9383().s[33]++;
    await prisma.$transaction(rewardTransactions);
  }
}
export default new StakingService();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfNGpid3E5MzgzIiwiYWN0dWFsQ292ZXJhZ2UiLCJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJzIiwiU1RBS0lOR19QT09MX1dBTExFVF9JRCIsInByb2Nlc3MiLCJlbnYiLCJTdGFraW5nU2VydmljZSIsInN0YWtlIiwidXNlcklkIiwiYW1vdW50IiwibG9ja1BlcmlvZERheXMiLCJmIiwid2FsbGV0IiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiYiIsIkVycm9yIiwiYmFsYW5jZSIsImFweSIsIiR0cmFuc2FjdGlvbiIsInVwZGF0ZSIsImlkIiwiZGF0YSIsImRlY3JlbWVudCIsInN0YWtlZCIsImluY3JlbWVudCIsInN0YWtpbmciLCJjcmVhdGUiLCJ3YWxsZXRJZCIsImxvY2tQZXJpb2QiLCJhY3RpdmUiLCJ0cmFuc2FjdGlvbiIsInR5cGUiLCJzdGF0dXMiLCJjb2luVHlwZSIsInVzZEVxdWl2YWxlbnQiLCJub3RlcyIsInNlbmRlcklkIiwidW5zdGFrZSIsInN0YWtpbmdSZWNvcmRJZCIsImluY2x1ZGUiLCJsb2NrRW5kRGF0ZSIsIkRhdGUiLCJzdGFydERhdGUiLCJnZXRUaW1lIiwidG9JU09TdHJpbmciLCJlbmREYXRlIiwicmVjaXBpZW50SWQiLCJkaXN0cmlidXRlU3Rha2luZ1Jld2FyZHMiLCJzdGFraW5nUG9vbFdhbGxldCIsInJld2FyZFBpZSIsInRvdGFsU3Rha2VkUmVzdWx0IiwiYWdncmVnYXRlIiwiX3N1bSIsInRvdGFsU3Rha2VkIiwicmV3YXJkUmF0ZSIsImFsbFN0YWtlcyIsImZpbmRNYW55IiwicmV3YXJkVHJhbnNhY3Rpb25zIiwicmV3YXJkQW1vdW50IiwicHVzaCIsInJld2FyZHNQYWlkIl0sInNvdXJjZXMiOlsic3Rha2luZ1NlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkFaT1JBIFBST1BSSUVUQVJZIExJQ0VOU0VcblxuQ29weXJpZ2h0IMKpIDIwMjUgQXpvcmEgRVMgKFB0eSkgTHRkLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuXG5TZWUgTElDRU5TRSBmaWxlIGZvciBkZXRhaWxzLlxuKi9cblxuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpO1xuXG5jb25zdCBTVEFLSU5HX1BPT0xfV0FMTEVUX0lEID0gcHJvY2Vzcy5lbnYuU1RBS0lOR19QT09MX1dBTExFVF9JRCE7XG5cbmNsYXNzIFN0YWtpbmdTZXJ2aWNlIHtcbiAgYXN5bmMgc3Rha2UodXNlcklkOiBzdHJpbmcsIGFtb3VudDogbnVtYmVyLCBsb2NrUGVyaW9kRGF5czogbnVtYmVyKSB7XG4gICAgY29uc3Qgd2FsbGV0ID0gYXdhaXQgcHJpc21hLndhbGxldC5maW5kVW5pcXVlKHsgd2hlcmU6IHsgdXNlcklkIH0gfSk7XG4gICAgaWYgKCF3YWxsZXQpIHt0aHJvdyBuZXcgRXJyb3IoJ1dhbGxldCBub3QgZm91bmQnKTt9XG4gICAgaWYgKHdhbGxldC5iYWxhbmNlIDwgYW1vdW50KSB7dGhyb3cgbmV3IEVycm9yKCdJbnN1ZmZpY2llbnQgQVpSIGJhbGFuY2UnKTt9XG4gICAgY29uc3QgYXB5ID0gbG9ja1BlcmlvZERheXMgPiAxODAgPyAwLjEwIDogMC4wNTtcblxuICAgIHJldHVybiBwcmlzbWEuJHRyYW5zYWN0aW9uKFtcbiAgICAgIHByaXNtYS53YWxsZXQudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHdhbGxldC5pZCB9LFxuICAgICAgICBkYXRhOiB7IGJhbGFuY2U6IHsgZGVjcmVtZW50OiBhbW91bnQgfSwgc3Rha2VkOiB7IGluY3JlbWVudDogYW1vdW50IH0gfVxuICAgICAgfSksXG4gICAgICBwcmlzbWEuc3Rha2luZy5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7IHdhbGxldElkOiB3YWxsZXQuaWQsIGFtb3VudCwgbG9ja1BlcmlvZDogbG9ja1BlcmlvZERheXMsIGFweSwgYWN0aXZlOiB0cnVlIH1cbiAgICAgIH0pLFxuICAgICAgcHJpc21hLnRyYW5zYWN0aW9uLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0eXBlOiAnU1RBS0UnLFxuICAgICAgICAgIHN0YXR1czogJ0NPTVBMRVRFRCcsXG4gICAgICAgICAgYW1vdW50LFxuICAgICAgICAgIGNvaW5UeXBlOiAnQVpSJyxcbiAgICAgICAgICB1c2RFcXVpdmFsZW50OiBhbW91bnQsXG4gICAgICAgICAgbm90ZXM6IGBTdGFrZWQgZm9yICR7bG9ja1BlcmlvZERheXN9IGRheXMgQCAke2FweSAqIDEwMH0lYCxcbiAgICAgICAgICBzZW5kZXJJZDogd2FsbGV0LmlkXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgXSk7XG4gIH1cblxuICBhc3luYyB1bnN0YWtlKHVzZXJJZDogc3RyaW5nLCBzdGFraW5nUmVjb3JkSWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHN0YWtlID0gYXdhaXQgcHJpc21hLnN0YWtpbmcuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiBzdGFraW5nUmVjb3JkSWQgfSwgaW5jbHVkZTogeyB3YWxsZXQ6IHRydWUgfSB9KTtcbiAgICBpZiAoIXN0YWtlIHx8IHN0YWtlLndhbGxldC51c2VySWQgIT09IHVzZXJJZCkge3Rocm93IG5ldyBFcnJvcignU3Rha2luZyByZWNvcmQgbm90IGZvdW5kIG9yIHBlcm1pc3Npb24gZGVuaWVkJyk7fVxuICAgIGlmIChzdGFrZS5hY3RpdmUgPT09IGZhbHNlKSB7dGhyb3cgbmV3IEVycm9yKCdTdGFrZSBpcyBhbHJlYWR5IGluYWN0aXZlJyk7fVxuICAgIGNvbnN0IGxvY2tFbmREYXRlID0gbmV3IERhdGUoc3Rha2Uuc3RhcnREYXRlLmdldFRpbWUoKSArIHN0YWtlLmxvY2tQZXJpb2QgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICBpZiAobmV3IERhdGUoKSA8IGxvY2tFbmREYXRlKSB7dGhyb3cgbmV3IEVycm9yKGBMb2NrIHBlcmlvZCBub3Qgb3Zlci4gQ2FuIHVuc3Rha2Ugb24gJHtsb2NrRW5kRGF0ZS50b0lTT1N0cmluZygpfWApO31cblxuICAgIHJldHVybiBwcmlzbWEuJHRyYW5zYWN0aW9uKFtcbiAgICAgIHByaXNtYS53YWxsZXQudXBkYXRlKHsgd2hlcmU6IHsgaWQ6IHN0YWtlLndhbGxldElkIH0sIGRhdGE6IHsgYmFsYW5jZTogeyBpbmNyZW1lbnQ6IHN0YWtlLmFtb3VudCB9LCBzdGFrZWQ6IHsgZGVjcmVtZW50OiBzdGFrZS5hbW91bnQgfSB9IH0pLFxuICAgICAgcHJpc21hLnN0YWtpbmcudXBkYXRlKHsgd2hlcmU6IHsgaWQ6IHN0YWtpbmdSZWNvcmRJZCB9LCBkYXRhOiB7IGFjdGl2ZTogZmFsc2UsIGVuZERhdGU6IG5ldyBEYXRlKCkgfSB9KSxcbiAgICAgIHByaXNtYS50cmFuc2FjdGlvbi5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdHlwZTogJ1VOU1RBS0UnLFxuICAgICAgICAgIHN0YXR1czogJ0NPTVBMRVRFRCcsXG4gICAgICAgICAgYW1vdW50OiBzdGFrZS5hbW91bnQsXG4gICAgICAgICAgY29pblR5cGU6ICdBWlInLFxuICAgICAgICAgIHVzZEVxdWl2YWxlbnQ6IHN0YWtlLmFtb3VudCxcbiAgICAgICAgICBub3RlczogYFVuc3Rha2VkIHJlY29yZCAke3N0YWtpbmdSZWNvcmRJZH1gLFxuICAgICAgICAgIHJlY2lwaWVudElkOiBzdGFrZS53YWxsZXRJZFxuICAgICAgICB9XG4gICAgICB9KVxuICAgIF0pO1xuICB9XG5cbiAgYXN5bmMgZGlzdHJpYnV0ZVN0YWtpbmdSZXdhcmRzKCkge1xuICAgIGNvbnN0IHN0YWtpbmdQb29sV2FsbGV0ID0gYXdhaXQgcHJpc21hLndhbGxldC5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQ6IFNUQUtJTkdfUE9PTF9XQUxMRVRfSUQgfSB9KTtcbiAgICBjb25zdCByZXdhcmRQaWUgPSBzdGFraW5nUG9vbFdhbGxldD8uYmFsYW5jZSB8fCAwO1xuICAgIGlmIChyZXdhcmRQaWUgPD0gMCkge3JldHVybjt9XG4gICAgY29uc3QgdG90YWxTdGFrZWRSZXN1bHQgPSBhd2FpdCBwcmlzbWEuc3Rha2luZy5hZ2dyZWdhdGUoeyBfc3VtOiB7IGFtb3VudDogdHJ1ZSB9LCB3aGVyZTogeyBhY3RpdmU6IHRydWUgfSB9KTtcbiAgICBjb25zdCB0b3RhbFN0YWtlZCA9IHRvdGFsU3Rha2VkUmVzdWx0Ll9zdW0uYW1vdW50IHx8IDA7XG4gICAgaWYgKHRvdGFsU3Rha2VkID09PSAwKSB7cmV0dXJuO31cbiAgICBjb25zdCByZXdhcmRSYXRlID0gcmV3YXJkUGllIC8gdG90YWxTdGFrZWQ7XG4gICAgY29uc3QgYWxsU3Rha2VzID0gYXdhaXQgcHJpc21hLnN0YWtpbmcuZmluZE1hbnkoeyB3aGVyZTogeyBhY3RpdmU6IHRydWUgfSB9KTtcbiAgICBjb25zdCByZXdhcmRUcmFuc2FjdGlvbnM6IGFueVtdID0gW107XG4gICAgZm9yIChjb25zdCBzdGFrZSBvZiBhbGxTdGFrZXMpIHtcbiAgICAgIGNvbnN0IHJld2FyZEFtb3VudCA9IHN0YWtlLmFtb3VudCAqIHJld2FyZFJhdGU7XG4gICAgICByZXdhcmRUcmFuc2FjdGlvbnMucHVzaChcbiAgICAgICAgcHJpc21hLndhbGxldC51cGRhdGUoeyB3aGVyZTogeyBpZDogc3Rha2Uud2FsbGV0SWQgfSwgZGF0YTogeyBiYWxhbmNlOiB7IGluY3JlbWVudDogcmV3YXJkQW1vdW50IH0gfSB9KSxcbiAgICAgICAgcHJpc21hLnRyYW5zYWN0aW9uLmNyZWF0ZSh7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgdHlwZTogJ1JFV0FSRCcsIHN0YXR1czogJ0NPTVBMRVRFRCcsIGFtb3VudDogcmV3YXJkQW1vdW50LCBjb2luVHlwZTogJ0FaUicsXG4gICAgICAgICAgICB1c2RFcXVpdmFsZW50OiByZXdhcmRBbW91bnQsIG5vdGVzOiBgU3Rha2luZyByZXdhcmQgZm9yIHN0YWtlICR7c3Rha2UuaWR9IEAgcmF0ZSAke3Jld2FyZFJhdGV9YCxcbiAgICAgICAgICAgIHNlbmRlcklkOiBTVEFLSU5HX1BPT0xfV0FMTEVUX0lELCByZWNpcGllbnRJZDogc3Rha2Uud2FsbGV0SWRcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICBwcmlzbWEuc3Rha2luZy51cGRhdGUoeyB3aGVyZTogeyBpZDogc3Rha2UuaWQgfSwgZGF0YTogeyByZXdhcmRzUGFpZDogeyBpbmNyZW1lbnQ6IHJld2FyZEFtb3VudCB9IH0gfSlcbiAgICAgICk7XG4gICAgfVxuICAgIHJld2FyZFRyYW5zYWN0aW9ucy5wdXNoKHByaXNtYS53YWxsZXQudXBkYXRlKHsgd2hlcmU6IHsgaWQ6IFNUQUtJTkdfUE9PTF9XQUxMRVRfSUQgfSwgZGF0YTogeyBiYWxhbmNlOiAwIH0gfSkpO1xuICAgIGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24ocmV3YXJkVHJhbnNhY3Rpb25zKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgU3Rha2luZ1NlcnZpY2UoKTsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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