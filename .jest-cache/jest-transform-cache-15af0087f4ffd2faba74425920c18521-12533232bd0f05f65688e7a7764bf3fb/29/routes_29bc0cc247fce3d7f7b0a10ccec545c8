ab53ec4e7c992f23e276bea770505920
/* istanbul ignore next */
function cov_17ofn9kgcz() {
  var path = "/workspaces/azora/services/shield_service/api/routes.js";
  var hash = "b41235046404c8e23b3762cbf71ee1c1a91220d1";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/shield_service/api/routes.js",
    statementMap: {
      "0": {
        start: {
          line: 1,
          column: 16
        },
        end: {
          line: 1,
          column: 34
        }
      },
      "1": {
        start: {
          line: 2,
          column: 15
        },
        end: {
          line: 2,
          column: 31
        }
      },
      "2": {
        start: {
          line: 3,
          column: 22
        },
        end: {
          line: 3,
          column: 41
        }
      },
      "3": {
        start: {
          line: 6,
          column: 0
        },
        end: {
          line: 30,
          column: 3
        }
      },
      "4": {
        start: {
          line: 7,
          column: 2
        },
        end: {
          line: 29,
          column: 3
        }
      },
      "5": {
        start: {
          line: 9,
          column: 20
        },
        end: {
          line: 17,
          column: 5
        }
      },
      "6": {
        start: {
          line: 16,
          column: 23
        },
        end: {
          line: 16,
          column: 71
        }
      },
      "7": {
        start: {
          line: 19,
          column: 21
        },
        end: {
          line: 19,
          column: 58
        }
      },
      "8": {
        start: {
          line: 21,
          column: 4
        },
        end: {
          line: 24,
          column: 7
        }
      },
      "9": {
        start: {
          line: 26,
          column: 4
        },
        end: {
          line: 28,
          column: 7
        }
      },
      "10": {
        start: {
          line: 33,
          column: 0
        },
        end: {
          line: 56,
          column: 3
        }
      },
      "11": {
        start: {
          line: 34,
          column: 2
        },
        end: {
          line: 55,
          column: 3
        }
      },
      "12": {
        start: {
          line: 35,
          column: 20
        },
        end: {
          line: 43,
          column: 5
        }
      },
      "13": {
        start: {
          line: 45,
          column: 19
        },
        end: {
          line: 45,
          column: 59
        }
      },
      "14": {
        start: {
          line: 47,
          column: 4
        },
        end: {
          line: 50,
          column: 7
        }
      },
      "15": {
        start: {
          line: 52,
          column: 4
        },
        end: {
          line: 54,
          column: 7
        }
      },
      "16": {
        start: {
          line: 59,
          column: 0
        },
        end: {
          line: 80,
          column: 3
        }
      },
      "17": {
        start: {
          line: 60,
          column: 2
        },
        end: {
          line: 79,
          column: 3
        }
      },
      "18": {
        start: {
          line: 61,
          column: 19
        },
        end: {
          line: 61,
          column: 27
        }
      },
      "19": {
        start: {
          line: 63,
          column: 4
        },
        end: {
          line: 67,
          column: 5
        }
      },
      "20": {
        start: {
          line: 64,
          column: 6
        },
        end: {
          line: 66,
          column: 9
        }
      },
      "21": {
        start: {
          line: 69,
          column: 4
        },
        end: {
          line: 69,
          column: 30
        }
      },
      "22": {
        start: {
          line: 71,
          column: 4
        },
        end: {
          line: 74,
          column: 7
        }
      },
      "23": {
        start: {
          line: 76,
          column: 4
        },
        end: {
          line: 78,
          column: 7
        }
      },
      "24": {
        start: {
          line: 83,
          column: 0
        },
        end: {
          line: 104,
          column: 3
        }
      },
      "25": {
        start: {
          line: 84,
          column: 2
        },
        end: {
          line: 103,
          column: 3
        }
      },
      "26": {
        start: {
          line: 85,
          column: 19
        },
        end: {
          line: 85,
          column: 27
        }
      },
      "27": {
        start: {
          line: 87,
          column: 4
        },
        end: {
          line: 91,
          column: 5
        }
      },
      "28": {
        start: {
          line: 88,
          column: 6
        },
        end: {
          line: 90,
          column: 9
        }
      },
      "29": {
        start: {
          line: 93,
          column: 4
        },
        end: {
          line: 93,
          column: 32
        }
      },
      "30": {
        start: {
          line: 95,
          column: 4
        },
        end: {
          line: 98,
          column: 7
        }
      },
      "31": {
        start: {
          line: 100,
          column: 4
        },
        end: {
          line: 102,
          column: 7
        }
      },
      "32": {
        start: {
          line: 107,
          column: 0
        },
        end: {
          line: 124,
          column: 3
        }
      },
      "33": {
        start: {
          line: 108,
          column: 2
        },
        end: {
          line: 123,
          column: 3
        }
      },
      "34": {
        start: {
          line: 109,
          column: 19
        },
        end: {
          line: 109,
          column: 29
        }
      },
      "35": {
        start: {
          line: 110,
          column: 22
        },
        end: {
          line: 110,
          column: 51
        }
      },
      "36": {
        start: {
          line: 112,
          column: 4
        },
        end: {
          line: 118,
          column: 7
        }
      },
      "37": {
        start: {
          line: 120,
          column: 4
        },
        end: {
          line: 122,
          column: 7
        }
      },
      "38": {
        start: {
          line: 127,
          column: 0
        },
        end: {
          line: 140,
          column: 3
        }
      },
      "39": {
        start: {
          line: 128,
          column: 2
        },
        end: {
          line: 139,
          column: 3
        }
      },
      "40": {
        start: {
          line: 129,
          column: 18
        },
        end: {
          line: 129,
          column: 48
        }
      },
      "41": {
        start: {
          line: 131,
          column: 4
        },
        end: {
          line: 134,
          column: 7
        }
      },
      "42": {
        start: {
          line: 136,
          column: 4
        },
        end: {
          line: 138,
          column: 7
        }
      },
      "43": {
        start: {
          line: 143,
          column: 0
        },
        end: {
          line: 158,
          column: 3
        }
      },
      "44": {
        start: {
          line: 144,
          column: 2
        },
        end: {
          line: 157,
          column: 3
        }
      },
      "45": {
        start: {
          line: 145,
          column: 26
        },
        end: {
          line: 145,
          column: 56
        }
      },
      "46": {
        start: {
          line: 146,
          column: 25
        },
        end: {
          line: 146,
          column: 68
        }
      },
      "47": {
        start: {
          line: 148,
          column: 4
        },
        end: {
          line: 152,
          column: 7
        }
      },
      "48": {
        start: {
          line: 154,
          column: 4
        },
        end: {
          line: 156,
          column: 7
        }
      },
      "49": {
        start: {
          line: 160,
          column: 0
        },
        end: {
          line: 160,
          column: 24
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 6,
            column: 24
          },
          end: {
            line: 6,
            column: 25
          }
        },
        loc: {
          start: {
            line: 6,
            column: 38
          },
          end: {
            line: 30,
            column: 1
          }
        },
        line: 6
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 16,
            column: 11
          },
          end: {
            line: 16,
            column: 12
          }
        },
        loc: {
          start: {
            line: 16,
            column: 23
          },
          end: {
            line: 16,
            column: 71
          }
        },
        line: 16
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 33,
            column: 22
          },
          end: {
            line: 33,
            column: 23
          }
        },
        loc: {
          start: {
            line: 33,
            column: 36
          },
          end: {
            line: 56,
            column: 1
          }
        },
        line: 33
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 59,
            column: 25
          },
          end: {
            line: 59,
            column: 26
          }
        },
        loc: {
          start: {
            line: 59,
            column: 39
          },
          end: {
            line: 80,
            column: 1
          }
        },
        line: 59
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 83,
            column: 27
          },
          end: {
            line: 83,
            column: 28
          }
        },
        loc: {
          start: {
            line: 83,
            column: 41
          },
          end: {
            line: 104,
            column: 1
          }
        },
        line: 83
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 107,
            column: 29
          },
          end: {
            line: 107,
            column: 30
          }
        },
        loc: {
          start: {
            line: 107,
            column: 43
          },
          end: {
            line: 124,
            column: 1
          }
        },
        line: 107
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 127,
            column: 21
          },
          end: {
            line: 127,
            column: 22
          }
        },
        loc: {
          start: {
            line: 127,
            column: 35
          },
          end: {
            line: 140,
            column: 1
          }
        },
        line: 127
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 143,
            column: 29
          },
          end: {
            line: 143,
            column: 30
          }
        },
        loc: {
          start: {
            line: 143,
            column: 43
          },
          end: {
            line: 158,
            column: 1
          }
        },
        line: 143
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 10,
            column: 10
          },
          end: {
            line: 10,
            column: 46
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 10,
            column: 10
          },
          end: {
            line: 10,
            column: 21
          }
        }, {
          start: {
            line: 10,
            column: 25
          },
          end: {
            line: 10,
            column: 31
          }
        }, {
          start: {
            line: 10,
            column: 35
          },
          end: {
            line: 10,
            column: 46
          }
        }],
        line: 10
      },
      "1": {
        loc: {
          start: {
            line: 11,
            column: 14
          },
          end: {
            line: 11,
            column: 38
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 11,
            column: 14
          },
          end: {
            line: 11,
            column: 29
          }
        }, {
          start: {
            line: 11,
            column: 33
          },
          end: {
            line: 11,
            column: 38
          }
        }],
        line: 11
      },
      "2": {
        loc: {
          start: {
            line: 12,
            column: 11
          },
          end: {
            line: 12,
            column: 30
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 12,
            column: 11
          },
          end: {
            line: 12,
            column: 23
          }
        }, {
          start: {
            line: 12,
            column: 27
          },
          end: {
            line: 12,
            column: 30
          }
        }],
        line: 12
      },
      "3": {
        loc: {
          start: {
            line: 13,
            column: 13
          },
          end: {
            line: 13,
            column: 33
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 13,
            column: 13
          },
          end: {
            line: 13,
            column: 27
          }
        }, {
          start: {
            line: 13,
            column: 31
          },
          end: {
            line: 13,
            column: 33
          }
        }],
        line: 13
      },
      "4": {
        loc: {
          start: {
            line: 14,
            column: 12
          },
          end: {
            line: 14,
            column: 31
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 14,
            column: 12
          },
          end: {
            line: 14,
            column: 25
          }
        }, {
          start: {
            line: 14,
            column: 29
          },
          end: {
            line: 14,
            column: 31
          }
        }],
        line: 14
      },
      "5": {
        loc: {
          start: {
            line: 15,
            column: 15
          },
          end: {
            line: 15,
            column: 37
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 15,
            column: 15
          },
          end: {
            line: 15,
            column: 31
          }
        }, {
          start: {
            line: 15,
            column: 35
          },
          end: {
            line: 15,
            column: 37
          }
        }],
        line: 15
      },
      "6": {
        loc: {
          start: {
            line: 16,
            column: 23
          },
          end: {
            line: 16,
            column: 71
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 16,
            column: 23
          },
          end: {
            line: 16,
            column: 63
          }
        }, {
          start: {
            line: 16,
            column: 67
          },
          end: {
            line: 16,
            column: 71
          }
        }],
        line: 16
      },
      "7": {
        loc: {
          start: {
            line: 37,
            column: 20
          },
          end: {
            line: 37,
            column: 84
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 37,
            column: 45
          },
          end: {
            line: 37,
            column: 77
          }
        }, {
          start: {
            line: 37,
            column: 80
          },
          end: {
            line: 37,
            column: 84
          }
        }],
        line: 37
      },
      "8": {
        loc: {
          start: {
            line: 41,
            column: 12
          },
          end: {
            line: 41,
            column: 41
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 41,
            column: 12
          },
          end: {
            line: 41,
            column: 36
          }
        }, {
          start: {
            line: 41,
            column: 40
          },
          end: {
            line: 41,
            column: 41
          }
        }],
        line: 41
      },
      "9": {
        loc: {
          start: {
            line: 42,
            column: 13
          },
          end: {
            line: 42,
            column: 44
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 42,
            column: 13
          },
          end: {
            line: 42,
            column: 38
          }
        }, {
          start: {
            line: 42,
            column: 42
          },
          end: {
            line: 42,
            column: 44
          }
        }],
        line: 42
      },
      "10": {
        loc: {
          start: {
            line: 63,
            column: 4
          },
          end: {
            line: 67,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 63,
            column: 4
          },
          end: {
            line: 67,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 63
      },
      "11": {
        loc: {
          start: {
            line: 87,
            column: 4
          },
          end: {
            line: 91,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 87,
            column: 4
          },
          end: {
            line: 91,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 87
      },
      "12": {
        loc: {
          start: {
            line: 145,
            column: 26
          },
          end: {
            line: 145,
            column: 56
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 145,
            column: 26
          },
          end: {
            line: 145,
            column: 50
          }
        }, {
          start: {
            line: 145,
            column: 54
          },
          end: {
            line: 145,
            column: 56
          }
        }],
        line: 145
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0
    },
    b: {
      "0": [0, 0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "b41235046404c8e23b3762cbf71ee1c1a91220d1"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_17ofn9kgcz = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_17ofn9kgcz();
const express =
/* istanbul ignore next */
(cov_17ofn9kgcz().s[0]++, require('express'));
const router =
/* istanbul ignore next */
(cov_17ofn9kgcz().s[1]++, express.Router());
const shieldService =
/* istanbul ignore next */
(cov_17ofn9kgcz().s[2]++, require('../index'));

// Analyze a request (for testing purposes)
/* istanbul ignore next */
cov_17ofn9kgcz().s[3]++;
router.post('/analyze', (req, res) => {
  /* istanbul ignore next */
  cov_17ofn9kgcz().f[0]++;
  cov_17ofn9kgcz().s[4]++;
  try {
    // Create a mock request object for analysis
    const mockReq =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[5]++, {
      ip:
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[0][0]++, req.body.ip) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[0][1]++, req.ip) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[0][2]++, '127.0.0.1'),
      method:
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[1][0]++, req.body.method) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[1][1]++, 'GET'),
      url:
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[2][0]++, req.body.url) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[2][1]++, '/'),
      query:
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[3][0]++, req.body.query) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[3][1]++, {}),
      body:
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[4][0]++, req.body.body) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[4][1]++, {}),
      headers:
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[5][0]++, req.body.headers) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[5][1]++, {}),
      get: header => {
        /* istanbul ignore next */
        cov_17ofn9kgcz().f[1]++;
        cov_17ofn9kgcz().s[6]++;
        return /* istanbul ignore next */(cov_17ofn9kgcz().b[6][0]++, req.body.headers?.[header.toLowerCase()]) ||
        /* istanbul ignore next */
        (cov_17ofn9kgcz().b[6][1]++, null);
      }
    });
    const analysis =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[7]++, shieldService.analyzeRequest(mockReq));
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[8]++;
    res.json({
      success: true,
      data: analysis
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[9]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Get security events with filtering
/* istanbul ignore next */
cov_17ofn9kgcz().s[10]++;
router.get('/events', (req, res) => {
  /* istanbul ignore next */
  cov_17ofn9kgcz().f[2]++;
  cov_17ofn9kgcz().s[11]++;
  try {
    const filters =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[12]++, {
      ip: req.query.ip,
      minRiskScore: req.query.minRiskScore ?
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[7][0]++, parseInt(req.query.minRiskScore)) :
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[7][1]++, null),
      threatType: req.query.threatType,
      startDate: req.query.startDate,
      endDate: req.query.endDate,
      page:
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[8][0]++, parseInt(req.query.page)) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[8][1]++, 1),
      limit:
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[9][0]++, parseInt(req.query.limit)) ||
      /* istanbul ignore next */
      (cov_17ofn9kgcz().b[9][1]++, 50)
    });
    const events =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[13]++, shieldService.getSecurityEvents(filters));
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[14]++;
    res.json({
      success: true,
      data: events
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[15]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Block an IP address
/* istanbul ignore next */
cov_17ofn9kgcz().s[16]++;
router.post('/block-ip', (req, res) => {
  /* istanbul ignore next */
  cov_17ofn9kgcz().f[3]++;
  cov_17ofn9kgcz().s[17]++;
  try {
    const {
      ip
    } =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[18]++, req.body);
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[19]++;
    if (!ip) {
      /* istanbul ignore next */
      cov_17ofn9kgcz().b[10][0]++;
      cov_17ofn9kgcz().s[20]++;
      return res.status(400).json({
        error: 'IP address is required'
      });
    } else
    /* istanbul ignore next */
    {
      cov_17ofn9kgcz().b[10][1]++;
    }
    cov_17ofn9kgcz().s[21]++;
    shieldService.blockIP(ip);
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[22]++;
    res.json({
      success: true,
      message: `IP address ${ip} blocked successfully`
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[23]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Unblock an IP address
/* istanbul ignore next */
cov_17ofn9kgcz().s[24]++;
router.post('/unblock-ip', (req, res) => {
  /* istanbul ignore next */
  cov_17ofn9kgcz().f[4]++;
  cov_17ofn9kgcz().s[25]++;
  try {
    const {
      ip
    } =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[26]++, req.body);
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[27]++;
    if (!ip) {
      /* istanbul ignore next */
      cov_17ofn9kgcz().b[11][0]++;
      cov_17ofn9kgcz().s[28]++;
      return res.status(400).json({
        error: 'IP address is required'
      });
    } else
    /* istanbul ignore next */
    {
      cov_17ofn9kgcz().b[11][1]++;
    }
    cov_17ofn9kgcz().s[29]++;
    shieldService.unblockIP(ip);
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[30]++;
    res.json({
      success: true,
      message: `IP address ${ip} unblocked successfully`
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[31]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Check if IP is blocked
/* istanbul ignore next */
cov_17ofn9kgcz().s[32]++;
router.get('/ip-status/:ip', (req, res) => {
  /* istanbul ignore next */
  cov_17ofn9kgcz().f[5]++;
  cov_17ofn9kgcz().s[33]++;
  try {
    const {
      ip
    } =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[34]++, req.params);
    const isBlocked =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[35]++, shieldService.isIPBlocked(ip));
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[36]++;
    res.json({
      success: true,
      data: {
        ip,
        isBlocked
      }
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[37]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Get threat statistics
/* istanbul ignore next */
cov_17ofn9kgcz().s[38]++;
router.get('/stats', (req, res) => {
  /* istanbul ignore next */
  cov_17ofn9kgcz().f[6]++;
  cov_17ofn9kgcz().s[39]++;
  try {
    const stats =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[40]++, shieldService.getThreatStats());
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[41]++;
    res.json({
      success: true,
      data: stats
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[42]++;
    res.status(500).json({
      error: error.message
    });
  }
});

// Clear old events
/* istanbul ignore next */
cov_17ofn9kgcz().s[43]++;
router.delete('/events/old', (req, res) => {
  /* istanbul ignore next */
  cov_17ofn9kgcz().f[7]++;
  cov_17ofn9kgcz().s[44]++;
  try {
    const retentionDays =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[45]++,
    /* istanbul ignore next */
    (cov_17ofn9kgcz().b[12][0]++, parseInt(req.query.days)) ||
    /* istanbul ignore next */
    (cov_17ofn9kgcz().b[12][1]++, 30));
    const removedCount =
    /* istanbul ignore next */
    (cov_17ofn9kgcz().s[46]++, shieldService.clearOldEvents(retentionDays));
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[47]++;
    res.json({
      success: true,
      message: `Removed ${removedCount} old security events`,
      removedCount
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_17ofn9kgcz().s[48]++;
    res.status(500).json({
      error: error.message
    });
  }
});
/* istanbul ignore next */
cov_17ofn9kgcz().s[49]++;
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTdvZm45a2djeiIsImFjdHVhbENvdmVyYWdlIiwiZXhwcmVzcyIsInMiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwic2hpZWxkU2VydmljZSIsInBvc3QiLCJyZXEiLCJyZXMiLCJmIiwibW9ja1JlcSIsImlwIiwiYiIsImJvZHkiLCJtZXRob2QiLCJ1cmwiLCJxdWVyeSIsImhlYWRlcnMiLCJnZXQiLCJoZWFkZXIiLCJ0b0xvd2VyQ2FzZSIsImFuYWx5c2lzIiwiYW5hbHl6ZVJlcXVlc3QiLCJqc29uIiwic3VjY2VzcyIsImRhdGEiLCJlcnJvciIsInN0YXR1cyIsIm1lc3NhZ2UiLCJmaWx0ZXJzIiwibWluUmlza1Njb3JlIiwicGFyc2VJbnQiLCJ0aHJlYXRUeXBlIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInBhZ2UiLCJsaW1pdCIsImV2ZW50cyIsImdldFNlY3VyaXR5RXZlbnRzIiwiYmxvY2tJUCIsInVuYmxvY2tJUCIsInBhcmFtcyIsImlzQmxvY2tlZCIsImlzSVBCbG9ja2VkIiwic3RhdHMiLCJnZXRUaHJlYXRTdGF0cyIsImRlbGV0ZSIsInJldGVudGlvbkRheXMiLCJkYXlzIiwicmVtb3ZlZENvdW50IiwiY2xlYXJPbGRFdmVudHMiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsicm91dGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuY29uc3Qgc2hpZWxkU2VydmljZSA9IHJlcXVpcmUoJy4uL2luZGV4Jyk7XG5cbi8vIEFuYWx5emUgYSByZXF1ZXN0IChmb3IgdGVzdGluZyBwdXJwb3NlcylcbnJvdXRlci5wb3N0KCcvYW5hbHl6ZScsIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIC8vIENyZWF0ZSBhIG1vY2sgcmVxdWVzdCBvYmplY3QgZm9yIGFuYWx5c2lzXG4gICAgY29uc3QgbW9ja1JlcSA9IHtcbiAgICAgIGlwOiByZXEuYm9keS5pcCB8fCByZXEuaXAgfHwgJzEyNy4wLjAuMScsXG4gICAgICBtZXRob2Q6IHJlcS5ib2R5Lm1ldGhvZCB8fCAnR0VUJyxcbiAgICAgIHVybDogcmVxLmJvZHkudXJsIHx8ICcvJyxcbiAgICAgIHF1ZXJ5OiByZXEuYm9keS5xdWVyeSB8fCB7fSxcbiAgICAgIGJvZHk6IHJlcS5ib2R5LmJvZHkgfHwge30sXG4gICAgICBoZWFkZXJzOiByZXEuYm9keS5oZWFkZXJzIHx8IHt9LFxuICAgICAgZ2V0OiAoaGVhZGVyKSA9PiByZXEuYm9keS5oZWFkZXJzPy5baGVhZGVyLnRvTG93ZXJDYXNlKCldIHx8IG51bGxcbiAgICB9O1xuXG4gICAgY29uc3QgYW5hbHlzaXMgPSBzaGllbGRTZXJ2aWNlLmFuYWx5emVSZXF1ZXN0KG1vY2tSZXEpO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IGFuYWx5c2lzXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIEdldCBzZWN1cml0eSBldmVudHMgd2l0aCBmaWx0ZXJpbmdcbnJvdXRlci5nZXQoJy9ldmVudHMnLCAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBmaWx0ZXJzID0ge1xuICAgICAgaXA6IHJlcS5xdWVyeS5pcCxcbiAgICAgIG1pblJpc2tTY29yZTogcmVxLnF1ZXJ5Lm1pblJpc2tTY29yZSA/IHBhcnNlSW50KHJlcS5xdWVyeS5taW5SaXNrU2NvcmUpIDogbnVsbCxcbiAgICAgIHRocmVhdFR5cGU6IHJlcS5xdWVyeS50aHJlYXRUeXBlLFxuICAgICAgc3RhcnREYXRlOiByZXEucXVlcnkuc3RhcnREYXRlLFxuICAgICAgZW5kRGF0ZTogcmVxLnF1ZXJ5LmVuZERhdGUsXG4gICAgICBwYWdlOiBwYXJzZUludChyZXEucXVlcnkucGFnZSkgfHwgMSxcbiAgICAgIGxpbWl0OiBwYXJzZUludChyZXEucXVlcnkubGltaXQpIHx8IDUwXG4gICAgfTtcblxuICAgIGNvbnN0IGV2ZW50cyA9IHNoaWVsZFNlcnZpY2UuZ2V0U2VjdXJpdHlFdmVudHMoZmlsdGVycyk7XG5cbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogZXZlbnRzXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIEJsb2NrIGFuIElQIGFkZHJlc3NcbnJvdXRlci5wb3N0KCcvYmxvY2staXAnLCAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGlwIH0gPSByZXEuYm9keTtcblxuICAgIGlmICghaXApIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgIGVycm9yOiAnSVAgYWRkcmVzcyBpcyByZXF1aXJlZCdcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHNoaWVsZFNlcnZpY2UuYmxvY2tJUChpcCk7XG5cbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogYElQIGFkZHJlc3MgJHtpcH0gYmxvY2tlZCBzdWNjZXNzZnVsbHlgXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIFVuYmxvY2sgYW4gSVAgYWRkcmVzc1xucm91dGVyLnBvc3QoJy91bmJsb2NrLWlwJywgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBpcCB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIWlwKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICBlcnJvcjogJ0lQIGFkZHJlc3MgaXMgcmVxdWlyZWQnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBzaGllbGRTZXJ2aWNlLnVuYmxvY2tJUChpcCk7XG5cbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogYElQIGFkZHJlc3MgJHtpcH0gdW5ibG9ja2VkIHN1Y2Nlc3NmdWxseWBcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gQ2hlY2sgaWYgSVAgaXMgYmxvY2tlZFxucm91dGVyLmdldCgnL2lwLXN0YXR1cy86aXAnLCAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGlwIH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IGlzQmxvY2tlZCA9IHNoaWVsZFNlcnZpY2UuaXNJUEJsb2NrZWQoaXApO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgaXAsXG4gICAgICAgIGlzQmxvY2tlZFxuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBHZXQgdGhyZWF0IHN0YXRpc3RpY3NcbnJvdXRlci5nZXQoJy9zdGF0cycsIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN0YXRzID0gc2hpZWxkU2VydmljZS5nZXRUaHJlYXRTdGF0cygpO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHN0YXRzXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIENsZWFyIG9sZCBldmVudHNcbnJvdXRlci5kZWxldGUoJy9ldmVudHMvb2xkJywgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmV0ZW50aW9uRGF5cyA9IHBhcnNlSW50KHJlcS5xdWVyeS5kYXlzKSB8fCAzMDtcbiAgICBjb25zdCByZW1vdmVkQ291bnQgPSBzaGllbGRTZXJ2aWNlLmNsZWFyT2xkRXZlbnRzKHJldGVudGlvbkRheXMpO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6IGBSZW1vdmVkICR7cmVtb3ZlZENvdW50fSBvbGQgc2VjdXJpdHkgZXZlbnRzYCxcbiAgICAgIHJlbW92ZWRDb3VudFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXG4gICAgfSk7XG4gIH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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