{"version":3,"names":["cov_gyat4v4ph","actualCoverage","Redis","logger","CacheService","stats","s","hits","misses","totalResponseTime","requestCount","constructor","config","f","redis","host","port","password","db","b","keyPrefix","maxRetriesPerRequest","maxRetries","enableReadyCheck","enableOfflineQueue","retryStrategy","times","delay","Math","min","setupEventHandlers","on","info","err","error","warn","get","key","startTime","Date","now","data","responseTime","JSON","parse","set","value","ttl","defaultTTL","serialized","stringify","setex","debug","delete","result","del","deletePattern","pattern","keys","length","clear","flushdb","getOrSet","fn","cached","getStats","total","hitRate","averageResponseTime","size","resetStats","isConnected","status","close","quit","cacheService","initializeCacheService","getCacheService","Error"],"sources":["cache.service.ts"],"sourcesContent":["/**\n * Cache Service\n * Provides Redis-based caching for courses, progress, analytics, and sessions\n * Implements TTL management, cache invalidation, and monitoring\n */\n\nimport Redis from 'ioredis';\nimport { logger } from '../utils/logger';\n\nexport interface CacheConfig {\n  host: string;\n  port: number;\n  password?: string;\n  db?: number;\n  keyPrefix: string;\n  defaultTTL: number;\n  maxRetries: number;\n}\n\nexport interface CacheStats {\n  hits: number;\n  misses: number;\n  size: number;\n  hitRate: number;\n  averageResponseTime: number;\n}\n\nexport interface CacheEntry<T> {\n  data: T;\n  timestamp: number;\n  ttl: number;\n}\n\n/**\n * Cache Service\n * Manages all caching operations with TTL, invalidation, and monitoring\n */\nexport class CacheService {\n  private redis: Redis;\n  private config: CacheConfig;\n  private stats = {\n    hits: 0,\n    misses: 0,\n    totalResponseTime: 0,\n    requestCount: 0\n  };\n\n  constructor(config: CacheConfig) {\n    this.config = config;\n    this.redis = new Redis({\n      host: config.host,\n      port: config.port,\n      password: config.password,\n      db: config.db || 0,\n      keyPrefix: config.keyPrefix,\n      maxRetriesPerRequest: config.maxRetries,\n      enableReadyCheck: true,\n      enableOfflineQueue: true,\n      retryStrategy: (times) => {\n        const delay = Math.min(times * 50, 2000);\n        return delay;\n      }\n    });\n\n    this.setupEventHandlers();\n  }\n\n  /**\n   * Setup Redis event handlers\n   */\n  private setupEventHandlers(): void {\n    this.redis.on('connect', () => {\n      logger.info('Cache service connected to Redis');\n    });\n\n    this.redis.on('error', (err) => {\n      logger.error('Cache service Redis error:', err);\n    });\n\n    this.redis.on('reconnecting', () => {\n      logger.warn('Cache service reconnecting to Redis');\n    });\n  }\n\n  /**\n   * Get value from cache\n   */\n  async get<T>(key: string): Promise<T | null> {\n    const startTime = Date.now();\n    try {\n      const data = await this.redis.get(key);\n      const responseTime = Date.now() - startTime;\n\n      if (!data) {\n        this.stats.misses++;\n        this.stats.totalResponseTime += responseTime;\n        this.stats.requestCount++;\n        return null;\n      }\n\n      this.stats.hits++;\n      this.stats.totalResponseTime += responseTime;\n      this.stats.requestCount++;\n\n      return JSON.parse(data) as T;\n    } catch (error) {\n      logger.error(`Cache get error for key ${key}:`, error);\n      this.stats.misses++;\n      return null;\n    }\n  }\n\n  /**\n   * Set value in cache with TTL\n   */\n  async set<T>(key: string, value: T, ttl: number = this.config.defaultTTL): Promise<void> {\n    try {\n      const serialized = JSON.stringify(value);\n      await this.redis.setex(key, ttl, serialized);\n      logger.debug(`Cache set: ${key} (TTL: ${ttl}s)`);\n    } catch (error) {\n      logger.error(`Cache set error for key ${key}:`, error);\n    }\n  }\n\n  /**\n   * Delete value from cache\n   */\n  async delete(key: string): Promise<boolean> {\n    try {\n      const result = await this.redis.del(key);\n      logger.debug(`Cache deleted: ${key}`);\n      return result > 0;\n    } catch (error) {\n      logger.error(`Cache delete error for key ${key}:`, error);\n      return false;\n    }\n  }\n\n  /**\n   * Delete multiple keys by pattern\n   */\n  async deletePattern(pattern: string): Promise<number> {\n    try {\n      const keys = await this.redis.keys(pattern);\n      if (keys.length === 0) {return 0;}\n\n      const result = await this.redis.del(...keys);\n      logger.debug(`Cache deleted ${result} keys matching pattern: ${pattern}`);\n      return result;\n    } catch (error) {\n      logger.error(`Cache delete pattern error for pattern ${pattern}:`, error);\n      return 0;\n    }\n  }\n\n  /**\n   * Clear all cache\n   */\n  async clear(): Promise<void> {\n    try {\n      await this.redis.flushdb();\n      logger.info('Cache cleared');\n    } catch (error) {\n      logger.error('Cache clear error:', error);\n    }\n  }\n\n  /**\n   * Get or set value (cache-aside pattern)\n   */\n  async getOrSet<T>(\n    key: string,\n    fn: () => Promise<T>,\n    ttl: number = this.config.defaultTTL\n  ): Promise<T> {\n    // Try to get from cache\n    const cached = await this.get<T>(key);\n    if (cached !== null) {\n      return cached;\n    }\n\n    // Cache miss - compute value\n    const value = await fn();\n\n    // Store in cache\n    await this.set(key, value, ttl);\n\n    return value;\n  }\n\n  /**\n   * Get cache statistics\n   */\n  getStats(): CacheStats {\n    const total = this.stats.hits + this.stats.misses;\n    const hitRate = total > 0 ? (this.stats.hits / total) * 100 : 0;\n    const averageResponseTime = this.stats.requestCount > 0 \n      ? this.stats.totalResponseTime / this.stats.requestCount \n      : 0;\n\n    return {\n      hits: this.stats.hits,\n      misses: this.stats.misses,\n      size: 0, // Would need to calculate from Redis\n      hitRate,\n      averageResponseTime\n    };\n  }\n\n  /**\n   * Reset statistics\n   */\n  resetStats(): void {\n    this.stats = {\n      hits: 0,\n      misses: 0,\n      totalResponseTime: 0,\n      requestCount: 0\n    };\n  }\n\n  /**\n   * Check if Redis is connected\n   */\n  isConnected(): boolean {\n    return this.redis.status === 'ready';\n  }\n\n  /**\n   * Close Redis connection\n   */\n  async close(): Promise<void> {\n    await this.redis.quit();\n    logger.info('Cache service disconnected');\n  }\n}\n\n// Singleton instance\nlet cacheService: CacheService | null = null;\n\n/**\n * Initialize cache service\n */\nexport function initializeCacheService(config: CacheConfig): CacheService {\n  if (!cacheService) {\n    cacheService = new CacheService(config);\n  }\n  return cacheService;\n}\n\n/**\n * Get cache service instance\n */\nexport function getCacheService(): CacheService {\n  if (!cacheService) {\n    throw new Error('Cache service not initialized. Call initializeCacheService first.');\n  }\n  return cacheService;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAfZ;AACA;AACA;AACA;AACA;;AAEA,OAAOE,KAAK,MAAM,SAAS;AAC3B,SAASC,MAAM,QAAQ,iBAAiB;AA0BxC;AACA;AACA;AACA;AACA,OAAO,MAAMC,YAAY,CAAC;EAGhBC,KAAK;EAAA;EAAA,CAAAL,aAAA,GAAAM,CAAA,OAAG;IACdC,IAAI,EAAE,CAAC;IACPC,MAAM,EAAE,CAAC;IACTC,iBAAiB,EAAE,CAAC;IACpBC,YAAY,EAAE;EAChB,CAAC;EAEDC,WAAWA,CAACC,MAAmB,EAAE;IAAA;IAAAZ,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IAC/B,IAAI,CAACM,MAAM,GAAGA,MAAM;IAAC;IAAAZ,aAAA,GAAAM,CAAA;IACrB,IAAI,CAACQ,KAAK,GAAG,IAAIZ,KAAK,CAAC;MACrBa,IAAI,EAAEH,MAAM,CAACG,IAAI;MACjBC,IAAI,EAAEJ,MAAM,CAACI,IAAI;MACjBC,QAAQ,EAAEL,MAAM,CAACK,QAAQ;MACzBC,EAAE;MAAE;MAAA,CAAAlB,aAAA,GAAAmB,CAAA,UAAAP,MAAM,CAACM,EAAE;MAAA;MAAA,CAAAlB,aAAA,GAAAmB,CAAA,UAAI,CAAC;MAClBC,SAAS,EAAER,MAAM,CAACQ,SAAS;MAC3BC,oBAAoB,EAAET,MAAM,CAACU,UAAU;MACvCC,gBAAgB,EAAE,IAAI;MACtBC,kBAAkB,EAAE,IAAI;MACxBC,aAAa,EAAGC,KAAK,IAAK;QAAA;QAAA1B,aAAA,GAAAa,CAAA;QACxB,MAAMc,KAAK;QAAA;QAAA,CAAA3B,aAAA,GAAAM,CAAA,OAAGsB,IAAI,CAACC,GAAG,CAACH,KAAK,GAAG,EAAE,EAAE,IAAI,CAAC;QAAC;QAAA1B,aAAA,GAAAM,CAAA;QACzC,OAAOqB,KAAK;MACd;IACF,CAAC,CAAC;IAAC;IAAA3B,aAAA,GAAAM,CAAA;IAEH,IAAI,CAACwB,kBAAkB,CAAC,CAAC;EAC3B;;EAEA;AACF;AACA;EACUA,kBAAkBA,CAAA,EAAS;IAAA;IAAA9B,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IACjC,IAAI,CAACQ,KAAK,CAACiB,EAAE,CAAC,SAAS,EAAE,MAAM;MAAA;MAAA/B,aAAA,GAAAa,CAAA;MAAAb,aAAA,GAAAM,CAAA;MAC7BH,MAAM,CAAC6B,IAAI,CAAC,kCAAkC,CAAC;IACjD,CAAC,CAAC;IAAC;IAAAhC,aAAA,GAAAM,CAAA;IAEH,IAAI,CAACQ,KAAK,CAACiB,EAAE,CAAC,OAAO,EAAGE,GAAG,IAAK;MAAA;MAAAjC,aAAA,GAAAa,CAAA;MAAAb,aAAA,GAAAM,CAAA;MAC9BH,MAAM,CAAC+B,KAAK,CAAC,4BAA4B,EAAED,GAAG,CAAC;IACjD,CAAC,CAAC;IAAC;IAAAjC,aAAA,GAAAM,CAAA;IAEH,IAAI,CAACQ,KAAK,CAACiB,EAAE,CAAC,cAAc,EAAE,MAAM;MAAA;MAAA/B,aAAA,GAAAa,CAAA;MAAAb,aAAA,GAAAM,CAAA;MAClCH,MAAM,CAACgC,IAAI,CAAC,qCAAqC,CAAC;IACpD,CAAC,CAAC;EACJ;;EAEA;AACF;AACA;EACE,MAAMC,GAAGA,CAAIC,GAAW,EAAqB;IAAA;IAAArC,aAAA,GAAAa,CAAA;IAC3C,MAAMyB,SAAS;IAAA;IAAA,CAAAtC,aAAA,GAAAM,CAAA,QAAGiC,IAAI,CAACC,GAAG,CAAC,CAAC;IAAC;IAAAxC,aAAA,GAAAM,CAAA;IAC7B,IAAI;MACF,MAAMmC,IAAI;MAAA;MAAA,CAAAzC,aAAA,GAAAM,CAAA,QAAG,MAAM,IAAI,CAACQ,KAAK,CAACsB,GAAG,CAACC,GAAG,CAAC;MACtC,MAAMK,YAAY;MAAA;MAAA,CAAA1C,aAAA,GAAAM,CAAA,QAAGiC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,SAAS;MAAC;MAAAtC,aAAA,GAAAM,CAAA;MAE5C,IAAI,CAACmC,IAAI,EAAE;QAAA;QAAAzC,aAAA,GAAAmB,CAAA;QAAAnB,aAAA,GAAAM,CAAA;QACT,IAAI,CAACD,KAAK,CAACG,MAAM,EAAE;QAAC;QAAAR,aAAA,GAAAM,CAAA;QACpB,IAAI,CAACD,KAAK,CAACI,iBAAiB,IAAIiC,YAAY;QAAC;QAAA1C,aAAA,GAAAM,CAAA;QAC7C,IAAI,CAACD,KAAK,CAACK,YAAY,EAAE;QAAC;QAAAV,aAAA,GAAAM,CAAA;QAC1B,OAAO,IAAI;MACb,CAAC;MAAA;MAAA;QAAAN,aAAA,GAAAmB,CAAA;MAAA;MAAAnB,aAAA,GAAAM,CAAA;MAED,IAAI,CAACD,KAAK,CAACE,IAAI,EAAE;MAAC;MAAAP,aAAA,GAAAM,CAAA;MAClB,IAAI,CAACD,KAAK,CAACI,iBAAiB,IAAIiC,YAAY;MAAC;MAAA1C,aAAA,GAAAM,CAAA;MAC7C,IAAI,CAACD,KAAK,CAACK,YAAY,EAAE;MAAC;MAAAV,aAAA,GAAAM,CAAA;MAE1B,OAAOqC,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC;IACzB,CAAC,CAAC,OAAOP,KAAK,EAAE;MAAA;MAAAlC,aAAA,GAAAM,CAAA;MACdH,MAAM,CAAC+B,KAAK,CAAC,2BAA2BG,GAAG,GAAG,EAAEH,KAAK,CAAC;MAAC;MAAAlC,aAAA,GAAAM,CAAA;MACvD,IAAI,CAACD,KAAK,CAACG,MAAM,EAAE;MAAC;MAAAR,aAAA,GAAAM,CAAA;MACpB,OAAO,IAAI;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMuC,GAAGA,CAAIR,GAAW,EAAES,KAAQ,EAAEC,GAAW;EAAA;EAAA,CAAA/C,aAAA,GAAAmB,CAAA,UAAG,IAAI,CAACP,MAAM,CAACoC,UAAU,GAAiB;IAAA;IAAAhD,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IACvF,IAAI;MACF,MAAM2C,UAAU;MAAA;MAAA,CAAAjD,aAAA,GAAAM,CAAA,QAAGqC,IAAI,CAACO,SAAS,CAACJ,KAAK,CAAC;MAAC;MAAA9C,aAAA,GAAAM,CAAA;MACzC,MAAM,IAAI,CAACQ,KAAK,CAACqC,KAAK,CAACd,GAAG,EAAEU,GAAG,EAAEE,UAAU,CAAC;MAAC;MAAAjD,aAAA,GAAAM,CAAA;MAC7CH,MAAM,CAACiD,KAAK,CAAC,cAAcf,GAAG,UAAUU,GAAG,IAAI,CAAC;IAClD,CAAC,CAAC,OAAOb,KAAK,EAAE;MAAA;MAAAlC,aAAA,GAAAM,CAAA;MACdH,MAAM,CAAC+B,KAAK,CAAC,2BAA2BG,GAAG,GAAG,EAAEH,KAAK,CAAC;IACxD;EACF;;EAEA;AACF;AACA;EACE,MAAMmB,MAAMA,CAAChB,GAAW,EAAoB;IAAA;IAAArC,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IAC1C,IAAI;MACF,MAAMgD,MAAM;MAAA;MAAA,CAAAtD,aAAA,GAAAM,CAAA,QAAG,MAAM,IAAI,CAACQ,KAAK,CAACyC,GAAG,CAAClB,GAAG,CAAC;MAAC;MAAArC,aAAA,GAAAM,CAAA;MACzCH,MAAM,CAACiD,KAAK,CAAC,kBAAkBf,GAAG,EAAE,CAAC;MAAC;MAAArC,aAAA,GAAAM,CAAA;MACtC,OAAOgD,MAAM,GAAG,CAAC;IACnB,CAAC,CAAC,OAAOpB,KAAK,EAAE;MAAA;MAAAlC,aAAA,GAAAM,CAAA;MACdH,MAAM,CAAC+B,KAAK,CAAC,8BAA8BG,GAAG,GAAG,EAAEH,KAAK,CAAC;MAAC;MAAAlC,aAAA,GAAAM,CAAA;MAC1D,OAAO,KAAK;IACd;EACF;;EAEA;AACF;AACA;EACE,MAAMkD,aAAaA,CAACC,OAAe,EAAmB;IAAA;IAAAzD,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IACpD,IAAI;MACF,MAAMoD,IAAI;MAAA;MAAA,CAAA1D,aAAA,GAAAM,CAAA,QAAG,MAAM,IAAI,CAACQ,KAAK,CAAC4C,IAAI,CAACD,OAAO,CAAC;MAAC;MAAAzD,aAAA,GAAAM,CAAA;MAC5C,IAAIoD,IAAI,CAACC,MAAM,KAAK,CAAC,EAAE;QAAA;QAAA3D,aAAA,GAAAmB,CAAA;QAAAnB,aAAA,GAAAM,CAAA;QAAC,OAAO,CAAC;MAAC,CAAC;MAAA;MAAA;QAAAN,aAAA,GAAAmB,CAAA;MAAA;MAElC,MAAMmC,MAAM;MAAA;MAAA,CAAAtD,aAAA,GAAAM,CAAA,QAAG,MAAM,IAAI,CAACQ,KAAK,CAACyC,GAAG,CAAC,GAAGG,IAAI,CAAC;MAAC;MAAA1D,aAAA,GAAAM,CAAA;MAC7CH,MAAM,CAACiD,KAAK,CAAC,iBAAiBE,MAAM,2BAA2BG,OAAO,EAAE,CAAC;MAAC;MAAAzD,aAAA,GAAAM,CAAA;MAC1E,OAAOgD,MAAM;IACf,CAAC,CAAC,OAAOpB,KAAK,EAAE;MAAA;MAAAlC,aAAA,GAAAM,CAAA;MACdH,MAAM,CAAC+B,KAAK,CAAC,0CAA0CuB,OAAO,GAAG,EAAEvB,KAAK,CAAC;MAAC;MAAAlC,aAAA,GAAAM,CAAA;MAC1E,OAAO,CAAC;IACV;EACF;;EAEA;AACF;AACA;EACE,MAAMsD,KAAKA,CAAA,EAAkB;IAAA;IAAA5D,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IAC3B,IAAI;MAAA;MAAAN,aAAA,GAAAM,CAAA;MACF,MAAM,IAAI,CAACQ,KAAK,CAAC+C,OAAO,CAAC,CAAC;MAAC;MAAA7D,aAAA,GAAAM,CAAA;MAC3BH,MAAM,CAAC6B,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC,CAAC,OAAOE,KAAK,EAAE;MAAA;MAAAlC,aAAA,GAAAM,CAAA;MACdH,MAAM,CAAC+B,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;IAC3C;EACF;;EAEA;AACF;AACA;EACE,MAAM4B,QAAQA,CACZzB,GAAW,EACX0B,EAAoB,EACpBhB,GAAW;EAAA;EAAA,CAAA/C,aAAA,GAAAmB,CAAA,UAAG,IAAI,CAACP,MAAM,CAACoC,UAAU,GACxB;IAAA;IAAAhD,aAAA,GAAAa,CAAA;IACZ;IACA,MAAMmD,MAAM;IAAA;IAAA,CAAAhE,aAAA,GAAAM,CAAA,QAAG,MAAM,IAAI,CAAC8B,GAAG,CAAIC,GAAG,CAAC;IAAC;IAAArC,aAAA,GAAAM,CAAA;IACtC,IAAI0D,MAAM,KAAK,IAAI,EAAE;MAAA;MAAAhE,aAAA,GAAAmB,CAAA;MAAAnB,aAAA,GAAAM,CAAA;MACnB,OAAO0D,MAAM;IACf,CAAC;IAAA;IAAA;MAAAhE,aAAA,GAAAmB,CAAA;IAAA;;IAED;IACA,MAAM2B,KAAK;IAAA;IAAA,CAAA9C,aAAA,GAAAM,CAAA,QAAG,MAAMyD,EAAE,CAAC,CAAC;;IAExB;IAAA;IAAA/D,aAAA,GAAAM,CAAA;IACA,MAAM,IAAI,CAACuC,GAAG,CAACR,GAAG,EAAES,KAAK,EAAEC,GAAG,CAAC;IAAC;IAAA/C,aAAA,GAAAM,CAAA;IAEhC,OAAOwC,KAAK;EACd;;EAEA;AACF;AACA;EACEmB,QAAQA,CAAA,EAAe;IAAA;IAAAjE,aAAA,GAAAa,CAAA;IACrB,MAAMqD,KAAK;IAAA;IAAA,CAAAlE,aAAA,GAAAM,CAAA,QAAG,IAAI,CAACD,KAAK,CAACE,IAAI,GAAG,IAAI,CAACF,KAAK,CAACG,MAAM;IACjD,MAAM2D,OAAO;IAAA;IAAA,CAAAnE,aAAA,GAAAM,CAAA,QAAG4D,KAAK,GAAG,CAAC;IAAA;IAAA,CAAAlE,aAAA,GAAAmB,CAAA,UAAI,IAAI,CAACd,KAAK,CAACE,IAAI,GAAG2D,KAAK,GAAI,GAAG;IAAA;IAAA,CAAAlE,aAAA,GAAAmB,CAAA,UAAG,CAAC;IAC/D,MAAMiD,mBAAmB;IAAA;IAAA,CAAApE,aAAA,GAAAM,CAAA,QAAG,IAAI,CAACD,KAAK,CAACK,YAAY,GAAG,CAAC;IAAA;IAAA,CAAAV,aAAA,GAAAmB,CAAA,UACnD,IAAI,CAACd,KAAK,CAACI,iBAAiB,GAAG,IAAI,CAACJ,KAAK,CAACK,YAAY;IAAA;IAAA,CAAAV,aAAA,GAAAmB,CAAA,UACtD,CAAC;IAAC;IAAAnB,aAAA,GAAAM,CAAA;IAEN,OAAO;MACLC,IAAI,EAAE,IAAI,CAACF,KAAK,CAACE,IAAI;MACrBC,MAAM,EAAE,IAAI,CAACH,KAAK,CAACG,MAAM;MACzB6D,IAAI,EAAE,CAAC;MAAE;MACTF,OAAO;MACPC;IACF,CAAC;EACH;;EAEA;AACF;AACA;EACEE,UAAUA,CAAA,EAAS;IAAA;IAAAtE,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IACjB,IAAI,CAACD,KAAK,GAAG;MACXE,IAAI,EAAE,CAAC;MACPC,MAAM,EAAE,CAAC;MACTC,iBAAiB,EAAE,CAAC;MACpBC,YAAY,EAAE;IAChB,CAAC;EACH;;EAEA;AACF;AACA;EACE6D,WAAWA,CAAA,EAAY;IAAA;IAAAvE,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IACrB,OAAO,IAAI,CAACQ,KAAK,CAAC0D,MAAM,KAAK,OAAO;EACtC;;EAEA;AACF;AACA;EACE,MAAMC,KAAKA,CAAA,EAAkB;IAAA;IAAAzE,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAM,CAAA;IAC3B,MAAM,IAAI,CAACQ,KAAK,CAAC4D,IAAI,CAAC,CAAC;IAAC;IAAA1E,aAAA,GAAAM,CAAA;IACxBH,MAAM,CAAC6B,IAAI,CAAC,4BAA4B,CAAC;EAC3C;AACF;;AAEA;AACA,IAAI2C,YAAiC;AAAA;AAAA,CAAA3E,aAAA,GAAAM,CAAA,QAAG,IAAI;;AAE5C;AACA;AACA;AACA,OAAO,SAASsE,sBAAsBA,CAAChE,MAAmB,EAAgB;EAAA;EAAAZ,aAAA,GAAAa,CAAA;EAAAb,aAAA,GAAAM,CAAA;EACxE,IAAI,CAACqE,YAAY,EAAE;IAAA;IAAA3E,aAAA,GAAAmB,CAAA;IAAAnB,aAAA,GAAAM,CAAA;IACjBqE,YAAY,GAAG,IAAIvE,YAAY,CAACQ,MAAM,CAAC;EACzC,CAAC;EAAA;EAAA;IAAAZ,aAAA,GAAAmB,CAAA;EAAA;EAAAnB,aAAA,GAAAM,CAAA;EACD,OAAOqE,YAAY;AACrB;;AAEA;AACA;AACA;AACA,OAAO,SAASE,eAAeA,CAAA,EAAiB;EAAA;EAAA7E,aAAA,GAAAa,CAAA;EAAAb,aAAA,GAAAM,CAAA;EAC9C,IAAI,CAACqE,YAAY,EAAE;IAAA;IAAA3E,aAAA,GAAAmB,CAAA;IAAAnB,aAAA,GAAAM,CAAA;IACjB,MAAM,IAAIwE,KAAK,CAAC,mEAAmE,CAAC;EACtF,CAAC;EAAA;EAAA;IAAA9E,aAAA,GAAAmB,CAAA;EAAA;EAAAnB,aAAA,GAAAM,CAAA;EACD,OAAOqE,YAAY;AACrB","ignoreList":[]}