{"version":3,"names":["cov_mab091gtd","actualCoverage","EventEmitter","getServiceRegistry","eventBus","MyceliumNetwork","nodes","s","Map","messageHistory","constructor","f","serviceRegistry","initializeMyceliumNetwork","connectToEventBus","services","forEach","serviceName","node","id","connections","health","messageCount","lastMessage","Date","set","establishConnections","emit","nodeCount","size","nodeArray","Array","from","values","otherNodes","filter","n","sort","Math","random","slice","floor","otherNode","push","otherNodeData","get","b","includes","totalConnections","reduce","sum","length","on","event","routeThroughMycelium","sourceService","metadata","service","sourceNode","find","message","to","data","timestamp","hops","path","propagateMessage","shift","maxHops","nodeId","nextMessage","publish","myceliumPath","getNodeStatus","getNetworkTopology","averageConnections","healthyNodes","networkHealth","checkNetworkHealth","entries","serviceInfo","getService","error","startHealthMonitoring","intervalMs","setInterval","myceliumNetwork"],"sources":["mycelium-network.ts"],"sourcesContent":["/*\nAZORA PROPRIETARY LICENSE\nCopyright Â© 2025 Azora ES (Pty) Ltd. All Rights Reserved.\n\nMYCELIUM NETWORK LAYER\nConnected to networks of mycelium - Interconnected service mesh\n*/\n\nimport { EventEmitter } from 'events';\nimport { getServiceRegistry, ServiceRegistry } from '@azora/shared-services/service-registry';\nimport { eventBus } from '@azora/shared-services/event-bus';\n\nexport interface MyceliumNode {\n  id: string;\n  serviceName: string;\n  connections: string[];\n  health: 'healthy' | 'degraded' | 'disconnected';\n  messageCount: number;\n  lastMessage: Date;\n}\n\nexport interface MyceliumMessage {\n  from: string;\n  to: string[];\n  data: any;\n  timestamp: Date;\n  hops: number;\n  path: string[];\n}\n\n/**\n * Mycelium Network Layer\n * Connected networks of mycelium - Interconnected services\n */\nexport class MyceliumNetwork extends EventEmitter {\n  private nodes: Map<string, MyceliumNode> = new Map();\n  private messageHistory: MyceliumMessage[] = [];\n  private serviceRegistry: ServiceRegistry;\n\n  constructor() {\n    super();\n    this.serviceRegistry = getServiceRegistry();\n    this.initializeMyceliumNetwork();\n    this.connectToEventBus();\n  }\n\n  /**\n   * Initialize mycelium network\n   * Connect all services in a mesh\n   */\n  private initializeMyceliumNetwork(): void {\n    // Discover services from registry\n    const services = [\n      'api-gateway',\n      'auth-service',\n      'lms-service',\n      'retail-ai-service',\n      'institutional-service',\n      'wallet-service',\n      'chronicle-service',\n      'nexus-service',\n      'analytics-service',\n      'ai-service',\n    ];\n\n    services.forEach(serviceName => {\n      const node: MyceliumNode = {\n        id: `mycelium-${serviceName}`,\n        serviceName,\n        connections: [],\n        health: 'healthy',\n        messageCount: 0,\n        lastMessage: new Date(),\n      };\n      \n      this.nodes.set(node.id, node);\n    });\n\n    // Establish connections (mycelium network)\n    this.establishConnections();\n    \n    this.emit('network-initialized', { nodeCount: this.nodes.size });\n  }\n\n  /**\n   * Establish connections between nodes\n   * Mycelium forms interconnected network\n   */\n  private establishConnections(): void {\n    const nodeArray = Array.from(this.nodes.values());\n    \n    // Each node connects to multiple others (mycelium structure)\n    nodeArray.forEach(node => {\n      const connections: string[] = [];\n      \n      // Connect to 3-5 other nodes (mycelium network)\n      const otherNodes = nodeArray\n        .filter(n => n.id !== node.id)\n        .sort(() => Math.random() - 0.5)\n        .slice(0, Math.floor(Math.random() * 3) + 3);\n      \n      otherNodes.forEach(otherNode => {\n        connections.push(otherNode.id);\n        // Bidirectional connection\n        const otherNodeData = this.nodes.get(otherNode.id);\n        if (otherNodeData && !otherNodeData.connections.includes(node.id)) {\n          otherNodeData.connections.push(node.id);\n        }\n      });\n      \n      node.connections = connections;\n    });\n\n    this.emit('connections-established', { \n      totalConnections: Array.from(this.nodes.values())\n        .reduce((sum, n) => sum + n.connections.length, 0) / 2 \n    });\n  }\n\n  /**\n   * Connect to event bus\n   * Mycelium network routes through events\n   */\n  private connectToEventBus(): void {\n    eventBus.on('*', (event: any) => {\n      this.routeThroughMycelium(event);\n    });\n  }\n\n  /**\n   * Route message through mycelium network\n   */\n  private routeThroughMycelium(event: any): void {\n    const sourceService = event.metadata?.service || 'unknown';\n    const sourceNode = Array.from(this.nodes.values())\n      .find(n => n.serviceName === sourceService);\n\n    if (!sourceNode) {\n      return;\n    }\n\n    // Update source node\n    sourceNode.messageCount += 1;\n    sourceNode.lastMessage = new Date();\n\n    // Route to connected nodes\n    const message: MyceliumMessage = {\n      from: sourceNode.id,\n      to: sourceNode.connections,\n      data: event,\n      timestamp: new Date(),\n      hops: 0,\n      path: [sourceNode.id],\n    };\n\n    this.propagateMessage(message);\n    this.messageHistory.push(message);\n    \n    // Keep history limited\n    if (this.messageHistory.length > 1000) {\n      this.messageHistory.shift();\n    }\n  }\n\n  /**\n   * Propagate message through network\n   */\n  private propagateMessage(message: MyceliumMessage, maxHops: number = 3): void {\n    if (message.hops >= maxHops) {\n      return;\n    }\n\n    message.to.forEach(nodeId => {\n      const node = this.nodes.get(nodeId);\n      if (!node || message.path.includes(nodeId)) {\n        return; // Avoid loops\n      }\n\n      // Update node\n      node.messageCount += 1;\n      node.lastMessage = new Date();\n\n      // Create new message for next hop\n      const nextMessage: MyceliumMessage = {\n        ...message,\n        hops: message.hops + 1,\n        path: [...message.path, nodeId],\n        to: node.connections.filter(id => !message.path.includes(id)),\n      };\n\n      // Emit to connected service\n      eventBus.publish(`${node.serviceName}.mycelium.message`, {\n        ...message.data,\n        myceliumPath: nextMessage.path,\n        hops: nextMessage.hops,\n      });\n\n      // Continue propagation\n      if (nextMessage.to.length > 0 && nextMessage.hops < maxHops) {\n        this.propagateMessage(nextMessage, maxHops);\n      }\n    });\n  }\n\n  /**\n   * Get node status\n   */\n  getNodeStatus(nodeId: string): MyceliumNode | null {\n    return this.nodes.get(nodeId) || null;\n  }\n\n  /**\n   * Get network topology\n   */\n  getNetworkTopology(): {\n    nodes: MyceliumNode[];\n    totalConnections: number;\n    averageConnections: number;\n    networkHealth: 'healthy' | 'degraded' | 'fragmented';\n  } {\n    const nodes = Array.from(this.nodes.values());\n    const totalConnections = nodes.reduce((sum, n) => sum + n.connections.length, 0) / 2;\n    const averageConnections = nodes.length > 0 ? totalConnections / nodes.length : 0;\n    const healthyNodes = nodes.filter(n => n.health === 'healthy').length;\n    \n    let networkHealth: 'healthy' | 'degraded' | 'fragmented';\n    if (healthyNodes === nodes.length) {\n      networkHealth = 'healthy';\n    } else if (healthyNodes >= nodes.length * 0.7) {\n      networkHealth = 'degraded';\n    } else {\n      networkHealth = 'fragmented';\n    }\n\n    return {\n      nodes,\n      totalConnections,\n      averageConnections,\n      networkHealth,\n    };\n  }\n\n  /**\n   * Health check all nodes\n   */\n  async checkNetworkHealth(): Promise<void> {\n    for (const [id, node] of this.nodes.entries()) {\n      try {\n        const serviceInfo = this.serviceRegistry.getService(node.serviceName);\n        if (serviceInfo && serviceInfo.health === 'healthy') {\n          node.health = 'healthy';\n        } else {\n          node.health = 'degraded';\n        }\n      } catch (error) {\n        node.health = 'disconnected';\n      }\n    }\n\n    this.emit('network-health-updated', this.getNetworkTopology());\n  }\n\n  /**\n   * Start health monitoring\n   */\n  startHealthMonitoring(intervalMs: number = 30000): void {\n    setInterval(() => {\n      this.checkNetworkHealth();\n    }, intervalMs);\n    \n    // Initial check\n    this.checkNetworkHealth();\n  }\n}\n\n// Export singleton\nexport const myceliumNetwork = new MyceliumNetwork();\n\n// Start health monitoring\nmyceliumNetwork.startHealthMonitoring();\n\nexport default MyceliumNetwork;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}