{"version":3,"names":["cov_28sccmdzdi","actualCoverage","ElaraLogger","ComplianceService","complianceRecords","s","Map","constructor","f","logger","performKYC","userId","data","info","status","b","get","createInitialStatus","firstName","lastName","email","kycStatus","warn","simulateKYCVerification","kycResult","verified","timestamp","Date","method","updatedAt","updateOverallStatus","set","error","performAML","amlStatus","simulateAMLScreening","amlResult","passed","riskLevel","getComplianceStatus","flagForManualReview","reason","overallStatus","approveCompliance","reviewedBy","reviewedAt","rejectCompliance","isCompliant","createdAt","Math","random"],"sources":["compliance.service.ts"],"sourcesContent":["/**\n * Compliance Service\n * \n * Manages KYC/AML verification and compliance status tracking\n */\n\nimport { ElaraLogger } from '../utils/logger';\n\nexport interface KYCData {\n  firstName: string;\n  lastName: string;\n  email: string;\n  dateOfBirth?: string;\n  address?: string;\n  idType?: string;\n  idNumber?: string;\n}\n\nexport interface AMLData {\n  firstName: string;\n  lastName: string;\n  dateOfBirth?: string;\n}\n\nexport interface ComplianceStatus {\n  userId: string;\n  kycStatus: 'pending' | 'verified' | 'failed' | 'manual_review';\n  amlStatus: 'pending' | 'passed' | 'failed' | 'manual_review';\n  overallStatus: 'pending' | 'approved' | 'rejected' | 'manual_review';\n  kycResult?: any;\n  amlResult?: any;\n  reviewedAt?: Date;\n  reviewedBy?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport class ComplianceService {\n  private logger: ElaraLogger;\n  private complianceRecords: Map<string, ComplianceStatus> = new Map();\n\n  constructor() {\n    this.logger = new ElaraLogger('ComplianceService');\n  }\n\n  /**\n   * Perform KYC verification\n   */\n  async performKYC(userId: string, data: KYCData): Promise<ComplianceStatus> {\n    try {\n      this.logger.info(`Performing KYC verification for user: ${userId}`);\n\n      const status = this.complianceRecords.get(userId) || this.createInitialStatus(userId);\n\n      // Validate required fields\n      if (!data.firstName || !data.lastName || !data.email) {\n        status.kycStatus = 'failed';\n        this.logger.warn(`KYC failed for user ${userId}: missing required fields`);\n      } else {\n        // In production, would call third-party KYC service\n        // For now, simulate verification\n        status.kycStatus = this.simulateKYCVerification(data);\n        status.kycResult = {\n          verified: status.kycStatus === 'verified',\n          timestamp: new Date(),\n          method: 'document_verification',\n        };\n      }\n\n      status.updatedAt = new Date();\n      this.updateOverallStatus(status);\n      this.complianceRecords.set(userId, status);\n\n      this.logger.info(`KYC verification completed for user ${userId}: ${status.kycStatus}`);\n      return status;\n    } catch (error) {\n      this.logger.error('Error performing KYC:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Perform AML screening\n   */\n  async performAML(userId: string, data: AMLData): Promise<ComplianceStatus> {\n    try {\n      this.logger.info(`Performing AML screening for user: ${userId}`);\n\n      const status = this.complianceRecords.get(userId) || this.createInitialStatus(userId);\n\n      // Validate required fields\n      if (!data.firstName || !data.lastName) {\n        status.amlStatus = 'failed';\n        this.logger.warn(`AML screening failed for user ${userId}: missing required fields`);\n      } else {\n        // In production, would call third-party AML service\n        // For now, simulate screening\n        status.amlStatus = this.simulateAMLScreening(data);\n        status.amlResult = {\n          passed: status.amlStatus === 'passed',\n          timestamp: new Date(),\n          method: 'sanctions_screening',\n          riskLevel: 'low',\n        };\n      }\n\n      status.updatedAt = new Date();\n      this.updateOverallStatus(status);\n      this.complianceRecords.set(userId, status);\n\n      this.logger.info(`AML screening completed for user ${userId}: ${status.amlStatus}`);\n      return status;\n    } catch (error) {\n      this.logger.error('Error performing AML screening:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get compliance status\n   */\n  async getComplianceStatus(userId: string): Promise<ComplianceStatus | null> {\n    try {\n      this.logger.info(`Getting compliance status for user: ${userId}`);\n      return this.complianceRecords.get(userId) || null;\n    } catch (error) {\n      this.logger.error('Error getting compliance status:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Flag for manual review\n   */\n  async flagForManualReview(userId: string, reason: string): Promise<ComplianceStatus> {\n    try {\n      this.logger.info(`Flagging user ${userId} for manual review: ${reason}`);\n\n      const status = this.complianceRecords.get(userId) || this.createInitialStatus(userId);\n\n      if (status.kycStatus !== 'verified') {\n        status.kycStatus = 'manual_review';\n      }\n      if (status.amlStatus !== 'passed') {\n        status.amlStatus = 'manual_review';\n      }\n\n      status.overallStatus = 'manual_review';\n      status.updatedAt = new Date();\n\n      this.complianceRecords.set(userId, status);\n      this.logger.info(`User ${userId} flagged for manual review`);\n\n      return status;\n    } catch (error) {\n      this.logger.error('Error flagging for manual review:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Approve compliance\n   */\n  async approveCompliance(userId: string, reviewedBy: string): Promise<ComplianceStatus> {\n    try {\n      this.logger.info(`Approving compliance for user: ${userId}`);\n\n      const status = this.complianceRecords.get(userId) || this.createInitialStatus(userId);\n\n      status.kycStatus = 'verified';\n      status.amlStatus = 'passed';\n      status.overallStatus = 'approved';\n      status.reviewedAt = new Date();\n      status.reviewedBy = reviewedBy;\n      status.updatedAt = new Date();\n\n      this.complianceRecords.set(userId, status);\n      this.logger.info(`Compliance approved for user ${userId}`);\n\n      return status;\n    } catch (error) {\n      this.logger.error('Error approving compliance:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Reject compliance\n   */\n  async rejectCompliance(userId: string, reason: string, reviewedBy: string): Promise<ComplianceStatus> {\n    try {\n      this.logger.info(`Rejecting compliance for user: ${userId}, reason: ${reason}`);\n\n      const status = this.complianceRecords.get(userId) || this.createInitialStatus(userId);\n\n      status.kycStatus = 'failed';\n      status.amlStatus = 'failed';\n      status.overallStatus = 'rejected';\n      status.reviewedAt = new Date();\n      status.reviewedBy = reviewedBy;\n      status.updatedAt = new Date();\n\n      this.complianceRecords.set(userId, status);\n      this.logger.info(`Compliance rejected for user ${userId}`);\n\n      return status;\n    } catch (error) {\n      this.logger.error('Error rejecting compliance:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Check if user is compliant\n   */\n  async isCompliant(userId: string): Promise<boolean> {\n    try {\n      const status = await this.getComplianceStatus(userId);\n      return status?.overallStatus === 'approved' || false;\n    } catch (error) {\n      this.logger.error('Error checking compliance:', error);\n      throw error;\n    }\n  }\n\n  // Private helper methods\n\n  private createInitialStatus(userId: string): ComplianceStatus {\n    return {\n      userId,\n      kycStatus: 'pending',\n      amlStatus: 'pending',\n      overallStatus: 'pending',\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n  }\n\n  private simulateKYCVerification(data: KYCData): 'verified' | 'failed' | 'manual_review' {\n    // Simulate KYC verification\n    // In production, would call actual KYC service\n    if (!data.firstName || !data.lastName) {\n      return 'failed';\n    }\n    // 90% pass rate for demo\n    return Math.random() > 0.1 ? 'verified' : 'manual_review';\n  }\n\n  private simulateAMLScreening(data: AMLData): 'passed' | 'failed' | 'manual_review' {\n    // Simulate AML screening\n    // In production, would call actual AML service\n    if (!data.firstName || !data.lastName) {\n      return 'failed';\n    }\n    // 95% pass rate for demo\n    return Math.random() > 0.05 ? 'passed' : 'manual_review';\n  }\n\n  private updateOverallStatus(status: ComplianceStatus): void {\n    if (status.kycStatus === 'failed' || status.amlStatus === 'failed') {\n      status.overallStatus = 'rejected';\n    } else if (status.kycStatus === 'manual_review' || status.amlStatus === 'manual_review') {\n      status.overallStatus = 'manual_review';\n    } else if (status.kycStatus === 'verified' && status.amlStatus === 'passed') {\n      status.overallStatus = 'approved';\n    } else {\n      status.overallStatus = 'pending';\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ;AACA;AACA;AACA;AACA;;AAEA,SAASE,WAAW,QAAQ,iBAAiB;AA+B7C,OAAO,MAAMC,iBAAiB,CAAC;EAErBC,iBAAiB;EAAA;EAAA,CAAAJ,cAAA,GAAAK,CAAA,OAAkC,IAAIC,GAAG,CAAC,CAAC;EAEpEC,WAAWA,CAAA,EAAG;IAAA;IAAAP,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IACZ,IAAI,CAACI,MAAM,GAAG,IAAIP,WAAW,CAAC,mBAAmB,CAAC;EACpD;;EAEA;AACF;AACA;EACE,MAAMQ,UAAUA,CAACC,MAAc,EAAEC,IAAa,EAA6B;IAAA;IAAAZ,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IACzE,IAAI;MAAA;MAAAL,cAAA,GAAAK,CAAA;MACF,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,yCAAyCF,MAAM,EAAE,CAAC;MAEnE,MAAMG,MAAM;MAAA;MAAA,CAAAd,cAAA,GAAAK,CAAA;MAAG;MAAA,CAAAL,cAAA,GAAAe,CAAA,cAAI,CAACX,iBAAiB,CAACY,GAAG,CAACL,MAAM,CAAC;MAAA;MAAA,CAAAX,cAAA,GAAAe,CAAA,UAAI,IAAI,CAACE,mBAAmB,CAACN,MAAM,CAAC;;MAErF;MAAA;MAAAX,cAAA,GAAAK,CAAA;MACA;MAAI;MAAA,CAAAL,cAAA,GAAAe,CAAA,WAACH,IAAI,CAACM,SAAS;MAAA;MAAA,CAAAlB,cAAA,GAAAe,CAAA,UAAI,CAACH,IAAI,CAACO,QAAQ;MAAA;MAAA,CAAAnB,cAAA,GAAAe,CAAA,UAAI,CAACH,IAAI,CAACQ,KAAK,GAAE;QAAA;QAAApB,cAAA,GAAAe,CAAA;QAAAf,cAAA,GAAAK,CAAA;QACpDS,MAAM,CAACO,SAAS,GAAG,QAAQ;QAAC;QAAArB,cAAA,GAAAK,CAAA;QAC5B,IAAI,CAACI,MAAM,CAACa,IAAI,CAAC,uBAAuBX,MAAM,2BAA2B,CAAC;MAC5E,CAAC,MAAM;QAAA;QAAAX,cAAA,GAAAe,CAAA;QAAAf,cAAA,GAAAK,CAAA;QACL;QACA;QACAS,MAAM,CAACO,SAAS,GAAG,IAAI,CAACE,uBAAuB,CAACX,IAAI,CAAC;QAAC;QAAAZ,cAAA,GAAAK,CAAA;QACtDS,MAAM,CAACU,SAAS,GAAG;UACjBC,QAAQ,EAAEX,MAAM,CAACO,SAAS,KAAK,UAAU;UACzCK,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;UACrBC,MAAM,EAAE;QACV,CAAC;MACH;MAAC;MAAA5B,cAAA,GAAAK,CAAA;MAEDS,MAAM,CAACe,SAAS,GAAG,IAAIF,IAAI,CAAC,CAAC;MAAC;MAAA3B,cAAA,GAAAK,CAAA;MAC9B,IAAI,CAACyB,mBAAmB,CAAChB,MAAM,CAAC;MAAC;MAAAd,cAAA,GAAAK,CAAA;MACjC,IAAI,CAACD,iBAAiB,CAAC2B,GAAG,CAACpB,MAAM,EAAEG,MAAM,CAAC;MAAC;MAAAd,cAAA,GAAAK,CAAA;MAE3C,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,uCAAuCF,MAAM,KAAKG,MAAM,CAACO,SAAS,EAAE,CAAC;MAAC;MAAArB,cAAA,GAAAK,CAAA;MACvF,OAAOS,MAAM;IACf,CAAC,CAAC,OAAOkB,KAAK,EAAE;MAAA;MAAAhC,cAAA,GAAAK,CAAA;MACd,IAAI,CAACI,MAAM,CAACuB,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAAC;MAAAhC,cAAA,GAAAK,CAAA;MAClD,MAAM2B,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMC,UAAUA,CAACtB,MAAc,EAAEC,IAAa,EAA6B;IAAA;IAAAZ,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IACzE,IAAI;MAAA;MAAAL,cAAA,GAAAK,CAAA;MACF,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,sCAAsCF,MAAM,EAAE,CAAC;MAEhE,MAAMG,MAAM;MAAA;MAAA,CAAAd,cAAA,GAAAK,CAAA;MAAG;MAAA,CAAAL,cAAA,GAAAe,CAAA,cAAI,CAACX,iBAAiB,CAACY,GAAG,CAACL,MAAM,CAAC;MAAA;MAAA,CAAAX,cAAA,GAAAe,CAAA,UAAI,IAAI,CAACE,mBAAmB,CAACN,MAAM,CAAC;;MAErF;MAAA;MAAAX,cAAA,GAAAK,CAAA;MACA;MAAI;MAAA,CAAAL,cAAA,GAAAe,CAAA,WAACH,IAAI,CAACM,SAAS;MAAA;MAAA,CAAAlB,cAAA,GAAAe,CAAA,UAAI,CAACH,IAAI,CAACO,QAAQ,GAAE;QAAA;QAAAnB,cAAA,GAAAe,CAAA;QAAAf,cAAA,GAAAK,CAAA;QACrCS,MAAM,CAACoB,SAAS,GAAG,QAAQ;QAAC;QAAAlC,cAAA,GAAAK,CAAA;QAC5B,IAAI,CAACI,MAAM,CAACa,IAAI,CAAC,iCAAiCX,MAAM,2BAA2B,CAAC;MACtF,CAAC,MAAM;QAAA;QAAAX,cAAA,GAAAe,CAAA;QAAAf,cAAA,GAAAK,CAAA;QACL;QACA;QACAS,MAAM,CAACoB,SAAS,GAAG,IAAI,CAACC,oBAAoB,CAACvB,IAAI,CAAC;QAAC;QAAAZ,cAAA,GAAAK,CAAA;QACnDS,MAAM,CAACsB,SAAS,GAAG;UACjBC,MAAM,EAAEvB,MAAM,CAACoB,SAAS,KAAK,QAAQ;UACrCR,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC;UACrBC,MAAM,EAAE,qBAAqB;UAC7BU,SAAS,EAAE;QACb,CAAC;MACH;MAAC;MAAAtC,cAAA,GAAAK,CAAA;MAEDS,MAAM,CAACe,SAAS,GAAG,IAAIF,IAAI,CAAC,CAAC;MAAC;MAAA3B,cAAA,GAAAK,CAAA;MAC9B,IAAI,CAACyB,mBAAmB,CAAChB,MAAM,CAAC;MAAC;MAAAd,cAAA,GAAAK,CAAA;MACjC,IAAI,CAACD,iBAAiB,CAAC2B,GAAG,CAACpB,MAAM,EAAEG,MAAM,CAAC;MAAC;MAAAd,cAAA,GAAAK,CAAA;MAE3C,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,oCAAoCF,MAAM,KAAKG,MAAM,CAACoB,SAAS,EAAE,CAAC;MAAC;MAAAlC,cAAA,GAAAK,CAAA;MACpF,OAAOS,MAAM;IACf,CAAC,CAAC,OAAOkB,KAAK,EAAE;MAAA;MAAAhC,cAAA,GAAAK,CAAA;MACd,IAAI,CAACI,MAAM,CAACuB,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;MAAC;MAAAhC,cAAA,GAAAK,CAAA;MAC5D,MAAM2B,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMO,mBAAmBA,CAAC5B,MAAc,EAAoC;IAAA;IAAAX,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IAC1E,IAAI;MAAA;MAAAL,cAAA,GAAAK,CAAA;MACF,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,uCAAuCF,MAAM,EAAE,CAAC;MAAC;MAAAX,cAAA,GAAAK,CAAA;MAClE,OAAO,2BAAAL,cAAA,GAAAe,CAAA,cAAI,CAACX,iBAAiB,CAACY,GAAG,CAACL,MAAM,CAAC;MAAA;MAAA,CAAAX,cAAA,GAAAe,CAAA,UAAI,IAAI;IACnD,CAAC,CAAC,OAAOiB,KAAK,EAAE;MAAA;MAAAhC,cAAA,GAAAK,CAAA;MACd,IAAI,CAACI,MAAM,CAACuB,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;MAAC;MAAAhC,cAAA,GAAAK,CAAA;MAC7D,MAAM2B,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMQ,mBAAmBA,CAAC7B,MAAc,EAAE8B,MAAc,EAA6B;IAAA;IAAAzC,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IACnF,IAAI;MAAA;MAAAL,cAAA,GAAAK,CAAA;MACF,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,iBAAiBF,MAAM,uBAAuB8B,MAAM,EAAE,CAAC;MAExE,MAAM3B,MAAM;MAAA;MAAA,CAAAd,cAAA,GAAAK,CAAA;MAAG;MAAA,CAAAL,cAAA,GAAAe,CAAA,cAAI,CAACX,iBAAiB,CAACY,GAAG,CAACL,MAAM,CAAC;MAAA;MAAA,CAAAX,cAAA,GAAAe,CAAA,UAAI,IAAI,CAACE,mBAAmB,CAACN,MAAM,CAAC;MAAC;MAAAX,cAAA,GAAAK,CAAA;MAEtF,IAAIS,MAAM,CAACO,SAAS,KAAK,UAAU,EAAE;QAAA;QAAArB,cAAA,GAAAe,CAAA;QAAAf,cAAA,GAAAK,CAAA;QACnCS,MAAM,CAACO,SAAS,GAAG,eAAe;MACpC,CAAC;MAAA;MAAA;QAAArB,cAAA,GAAAe,CAAA;MAAA;MAAAf,cAAA,GAAAK,CAAA;MACD,IAAIS,MAAM,CAACoB,SAAS,KAAK,QAAQ,EAAE;QAAA;QAAAlC,cAAA,GAAAe,CAAA;QAAAf,cAAA,GAAAK,CAAA;QACjCS,MAAM,CAACoB,SAAS,GAAG,eAAe;MACpC,CAAC;MAAA;MAAA;QAAAlC,cAAA,GAAAe,CAAA;MAAA;MAAAf,cAAA,GAAAK,CAAA;MAEDS,MAAM,CAAC4B,aAAa,GAAG,eAAe;MAAC;MAAA1C,cAAA,GAAAK,CAAA;MACvCS,MAAM,CAACe,SAAS,GAAG,IAAIF,IAAI,CAAC,CAAC;MAAC;MAAA3B,cAAA,GAAAK,CAAA;MAE9B,IAAI,CAACD,iBAAiB,CAAC2B,GAAG,CAACpB,MAAM,EAAEG,MAAM,CAAC;MAAC;MAAAd,cAAA,GAAAK,CAAA;MAC3C,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,QAAQF,MAAM,4BAA4B,CAAC;MAAC;MAAAX,cAAA,GAAAK,CAAA;MAE7D,OAAOS,MAAM;IACf,CAAC,CAAC,OAAOkB,KAAK,EAAE;MAAA;MAAAhC,cAAA,GAAAK,CAAA;MACd,IAAI,CAACI,MAAM,CAACuB,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;MAAC;MAAAhC,cAAA,GAAAK,CAAA;MAC9D,MAAM2B,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMW,iBAAiBA,CAAChC,MAAc,EAAEiC,UAAkB,EAA6B;IAAA;IAAA5C,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IACrF,IAAI;MAAA;MAAAL,cAAA,GAAAK,CAAA;MACF,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,kCAAkCF,MAAM,EAAE,CAAC;MAE5D,MAAMG,MAAM;MAAA;MAAA,CAAAd,cAAA,GAAAK,CAAA;MAAG;MAAA,CAAAL,cAAA,GAAAe,CAAA,eAAI,CAACX,iBAAiB,CAACY,GAAG,CAACL,MAAM,CAAC;MAAA;MAAA,CAAAX,cAAA,GAAAe,CAAA,WAAI,IAAI,CAACE,mBAAmB,CAACN,MAAM,CAAC;MAAC;MAAAX,cAAA,GAAAK,CAAA;MAEtFS,MAAM,CAACO,SAAS,GAAG,UAAU;MAAC;MAAArB,cAAA,GAAAK,CAAA;MAC9BS,MAAM,CAACoB,SAAS,GAAG,QAAQ;MAAC;MAAAlC,cAAA,GAAAK,CAAA;MAC5BS,MAAM,CAAC4B,aAAa,GAAG,UAAU;MAAC;MAAA1C,cAAA,GAAAK,CAAA;MAClCS,MAAM,CAAC+B,UAAU,GAAG,IAAIlB,IAAI,CAAC,CAAC;MAAC;MAAA3B,cAAA,GAAAK,CAAA;MAC/BS,MAAM,CAAC8B,UAAU,GAAGA,UAAU;MAAC;MAAA5C,cAAA,GAAAK,CAAA;MAC/BS,MAAM,CAACe,SAAS,GAAG,IAAIF,IAAI,CAAC,CAAC;MAAC;MAAA3B,cAAA,GAAAK,CAAA;MAE9B,IAAI,CAACD,iBAAiB,CAAC2B,GAAG,CAACpB,MAAM,EAAEG,MAAM,CAAC;MAAC;MAAAd,cAAA,GAAAK,CAAA;MAC3C,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,gCAAgCF,MAAM,EAAE,CAAC;MAAC;MAAAX,cAAA,GAAAK,CAAA;MAE3D,OAAOS,MAAM;IACf,CAAC,CAAC,OAAOkB,KAAK,EAAE;MAAA;MAAAhC,cAAA,GAAAK,CAAA;MACd,IAAI,CAACI,MAAM,CAACuB,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MAAC;MAAAhC,cAAA,GAAAK,CAAA;MACxD,MAAM2B,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMc,gBAAgBA,CAACnC,MAAc,EAAE8B,MAAc,EAAEG,UAAkB,EAA6B;IAAA;IAAA5C,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IACpG,IAAI;MAAA;MAAAL,cAAA,GAAAK,CAAA;MACF,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,kCAAkCF,MAAM,aAAa8B,MAAM,EAAE,CAAC;MAE/E,MAAM3B,MAAM;MAAA;MAAA,CAAAd,cAAA,GAAAK,CAAA;MAAG;MAAA,CAAAL,cAAA,GAAAe,CAAA,eAAI,CAACX,iBAAiB,CAACY,GAAG,CAACL,MAAM,CAAC;MAAA;MAAA,CAAAX,cAAA,GAAAe,CAAA,WAAI,IAAI,CAACE,mBAAmB,CAACN,MAAM,CAAC;MAAC;MAAAX,cAAA,GAAAK,CAAA;MAEtFS,MAAM,CAACO,SAAS,GAAG,QAAQ;MAAC;MAAArB,cAAA,GAAAK,CAAA;MAC5BS,MAAM,CAACoB,SAAS,GAAG,QAAQ;MAAC;MAAAlC,cAAA,GAAAK,CAAA;MAC5BS,MAAM,CAAC4B,aAAa,GAAG,UAAU;MAAC;MAAA1C,cAAA,GAAAK,CAAA;MAClCS,MAAM,CAAC+B,UAAU,GAAG,IAAIlB,IAAI,CAAC,CAAC;MAAC;MAAA3B,cAAA,GAAAK,CAAA;MAC/BS,MAAM,CAAC8B,UAAU,GAAGA,UAAU;MAAC;MAAA5C,cAAA,GAAAK,CAAA;MAC/BS,MAAM,CAACe,SAAS,GAAG,IAAIF,IAAI,CAAC,CAAC;MAAC;MAAA3B,cAAA,GAAAK,CAAA;MAE9B,IAAI,CAACD,iBAAiB,CAAC2B,GAAG,CAACpB,MAAM,EAAEG,MAAM,CAAC;MAAC;MAAAd,cAAA,GAAAK,CAAA;MAC3C,IAAI,CAACI,MAAM,CAACI,IAAI,CAAC,gCAAgCF,MAAM,EAAE,CAAC;MAAC;MAAAX,cAAA,GAAAK,CAAA;MAE3D,OAAOS,MAAM;IACf,CAAC,CAAC,OAAOkB,KAAK,EAAE;MAAA;MAAAhC,cAAA,GAAAK,CAAA;MACd,IAAI,CAACI,MAAM,CAACuB,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MAAC;MAAAhC,cAAA,GAAAK,CAAA;MACxD,MAAM2B,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,MAAMe,WAAWA,CAACpC,MAAc,EAAoB;IAAA;IAAAX,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IAClD,IAAI;MACF,MAAMS,MAAM;MAAA;MAAA,CAAAd,cAAA,GAAAK,CAAA,QAAG,MAAM,IAAI,CAACkC,mBAAmB,CAAC5B,MAAM,CAAC;MAAC;MAAAX,cAAA,GAAAK,CAAA;MACtD,OAAO,2BAAAL,cAAA,GAAAe,CAAA,WAAAD,MAAM,EAAE4B,aAAa,KAAK,UAAU;MAAA;MAAA,CAAA1C,cAAA,GAAAe,CAAA,WAAI,KAAK;IACtD,CAAC,CAAC,OAAOiB,KAAK,EAAE;MAAA;MAAAhC,cAAA,GAAAK,CAAA;MACd,IAAI,CAACI,MAAM,CAACuB,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAAC;MAAAhC,cAAA,GAAAK,CAAA;MACvD,MAAM2B,KAAK;IACb;EACF;;EAEA;;EAEQf,mBAAmBA,CAACN,MAAc,EAAoB;IAAA;IAAAX,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IAC5D,OAAO;MACLM,MAAM;MACNU,SAAS,EAAE,SAAS;MACpBa,SAAS,EAAE,SAAS;MACpBQ,aAAa,EAAE,SAAS;MACxBM,SAAS,EAAE,IAAIrB,IAAI,CAAC,CAAC;MACrBE,SAAS,EAAE,IAAIF,IAAI,CAAC;IACtB,CAAC;EACH;EAEQJ,uBAAuBA,CAACX,IAAa,EAA2C;IAAA;IAAAZ,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IACtF;IACA;IACA;IAAI;IAAA,CAAAL,cAAA,GAAAe,CAAA,YAACH,IAAI,CAACM,SAAS;IAAA;IAAA,CAAAlB,cAAA,GAAAe,CAAA,WAAI,CAACH,IAAI,CAACO,QAAQ,GAAE;MAAA;MAAAnB,cAAA,GAAAe,CAAA;MAAAf,cAAA,GAAAK,CAAA;MACrC,OAAO,QAAQ;IACjB,CAAC;IAAA;IAAA;MAAAL,cAAA,GAAAe,CAAA;IAAA;IACD;IAAAf,cAAA,GAAAK,CAAA;IACA,OAAO4C,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,GAAG;IAAA;IAAA,CAAAlD,cAAA,GAAAe,CAAA,WAAG,UAAU;IAAA;IAAA,CAAAf,cAAA,GAAAe,CAAA,WAAG,eAAe;EAC3D;EAEQoB,oBAAoBA,CAACvB,IAAa,EAAyC;IAAA;IAAAZ,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IACjF;IACA;IACA;IAAI;IAAA,CAAAL,cAAA,GAAAe,CAAA,YAACH,IAAI,CAACM,SAAS;IAAA;IAAA,CAAAlB,cAAA,GAAAe,CAAA,WAAI,CAACH,IAAI,CAACO,QAAQ,GAAE;MAAA;MAAAnB,cAAA,GAAAe,CAAA;MAAAf,cAAA,GAAAK,CAAA;MACrC,OAAO,QAAQ;IACjB,CAAC;IAAA;IAAA;MAAAL,cAAA,GAAAe,CAAA;IAAA;IACD;IAAAf,cAAA,GAAAK,CAAA;IACA,OAAO4C,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,IAAI;IAAA;IAAA,CAAAlD,cAAA,GAAAe,CAAA,WAAG,QAAQ;IAAA;IAAA,CAAAf,cAAA,GAAAe,CAAA,WAAG,eAAe;EAC1D;EAEQe,mBAAmBA,CAAChB,MAAwB,EAAQ;IAAA;IAAAd,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAK,CAAA;IAC1D;IAAI;IAAA,CAAAL,cAAA,GAAAe,CAAA,WAAAD,MAAM,CAACO,SAAS,KAAK,QAAQ;IAAA;IAAA,CAAArB,cAAA,GAAAe,CAAA,WAAID,MAAM,CAACoB,SAAS,KAAK,QAAQ,GAAE;MAAA;MAAAlC,cAAA,GAAAe,CAAA;MAAAf,cAAA,GAAAK,CAAA;MAClES,MAAM,CAAC4B,aAAa,GAAG,UAAU;IACnC,CAAC,MAAM;MAAA;MAAA1C,cAAA,GAAAe,CAAA;MAAAf,cAAA,GAAAK,CAAA;MAAA;MAAI;MAAA,CAAAL,cAAA,GAAAe,CAAA,WAAAD,MAAM,CAACO,SAAS,KAAK,eAAe;MAAA;MAAA,CAAArB,cAAA,GAAAe,CAAA,WAAID,MAAM,CAACoB,SAAS,KAAK,eAAe,GAAE;QAAA;QAAAlC,cAAA,GAAAe,CAAA;QAAAf,cAAA,GAAAK,CAAA;QACvFS,MAAM,CAAC4B,aAAa,GAAG,eAAe;MACxC,CAAC,MAAM;QAAA;QAAA1C,cAAA,GAAAe,CAAA;QAAAf,cAAA,GAAAK,CAAA;QAAA;QAAI;QAAA,CAAAL,cAAA,GAAAe,CAAA,WAAAD,MAAM,CAACO,SAAS,KAAK,UAAU;QAAA;QAAA,CAAArB,cAAA,GAAAe,CAAA,WAAID,MAAM,CAACoB,SAAS,KAAK,QAAQ,GAAE;UAAA;UAAAlC,cAAA,GAAAe,CAAA;UAAAf,cAAA,GAAAK,CAAA;UAC3ES,MAAM,CAAC4B,aAAa,GAAG,UAAU;QACnC,CAAC,MAAM;UAAA;UAAA1C,cAAA,GAAAe,CAAA;UAAAf,cAAA,GAAAK,CAAA;UACLS,MAAM,CAAC4B,aAAa,GAAG,SAAS;QAClC;MAAA;IAAA;EACF;AACF","ignoreList":[]}