ffa3809434709a743841d1f703af56d1
/* istanbul ignore next */
function cov_25gu1o0342() {
  var path = "/workspaces/azora/services/ai-family-service/research-collaboration-protocol.ts";
  var hash = "18e66018c6461044d66ee502e96a5cb07cbded72";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/ai-family-service/research-collaboration-protocol.ts",
    statementMap: {
      "0": {
        start: {
          line: 29,
          column: 49
        },
        end: {
          line: 29,
          column: 51
        }
      },
      "1": {
        start: {
          line: 30,
          column: 57
        },
        end: {
          line: 30,
          column: 66
        }
      },
      "2": {
        start: {
          line: 33,
          column: 4
        },
        end: {
          line: 33,
          column: 36
        }
      },
      "3": {
        start: {
          line: 35,
          column: 4
        },
        end: {
          line: 39,
          column: 5
        }
      },
      "4": {
        start: {
          line: 36,
          column: 6
        },
        end: {
          line: 36,
          column: 41
        }
      },
      "5": {
        start: {
          line: 37,
          column: 11
        },
        end: {
          line: 39,
          column: 5
        }
      },
      "6": {
        start: {
          line: 38,
          column: 6
        },
        end: {
          line: 38,
          column: 37
        }
      },
      "7": {
        start: {
          line: 43,
          column: 19
        },
        end: {
          line: 43,
          column: 122
        }
      },
      "8": {
        start: {
          line: 45,
          column: 4
        },
        end: {
          line: 49,
          column: 5
        }
      },
      "9": {
        start: {
          line: 46,
          column: 6
        },
        end: {
          line: 48,
          column: 7
        }
      },
      "10": {
        start: {
          line: 47,
          column: 8
        },
        end: {
          line: 47,
          column: 47
        }
      },
      "11": {
        start: {
          line: 53,
          column: 4
        },
        end: {
          line: 55,
          column: 5
        }
      },
      "12": {
        start: {
          line: 54,
          column: 6
        },
        end: {
          line: 54,
          column: 50
        }
      },
      "13": {
        start: {
          line: 60,
          column: 4
        },
        end: {
          line: 60,
          column: 77
        }
      },
      "14": {
        start: {
          line: 64,
          column: 4
        },
        end: {
          line: 64,
          column: 45
        }
      },
      "15": {
        start: {
          line: 68,
          column: 4
        },
        end: {
          line: 68,
          column: 41
        }
      },
      "16": {
        start: {
          line: 72,
          column: 17
        },
        end: {
          line: 72,
          column: 46
        }
      },
      "17": {
        start: {
          line: 73,
          column: 4
        },
        end: {
          line: 78,
          column: 5
        }
      },
      "18": {
        start: {
          line: 74,
          column: 22
        },
        end: {
          line: 74,
          column: 67
        }
      },
      "19": {
        start: {
          line: 74,
          column: 47
        },
        end: {
          line: 74,
          column: 66
        }
      },
      "20": {
        start: {
          line: 75,
          column: 6
        },
        end: {
          line: 77,
          column: 7
        }
      },
      "21": {
        start: {
          line: 76,
          column: 8
        },
        end: {
          line: 76,
          column: 32
        }
      },
      "22": {
        start: {
          line: 82,
          column: 19
        },
        end: {
          line: 82,
          column: 36
        }
      },
      "23": {
        start: {
          line: 84,
          column: 4
        },
        end: {
          line: 86,
          column: 5
        }
      },
      "24": {
        start: {
          line: 85,
          column: 6
        },
        end: {
          line: 85,
          column: 100
        }
      },
      "25": {
        start: {
          line: 85,
          column: 38
        },
        end: {
          line: 85,
          column: 98
        }
      },
      "26": {
        start: {
          line: 88,
          column: 4
        },
        end: {
          line: 88,
          column: 34
        }
      },
      "27": {
        start: {
          line: 92,
          column: 4
        },
        end: {
          line: 92,
          column: 27
        }
      },
      "28": {
        start: {
          line: 96,
          column: 37
        },
        end: {
          line: 96,
          column: 72
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 32,
            column: 2
          },
          end: {
            line: 32,
            column: 3
          }
        },
        loc: {
          start: {
            line: 32,
            column: 67
          },
          end: {
            line: 40,
            column: 3
          }
        },
        line: 32
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 42,
            column: 2
          },
          end: {
            line: 42,
            column: 3
          }
        },
        loc: {
          start: {
            line: 42,
            column: 69
          },
          end: {
            line: 50,
            column: 3
          }
        },
        line: 42
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 52,
            column: 2
          },
          end: {
            line: 52,
            column: 3
          }
        },
        loc: {
          start: {
            line: 52,
            column: 65
          },
          end: {
            line: 56,
            column: 3
          }
        },
        line: 52
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 58,
            column: 2
          },
          end: {
            line: 58,
            column: 3
          }
        },
        loc: {
          start: {
            line: 58,
            column: 89
          },
          end: {
            line: 61,
            column: 3
          }
        },
        line: 58
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 63,
            column: 2
          },
          end: {
            line: 63,
            column: 3
          }
        },
        loc: {
          start: {
            line: 63,
            column: 46
          },
          end: {
            line: 65,
            column: 3
          }
        },
        line: 63
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 67,
            column: 2
          },
          end: {
            line: 67,
            column: 3
          }
        },
        loc: {
          start: {
            line: 67,
            column: 57
          },
          end: {
            line: 69,
            column: 3
          }
        },
        line: 67
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 71,
            column: 2
          },
          end: {
            line: 71,
            column: 3
          }
        },
        loc: {
          start: {
            line: 71,
            column: 90
          },
          end: {
            line: 79,
            column: 3
          }
        },
        line: 71
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 74,
            column: 41
          },
          end: {
            line: 74,
            column: 42
          }
        },
        loc: {
          start: {
            line: 74,
            column: 47
          },
          end: {
            line: 74,
            column: 66
          }
        },
        line: 74
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 81,
            column: 2
          },
          end: {
            line: 81,
            column: 3
          }
        },
        loc: {
          start: {
            line: 81,
            column: 80
          },
          end: {
            line: 89,
            column: 3
          }
        },
        line: 81
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 85,
            column: 33
          },
          end: {
            line: 85,
            column: 34
          }
        },
        loc: {
          start: {
            line: 85,
            column: 38
          },
          end: {
            line: 85,
            column: 98
          }
        },
        line: 85
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 91,
            column: 2
          },
          end: {
            line: 91,
            column: 3
          }
        },
        loc: {
          start: {
            line: 91,
            column: 23
          },
          end: {
            line: 93,
            column: 3
          }
        },
        line: 91
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 35,
            column: 4
          },
          end: {
            line: 39,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 35,
            column: 4
          },
          end: {
            line: 39,
            column: 5
          }
        }, {
          start: {
            line: 37,
            column: 11
          },
          end: {
            line: 39,
            column: 5
          }
        }],
        line: 35
      },
      "1": {
        loc: {
          start: {
            line: 37,
            column: 11
          },
          end: {
            line: 39,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 37,
            column: 11
          },
          end: {
            line: 39,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 37
      },
      "2": {
        loc: {
          start: {
            line: 37,
            column: 15
          },
          end: {
            line: 37,
            column: 54
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 37,
            column: 15
          },
          end: {
            line: 37,
            column: 40
          }
        }, {
          start: {
            line: 37,
            column: 44
          },
          end: {
            line: 37,
            column: 54
          }
        }],
        line: 37
      },
      "3": {
        loc: {
          start: {
            line: 46,
            column: 6
          },
          end: {
            line: 48,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 46,
            column: 6
          },
          end: {
            line: 48,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 46
      },
      "4": {
        loc: {
          start: {
            line: 53,
            column: 4
          },
          end: {
            line: 55,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 53,
            column: 4
          },
          end: {
            line: 55,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 53
      },
      "5": {
        loc: {
          start: {
            line: 73,
            column: 4
          },
          end: {
            line: 78,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 73,
            column: 4
          },
          end: {
            line: 78,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 73
      },
      "6": {
        loc: {
          start: {
            line: 75,
            column: 6
          },
          end: {
            line: 77,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 75,
            column: 6
          },
          end: {
            line: 77,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 75
      },
      "7": {
        loc: {
          start: {
            line: 81,
            column: 36
          },
          end: {
            line: 81,
            column: 54
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 81,
            column: 52
          },
          end: {
            line: 81,
            column: 54
          }
        }],
        line: 81
      },
      "8": {
        loc: {
          start: {
            line: 84,
            column: 4
          },
          end: {
            line: 86,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 84,
            column: 4
          },
          end: {
            line: 86,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 84
      },
      "9": {
        loc: {
          start: {
            line: 85,
            column: 38
          },
          end: {
            line: 85,
            column: 98
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 85,
            column: 38
          },
          end: {
            line: 85,
            column: 54
          }
        }, {
          start: {
            line: 85,
            column: 58
          },
          end: {
            line: 85,
            column: 72
          }
        }, {
          start: {
            line: 85,
            column: 76
          },
          end: {
            line: 85,
            column: 98
          }
        }],
        line: 85
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0],
      "8": [0, 0],
      "9": [0, 0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "18e66018c6461044d66ee502e96a5cb07cbded72"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_25gu1o0342 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_25gu1o0342();
export class ResearchCollaborationProtocol {
  messageQueue =
  /* istanbul ignore next */
  (cov_25gu1o0342().s[0]++, []);
  taskRegistry =
  /* istanbul ignore next */
  (cov_25gu1o0342().s[1]++, new Map());
  async routeMessage(message) {
    /* istanbul ignore next */
    cov_25gu1o0342().f[0]++;
    cov_25gu1o0342().s[2]++;
    this.messageQueue.push(message);
    /* istanbul ignore next */
    cov_25gu1o0342().s[3]++;
    if (message.type === 'broadcast') {
      /* istanbul ignore next */
      cov_25gu1o0342().b[0][0]++;
      cov_25gu1o0342().s[4]++;
      await this.broadcastToAll(message);
    } else {
      /* istanbul ignore next */
      cov_25gu1o0342().b[0][1]++;
      cov_25gu1o0342().s[5]++;
      if (
      /* istanbul ignore next */
      (cov_25gu1o0342().b[2][0]++, message.type === 'direct') &&
      /* istanbul ignore next */
      (cov_25gu1o0342().b[2][1]++, message.to)) {
        /* istanbul ignore next */
        cov_25gu1o0342().b[1][0]++;
        cov_25gu1o0342().s[6]++;
        await this.sendDirect(message);
      } else
      /* istanbul ignore next */
      {
        cov_25gu1o0342().b[1][1]++;
      }
    }
  }
  async broadcastToAll(message) {
    /* istanbul ignore next */
    cov_25gu1o0342().f[1]++;
    const agents =
    /* istanbul ignore next */
    (cov_25gu1o0342().s[7]++, ['elara', 'sankofa', 'themba', 'naledi', 'jabari', 'amara', 'kofi', 'zola', 'abeni', 'thembo', 'nexus']);
    /* istanbul ignore next */
    cov_25gu1o0342().s[8]++;
    for (const agent of agents) {
      /* istanbul ignore next */
      cov_25gu1o0342().s[9]++;
      if (agent !== message.from) {
        /* istanbul ignore next */
        cov_25gu1o0342().b[3][0]++;
        cov_25gu1o0342().s[10]++;
        await this.notifyAgent(agent, message);
      } else
      /* istanbul ignore next */
      {
        cov_25gu1o0342().b[3][1]++;
      }
    }
  }
  async sendDirect(message) {
    /* istanbul ignore next */
    cov_25gu1o0342().f[2]++;
    cov_25gu1o0342().s[11]++;
    if (message.to) {
      /* istanbul ignore next */
      cov_25gu1o0342().b[4][0]++;
      cov_25gu1o0342().s[12]++;
      await this.notifyAgent(message.to, message);
    } else
    /* istanbul ignore next */
    {
      cov_25gu1o0342().b[4][1]++;
    }
  }
  async notifyAgent(agent, message) {
    /* istanbul ignore next */
    cov_25gu1o0342().f[3]++;
    cov_25gu1o0342().s[13]++;
    // Agent receives message and can respond
    console.log(`[Protocol] ${agent} received message from ${message.from}`);
  }
  registerTask(task) {
    /* istanbul ignore next */
    cov_25gu1o0342().f[4]++;
    cov_25gu1o0342().s[14]++;
    this.taskRegistry.set(task.taskId, task);
  }
  getTask(taskId) {
    /* istanbul ignore next */
    cov_25gu1o0342().f[5]++;
    cov_25gu1o0342().s[15]++;
    return this.taskRegistry.get(taskId);
  }
  updateSubTaskStatus(taskId, subtaskId, status) {
    /* istanbul ignore next */
    cov_25gu1o0342().f[6]++;
    const task =
    /* istanbul ignore next */
    (cov_25gu1o0342().s[16]++, this.taskRegistry.get(taskId));
    /* istanbul ignore next */
    cov_25gu1o0342().s[17]++;
    if (task) {
      /* istanbul ignore next */
      cov_25gu1o0342().b[5][0]++;
      const subtask =
      /* istanbul ignore next */
      (cov_25gu1o0342().s[18]++, task.subtasks.find(st => {
        /* istanbul ignore next */
        cov_25gu1o0342().f[7]++;
        cov_25gu1o0342().s[19]++;
        return st.id === subtaskId;
      }));
      /* istanbul ignore next */
      cov_25gu1o0342().s[20]++;
      if (subtask) {
        /* istanbul ignore next */
        cov_25gu1o0342().b[6][0]++;
        cov_25gu1o0342().s[21]++;
        subtask.status = status;
      } else
      /* istanbul ignore next */
      {
        cov_25gu1o0342().b[6][1]++;
      }
    } else
    /* istanbul ignore next */
    {
      cov_25gu1o0342().b[5][1]++;
    }
  }
  getMessageHistory(agent, limit =
  /* istanbul ignore next */
  (cov_25gu1o0342().b[7][0]++, 50)) {
    /* istanbul ignore next */
    cov_25gu1o0342().f[8]++;
    let messages =
    /* istanbul ignore next */
    (cov_25gu1o0342().s[22]++, this.messageQueue);
    /* istanbul ignore next */
    cov_25gu1o0342().s[23]++;
    if (agent) {
      /* istanbul ignore next */
      cov_25gu1o0342().b[8][0]++;
      cov_25gu1o0342().s[24]++;
      messages = messages.filter(m => {
        /* istanbul ignore next */
        cov_25gu1o0342().f[9]++;
        cov_25gu1o0342().s[25]++;
        return /* istanbul ignore next */(cov_25gu1o0342().b[9][0]++, m.from === agent) ||
        /* istanbul ignore next */
        (cov_25gu1o0342().b[9][1]++, m.to === agent) ||
        /* istanbul ignore next */
        (cov_25gu1o0342().b[9][2]++, m.type === 'broadcast');
      });
    } else
    /* istanbul ignore next */
    {
      cov_25gu1o0342().b[8][1]++;
    }
    cov_25gu1o0342().s[26]++;
    return messages.slice(-limit);
  }
  clearHistory() {
    /* istanbul ignore next */
    cov_25gu1o0342().f[10]++;
    cov_25gu1o0342().s[27]++;
    this.messageQueue = [];
  }
}
export const collaborationProtocol =
/* istanbul ignore next */
(cov_25gu1o0342().s[28]++, new ResearchCollaborationProtocol());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMjVndTFvMDM0MiIsImFjdHVhbENvdmVyYWdlIiwiUmVzZWFyY2hDb2xsYWJvcmF0aW9uUHJvdG9jb2wiLCJtZXNzYWdlUXVldWUiLCJzIiwidGFza1JlZ2lzdHJ5IiwiTWFwIiwicm91dGVNZXNzYWdlIiwibWVzc2FnZSIsImYiLCJwdXNoIiwidHlwZSIsImIiLCJicm9hZGNhc3RUb0FsbCIsInRvIiwic2VuZERpcmVjdCIsImFnZW50cyIsImFnZW50IiwiZnJvbSIsIm5vdGlmeUFnZW50IiwiY29uc29sZSIsImxvZyIsInJlZ2lzdGVyVGFzayIsInRhc2siLCJzZXQiLCJ0YXNrSWQiLCJnZXRUYXNrIiwiZ2V0IiwidXBkYXRlU3ViVGFza1N0YXR1cyIsInN1YnRhc2tJZCIsInN0YXR1cyIsInN1YnRhc2siLCJzdWJ0YXNrcyIsImZpbmQiLCJzdCIsImlkIiwiZ2V0TWVzc2FnZUhpc3RvcnkiLCJsaW1pdCIsIm1lc3NhZ2VzIiwiZmlsdGVyIiwibSIsInNsaWNlIiwiY2xlYXJIaXN0b3J5IiwiY29sbGFib3JhdGlvblByb3RvY29sIl0sInNvdXJjZXMiOlsicmVzZWFyY2gtY29sbGFib3JhdGlvbi1wcm90b2NvbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgaW50ZXJmYWNlIENvbGxhYm9yYXRpb25NZXNzYWdlIHtcbiAgaWQ6IHN0cmluZztcbiAgZnJvbTogc3RyaW5nO1xuICB0bz86IHN0cmluZztcbiAgdHlwZTogJ2Jyb2FkY2FzdCcgfCAnZGlyZWN0JyB8ICdxdWVyeScgfCAncmVzcG9uc2UnO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIG1ldGFkYXRhPzogYW55O1xuICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGFza0RlY29tcG9zaXRpb24ge1xuICB0YXNrSWQ6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgc3VidGFza3M6IFN1YlRhc2tbXTtcbiAgcmVxdWlyZWRBZ2VudHM6IHN0cmluZ1tdO1xuICBwcmlvcml0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3ViVGFzayB7XG4gIGlkOiBzdHJpbmc7XG4gIGFnZW50OiBzdHJpbmc7XG4gIHRhc2s6IHN0cmluZztcbiAgdHlwZTogc3RyaW5nO1xuICBkZXBlbmRlbmNpZXM/OiBzdHJpbmdbXTtcbiAgc3RhdHVzOiAncGVuZGluZycgfCAnaW4tcHJvZ3Jlc3MnIHwgJ2NvbXBsZXRlZCcgfCAnZmFpbGVkJztcbn1cblxuZXhwb3J0IGNsYXNzIFJlc2VhcmNoQ29sbGFib3JhdGlvblByb3RvY29sIHtcbiAgcHJpdmF0ZSBtZXNzYWdlUXVldWU6IENvbGxhYm9yYXRpb25NZXNzYWdlW10gPSBbXTtcbiAgcHJpdmF0ZSB0YXNrUmVnaXN0cnk6IE1hcDxzdHJpbmcsIFRhc2tEZWNvbXBvc2l0aW9uPiA9IG5ldyBNYXAoKTtcblxuICBhc3luYyByb3V0ZU1lc3NhZ2UobWVzc2FnZTogQ29sbGFib3JhdGlvbk1lc3NhZ2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLm1lc3NhZ2VRdWV1ZS5wdXNoKG1lc3NhZ2UpO1xuICAgIFxuICAgIGlmIChtZXNzYWdlLnR5cGUgPT09ICdicm9hZGNhc3QnKSB7XG4gICAgICBhd2FpdCB0aGlzLmJyb2FkY2FzdFRvQWxsKG1lc3NhZ2UpO1xuICAgIH0gZWxzZSBpZiAobWVzc2FnZS50eXBlID09PSAnZGlyZWN0JyAmJiBtZXNzYWdlLnRvKSB7XG4gICAgICBhd2FpdCB0aGlzLnNlbmREaXJlY3QobWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYnJvYWRjYXN0VG9BbGwobWVzc2FnZTogQ29sbGFib3JhdGlvbk1lc3NhZ2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhZ2VudHMgPSBbJ2VsYXJhJywgJ3NhbmtvZmEnLCAndGhlbWJhJywgJ25hbGVkaScsICdqYWJhcmknLCAnYW1hcmEnLCAna29maScsICd6b2xhJywgJ2FiZW5pJywgJ3RoZW1ibycsICduZXh1cyddO1xuICAgIFxuICAgIGZvciAoY29uc3QgYWdlbnQgb2YgYWdlbnRzKSB7XG4gICAgICBpZiAoYWdlbnQgIT09IG1lc3NhZ2UuZnJvbSkge1xuICAgICAgICBhd2FpdCB0aGlzLm5vdGlmeUFnZW50KGFnZW50LCBtZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBzZW5kRGlyZWN0KG1lc3NhZ2U6IENvbGxhYm9yYXRpb25NZXNzYWdlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKG1lc3NhZ2UudG8pIHtcbiAgICAgIGF3YWl0IHRoaXMubm90aWZ5QWdlbnQobWVzc2FnZS50bywgbWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBub3RpZnlBZ2VudChhZ2VudDogc3RyaW5nLCBtZXNzYWdlOiBDb2xsYWJvcmF0aW9uTWVzc2FnZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIEFnZW50IHJlY2VpdmVzIG1lc3NhZ2UgYW5kIGNhbiByZXNwb25kXG4gICAgY29uc29sZS5sb2coYFtQcm90b2NvbF0gJHthZ2VudH0gcmVjZWl2ZWQgbWVzc2FnZSBmcm9tICR7bWVzc2FnZS5mcm9tfWApO1xuICB9XG5cbiAgcmVnaXN0ZXJUYXNrKHRhc2s6IFRhc2tEZWNvbXBvc2l0aW9uKTogdm9pZCB7XG4gICAgdGhpcy50YXNrUmVnaXN0cnkuc2V0KHRhc2sudGFza0lkLCB0YXNrKTtcbiAgfVxuXG4gIGdldFRhc2sodGFza0lkOiBzdHJpbmcpOiBUYXNrRGVjb21wb3NpdGlvbiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMudGFza1JlZ2lzdHJ5LmdldCh0YXNrSWQpO1xuICB9XG5cbiAgdXBkYXRlU3ViVGFza1N0YXR1cyh0YXNrSWQ6IHN0cmluZywgc3VidGFza0lkOiBzdHJpbmcsIHN0YXR1czogU3ViVGFza1snc3RhdHVzJ10pOiB2b2lkIHtcbiAgICBjb25zdCB0YXNrID0gdGhpcy50YXNrUmVnaXN0cnkuZ2V0KHRhc2tJZCk7XG4gICAgaWYgKHRhc2spIHtcbiAgICAgIGNvbnN0IHN1YnRhc2sgPSB0YXNrLnN1YnRhc2tzLmZpbmQoc3QgPT4gc3QuaWQgPT09IHN1YnRhc2tJZCk7XG4gICAgICBpZiAoc3VidGFzaykge1xuICAgICAgICBzdWJ0YXNrLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRNZXNzYWdlSGlzdG9yeShhZ2VudD86IHN0cmluZywgbGltaXQ6IG51bWJlciA9IDUwKTogQ29sbGFib3JhdGlvbk1lc3NhZ2VbXSB7XG4gICAgbGV0IG1lc3NhZ2VzID0gdGhpcy5tZXNzYWdlUXVldWU7XG4gICAgXG4gICAgaWYgKGFnZW50KSB7XG4gICAgICBtZXNzYWdlcyA9IG1lc3NhZ2VzLmZpbHRlcihtID0+IG0uZnJvbSA9PT0gYWdlbnQgfHwgbS50byA9PT0gYWdlbnQgfHwgbS50eXBlID09PSAnYnJvYWRjYXN0Jyk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBtZXNzYWdlcy5zbGljZSgtbGltaXQpO1xuICB9XG5cbiAgY2xlYXJIaXN0b3J5KCk6IHZvaWQge1xuICAgIHRoaXMubWVzc2FnZVF1ZXVlID0gW107XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGNvbGxhYm9yYXRpb25Qcm90b2NvbCA9IG5ldyBSZXNlYXJjaENvbGxhYm9yYXRpb25Qcm90b2NvbCgpO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFlWTtJQUFBQSxjQUFBLFlBQUFBLENBQUE7TUFBQSxPQUFBQyxjQUFBO0lBQUE7RUFBQTtFQUFBLE9BQUFBLGNBQUE7QUFBQTtBQUFBRCxjQUFBO0FBWVosT0FBTyxNQUFNRSw2QkFBNkIsQ0FBQztFQUNqQ0MsWUFBWTtFQUFBO0VBQUEsQ0FBQUgsY0FBQSxHQUFBSSxDQUFBLE9BQTJCLEVBQUU7RUFDekNDLFlBQVk7RUFBQTtFQUFB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