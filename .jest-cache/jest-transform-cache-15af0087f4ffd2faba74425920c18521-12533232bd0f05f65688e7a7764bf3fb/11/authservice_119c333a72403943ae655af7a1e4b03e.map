{"version":3,"names":["cov_2afbq7ya4q","actualCoverage","ApiClient","AuthService","constructor","f","s","b","process","env","NEXT_PUBLIC_AUTH_URL","register","data","post","login","credentials","verifyToken","token","response","headers","Authorization","success","getProfile","get","user","handleGoogleCallback","code","handleGithubCallback","handleAppleCallback","getGoogleAuthUrl","getGithubAuthUrl","getAppleAuthUrl","authService","setAuthToken","window","localStorage","setItem","getAuthToken","getItem","removeAuthToken","removeItem","setUser","JSON","stringify","getUser","userStr","parse","removeUser","isAuthenticated","logout","location","href"],"sources":["auth-service.ts"],"sourcesContent":["/*\nAZORA PROPRIETARY LICENSE\nCopyright (c) 2025 Azora ES (Pty) Ltd. All Rights Reserved.\nSee LICENSE file for details.\n*/\n\nimport { ApiClient } from './api-client';\n\nexport interface User {\n  id: string;\n  email: string;\n  name: string;\n  avatar?: string;\n  role?: string;\n}\n\nexport interface AuthResponse {\n  success: boolean;\n  token?: string;\n  user?: User;\n  error?: string;\n}\n\nexport interface LoginCredentials {\n  email: string;\n  password: string;\n}\n\nexport interface RegisterData {\n  email: string;\n  password: string;\n  name: string;\n}\n\nexport class AuthService extends ApiClient {\n  constructor() {\n    super('auth', process.env.NEXT_PUBLIC_AUTH_URL || 'http://localhost:3001');\n  }\n\n  /**\n   * Register a new user\n   */\n  async register(data: RegisterData): Promise<AuthResponse> {\n    return this.post('/register', data);\n  }\n\n  /**\n   * Login with email and password\n   */\n  async login(credentials: LoginCredentials): Promise<AuthResponse> {\n    return this.post('/login', credentials);\n  }\n\n  /**\n   * Verify JWT token\n   */\n  async verifyToken(token: string): Promise<User | null> {\n    try {\n      const response = await this.post('/verify', {}, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      return response.success ? response.data : null;\n    } catch {\n      return null;\n    }\n  }\n\n  /**\n   * Get user profile\n   */\n  async getProfile(): Promise<User | null> {\n    try {\n      const response = await this.get('/profile');\n      return response.success ? response.data?.user : null;\n    } catch {\n      return null;\n    }\n  }\n\n  /**\n   * Handle Google OAuth callback\n   */\n  async handleGoogleCallback(code: string): Promise<AuthResponse> {\n    return this.post('/auth/google/callback', { code });\n  }\n\n  /**\n   * Handle GitHub OAuth callback\n   */\n  async handleGithubCallback(code: string): Promise<AuthResponse> {\n    return this.post('/auth/github/callback', { code });\n  }\n\n  /**\n   * Handle Apple OAuth callback\n   */\n  async handleAppleCallback(code: string, user?: string): Promise<AuthResponse> {\n    return this.post('/auth/apple/callback', { code, user });\n  }\n\n  /**\n   * Get Google OAuth authorization URL\n   */\n  async getGoogleAuthUrl(): Promise<{ authorizationUrl: string }> {\n    const response = await this.get('/auth/google');\n    return response.data;\n  }\n\n  /**\n   * Get GitHub OAuth authorization URL\n   */\n  async getGithubAuthUrl(): Promise<{ authorizationUrl: string }> {\n    const response = await this.get('/auth/github');\n    return response.data;\n  }\n\n  /**\n   * Get Apple OAuth authorization URL\n   */\n  async getAppleAuthUrl(): Promise<{ authorizationUrl: string }> {\n    const response = await this.get('/auth/apple');\n    return response.data;\n  }\n}\n\n// Create and export auth service instance\nexport const authService = new AuthService();\n\n// Authentication helpers\nexport const setAuthToken = (token: string) => {\n  if (typeof window !== 'undefined') {\n    localStorage.setItem('auth_token', token);\n  }\n};\n\nexport const getAuthToken = (): string | null => {\n  if (typeof window !== 'undefined') {\n    return localStorage.getItem('auth_token');\n  }\n  return null;\n};\n\nexport const removeAuthToken = () => {\n  if (typeof window !== 'undefined') {\n    localStorage.removeItem('auth_token');\n  }\n};\n\nexport const setUser = (user: User) => {\n  if (typeof window !== 'undefined') {\n    localStorage.setItem('user', JSON.stringify(user));\n  }\n};\n\nexport const getUser = (): User | null => {\n  if (typeof window !== 'undefined') {\n    const userStr = localStorage.getItem('user');\n    return userStr ? JSON.parse(userStr) : null;\n  }\n  return null;\n};\n\nexport const removeUser = () => {\n  if (typeof window !== 'undefined') {\n    localStorage.removeItem('user');\n  }\n};\n\nexport const isAuthenticated = (): boolean => {\n  return !!getAuthToken() && !!getUser();\n};\n\nexport const logout = () => {\n  removeAuthToken();\n  removeUser();\n  // Redirect to login page\n  if (typeof window !== 'undefined') {\n    window.location.href = '/auth/login';\n  }\n};\n\nexport default authService;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}