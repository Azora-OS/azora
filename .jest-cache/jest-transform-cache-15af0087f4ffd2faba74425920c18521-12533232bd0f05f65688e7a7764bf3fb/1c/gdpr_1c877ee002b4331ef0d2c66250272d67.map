{"version":3,"names":["cov_1ujck2q3n2","actualCoverage","express","s","require","router","Router","authenticateToken","get","req","res","f","userId","user","userData","profile","id","email","name","courses","payments","activity","exportDate","Date","toISOString","json","success","data","format","err","status","error","post","deletionDate","setDate","getDate","message","scheduledFor","retentionPeriod","marketing","analytics","thirdParty","body","consent","timestamp","module","exports"],"sources":["gdpr.js"],"sourcesContent":["const express = require('express');\nconst router = express.Router();\nconst { authenticateToken } = require('../middleware/jwt');\n\n// Data export endpoint\nrouter.get('/export', authenticateToken, async (req, res) => {\n  try {\n    const userId = req.user.userId;\n    \n    // Mock data export (replace with actual database queries)\n    const userData = {\n      profile: { id: userId, email: req.user.email, name: req.user.name },\n      courses: [],\n      payments: [],\n      activity: [],\n      exportDate: new Date().toISOString()\n    };\n    \n    res.json({\n      success: true,\n      data: userData,\n      format: 'json'\n    });\n  } catch (err) {\n    res.status(500).json({ error: 'Data export failed' });\n  }\n});\n\n// Data deletion request\nrouter.post('/delete', authenticateToken, async (req, res) => {\n  try {\n    const userId = req.user.userId;\n    \n    // Schedule deletion (30-day retention)\n    const deletionDate = new Date();\n    deletionDate.setDate(deletionDate.getDate() + 30);\n    \n    res.json({\n      success: true,\n      message: 'Deletion scheduled',\n      scheduledFor: deletionDate.toISOString(),\n      retentionPeriod: '30 days'\n    });\n  } catch (err) {\n    res.status(500).json({ error: 'Deletion request failed' });\n  }\n});\n\n// Consent management\nrouter.post('/consent', authenticateToken, async (req, res) => {\n  try {\n    const { marketing, analytics, thirdParty } = req.body;\n    \n    // Store consent preferences\n    const consent = {\n      userId: req.user.userId,\n      marketing: !!marketing,\n      analytics: !!analytics,\n      thirdParty: !!thirdParty,\n      timestamp: new Date().toISOString()\n    };\n    \n    res.json({ success: true, consent });\n  } catch (err) {\n    res.status(500).json({ error: 'Consent update failed' });\n  }\n});\n\nrouter.get('/consent', authenticateToken, async (req, res) => {\n  try {\n    // Mock consent retrieval\n    const consent = {\n      marketing: false,\n      analytics: true,\n      thirdParty: false\n    };\n    \n    res.json({ success: true, consent });\n  } catch (err) {\n    res.status(500).json({ error: 'Consent retrieval failed' });\n  }\n});\n\nmodule.exports = router;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ,MAAME,OAAO;AAAA;AAAA,CAAAF,cAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM;AAAA;AAAA,CAAAL,cAAA,GAAAG,CAAA,OAAGD,OAAO,CAACI,MAAM,CAAC,CAAC;AAC/B,MAAM;EAAEC;AAAkB,CAAC;AAAA;AAAA,CAAAP,cAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,mBAAmB,CAAC;;AAE1D;AAAA;AAAAJ,cAAA,GAAAG,CAAA;AACAE,MAAM,CAACG,GAAG,CAAC,SAAS,EAAED,iBAAiB,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAAA;EAAAV,cAAA,GAAAW,CAAA;EAAAX,cAAA,GAAAG,CAAA;EAC3D,IAAI;IACF,MAAMS,MAAM;IAAA;IAAA,CAAAZ,cAAA,GAAAG,CAAA,OAAGM,GAAG,CAACI,IAAI,CAACD,MAAM;;IAE9B;IACA,MAAME,QAAQ;IAAA;IAAA,CAAAd,cAAA,GAAAG,CAAA,OAAG;MACfY,OAAO,EAAE;QAAEC,EAAE,EAAEJ,MAAM;QAAEK,KAAK,EAAER,GAAG,CAACI,IAAI,CAACI,KAAK;QAAEC,IAAI,EAAET,GAAG,CAACI,IAAI,CAACK;MAAK,CAAC;MACnEC,OAAO,EAAE,EAAE;MACXC,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,UAAU,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;IACrC,CAAC;IAAC;IAAAxB,cAAA,GAAAG,CAAA;IAEFO,GAAG,CAACe,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbC,IAAI,EAAEb,QAAQ;MACdc,MAAM,EAAE;IACV,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA;IAAA7B,cAAA,GAAAG,CAAA;IACZO,GAAG,CAACoB,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAAC;MAAEM,KAAK,EAAE;IAAqB,CAAC,CAAC;EACvD;AACF,CAAC,CAAC;;AAEF;AAAA;AAAA/B,cAAA,GAAAG,CAAA;AACAE,MAAM,CAAC2B,IAAI,CAAC,SAAS,EAAEzB,iBAAiB,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAAA;EAAAV,cAAA,GAAAW,CAAA;EAAAX,cAAA,GAAAG,CAAA;EAC5D,IAAI;IACF,MAAMS,MAAM;IAAA;IAAA,CAAAZ,cAAA,GAAAG,CAAA,QAAGM,GAAG,CAACI,IAAI,CAACD,MAAM;;IAE9B;IACA,MAAMqB,YAAY;IAAA;IAAA,CAAAjC,cAAA,GAAAG,CAAA,QAAG,IAAIoB,IAAI,CAAC,CAAC;IAAC;IAAAvB,cAAA,GAAAG,CAAA;IAChC8B,YAAY,CAACC,OAAO,CAACD,YAAY,CAACE,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC;IAAC;IAAAnC,cAAA,GAAAG,CAAA;IAElDO,GAAG,CAACe,IAAI,CAAC;MACPC,OAAO,EAAE,IAAI;MACbU,OAAO,EAAE,oBAAoB;MAC7BC,YAAY,EAAEJ,YAAY,CAACT,WAAW,CAAC,CAAC;MACxCc,eAAe,EAAE;IACnB,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOT,GAAG,EAAE;IAAA;IAAA7B,cAAA,GAAAG,CAAA;IACZO,GAAG,CAACoB,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAAC;MAAEM,KAAK,EAAE;IAA0B,CAAC,CAAC;EAC5D;AACF,CAAC,CAAC;;AAEF;AAAA;AAAA/B,cAAA,GAAAG,CAAA;AACAE,MAAM,CAAC2B,IAAI,CAAC,UAAU,EAAEzB,iBAAiB,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAAA;EAAAV,cAAA,GAAAW,CAAA;EAAAX,cAAA,GAAAG,CAAA;EAC7D,IAAI;IACF,MAAM;MAAEoC,SAAS;MAAEC,SAAS;MAAEC;IAAW,CAAC;IAAA;IAAA,CAAAzC,cAAA,GAAAG,CAAA,QAAGM,GAAG,CAACiC,IAAI;;IAErD;IACA,MAAMC,OAAO;IAAA;IAAA,CAAA3C,cAAA,GAAAG,CAAA,QAAG;MACdS,MAAM,EAAEH,GAAG,CAACI,IAAI,CAACD,MAAM;MACvB2B,SAAS,EAAE,CAAC,CAACA,SAAS;MACtBC,SAAS,EAAE,CAAC,CAACA,SAAS;MACtBC,UAAU,EAAE,CAAC,CAACA,UAAU;MACxBG,SAAS,EAAE,IAAIrB,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;IACpC,CAAC;IAAC;IAAAxB,cAAA,GAAAG,CAAA;IAEFO,GAAG,CAACe,IAAI,CAAC;MAAEC,OAAO,EAAE,IAAI;MAAEiB;IAAQ,CAAC,CAAC;EACtC,CAAC,CAAC,OAAOd,GAAG,EAAE;IAAA;IAAA7B,cAAA,GAAAG,CAAA;IACZO,GAAG,CAACoB,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAAC;MAAEM,KAAK,EAAE;IAAwB,CAAC,CAAC;EAC1D;AACF,CAAC,CAAC;AAAC;AAAA/B,cAAA,GAAAG,CAAA;AAEHE,MAAM,CAACG,GAAG,CAAC,UAAU,EAAED,iBAAiB,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAAA;EAAAV,cAAA,GAAAW,CAAA;EAAAX,cAAA,GAAAG,CAAA;EAC5D,IAAI;IACF;IACA,MAAMwC,OAAO;IAAA;IAAA,CAAA3C,cAAA,GAAAG,CAAA,QAAG;MACdoC,SAAS,EAAE,KAAK;MAChBC,SAAS,EAAE,IAAI;MACfC,UAAU,EAAE;IACd,CAAC;IAAC;IAAAzC,cAAA,GAAAG,CAAA;IAEFO,GAAG,CAACe,IAAI,CAAC;MAAEC,OAAO,EAAE,IAAI;MAAEiB;IAAQ,CAAC,CAAC;EACtC,CAAC,CAAC,OAAOd,GAAG,EAAE;IAAA;IAAA7B,cAAA,GAAAG,CAAA;IACZO,GAAG,CAACoB,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAAC;MAAEM,KAAK,EAAE;IAA2B,CAAC,CAAC;EAC7D;AACF,CAAC,CAAC;AAAC;AAAA/B,cAAA,GAAAG,CAAA;AAEH0C,MAAM,CAACC,OAAO,GAAGzC,MAAM","ignoreList":[]}