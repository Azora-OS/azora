{"version":3,"names":["cov_k019zrsri","actualCoverage","ValidationError","AppError","Error","constructor","statusCode","message","isOperational","b","f","s","captureStackTrace","errorHandler","err","req","res","next","status","json","success","error","field","console","asyncHandler","fn","Promise","resolve","catch"],"sources":["errorHandler.ts"],"sourcesContent":["import { Request, Response, NextFunction } from 'express';\nimport { ValidationError } from '../utils/validators.js';\n\nexport class AppError extends Error {\n  constructor(\n    public statusCode: number,\n    message: string,\n    public isOperational: boolean = true\n  ) {\n    super(message);\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\nexport const errorHandler = (\n  err: Error | AppError | ValidationError,\n  req: Request,\n  res: Response,\n  next: NextFunction\n) => {\n  if (err instanceof ValidationError) {\n    return res.status(400).json({\n      success: false,\n      error: err.message,\n      field: err.field,\n    });\n  }\n\n  if (err instanceof AppError) {\n    return res.status(err.statusCode).json({\n      success: false,\n      error: err.message,\n    });\n  }\n\n  // Unhandled errors\n  console.error('Unhandled error:', err);\n  return res.status(500).json({\n    success: false,\n    error: 'Internal server error',\n  });\n};\n\nexport const asyncHandler = (fn: Function) => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    Promise.resolve(fn(req, res, next)).catch(next);\n  };\n};\n"],"mappings":"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","ignoreList":[]}