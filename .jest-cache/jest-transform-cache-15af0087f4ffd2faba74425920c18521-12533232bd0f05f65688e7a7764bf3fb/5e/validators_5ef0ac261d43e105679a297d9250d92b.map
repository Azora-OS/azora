{"version":3,"names":["cov_8u633ba7p","actualCoverage","s","validateEmail","email","f","emailRegex","test","validateLearnerInput","data","errors","b","name","trim","length","push","learningGoals","Array","isArray","isValid","validateCourseInput","title","instructor","difficulty","price","validateProgressInput","learnerId","courseId","score","undefined","timeSpent","sanitizeInput","input","replace","module","exports"],"sources":["validators.js"],"sourcesContent":["// âœ… Input Validation Utilities\n\nconst validateEmail = (email) => {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n};\n\nconst validateLearnerInput = (data) => {\n  const errors = [];\n  \n  if (!data.name || data.name.trim().length < 2) {\n    errors.push('Name must be at least 2 characters long');\n  }\n  \n  if (!data.email || !validateEmail(data.email)) {\n    errors.push('Valid email address is required');\n  }\n  \n  if (data.learningGoals && !Array.isArray(data.learningGoals)) {\n    errors.push('Learning goals must be an array');\n  }\n  \n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\nconst validateCourseInput = (data) => {\n  const errors = [];\n  \n  if (!data.title || data.title.trim().length < 5) {\n    errors.push('Course title must be at least 5 characters long');\n  }\n  \n  if (!data.instructor || data.instructor.trim().length < 3) {\n    errors.push('Instructor name must be at least 3 characters long');\n  }\n  \n  if (data.difficulty && (data.difficulty < 1 || data.difficulty > 5)) {\n    errors.push('Difficulty must be between 1 and 5');\n  }\n  \n  if (data.price && data.price < 0) {\n    errors.push('Price cannot be negative');\n  }\n  \n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\nconst validateProgressInput = (data) => {\n  const errors = [];\n  \n  if (!data.learnerId) {\n    errors.push('Learner ID is required');\n  }\n  \n  if (!data.courseId) {\n    errors.push('Course ID is required');\n  }\n  \n  if (data.score !== undefined && (data.score < 0 || data.score > 1)) {\n    errors.push('Score must be between 0 and 1');\n  }\n  \n  if (data.timeSpent && data.timeSpent < 0) {\n    errors.push('Time spent cannot be negative');\n  }\n  \n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\nconst sanitizeInput = (input) => {\n  if (typeof input !== 'string') return input;\n  \n  return input\n    .trim()\n    .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '')\n    .replace(/[<>]/g, '');\n};\n\nmodule.exports = {\n  validateEmail,\n  validateLearnerInput,\n  validateCourseInput,\n  validateProgressInput,\n  sanitizeInput\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}