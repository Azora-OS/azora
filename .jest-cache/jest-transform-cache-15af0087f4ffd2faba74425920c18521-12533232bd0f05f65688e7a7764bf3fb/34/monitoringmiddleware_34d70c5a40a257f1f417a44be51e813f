83f0c270be2195e740e1e570907750b7
/* istanbul ignore next */
function cov_13limy7vb1() {
  var path = "/workspaces/azora/services/education-revenue-engine/src/middleware/monitoring.middleware.ts";
  var hash = "ff440931688de73d2d583f0db3a804de85b7a748";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/education-revenue-engine/src/middleware/monitoring.middleware.ts",
    statementMap: {
      "0": {
        start: {
          line: 35,
          column: 2
        },
        end: {
          line: 35,
          column: 68
        }
      },
      "1": {
        start: {
          line: 36,
          column: 2
        },
        end: {
          line: 36,
          column: 29
        }
      },
      "2": {
        start: {
          line: 39,
          column: 2
        },
        end: {
          line: 39,
          column: 47
        }
      },
      "3": {
        start: {
          line: 41,
          column: 2
        },
        end: {
          line: 41,
          column: 9
        }
      },
      "4": {
        start: {
          line: 53,
          column: 23
        },
        end: {
          line: 53,
          column: 31
        }
      },
      "5": {
        start: {
          line: 56,
          column: 2
        },
        end: {
          line: 77,
          column: 4
        }
      },
      "6": {
        start: {
          line: 57,
          column: 21
        },
        end: {
          line: 57,
          column: 56
        }
      },
      "7": {
        start: {
          line: 58,
          column: 23
        },
        end: {
          line: 58,
          column: 37
        }
      },
      "8": {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 61,
          column: 66
        }
      },
      "9": {
        start: {
          line: 64,
          column: 4
        },
        end: {
          line: 73,
          column: 6
        }
      },
      "10": {
        start: {
          line: 76,
          column: 4
        },
        end: {
          line: 76,
          column: 41
        }
      },
      "11": {
        start: {
          line: 79,
          column: 2
        },
        end: {
          line: 79,
          column: 9
        }
      },
      "12": {
        start: {
          line: 91,
          column: 21
        },
        end: {
          line: 91,
          column: 56
        }
      },
      "13": {
        start: {
          line: 92,
          column: 20
        },
        end: {
          line: 92,
          column: 46
        }
      },
      "14": {
        start: {
          line: 95,
          column: 2
        },
        end: {
          line: 95,
          column: 51
        }
      },
      "15": {
        start: {
          line: 98,
          column: 2
        },
        end: {
          line: 111,
          column: 4
        }
      },
      "16": {
        start: {
          line: 114,
          column: 2
        },
        end: {
          line: 119,
          column: 5
        }
      },
      "17": {
        start: {
          line: 131,
          column: 2
        },
        end: {
          line: 133,
          column: 3
        }
      },
      "18": {
        start: {
          line: 132,
          column: 4
        },
        end: {
          line: 132,
          column: 26
        }
      },
      "19": {
        start: {
          line: 135,
          column: 2
        },
        end: {
          line: 135,
          column: 9
        }
      },
      "20": {
        start: {
          line: 144,
          column: 2
        },
        end: {
          line: 170,
          column: 4
        }
      },
      "21": {
        start: {
          line: 145,
          column: 25
        },
        end: {
          line: 145,
          column: 33
        }
      },
      "22": {
        start: {
          line: 147,
          column: 4
        },
        end: {
          line: 167,
          column: 6
        }
      },
      "23": {
        start: {
          line: 148,
          column: 23
        },
        end: {
          line: 148,
          column: 49
        }
      },
      "24": {
        start: {
          line: 150,
          column: 6
        },
        end: {
          line: 164,
          column: 7
        }
      },
      "25": {
        start: {
          line: 151,
          column: 8
        },
        end: {
          line: 163,
          column: 10
        }
      },
      "26": {
        start: {
          line: 166,
          column: 6
        },
        end: {
          line: 166,
          column: 43
        }
      },
      "27": {
        start: {
          line: 169,
          column: 4
        },
        end: {
          line: 169,
          column: 11
        }
      },
      "28": {
        start: {
          line: 181,
          column: 2
        },
        end: {
          line: 192,
          column: 3
        }
      },
      "29": {
        start: {
          line: 182,
          column: 4
        },
        end: {
          line: 191,
          column: 6
        }
      },
      "30": {
        start: {
          line: 194,
          column: 2
        },
        end: {
          line: 194,
          column: 9
        }
      }
    },
    fnMap: {
      "0": {
        name: "requestIdMiddleware",
        decl: {
          start: {
            line: 30,
            column: 16
          },
          end: {
            line: 30,
            column: 35
          }
        },
        loc: {
          start: {
            line: 34,
            column: 8
          },
          end: {
            line: 42,
            column: 1
          }
        },
        line: 34
      },
      "1": {
        name: "httpLoggingMiddleware",
        decl: {
          start: {
            line: 47,
            column: 16
          },
          end: {
            line: 47,
            column: 37
          }
        },
        loc: {
          start: {
            line: 51,
            column: 8
          },
          end: {
            line: 80,
            column: 1
          }
        },
        line: 51
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 56,
            column: 13
          },
          end: {
            line: 56,
            column: 14
          }
        },
        loc: {
          start: {
            line: 56,
            column: 34
          },
          end: {
            line: 77,
            column: 3
          }
        },
        line: 56
      },
      "3": {
        name: "errorHandlingMiddleware",
        decl: {
          start: {
            line: 85,
            column: 16
          },
          end: {
            line: 85,
            column: 39
          }
        },
        loc: {
          start: {
            line: 90,
            column: 8
          },
          end: {
            line: 120,
            column: 1
          }
        },
        line: 90
      },
      "4": {
        name: "systemMetricsMiddleware",
        decl: {
          start: {
            line: 125,
            column: 16
          },
          end: {
            line: 125,
            column: 39
          }
        },
        loc: {
          start: {
            line: 129,
            column: 8
          },
          end: {
            line: 136,
            column: 1
          }
        },
        line: 129
      },
      "5": {
        name: "slowRequestMiddleware",
        decl: {
          start: {
            line: 141,
            column: 16
          },
          end: {
            line: 141,
            column: 37
          }
        },
        loc: {
          start: {
            line: 143,
            column: 2
          },
          end: {
            line: 171,
            column: 1
          }
        },
        line: 143
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 144,
            column: 9
          },
          end: {
            line: 144,
            column: 10
          }
        },
        loc: {
          start: {
            line: 144,
            column: 68
          },
          end: {
            line: 170,
            column: 3
          }
        },
        line: 144
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 147,
            column: 15
          },
          end: {
            line: 147,
            column: 16
          }
        },
        loc: {
          start: {
            line: 147,
            column: 36
          },
          end: {
            line: 167,
            column: 5
          }
        },
        line: 147
      },
      "8": {
        name: "requestBodyLoggingMiddleware",
        decl: {
          start: {
            line: 176,
            column: 16
          },
          end: {
            line: 176,
            column: 44
          }
        },
        loc: {
          start: {
            line: 180,
            column: 8
          },
          end: {
            line: 195,
            column: 1
          }
        },
        line: 180
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 35,
            column: 18
          },
          end: {
            line: 35,
            column: 67
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 35,
            column: 18
          },
          end: {
            line: 35,
            column: 55
          }
        }, {
          start: {
            line: 35,
            column: 59
          },
          end: {
            line: 35,
            column: 67
          }
        }],
        line: 35
      },
      "1": {
        loc: {
          start: {
            line: 91,
            column: 21
          },
          end: {
            line: 91,
            column: 56
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 91,
            column: 21
          },
          end: {
            line: 91,
            column: 31
          }
        }, {
          start: {
            line: 91,
            column: 35
          },
          end: {
            line: 91,
            column: 49
          }
        }, {
          start: {
            line: 91,
            column: 53
          },
          end: {
            line: 91,
            column: 56
          }
        }],
        line: 91
      },
      "2": {
        loc: {
          start: {
            line: 92,
            column: 20
          },
          end: {
            line: 92,
            column: 46
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 92,
            column: 20
          },
          end: {
            line: 92,
            column: 28
          }
        }, {
          start: {
            line: 92,
            column: 32
          },
          end: {
            line: 92,
            column: 46
          }
        }],
        line: 92
      },
      "3": {
        loc: {
          start: {
            line: 116,
            column: 11
          },
          end: {
            line: 116,
            column: 49
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 116,
            column: 11
          },
          end: {
            line: 116,
            column: 22
          }
        }, {
          start: {
            line: 116,
            column: 26
          },
          end: {
            line: 116,
            column: 49
          }
        }],
        line: 116
      },
      "4": {
        loc: {
          start: {
            line: 131,
            column: 2
          },
          end: {
            line: 133,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 131,
            column: 2
          },
          end: {
            line: 133,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 131
      },
      "5": {
        loc: {
          start: {
            line: 142,
            column: 2
          },
          end: {
            line: 142,
            column: 32
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 142,
            column: 28
          },
          end: {
            line: 142,
            column: 32
          }
        }],
        line: 142
      },
      "6": {
        loc: {
          start: {
            line: 150,
            column: 6
          },
          end: {
            line: 164,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 150,
            column: 6
          },
          end: {
            line: 164,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 150
      },
      "7": {
        loc: {
          start: {
            line: 181,
            column: 2
          },
          end: {
            line: 192,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 181,
            column: 2
          },
          end: {
            line: 192,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 181
      },
      "8": {
        loc: {
          start: {
            line: 181,
            column: 6
          },
          end: {
            line: 181,
            column: 69
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 181,
            column: 6
          },
          end: {
            line: 181,
            column: 45
          }
        }, {
          start: {
            line: 181,
            column: 49
          },
          end: {
            line: 181,
            column: 69
          }
        }],
        line: 181
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "ff440931688de73d2d583f0db3a804de85b7a748"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_13limy7vb1 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_13limy7vb1();
/**
 * Monitoring Middleware
 * Tracks HTTP requests, errors, and performance metrics
 */

import { Request } from 'express';
import { v4 as uuidv4 } from 'uuid';
import { structuredLogger } from '../utils/structured-logger';
import { recordHttpRequest, recordHttpError, updateSystemMetrics } from '../utils/metrics';

/**
 * Extend Express Request to include monitoring data
 */

/**
 * Middleware to add request ID and start time
 */
export function requestIdMiddleware(req, res, next) {
  /* istanbul ignore next */
  cov_13limy7vb1().f[0]++;
  cov_13limy7vb1().s[0]++;
  req.requestId =
  /* istanbul ignore next */
  (cov_13limy7vb1().b[0][0]++, req.headers['x-request-id']) ||
  /* istanbul ignore next */
  (cov_13limy7vb1().b[0][1]++, uuidv4());
  /* istanbul ignore next */
  cov_13limy7vb1().s[1]++;
  req.startTime = Date.now();

  // Add request ID to response headers
  /* istanbul ignore next */
  cov_13limy7vb1().s[2]++;
  res.setHeader('X-Request-ID', req.requestId);
  /* istanbul ignore next */
  cov_13limy7vb1().s[3]++;
  next();
}

/**
 * Middleware to log HTTP requests and record metrics
 */
export function httpLoggingMiddleware(req, res, next) {
  /* istanbul ignore next */
  cov_13limy7vb1().f[1]++;
  // Capture the original send function
  const originalSend =
  /* istanbul ignore next */
  (cov_13limy7vb1().s[4]++, res.send);

  // Override send to capture response
  /* istanbul ignore next */
  cov_13limy7vb1().s[5]++;
  res.send = function (data) {
    /* istanbul ignore next */
    cov_13limy7vb1().f[2]++;
    const duration =
    /* istanbul ignore next */
    (cov_13limy7vb1().s[6]++, (Date.now() - req.startTime) / 1000); // Convert to seconds
    const statusCode =
    /* istanbul ignore next */
    (cov_13limy7vb1().s[7]++, res.statusCode);

    // Record metrics
    /* istanbul ignore next */
    cov_13limy7vb1().s[8]++;
    recordHttpRequest(req.method, req.path, statusCode, duration);

    // Log request
    /* istanbul ignore next */
    cov_13limy7vb1().s[9]++;
    structuredLogger.logHttpRequest(req.method, req.path, statusCode, duration, {
      requestId: req.requestId,
      userId: req.userId
    });

    // Call original send
    /* istanbul ignore next */
    cov_13limy7vb1().s[10]++;
    return originalSend.call(this, data);
  };
  /* istanbul ignore next */
  cov_13limy7vb1().s[11]++;
  next();
}

/**
 * Middleware to handle errors and record error metrics
 */
export function errorHandlingMiddleware(err, req, res, next) {
  /* istanbul ignore next */
  cov_13limy7vb1().f[3]++;
  const statusCode =
  /* istanbul ignore next */
  (cov_13limy7vb1().s[12]++,
  /* istanbul ignore next */
  (cov_13limy7vb1().b[1][0]++, err.status) ||
  /* istanbul ignore next */
  (cov_13limy7vb1().b[1][1]++, err.statusCode) ||
  /* istanbul ignore next */
  (cov_13limy7vb1().b[1][2]++, 500));
  const errorType =
  /* istanbul ignore next */
  (cov_13limy7vb1().s[13]++,
  /* istanbul ignore next */
  (cov_13limy7vb1().b[2][0]++, err.name) ||
  /* istanbul ignore next */
  (cov_13limy7vb1().b[2][1]++, 'UnknownError'));

  // Record error metric
  /* istanbul ignore next */
  cov_13limy7vb1().s[14]++;
  recordHttpError(req.method, req.path, errorType);

  // Log error
  /* istanbul ignore next */
  cov_13limy7vb1().s[15]++;
  structuredLogger.error(`HTTP Error: ${err.message}`, err, {
    requestId: req.requestId,
    userId: req.userId
  }, {
    method: req.method,
    path: req.path,
    statusCode,
    errorType
  });

  // Send error response
  /* istanbul ignore next */
  cov_13limy7vb1().s[16]++;
  res.status(statusCode).json({
    success: false,
    error:
    /* istanbul ignore next */
    (cov_13limy7vb1().b[3][0]++, err.message) ||
    /* istanbul ignore next */
    (cov_13limy7vb1().b[3][1]++, 'Internal server error'),
    requestId: req.requestId,
    timestamp: new Date().toISOString()
  });
}

/**
 * Middleware to update system metrics periodically
 */
export function systemMetricsMiddleware(req,
// eslint-disable-line @typescript-eslint/no-unused-vars
res,
// eslint-disable-line @typescript-eslint/no-unused-vars
next) {
  /* istanbul ignore next */
  cov_13limy7vb1().f[4]++;
  cov_13limy7vb1().s[17]++;
  // Update system metrics every 10 requests
  if (Math.random() < 0.1) {
    /* istanbul ignore next */
    cov_13limy7vb1().b[4][0]++;
    cov_13limy7vb1().s[18]++;
    updateSystemMetrics();
  } else
  /* istanbul ignore next */
  {
    cov_13limy7vb1().b[4][1]++;
  }
  cov_13limy7vb1().s[19]++;
  next();
}

/**
 * Middleware to log slow requests
 */
export function slowRequestMiddleware(slowThresholdMs =
/* istanbul ignore next */
(cov_13limy7vb1().b[5][0]++, 1000)) {
  /* istanbul ignore next */
  cov_13limy7vb1().f[5]++;
  cov_13limy7vb1().s[20]++;
  return (req, res, next) => {
    /* istanbul ignore next */
    cov_13limy7vb1().f[6]++;
    const originalSend =
    /* istanbul ignore next */
    (cov_13limy7vb1().s[21]++, res.send);
    /* istanbul ignore next */
    cov_13limy7vb1().s[22]++;
    res.send = function (data) {
      /* istanbul ignore next */
      cov_13limy7vb1().f[7]++;
      const duration =
      /* istanbul ignore next */
      (cov_13limy7vb1().s[23]++, Date.now() - req.startTime);
      /* istanbul ignore next */
      cov_13limy7vb1().s[24]++;
      if (duration > slowThresholdMs) {
        /* istanbul ignore next */
        cov_13limy7vb1().b[6][0]++;
        cov_13limy7vb1().s[25]++;
        structuredLogger.warn(`Slow request detected: ${req.method} ${req.path} took ${duration}ms`, {
          requestId: req.requestId,
          userId: req.userId
        }, {
          method: req.method,
          path: req.path,
          duration,
          threshold: slowThresholdMs
        });
      } else
      /* istanbul ignore next */
      {
        cov_13limy7vb1().b[6][1]++;
      }
      cov_13limy7vb1().s[26]++;
      return originalSend.call(this, data);
    };
    /* istanbul ignore next */
    cov_13limy7vb1().s[27]++;
    next();
  };
}

/**
 * Middleware to log request body (for debugging)
 */
export function requestBodyLoggingMiddleware(req, res,
// eslint-disable-line @typescript-eslint/no-unused-vars
next) {
  /* istanbul ignore next */
  cov_13limy7vb1().f[8]++;
  cov_13limy7vb1().s[28]++;
  if (
  /* istanbul ignore next */
  (cov_13limy7vb1().b[8][0]++, process.env.LOG_REQUEST_BODY === 'true') &&
  /* istanbul ignore next */
  (cov_13limy7vb1().b[8][1]++, req.method !== 'GET')) {
    /* istanbul ignore next */
    cov_13limy7vb1().b[7][0]++;
    cov_13limy7vb1().s[29]++;
    structuredLogger.debug(`Request body: ${req.method} ${req.path}`, {
      requestId: req.requestId,
      userId: req.userId
    }, {
      body: req.body
    });
  } else
  /* istanbul ignore next */
  {
    cov_13limy7vb1().b[7][1]++;
  }
  cov_13limy7vb1().s[30]++;
  next();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTNsaW15N3ZiMSIsImFjdHVhbENvdmVyYWdlIiwiUmVxdWVzdCIsInY0IiwidXVpZHY0Iiwic3RydWN0dXJlZExvZ2dlciIsInJlY29yZEh0dHBSZXF1ZXN0IiwicmVjb3JkSHR0cEVycm9yIiwidXBkYXRlU3lzdGVtTWV0cmljcyIsInJlcXVlc3RJZE1pZGRsZXdhcmUiLCJyZXEiLCJyZXMiLCJuZXh0IiwiZiIsInMiLCJyZXF1ZXN0SWQiLCJiIiwiaGVhZGVycyIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJzZXRIZWFkZXIiLCJodHRwTG9nZ2luZ01pZGRsZXdhcmUiLCJvcmlnaW5hbFNlbmQiLCJzZW5kIiwiZGF0YSIsImR1cmF0aW9uIiwic3RhdHVzQ29kZSIsIm1ldGhvZCIsInBhdGgiLCJsb2dIdHRwUmVxdWVzdCIsInVzZXJJZCIsImNhbGwiLCJlcnJvckhhbmRsaW5nTWlkZGxld2FyZSIsImVyciIsInN0YXR1cyIsImVycm9yVHlwZSIsIm5hbWUiLCJlcnJvciIsIm1lc3NhZ2UiLCJqc29uIiwic3VjY2VzcyIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwic3lzdGVtTWV0cmljc01pZGRsZXdhcmUiLCJNYXRoIiwicmFuZG9tIiwic2xvd1JlcXVlc3RNaWRkbGV3YXJlIiwic2xvd1RocmVzaG9sZE1zIiwid2FybiIsInRocmVzaG9sZCIsInJlcXVlc3RCb2R5TG9nZ2luZ01pZGRsZXdhcmUiLCJwcm9jZXNzIiwiZW52IiwiTE9HX1JFUVVFU1RfQk9EWSIsImRlYnVnIiwiYm9keSJdLCJzb3VyY2VzIjpbIm1vbml0b3JpbmcubWlkZGxld2FyZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1vbml0b3JpbmcgTWlkZGxld2FyZVxuICogVHJhY2tzIEhUVFAgcmVxdWVzdHMsIGVycm9ycywgYW5kIHBlcmZvcm1hbmNlIG1ldHJpY3NcbiAqL1xuXG5pbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSwgTmV4dEZ1bmN0aW9uIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcbmltcG9ydCB7IHN0cnVjdHVyZWRMb2dnZXIgfSBmcm9tICcuLi91dGlscy9zdHJ1Y3R1cmVkLWxvZ2dlcic7XG5pbXBvcnQge1xuICByZWNvcmRIdHRwUmVxdWVzdCxcbiAgcmVjb3JkSHR0cEVycm9yLFxuICB1cGRhdGVTeXN0ZW1NZXRyaWNzLFxufSBmcm9tICcuLi91dGlscy9tZXRyaWNzJztcblxuLyoqXG4gKiBFeHRlbmQgRXhwcmVzcyBSZXF1ZXN0IHRvIGluY2x1ZGUgbW9uaXRvcmluZyBkYXRhXG4gKi9cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgbmFtZXNwYWNlIEV4cHJlc3Mge1xuICAgIGludGVyZmFjZSBSZXF1ZXN0IHtcbiAgICAgIHJlcXVlc3RJZDogc3RyaW5nO1xuICAgICAgc3RhcnRUaW1lOiBudW1iZXI7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogTWlkZGxld2FyZSB0byBhZGQgcmVxdWVzdCBJRCBhbmQgc3RhcnQgdGltZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVxdWVzdElkTWlkZGxld2FyZShcbiAgcmVxOiBSZXF1ZXN0LFxuICByZXM6IFJlc3BvbnNlLFxuICBuZXh0OiBOZXh0RnVuY3Rpb25cbik6IHZvaWQge1xuICByZXEucmVxdWVzdElkID0gcmVxLmhlYWRlcnNbJ3gtcmVxdWVzdC1pZCddIGFzIHN0cmluZyB8fCB1dWlkdjQoKTtcbiAgcmVxLnN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgLy8gQWRkIHJlcXVlc3QgSUQgdG8gcmVzcG9uc2UgaGVhZGVyc1xuICByZXMuc2V0SGVhZGVyKCdYLVJlcXVlc3QtSUQnLCByZXEucmVxdWVzdElkKTtcblxuICBuZXh0KCk7XG59XG5cbi8qKlxuICogTWlkZGxld2FyZSB0byBsb2cgSFRUUCByZXF1ZXN0cyBhbmQgcmVjb3JkIG1ldHJpY3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGh0dHBMb2dnaW5nTWlkZGxld2FyZShcbiAgcmVxOiBSZXF1ZXN0LFxuICByZXM6IFJlc3BvbnNlLFxuICBuZXh0OiBOZXh0RnVuY3Rpb24gLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbik6IHZvaWQge1xuICAvLyBDYXB0dXJlIHRoZSBvcmlnaW5hbCBzZW5kIGZ1bmN0aW9uXG4gIGNvbnN0IG9yaWdpbmFsU2VuZCA9IHJlcy5zZW5kO1xuXG4gIC8vIE92ZXJyaWRlIHNlbmQgdG8gY2FwdHVyZSByZXNwb25zZVxuICByZXMuc2VuZCA9IGZ1bmN0aW9uIChkYXRhOiBhbnkpIHtcbiAgICBjb25zdCBkdXJhdGlvbiA9IChEYXRlLm5vdygpIC0gcmVxLnN0YXJ0VGltZSkgLyAxMDAwOyAvLyBDb252ZXJ0IHRvIHNlY29uZHNcbiAgICBjb25zdCBzdGF0dXNDb2RlID0gcmVzLnN0YXR1c0NvZGU7XG5cbiAgICAvLyBSZWNvcmQgbWV0cmljc1xuICAgIHJlY29yZEh0dHBSZXF1ZXN0KHJlcS5tZXRob2QsIHJlcS5wYXRoLCBzdGF0dXNDb2RlLCBkdXJhdGlvbik7XG5cbiAgICAvLyBMb2cgcmVxdWVzdFxuICAgIHN0cnVjdHVyZWRMb2dnZXIubG9nSHR0cFJlcXVlc3QoXG4gICAgICByZXEubWV0aG9kLFxuICAgICAgcmVxLnBhdGgsXG4gICAgICBzdGF0dXNDb2RlLFxuICAgICAgZHVyYXRpb24sXG4gICAgICB7XG4gICAgICAgIHJlcXVlc3RJZDogcmVxLnJlcXVlc3RJZCxcbiAgICAgICAgdXNlcklkOiAocmVxIGFzIGFueSkudXNlcklkLFxuICAgICAgfVxuICAgICk7XG5cbiAgICAvLyBDYWxsIG9yaWdpbmFsIHNlbmRcbiAgICByZXR1cm4gb3JpZ2luYWxTZW5kLmNhbGwodGhpcywgZGF0YSk7XG4gIH07XG5cbiAgbmV4dCgpO1xufVxuXG4vKipcbiAqIE1pZGRsZXdhcmUgdG8gaGFuZGxlIGVycm9ycyBhbmQgcmVjb3JkIGVycm9yIG1ldHJpY3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVycm9ySGFuZGxpbmdNaWRkbGV3YXJlKFxuICBlcnI6IGFueSxcbiAgcmVxOiBSZXF1ZXN0LFxuICByZXM6IFJlc3BvbnNlLFxuICBuZXh0OiBOZXh0RnVuY3Rpb25cbik6IHZvaWQge1xuICBjb25zdCBzdGF0dXNDb2RlID0gZXJyLnN0YXR1cyB8fCBlcnIuc3RhdHVzQ29kZSB8fCA1MDA7XG4gIGNvbnN0IGVycm9yVHlwZSA9IGVyci5uYW1lIHx8ICdVbmtub3duRXJyb3InO1xuXG4gIC8vIFJlY29yZCBlcnJvciBtZXRyaWNcbiAgcmVjb3JkSHR0cEVycm9yKHJlcS5tZXRob2QsIHJlcS5wYXRoLCBlcnJvclR5cGUpO1xuXG4gIC8vIExvZyBlcnJvclxuICBzdHJ1Y3R1cmVkTG9nZ2VyLmVycm9yKFxuICAgIGBIVFRQIEVycm9yOiAke2Vyci5tZXNzYWdlfWAsXG4gICAgZXJyLFxuICAgIHtcbiAgICAgIHJlcXVlc3RJZDogcmVxLnJlcXVlc3RJZCxcbiAgICAgIHVzZXJJZDogKHJlcSBhcyBhbnkpLnVzZXJJZCxcbiAgICB9LFxuICAgIHtcbiAgICAgIG1ldGhvZDogcmVxLm1ldGhvZCxcbiAgICAgIHBhdGg6IHJlcS5wYXRoLFxuICAgICAgc3RhdHVzQ29kZSxcbiAgICAgIGVycm9yVHlwZSxcbiAgICB9XG4gICk7XG5cbiAgLy8gU2VuZCBlcnJvciByZXNwb25zZVxuICByZXMuc3RhdHVzKHN0YXR1c0NvZGUpLmpzb24oe1xuICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgIGVycm9yOiBlcnIubWVzc2FnZSB8fCAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyxcbiAgICByZXF1ZXN0SWQ6IHJlcS5yZXF1ZXN0SWQsXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gIH0pO1xufVxuXG4vKipcbiAqIE1pZGRsZXdhcmUgdG8gdXBkYXRlIHN5c3RlbSBtZXRyaWNzIHBlcmlvZGljYWxseVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3lzdGVtTWV0cmljc01pZGRsZXdhcmUoXG4gIHJlcTogUmVxdWVzdCwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgcmVzOiBSZXNwb25zZSwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgbmV4dDogTmV4dEZ1bmN0aW9uXG4pOiB2b2lkIHtcbiAgLy8gVXBkYXRlIHN5c3RlbSBtZXRyaWNzIGV2ZXJ5IDEwIHJlcXVlc3RzXG4gIGlmIChNYXRoLnJhbmRvbSgpIDwgMC4xKSB7XG4gICAgdXBkYXRlU3lzdGVtTWV0cmljcygpO1xuICB9XG5cbiAgbmV4dCgpO1xufVxuXG4vKipcbiAqIE1pZGRsZXdhcmUgdG8gbG9nIHNsb3cgcmVxdWVzdHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNsb3dSZXF1ZXN0TWlkZGxld2FyZShcbiAgc2xvd1RocmVzaG9sZE1zOiBudW1iZXIgPSAxMDAwXG4pIHtcbiAgcmV0dXJuIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbik6IHZvaWQgPT4ge1xuICAgIGNvbnN0IG9yaWdpbmFsU2VuZCA9IHJlcy5zZW5kO1xuXG4gICAgcmVzLnNlbmQgPSBmdW5jdGlvbiAoZGF0YTogYW55KSB7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSByZXEuc3RhcnRUaW1lO1xuXG4gICAgICBpZiAoZHVyYXRpb24gPiBzbG93VGhyZXNob2xkTXMpIHtcbiAgICAgICAgc3RydWN0dXJlZExvZ2dlci53YXJuKFxuICAgICAgICAgIGBTbG93IHJlcXVlc3QgZGV0ZWN0ZWQ6ICR7cmVxLm1ldGhvZH0gJHtyZXEucGF0aH0gdG9vayAke2R1cmF0aW9ufW1zYCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICByZXF1ZXN0SWQ6IHJlcS5yZXF1ZXN0SWQsXG4gICAgICAgICAgICB1c2VySWQ6IChyZXEgYXMgYW55KS51c2VySWQsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBtZXRob2Q6IHJlcS5tZXRob2QsXG4gICAgICAgICAgICBwYXRoOiByZXEucGF0aCxcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgdGhyZXNob2xkOiBzbG93VGhyZXNob2xkTXMsXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gb3JpZ2luYWxTZW5kLmNhbGwodGhpcywgZGF0YSk7XG4gICAgfTtcblxuICAgIG5leHQoKTtcbiAgfTtcbn1cblxuLyoqXG4gKiBNaWRkbGV3YXJlIHRvIGxvZyByZXF1ZXN0IGJvZHkgKGZvciBkZWJ1Z2dpbmcpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXF1ZXN0Qm9keUxvZ2dpbmdNaWRkbGV3YXJlKFxuICByZXE6IFJlcXVlc3QsXG4gIHJlczogUmVzcG9uc2UsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gIG5leHQ6IE5leHRGdW5jdGlvblxuKTogdm9pZCB7XG4gIGlmIChwcm9jZXNzLmVudi5MT0dfUkVRVUVTVF9CT0RZID09PSAndHJ1ZScgJiYgcmVxLm1ldGhvZCAhPT0gJ0dFVCcpIHtcbiAgICBzdHJ1Y3R1cmVkTG9nZ2VyLmRlYnVnKFxuICAgICAgYFJlcXVlc3QgYm9keTogJHtyZXEubWV0aG9kfSAke3JlcS5wYXRofWAsXG4gICAgICB7XG4gICAgICAgIHJlcXVlc3RJZDogcmVxLnJlcXVlc3RJZCxcbiAgICAgICAgdXNlcklkOiAocmVxIGFzIGFueSkudXNlcklkLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgYm9keTogcmVxLmJvZHksXG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIG5leHQoKTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQWVZO0lBQUFBLGNBQUEsWUFBQUEsQ0FBQTtNQUFBLE9BQUFDLGNBQUE7SUFBQTtFQUFBO0VBQUEsT0FBQUEsY0FBQTtBQUFB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