{"version":3,"names":["cov_1it3j1wrh1","actualCoverage","createSlice","createAsyncThunk","apiClient","initialState","s","isAuthenticated","isLoading","error","token","user","mfaRequired","mfaChallengeId","login","credentials","rejectWithValue","f","response","post","data","b","verifyMFA","challengeId","code","logout","_","authSlice","name","reducers","setToken","state","action","payload","clearError","extraReducers","builder","addCase","pending","fulfilled","rejected","actions","reducer"],"sources":["authSlice.ts"],"sourcesContent":["/**\n * Authentication Redux Slice\n */\n\nimport { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport apiClient from '../../services/api';\n\ninterface AuthState {\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  error: string | null;\n  token: string | null;\n  user: any | null;\n  mfaRequired: boolean;\n  mfaChallengeId: string | null;\n}\n\nconst initialState: AuthState = {\n  isAuthenticated: false,\n  isLoading: true,\n  error: null,\n  token: null,\n  user: null,\n  mfaRequired: false,\n  mfaChallengeId: null\n};\n\n/**\n * Login Thunk\n */\nexport const login = createAsyncThunk(\n  'auth/login',\n  async (credentials: { email: string; password: string }, { rejectWithValue }) => {\n    try {\n      const response = await apiClient.post('/auth/login', credentials);\n      return response.data;\n    } catch (error: any) {\n      return rejectWithValue(error.response?.data?.error || 'Login failed');\n    }\n  }\n);\n\n/**\n * Verify MFA Thunk\n */\nexport const verifyMFA = createAsyncThunk(\n  'auth/verifyMFA',\n  async (\n    { challengeId, code }: { challengeId: string; code: string },\n    { rejectWithValue }\n  ) => {\n    try {\n      const response = await apiClient.post('/auth/mfa/verify', {\n        challengeId,\n        code\n      });\n      return response.data;\n    } catch (error: any) {\n      return rejectWithValue(error.response?.data?.error || 'MFA verification failed');\n    }\n  }\n);\n\n/**\n * Logout Thunk\n */\nexport const logout = createAsyncThunk(\n  'auth/logout',\n  async (_, { rejectWithValue }) => {\n    try {\n      await apiClient.post('/auth/logout');\n      return null;\n    } catch (error: any) {\n      return rejectWithValue(error.response?.data?.error || 'Logout failed');\n    }\n  }\n);\n\n/**\n * Auth Slice\n */\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    setToken: (state, action: PayloadAction<string>) => {\n      state.token = action.payload;\n      state.isAuthenticated = true;\n    },\n    clearError: (state) => {\n      state.error = null;\n    }\n  },\n  extraReducers: (builder) => {\n    // Login\n    builder\n      .addCase(login.pending, (state) => {\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.isLoading = false;\n        if (action.payload.mfaRequired) {\n          state.mfaRequired = true;\n          state.mfaChallengeId = action.payload.challengeId;\n        } else {\n          state.isAuthenticated = true;\n          state.token = action.payload.token;\n          state.user = action.payload.user;\n        }\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.payload as string;\n      });\n\n    // Verify MFA\n    builder\n      .addCase(verifyMFA.pending, (state) => {\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(verifyMFA.fulfilled, (state, action) => {\n        state.isLoading = false;\n        state.isAuthenticated = true;\n        state.token = action.payload.token;\n        state.user = action.payload.user;\n        state.mfaRequired = false;\n        state.mfaChallengeId = null;\n      })\n      .addCase(verifyMFA.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.payload as string;\n      });\n\n    // Logout\n    builder\n      .addCase(logout.pending, (state) => {\n        state.isLoading = true;\n      })\n      .addCase(logout.fulfilled, (state) => {\n        state.isLoading = false;\n        state.isAuthenticated = false;\n        state.token = null;\n        state.user = null;\n        state.mfaRequired = false;\n        state.mfaChallengeId = null;\n      })\n      .addCase(logout.rejected, (state, action) => {\n        state.isLoading = false;\n        state.error = action.payload as string;\n      });\n  }\n});\n\nexport const { setToken, clearError } = authSlice.actions;\nexport default authSlice.reducer;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ;AACA;AACA;;AAEA,SAASE,WAAW,EAAEC,gBAAgB,QAAuB,kBAAkB;AAC/E,OAAOC,SAAS,MAAM,oBAAoB;AAY1C,MAAMC,YAAuB;AAAA;AAAA,CAAAL,cAAA,GAAAM,CAAA,OAAG;EAC9BC,eAAe,EAAE,KAAK;EACtBC,SAAS,EAAE,IAAI;EACfC,KAAK,EAAE,IAAI;EACXC,KAAK,EAAE,IAAI;EACXC,IAAI,EAAE,IAAI;EACVC,WAAW,EAAE,KAAK;EAClBC,cAAc,EAAE;AAClB,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMC,KAAK;AAAA;AAAA,CAAAd,cAAA,GAAAM,CAAA,OAAGH,gBAAgB,CACnC,YAAY,EACZ,OAAOY,WAAgD,EAAE;EAAEC;AAAgB,CAAC,KAAK;EAAA;EAAAhB,cAAA,GAAAiB,CAAA;EAAAjB,cAAA,GAAAM,CAAA;EAC/E,IAAI;IACF,MAAMY,QAAQ;IAAA;IAAA,CAAAlB,cAAA,GAAAM,CAAA,OAAG,MAAMF,SAAS,CAACe,IAAI,CAAC,aAAa,EAAEJ,WAAW,CAAC;IAAC;IAAAf,cAAA,GAAAM,CAAA;IAClE,OAAOY,QAAQ,CAACE,IAAI;EACtB,CAAC,CAAC,OAAOX,KAAU,EAAE;IAAA;IAAAT,cAAA,GAAAM,CAAA;IACnB,OAAOU,eAAe;IAAC;IAAA,CAAAhB,cAAA,GAAAqB,CAAA,UAAAZ,KAAK,CAACS,QAAQ,EAAEE,IAAI,EAAEX,KAAK;IAAA;IAAA,CAAAT,cAAA,GAAAqB,CAAA,UAAI,cAAc,EAAC;EACvE;AACF,CACF,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMC,SAAS;AAAA;AAAA,CAAAtB,cAAA,GAAAM,CAAA,OAAGH,gBAAgB,CACvC,gBAAgB,EAChB,OACE;EAAEoB,WAAW;EAAEC;AAA4C,CAAC,EAC5D;EAAER;AAAgB,CAAC,KAChB;EAAA;EAAAhB,cAAA,GAAAiB,CAAA;EAAAjB,cAAA,GAAAM,CAAA;EACH,IAAI;IACF,MAAMY,QAAQ;IAAA;IAAA,CAAAlB,cAAA,GAAAM,CAAA,OAAG,MAAMF,SAAS,CAACe,IAAI,CAAC,kBAAkB,EAAE;MACxDI,WAAW;MACXC;IACF,CAAC,CAAC;IAAC;IAAAxB,cAAA,GAAAM,CAAA;IACH,OAAOY,QAAQ,CAACE,IAAI;EACtB,CAAC,CAAC,OAAOX,KAAU,EAAE;IAAA;IAAAT,cAAA,GAAAM,CAAA;IACnB,OAAOU,eAAe;IAAC;IAAA,CAAAhB,cAAA,GAAAqB,CAAA,UAAAZ,KAAK,CAACS,QAAQ,EAAEE,IAAI,EAAEX,KAAK;IAAA;IAAA,CAAAT,cAAA,GAAAqB,CAAA,UAAI,yBAAyB,EAAC;EAClF;AACF,CACF,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMI,MAAM;AAAA;AAAA,CAAAzB,cAAA,GAAAM,CAAA,QAAGH,gBAAgB,CACpC,aAAa,EACb,OAAOuB,CAAC,EAAE;EAAEV;AAAgB,CAAC,KAAK;EAAA;EAAAhB,cAAA,GAAAiB,CAAA;EAAAjB,cAAA,GAAAM,CAAA;EAChC,IAAI;IAAA;IAAAN,cAAA,GAAAM,CAAA;IACF,MAAMF,SAAS,CAACe,IAAI,CAAC,cAAc,CAAC;IAAC;IAAAnB,cAAA,GAAAM,CAAA;IACrC,OAAO,IAAI;EACb,CAAC,CAAC,OAAOG,KAAU,EAAE;IAAA;IAAAT,cAAA,GAAAM,CAAA;IACnB,OAAOU,eAAe;IAAC;IAAA,CAAAhB,cAAA,GAAAqB,CAAA,UAAAZ,KAAK,CAACS,QAAQ,EAAEE,IAAI,EAAEX,KAAK;IAAA;IAAA,CAAAT,cAAA,GAAAqB,CAAA,UAAI,eAAe,EAAC;EACxE;AACF,CACF,CAAC;;AAED;AACA;AACA;AACA,MAAMM,SAAS;AAAA;AAAA,CAAA3B,cAAA,GAAAM,CAAA,QAAGJ,WAAW,CAAC;EAC5B0B,IAAI,EAAE,MAAM;EACZvB,YAAY;EACZwB,QAAQ,EAAE;IACRC,QAAQ,EAAEA,CAACC,KAAK,EAAEC,MAA6B,KAAK;MAAA;MAAAhC,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MAClDyB,KAAK,CAACrB,KAAK,GAAGsB,MAAM,CAACC,OAAO;MAAC;MAAAjC,cAAA,GAAAM,CAAA;MAC7ByB,KAAK,CAACxB,eAAe,GAAG,IAAI;IAC9B,CAAC;IACD2B,UAAU,EAAGH,KAAK,IAAK;MAAA;MAAA/B,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MACrByB,KAAK,CAACtB,KAAK,GAAG,IAAI;IACpB;EACF,CAAC;EACD0B,aAAa,EAAGC,OAAO,IAAK;IAAA;IAAApC,cAAA,GAAAiB,CAAA;IAAAjB,cAAA,GAAAM,CAAA;IAC1B;IACA8B,OAAO,CACJC,OAAO,CAACvB,KAAK,CAACwB,OAAO,EAAGP,KAAK,IAAK;MAAA;MAAA/B,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MACjCyB,KAAK,CAACvB,SAAS,GAAG,IAAI;MAAC;MAAAR,cAAA,GAAAM,CAAA;MACvByB,KAAK,CAACtB,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACD4B,OAAO,CAACvB,KAAK,CAACyB,SAAS,EAAE,CAACR,KAAK,EAAEC,MAAM,KAAK;MAAA;MAAAhC,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MAC3CyB,KAAK,CAACvB,SAAS,GAAG,KAAK;MAAC;MAAAR,cAAA,GAAAM,CAAA;MACxB,IAAI0B,MAAM,CAACC,OAAO,CAACrB,WAAW,EAAE;QAAA;QAAAZ,cAAA,GAAAqB,CAAA;QAAArB,cAAA,GAAAM,CAAA;QAC9ByB,KAAK,CAACnB,WAAW,GAAG,IAAI;QAAC;QAAAZ,cAAA,GAAAM,CAAA;QACzByB,KAAK,CAAClB,cAAc,GAAGmB,MAAM,CAACC,OAAO,CAACV,WAAW;MACnD,CAAC,MAAM;QAAA;QAAAvB,cAAA,GAAAqB,CAAA;QAAArB,cAAA,GAAAM,CAAA;QACLyB,KAAK,CAACxB,eAAe,GAAG,IAAI;QAAC;QAAAP,cAAA,GAAAM,CAAA;QAC7ByB,KAAK,CAACrB,KAAK,GAAGsB,MAAM,CAACC,OAAO,CAACvB,KAAK;QAAC;QAAAV,cAAA,GAAAM,CAAA;QACnCyB,KAAK,CAACpB,IAAI,GAAGqB,MAAM,CAACC,OAAO,CAACtB,IAAI;MAClC;IACF,CAAC,CAAC,CACD0B,OAAO,CAACvB,KAAK,CAAC0B,QAAQ,EAAE,CAACT,KAAK,EAAEC,MAAM,KAAK;MAAA;MAAAhC,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MAC1CyB,KAAK,CAACvB,SAAS,GAAG,KAAK;MAAC;MAAAR,cAAA,GAAAM,CAAA;MACxByB,KAAK,CAACtB,KAAK,GAAGuB,MAAM,CAACC,OAAiB;IACxC,CAAC,CAAC;;IAEJ;IAAA;IAAAjC,cAAA,GAAAM,CAAA;IACA8B,OAAO,CACJC,OAAO,CAACf,SAAS,CAACgB,OAAO,EAAGP,KAAK,IAAK;MAAA;MAAA/B,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MACrCyB,KAAK,CAACvB,SAAS,GAAG,IAAI;MAAC;MAAAR,cAAA,GAAAM,CAAA;MACvByB,KAAK,CAACtB,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACD4B,OAAO,CAACf,SAAS,CAACiB,SAAS,EAAE,CAACR,KAAK,EAAEC,MAAM,KAAK;MAAA;MAAAhC,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MAC/CyB,KAAK,CAACvB,SAAS,GAAG,KAAK;MAAC;MAAAR,cAAA,GAAAM,CAAA;MACxByB,KAAK,CAACxB,eAAe,GAAG,IAAI;MAAC;MAAAP,cAAA,GAAAM,CAAA;MAC7ByB,KAAK,CAACrB,KAAK,GAAGsB,MAAM,CAACC,OAAO,CAACvB,KAAK;MAAC;MAAAV,cAAA,GAAAM,CAAA;MACnCyB,KAAK,CAACpB,IAAI,GAAGqB,MAAM,CAACC,OAAO,CAACtB,IAAI;MAAC;MAAAX,cAAA,GAAAM,CAAA;MACjCyB,KAAK,CAACnB,WAAW,GAAG,KAAK;MAAC;MAAAZ,cAAA,GAAAM,CAAA;MAC1ByB,KAAK,CAAClB,cAAc,GAAG,IAAI;IAC7B,CAAC,CAAC,CACDwB,OAAO,CAACf,SAAS,CAACkB,QAAQ,EAAE,CAACT,KAAK,EAAEC,MAAM,KAAK;MAAA;MAAAhC,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MAC9CyB,KAAK,CAACvB,SAAS,GAAG,KAAK;MAAC;MAAAR,cAAA,GAAAM,CAAA;MACxByB,KAAK,CAACtB,KAAK,GAAGuB,MAAM,CAACC,OAAiB;IACxC,CAAC,CAAC;;IAEJ;IAAA;IAAAjC,cAAA,GAAAM,CAAA;IACA8B,OAAO,CACJC,OAAO,CAACZ,MAAM,CAACa,OAAO,EAAGP,KAAK,IAAK;MAAA;MAAA/B,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MAClCyB,KAAK,CAACvB,SAAS,GAAG,IAAI;IACxB,CAAC,CAAC,CACD6B,OAAO,CAACZ,MAAM,CAACc,SAAS,EAAGR,KAAK,IAAK;MAAA;MAAA/B,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MACpCyB,KAAK,CAACvB,SAAS,GAAG,KAAK;MAAC;MAAAR,cAAA,GAAAM,CAAA;MACxByB,KAAK,CAACxB,eAAe,GAAG,KAAK;MAAC;MAAAP,cAAA,GAAAM,CAAA;MAC9ByB,KAAK,CAACrB,KAAK,GAAG,IAAI;MAAC;MAAAV,cAAA,GAAAM,CAAA;MACnByB,KAAK,CAACpB,IAAI,GAAG,IAAI;MAAC;MAAAX,cAAA,GAAAM,CAAA;MAClByB,KAAK,CAACnB,WAAW,GAAG,KAAK;MAAC;MAAAZ,cAAA,GAAAM,CAAA;MAC1ByB,KAAK,CAAClB,cAAc,GAAG,IAAI;IAC7B,CAAC,CAAC,CACDwB,OAAO,CAACZ,MAAM,CAACe,QAAQ,EAAE,CAACT,KAAK,EAAEC,MAAM,KAAK;MAAA;MAAAhC,cAAA,GAAAiB,CAAA;MAAAjB,cAAA,GAAAM,CAAA;MAC3CyB,KAAK,CAACvB,SAAS,GAAG,KAAK;MAAC;MAAAR,cAAA,GAAAM,CAAA;MACxByB,KAAK,CAACtB,KAAK,GAAGuB,MAAM,CAACC,OAAiB;IACxC,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEH,QAAQ;EAAEI;AAAW,CAAC;AAAA;AAAA,CAAAlC,cAAA,GAAAM,CAAA,QAAGqB,SAAS,CAACc,OAAO;AACzD,eAAed,SAAS,CAACe,OAAO","ignoreList":[]}