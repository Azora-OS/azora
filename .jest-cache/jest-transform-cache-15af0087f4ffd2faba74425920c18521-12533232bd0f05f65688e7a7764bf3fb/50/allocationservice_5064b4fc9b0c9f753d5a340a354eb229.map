{"version":3,"names":["cov_8rmxwgymd","actualCoverage","generateUUID","AppError","auditService","allocations","s","Map","allocationRules","allocationAuditTrail","businessAllocations","AllocationService","createAllocation","transactionId","amount","businessShare","b","fundShare","userId","ipAddress","businessId","f","Math","abs","allocationId","now","Date","businessOwnerAmount","citadelFundAmount","allocation","id","allocatedAt","set","has","Set","get","add","logAllocationAction","toFixed","getAllocationByTransaction","Array","from","values","find","a","getBusinessAllocations","allocationIds","result","push","calculateTotalAllocations","totalRevenue","reduce","sum","businessOwnerTotal","citadelFundTotal","allocationCount","length","getAllocationRule","updateAllocationRule","ruleKey","getAllocationBreakdown","startDate","endDate","filtered","start","end","filter","allocDate","businessOwnerShare","citadelFundShare","businessOwnerPercentage","citadelFundPercentage","period","validateAllocation","errors","total","valid","getAllocationStats","totalAllocations","averageAllocation","largestAllocation","smallestAllocation","totalBusinessOwnerAmount","totalCitadelFundAmount","averageBusinessShare","averageFundShare","amounts","map","totalAmount","max","min","recalculateAllocations","newBusinessShare","newFundShare","totalNewBusinessOwnerAmount","totalNewCitadelFundAmount","oldTotalBusinessOwnerAmount","oldTotalCitadelFundAmount","forEach","recalculated","action","details","trail","timestamp","getAllocationAuditTrail","getAllAllocationAuditTrails","entries","exportAllocationAuditTrailAsCSV","headers","rows","entry","toISOString","csv","row","cell","join","allocationService"],"sources":["allocation.service.ts"],"sourcesContent":["import { generateUUID } from '../utils/uuid.js';\nimport { RevenueAllocation } from '../types/index.js';\nimport { AppError } from '../middleware/errorHandler.js';\nimport { auditService } from './audit.service.js';\n\n// Mock database - replace with actual database calls\nconst allocations: Map<string, RevenueAllocation> = new Map();\nconst allocationRules: Map<string, { businessShare: number; fundShare: number }> = new Map();\nconst allocationAuditTrail: Map<string, Array<{\n  timestamp: Date;\n  action: string;\n  details: string;\n  userId?: string;\n  ipAddress?: string;\n}>> = new Map();\n// Track which allocations belong to which business\nconst businessAllocations: Map<string, Set<string>> = new Map();\n\nexport class AllocationService {\n  /**\n   * Create allocation for a transaction (90/10 split by default)\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async createAllocation(\n    transactionId: string,\n    amount: number,\n    businessShare: number = 90,\n    fundShare: number = 10,\n    userId?: string,\n    ipAddress?: string,\n    businessId?: string\n  ): Promise<RevenueAllocation> {\n    // Validate shares add up to 100\n    if (Math.abs(businessShare + fundShare - 100) > 0.01) {\n      throw new AppError(400, 'Business share and fund share must add up to 100%');\n    }\n\n    // Validate amount\n    if (amount <= 0) {\n      throw new AppError(400, 'Amount must be positive');\n    }\n\n    const allocationId = generateUUID();\n    const now = new Date();\n\n    const businessOwnerAmount = (amount * businessShare) / 100;\n    const citadelFundAmount = (amount * fundShare) / 100;\n\n    const allocation: RevenueAllocation = {\n      id: allocationId,\n      transactionId,\n      businessOwnerAmount,\n      citadelFundAmount,\n      allocatedAt: now,\n    };\n\n    allocations.set(allocationId, allocation);\n\n    // Store allocation rule for this transaction\n    allocationRules.set(transactionId, {\n      businessShare,\n      fundShare,\n    });\n\n    // Track business allocation if businessId provided\n    if (businessId) {\n      if (!businessAllocations.has(businessId)) {\n        businessAllocations.set(businessId, new Set());\n      }\n      businessAllocations.get(businessId)!.add(allocationId);\n    }\n\n    // Log allocation creation\n    await this.logAllocationAction(\n      allocationId,\n      'allocation_created',\n      `Created allocation for transaction ${transactionId}: Business ${businessOwnerAmount.toFixed(2)}, Fund ${citadelFundAmount.toFixed(2)}`,\n      userId,\n      ipAddress\n    );\n\n    return allocation;\n  }\n\n  /**\n   * Get allocation by transaction ID\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async getAllocationByTransaction(transactionId: string): Promise<RevenueAllocation | null> {\n    const allocation = Array.from(allocations.values()).find(\n      (a) => a.transactionId === transactionId\n    );\n    return allocation || null;\n  }\n\n  /**\n   * Get all allocations for a business\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async getBusinessAllocations(businessId: string): Promise<RevenueAllocation[]> {\n    const allocationIds = businessAllocations.get(businessId) || new Set();\n    const result: RevenueAllocation[] = [];\n    \n    for (const allocationId of allocationIds) {\n      const allocation = allocations.get(allocationId);\n      if (allocation) {\n        result.push(allocation);\n      }\n    }\n    \n    return result;\n  }\n\n  /**\n   * Calculate total allocations for a business\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async calculateTotalAllocations(businessId: string): Promise<{\n    totalRevenue: number;\n    businessOwnerTotal: number;\n    citadelFundTotal: number;\n    allocationCount: number;\n  }> {\n    const businessAllocations = await this.getBusinessAllocations(businessId);\n\n    const totalRevenue = businessAllocations.reduce(\n      (sum, a) => sum + a.businessOwnerAmount + a.citadelFundAmount,\n      0\n    );\n    const businessOwnerTotal = businessAllocations.reduce(\n      (sum, a) => sum + a.businessOwnerAmount,\n      0\n    );\n    const citadelFundTotal = businessAllocations.reduce(\n      (sum, a) => sum + a.citadelFundAmount,\n      0\n    );\n\n    return {\n      totalRevenue,\n      businessOwnerTotal,\n      citadelFundTotal,\n      allocationCount: businessAllocations.length,\n    };\n  }\n\n  /**\n   * Get allocation rule for a transaction\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async getAllocationRule(transactionId: string): Promise<{\n    businessShare: number;\n    fundShare: number;\n  } | null> {\n    return allocationRules.get(transactionId) || null;\n  }\n\n  /**\n   * Update allocation rule (for future transactions)\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async updateAllocationRule(\n    businessId: string,\n    businessShare: number,\n    fundShare: number,\n    userId?: string,\n    ipAddress?: string\n  ): Promise<{\n    businessShare: number;\n    fundShare: number;\n  }> {\n    // Validate shares\n    if (Math.abs(businessShare + fundShare - 100) > 0.01) {\n      throw new AppError(400, 'Business share and fund share must add up to 100%');\n    }\n\n    if (businessShare < 0 || businessShare > 100 || fundShare < 0 || fundShare > 100) {\n      throw new AppError(400, 'Shares must be between 0 and 100');\n    }\n\n    // Store rule (would be stored per business in real implementation)\n    const ruleKey = `business_${businessId}`;\n    allocationRules.set(ruleKey, {\n      businessShare,\n      fundShare,\n    });\n\n    // Log rule update\n    await this.logAllocationAction(\n      ruleKey,\n      'allocation_rule_updated',\n      `Updated allocation rule for business ${businessId}: Business ${businessShare}%, Fund ${fundShare}%`,\n      userId,\n      ipAddress\n    );\n\n    return {\n      businessShare,\n      fundShare,\n    };\n  }\n\n  /**\n   * Get allocation breakdown by period\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async getAllocationBreakdown(\n    businessId: string,\n    startDate?: Date,\n    endDate?: Date\n  ): Promise<{\n    period: { startDate: Date; endDate: Date };\n    totalRevenue: number;\n    businessOwnerShare: number;\n    citadelFundShare: number;\n    businessOwnerPercentage: number;\n    citadelFundPercentage: number;\n    allocationCount: number;\n  }> {\n    const allocations = await this.getBusinessAllocations(businessId);\n\n    let filtered = allocations;\n\n    if (startDate || endDate) {\n      const start = startDate || new Date(0);\n      const end = endDate || new Date();\n\n      filtered = allocations.filter((a) => {\n        const allocDate = new Date(a.allocatedAt);\n        return allocDate >= start && allocDate <= end;\n      });\n    }\n\n    const totalRevenue = filtered.reduce(\n      (sum, a) => sum + a.businessOwnerAmount + a.citadelFundAmount,\n      0\n    );\n    const businessOwnerShare = filtered.reduce((sum, a) => sum + a.businessOwnerAmount, 0);\n    const citadelFundShare = filtered.reduce((sum, a) => sum + a.citadelFundAmount, 0);\n\n    const businessOwnerPercentage =\n      totalRevenue > 0 ? (businessOwnerShare / totalRevenue) * 100 : 0;\n    const citadelFundPercentage = totalRevenue > 0 ? (citadelFundShare / totalRevenue) * 100 : 0;\n\n    return {\n      period: {\n        startDate: startDate || new Date(),\n        endDate: endDate || new Date(),\n      },\n      totalRevenue,\n      businessOwnerShare,\n      citadelFundShare,\n      businessOwnerPercentage,\n      citadelFundPercentage,\n      allocationCount: filtered.length,\n    };\n  }\n\n  /**\n   * Validate allocation amounts\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  validateAllocation(\n    amount: number,\n    businessOwnerAmount: number,\n    citadelFundAmount: number\n  ): {\n    valid: boolean;\n    errors: string[];\n  } {\n    const errors: string[] = [];\n\n    if (amount <= 0) {\n      errors.push('Amount must be positive');\n    }\n\n    if (businessOwnerAmount < 0 || citadelFundAmount < 0) {\n      errors.push('Allocated amounts cannot be negative');\n    }\n\n    const total = businessOwnerAmount + citadelFundAmount;\n    if (Math.abs(total - amount) > 0.01) {\n      errors.push(\n        `Allocated amounts (${total}) do not match transaction amount (${amount})`\n      );\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n\n  /**\n   * Get allocation statistics\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async getAllocationStats(businessId: string): Promise<{\n    totalAllocations: number;\n    averageAllocation: number;\n    largestAllocation: number;\n    smallestAllocation: number;\n    totalBusinessOwnerAmount: number;\n    totalCitadelFundAmount: number;\n    averageBusinessShare: number;\n    averageFundShare: number;\n  }> {\n    const allocations = await this.getBusinessAllocations(businessId);\n\n    if (allocations.length === 0) {\n      return {\n        totalAllocations: 0,\n        averageAllocation: 0,\n        largestAllocation: 0,\n        smallestAllocation: 0,\n        totalBusinessOwnerAmount: 0,\n        totalCitadelFundAmount: 0,\n        averageBusinessShare: 0,\n        averageFundShare: 0,\n      };\n    }\n\n    const amounts = allocations.map((a) => a.businessOwnerAmount + a.citadelFundAmount);\n    const totalBusinessOwnerAmount = allocations.reduce((sum, a) => sum + a.businessOwnerAmount, 0);\n    const totalCitadelFundAmount = allocations.reduce((sum, a) => sum + a.citadelFundAmount, 0);\n    const totalAmount = totalBusinessOwnerAmount + totalCitadelFundAmount;\n\n    return {\n      totalAllocations: allocations.length,\n      averageAllocation: totalAmount / allocations.length,\n      largestAllocation: Math.max(...amounts),\n      smallestAllocation: Math.min(...amounts),\n      totalBusinessOwnerAmount,\n      totalCitadelFundAmount,\n      averageBusinessShare: (totalBusinessOwnerAmount / totalAmount) * 100,\n      averageFundShare: (totalCitadelFundAmount / totalAmount) * 100,\n    };\n  }\n\n  /**\n   * Recalculate allocations for a business (for rule changes)\n   * Requirements: 2.1, 2.2, 4.1\n   */\n  async recalculateAllocations(\n    businessId: string,\n    newBusinessShare: number,\n    newFundShare: number,\n    userId?: string,\n    ipAddress?: string\n  ): Promise<{\n    recalculated: number;\n    totalNewBusinessOwnerAmount: number;\n    totalNewCitadelFundAmount: number;\n  }> {\n    // Validate new shares\n    if (Math.abs(newBusinessShare + newFundShare - 100) > 0.01) {\n      throw new AppError(400, 'Business share and fund share must add up to 100%');\n    }\n\n    const businessAllocations = await this.getBusinessAllocations(businessId);\n    let totalNewBusinessOwnerAmount = 0;\n    let totalNewCitadelFundAmount = 0;\n    const oldTotalBusinessOwnerAmount = businessAllocations.reduce((sum, a) => sum + a.businessOwnerAmount, 0);\n    const oldTotalCitadelFundAmount = businessAllocations.reduce((sum, a) => sum + a.citadelFundAmount, 0);\n\n    // Recalculate each allocation\n    businessAllocations.forEach((allocation) => {\n      const totalAmount = allocation.businessOwnerAmount + allocation.citadelFundAmount;\n      allocation.businessOwnerAmount = (totalAmount * newBusinessShare) / 100;\n      allocation.citadelFundAmount = (totalAmount * newFundShare) / 100;\n\n      totalNewBusinessOwnerAmount += allocation.businessOwnerAmount;\n      totalNewCitadelFundAmount += allocation.citadelFundAmount;\n\n      allocations.set(allocation.id, allocation);\n    });\n\n    // Log recalculation\n    await this.logAllocationAction(\n      `recalc_${businessId}`,\n      'allocation_recalculated',\n      `Recalculated ${businessAllocations.length} allocations. Old: Business ${oldTotalBusinessOwnerAmount.toFixed(2)}, Fund ${oldTotalCitadelFundAmount.toFixed(2)}. New: Business ${totalNewBusinessOwnerAmount.toFixed(2)}, Fund ${totalNewCitadelFundAmount.toFixed(2)}`,\n      userId,\n      ipAddress\n    );\n\n    return {\n      recalculated: businessAllocations.length,\n      totalNewBusinessOwnerAmount,\n      totalNewCitadelFundAmount,\n    };\n  }\n\n  /**\n   * Log allocation action\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  private async logAllocationAction(\n    allocationId: string,\n    action: string,\n    details: string,\n    userId?: string,\n    ipAddress?: string\n  ): Promise<void> {\n    // Store in local audit trail\n    if (!allocationAuditTrail.has(allocationId)) {\n      allocationAuditTrail.set(allocationId, []);\n    }\n\n    const trail = allocationAuditTrail.get(allocationId)!;\n    trail.push({\n      timestamp: new Date(),\n      action,\n      details,\n      userId,\n      ipAddress,\n    });\n\n    // Also log to global audit service\n    await auditService.logAllocationAction(allocationId, action, details, userId, ipAddress);\n  }\n\n  /**\n   * Get allocation audit trail\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getAllocationAuditTrail(allocationId: string): Promise<Array<{\n    timestamp: Date;\n    action: string;\n    details: string;\n    userId?: string;\n    ipAddress?: string;\n  }>> {\n    return allocationAuditTrail.get(allocationId) || [];\n  }\n\n  /**\n   * Get all allocation audit trails\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async getAllAllocationAuditTrails(): Promise<Record<string, Array<{\n    timestamp: Date;\n    action: string;\n    details: string;\n    userId?: string;\n    ipAddress?: string;\n  }>>> {\n    const result: Record<string, Array<{\n      timestamp: Date;\n      action: string;\n      details: string;\n      userId?: string;\n      ipAddress?: string;\n    }>> = {};\n\n    for (const [allocationId, trail] of allocationAuditTrail.entries()) {\n      result[allocationId] = trail;\n    }\n\n    return result;\n  }\n\n  /**\n   * Export allocation audit trail as CSV\n   * Requirements: 7.1, 7.2, 7.3, 7.4\n   */\n  async exportAllocationAuditTrailAsCSV(allocationId: string): Promise<string> {\n    const trail = await this.getAllocationAuditTrail(allocationId);\n\n    const headers = ['Timestamp', 'Action', 'Details', 'User ID', 'IP Address'];\n    const rows = trail.map((entry) => [\n      entry.timestamp.toISOString(),\n      entry.action,\n      entry.details,\n      entry.userId || 'N/A',\n      entry.ipAddress || 'N/A',\n    ]);\n\n    const csv = [headers, ...rows].map((row) => row.map((cell) => `\"${cell}\"`).join(',')).join('\\n');\n\n    return csv;\n  }\n}\n\nexport const allocationService = new AllocationService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}