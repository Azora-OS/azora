{"version":3,"names":["cov_1k6xg837ye","actualCoverage","structuredLogger","HealthCheckService","lastMetrics","s","requestCount","errorCount","totalResponseTime","requestTimestamps","constructor","prisma","f","getHealthStatus","startTime","Date","now","checks","database","checkDatabase","cache","checkCache","aiEngines","checkAiEngines","memory","checkMemory","allStatuses","Object","values","map","c","status","hasUnhealthy","includes","hasDegraded","b","timestamp","toISOString","uptime","process","metrics","getMetrics","$queryRaw","responseTime","message","lastChecked","error","warn","memUsage","memoryUsage","heapUsedPercent","heapUsed","heapTotal","toFixed","oneSecondAgo","recentRequests","filter","t","length","errorRate","averageResponseTime","requestsPerSecond","parseFloat","activeConnections","recordRequest","isError","push","getDiagnostics","health","system","external","rss","nodeVersion","version","platform"],"sources":["health-check.service.ts"],"sourcesContent":["/**\n * Health Check Service\n * Provides detailed health status and metrics for monitoring\n */\n\nimport { PrismaClient } from '@prisma/client';\nimport { structuredLogger } from '../utils/structured-logger';\n\nexport interface HealthStatus {\n  status: 'healthy' | 'degraded' | 'unhealthy';\n  timestamp: string;\n  uptime: number;\n  checks: {\n    database: HealthCheck;\n    cache?: HealthCheck;\n    aiEngines?: HealthCheck;\n    memory?: HealthCheck;\n  };\n  metrics?: {\n    requestsPerSecond: number;\n    errorRate: number;\n    averageResponseTime: number;\n    activeConnections: number;\n  };\n}\n\nexport interface HealthCheck {\n  status: 'healthy' | 'degraded' | 'unhealthy';\n  responseTime: number;\n  message?: string;\n  lastChecked: string;\n}\n\nclass HealthCheckService {\n  private prisma: PrismaClient;\n  private lastMetrics = {\n    requestCount: 0,\n    errorCount: 0,\n    totalResponseTime: 0,\n    requestTimestamps: [] as number[],\n  };\n\n  constructor(prisma: PrismaClient) {\n    this.prisma = prisma;\n  }\n\n  /**\n   * Get overall health status\n   */\n  async getHealthStatus(): Promise<HealthStatus> {\n    const startTime = Date.now();\n    const checks = {\n      database: await this.checkDatabase(),\n      cache: await this.checkCache(),\n      aiEngines: await this.checkAiEngines(),\n      memory: this.checkMemory(),\n    };\n\n    // Determine overall status\n    const allStatuses = Object.values(checks).map(c => c.status);\n    const hasUnhealthy = allStatuses.includes('unhealthy');\n    const hasDegraded = allStatuses.includes('degraded');\n\n    const status = hasUnhealthy ? 'unhealthy' : hasDegraded ? 'degraded' : 'healthy';\n\n    return {\n      status,\n      timestamp: new Date().toISOString(),\n      uptime: process.uptime(),\n      checks,\n      metrics: this.getMetrics(),\n    };\n  }\n\n  /**\n   * Check database connectivity\n   */\n  private async checkDatabase(): Promise<HealthCheck> {\n    const startTime = Date.now();\n    try {\n      await this.prisma.$queryRaw`SELECT 1`;\n      const responseTime = Date.now() - startTime;\n\n      return {\n        status: responseTime < 100 ? 'healthy' : 'degraded',\n        responseTime,\n        message: 'Database connection successful',\n        lastChecked: new Date().toISOString(),\n      };\n    } catch (error) {\n      structuredLogger.error('Database health check failed', error as Error);\n      return {\n        status: 'unhealthy',\n        responseTime: Date.now() - startTime,\n        message: (error as Error).message,\n        lastChecked: new Date().toISOString(),\n      };\n    }\n  }\n\n  /**\n   * Check cache connectivity (Redis)\n   */\n  private async checkCache(): Promise<HealthCheck> {\n    const startTime = Date.now();\n    try {\n      // This would check Redis connection if configured\n      // For now, return healthy as cache is optional\n      return {\n        status: 'healthy',\n        responseTime: Date.now() - startTime,\n        message: 'Cache available',\n        lastChecked: new Date().toISOString(),\n      };\n    } catch (error) {\n      structuredLogger.warn('Cache health check failed', error as Error);\n      return {\n        status: 'degraded',\n        responseTime: Date.now() - startTime,\n        message: (error as Error).message,\n        lastChecked: new Date().toISOString(),\n      };\n    }\n  }\n\n  /**\n   * Check AI engines connectivity\n   */\n  private async checkAiEngines(): Promise<HealthCheck> {\n    const startTime = Date.now();\n    try {\n      // This would check Elara, Knowledge Ocean, Constitutional AI\n      // For now, return healthy as AI engines are optional\n      return {\n        status: 'healthy',\n        responseTime: Date.now() - startTime,\n        message: 'AI engines available',\n        lastChecked: new Date().toISOString(),\n      };\n    } catch (error) {\n      structuredLogger.warn('AI engines health check failed', error as Error);\n      return {\n        status: 'degraded',\n        responseTime: Date.now() - startTime,\n        message: (error as Error).message,\n        lastChecked: new Date().toISOString(),\n      };\n    }\n  }\n\n  /**\n   * Check memory usage\n   */\n  private checkMemory(): HealthCheck {\n    const memUsage = process.memoryUsage();\n    const heapUsedPercent = (memUsage.heapUsed / memUsage.heapTotal) * 100;\n\n    let status: 'healthy' | 'degraded' | 'unhealthy' = 'healthy';\n    if (heapUsedPercent > 90) {\n      status = 'unhealthy';\n    } else if (heapUsedPercent > 75) {\n      status = 'degraded';\n    }\n\n    return {\n      status,\n      responseTime: 0,\n      message: `Heap usage: ${heapUsedPercent.toFixed(2)}%`,\n      lastChecked: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Get performance metrics\n   */\n  private getMetrics() {\n    const now = Date.now();\n    const oneSecondAgo = now - 1000;\n\n    // Count requests in last second\n    const recentRequests = this.lastMetrics.requestTimestamps.filter(\n      t => t > oneSecondAgo\n    ).length;\n\n    // Clean up old timestamps\n    this.lastMetrics.requestTimestamps = this.lastMetrics.requestTimestamps.filter(\n      t => t > oneSecondAgo\n    );\n\n    const errorRate = this.lastMetrics.requestCount > 0\n      ? (this.lastMetrics.errorCount / this.lastMetrics.requestCount) * 100\n      : 0;\n\n    const averageResponseTime = this.lastMetrics.requestCount > 0\n      ? this.lastMetrics.totalResponseTime / this.lastMetrics.requestCount\n      : 0;\n\n    return {\n      requestsPerSecond: recentRequests,\n      errorRate: parseFloat(errorRate.toFixed(2)),\n      averageResponseTime: parseFloat(averageResponseTime.toFixed(2)),\n      activeConnections: this.lastMetrics.requestTimestamps.length,\n    };\n  }\n\n  /**\n   * Record request metric\n   */\n  recordRequest(responseTime: number, isError: boolean = false): void {\n    this.lastMetrics.requestCount++;\n    this.lastMetrics.totalResponseTime += responseTime;\n    if (isError) {\n      this.lastMetrics.errorCount++;\n    }\n    this.lastMetrics.requestTimestamps.push(Date.now());\n  }\n\n  /**\n   * Get detailed diagnostics\n   */\n  async getDiagnostics() {\n    const health = await this.getHealthStatus();\n    const memUsage = process.memoryUsage();\n\n    return {\n      health,\n      system: {\n        uptime: process.uptime(),\n        memory: {\n          heapUsed: `${(memUsage.heapUsed / 1024 / 1024).toFixed(2)} MB`,\n          heapTotal: `${(memUsage.heapTotal / 1024 / 1024).toFixed(2)} MB`,\n          external: `${(memUsage.external / 1024 / 1024).toFixed(2)} MB`,\n          rss: `${(memUsage.rss / 1024 / 1024).toFixed(2)} MB`,\n        },\n        nodeVersion: process.version,\n        platform: process.platform,\n      },\n      timestamp: new Date().toISOString(),\n    };\n  }\n}\n\nexport { HealthCheckService };\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IA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","ignoreList":[]}