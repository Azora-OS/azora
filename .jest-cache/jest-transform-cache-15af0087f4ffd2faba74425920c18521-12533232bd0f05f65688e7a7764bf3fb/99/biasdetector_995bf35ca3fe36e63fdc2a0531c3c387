dc787f19100994061473d87a48a97995
/* istanbul ignore next */
function cov_2f28gx3mc8() {
  var path = "/workspaces/azora/services/azora-cloud/constitutional-ai/validators/bias-detector.ts";
  var hash = "5d94ce671d274087420da69817dc5e6c7e65b2d9";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/azora-cloud/constitutional-ai/validators/bias-detector.ts",
    statementMap: {
      "0": {
        start: {
          line: 28,
          column: 43
        },
        end: {
          line: 34,
          column: 1
        }
      },
      "1": {
        start: {
          line: 55,
          column: 4
        },
        end: {
          line: 55,
          column: 51
        }
      },
      "2": {
        start: {
          line: 56,
          column: 4
        },
        end: {
          line: 56,
          column: 54
        }
      },
      "3": {
        start: {
          line: 63,
          column: 4
        },
        end: {
          line: 148,
          column: 6
        }
      },
      "4": {
        start: {
          line: 155,
          column: 4
        },
        end: {
          line: 163,
          column: 5
        }
      },
      "5": {
        start: {
          line: 156,
          column: 6
        },
        end: {
          line: 162,
          column: 8
        }
      },
      "6": {
        start: {
          line: 165,
          column: 23
        },
        end: {
          line: 165,
          column: 62
        }
      },
      "7": {
        start: {
          line: 166,
          column: 20
        },
        end: {
          line: 166,
          column: 41
        }
      },
      "8": {
        start: {
          line: 167,
          column: 28
        },
        end: {
          line: 167,
          column: 69
        }
      },
      "9": {
        start: {
          line: 170,
          column: 28
        },
        end: {
          line: 170,
          column: 33
        }
      },
      "10": {
        start: {
          line: 172,
          column: 4
        },
        end: {
          line: 175,
          column: 5
        }
      },
      "11": {
        start: {
          line: 173,
          column: 6
        },
        end: {
          line: 173,
          column: 68
        }
      },
      "12": {
        start: {
          line: 174,
          column: 6
        },
        end: {
          line: 174,
          column: 31
        }
      },
      "13": {
        start: {
          line: 177,
          column: 4
        },
        end: {
          line: 183,
          column: 6
        }
      },
      "14": {
        start: {
          line: 190,
          column: 36
        },
        end: {
          line: 190,
          column: 38
        }
      },
      "15": {
        start: {
          line: 192,
          column: 4
        },
        end: {
          line: 221,
          column: 5
        }
      },
      "16": {
        start: {
          line: 194,
          column: 6
        },
        end: {
          line: 196,
          column: 7
        }
      },
      "17": {
        start: {
          line: 195,
          column: 8
        },
        end: {
          line: 195,
          column: 17
        }
      },
      "18": {
        start: {
          line: 198,
          column: 6
        },
        end: {
          line: 220,
          column: 7
        }
      },
      "19": {
        start: {
          line: 199,
          column: 24
        },
        end: {
          line: 199,
          column: 58
        }
      },
      "20": {
        start: {
          line: 201,
          column: 8
        },
        end: {
          line: 219,
          column: 9
        }
      },
      "21": {
        start: {
          line: 202,
          column: 10
        },
        end: {
          line: 218,
          column: 11
        }
      },
      "22": {
        start: {
          line: 203,
          column: 31
        },
        end: {
          line: 203,
          column: 74
        }
      },
      "23": {
        start: {
          line: 206,
          column: 12
        },
        end: {
          line: 217,
          column: 13
        }
      },
      "24": {
        start: {
          line: 207,
          column: 14
        },
        end: {
          line: 216,
          column: 17
        }
      },
      "25": {
        start: {
          line: 223,
          column: 4
        },
        end: {
          line: 223,
          column: 22
        }
      },
      "26": {
        start: {
          line: 230,
          column: 4
        },
        end: {
          line: 232,
          column: 5
        }
      },
      "27": {
        start: {
          line: 231,
          column: 6
        },
        end: {
          line: 231,
          column: 20
        }
      },
      "28": {
        start: {
          line: 234,
          column: 24
        },
        end: {
          line: 234,
          column: 30
        }
      },
      "29": {
        start: {
          line: 237,
          column: 25
        },
        end: {
          line: 237,
          column: 88
        }
      },
      "30": {
        start: {
          line: 237,
          column: 52
        },
        end: {
          line: 237,
          column: 87
        }
      },
      "31": {
        start: {
          line: 239,
          column: 4
        },
        end: {
          line: 247,
          column: 5
        }
      },
      "32": {
        start: {
          line: 240,
          column: 25
        },
        end: {
          line: 240,
          column: 81
        }
      },
      "33": {
        start: {
          line: 241,
          column: 26
        },
        end: {
          line: 241,
          column: 75
        }
      },
      "34": {
        start: {
          line: 243,
          column: 6
        },
        end: {
          line: 246,
          column: 51
        }
      },
      "35": {
        start: {
          line: 249,
          column: 4
        },
        end: {
          line: 249,
          column: 25
        }
      },
      "36": {
        start: {
          line: 257,
          column: 21
        },
        end: {
          line: 257,
          column: 24
        }
      },
      "37": {
        start: {
          line: 260,
          column: 4
        },
        end: {
          line: 264,
          column: 5
        }
      },
      "38": {
        start: {
          line: 261,
          column: 6
        },
        end: {
          line: 261,
          column: 24
        }
      },
      "39": {
        start: {
          line: 262,
          column: 11
        },
        end: {
          line: 264,
          column: 5
        }
      },
      "40": {
        start: {
          line: 263,
          column: 6
        },
        end: {
          line: 263,
          column: 24
        }
      },
      "41": {
        start: {
          line: 267,
          column: 4
        },
        end: {
          line: 269,
          column: 5
        }
      },
      "42": {
        start: {
          line: 268,
          column: 6
        },
        end: {
          line: 268,
          column: 24
        }
      },
      "43": {
        start: {
          line: 272,
          column: 4
        },
        end: {
          line: 272,
          column: 37
        }
      },
      "44": {
        start: {
          line: 279,
          column: 4
        },
        end: {
          line: 281,
          column: 5
        }
      },
      "45": {
        start: {
          line: 280,
          column: 6
        },
        end: {
          line: 280,
          column: 30
        }
      },
      "46": {
        start: {
          line: 284,
          column: 26
        },
        end: {
          line: 289,
          column: 5
        }
      },
      "47": {
        start: {
          line: 291,
          column: 22
        },
        end: {
          line: 291,
          column: 38
        }
      },
      "48": {
        start: {
          line: 292,
          column: 4
        },
        end: {
          line: 298,
          column: 5
        }
      },
      "49": {
        start: {
          line: 293,
          column: 27
        },
        end: {
          line: 293,
          column: 64
        }
      },
      "50": {
        start: {
          line: 294,
          column: 23
        },
        end: {
          line: 294,
          column: 57
        }
      },
      "51": {
        start: {
          line: 295,
          column: 6
        },
        end: {
          line: 297,
          column: 7
        }
      },
      "52": {
        start: {
          line: 296,
          column: 8
        },
        end: {
          line: 296,
          column: 37
        }
      },
      "53": {
        start: {
          line: 300,
          column: 4
        },
        end: {
          line: 300,
          column: 23
        }
      },
      "54": {
        start: {
          line: 307,
          column: 26
        },
        end: {
          line: 307,
          column: 28
        }
      },
      "55": {
        start: {
          line: 308,
          column: 25
        },
        end: {
          line: 308,
          column: 59
        }
      },
      "56": {
        start: {
          line: 309,
          column: 23
        },
        end: {
          line: 309,
          column: 76
        }
      },
      "57": {
        start: {
          line: 311,
          column: 18
        },
        end: {
          line: 311,
          column: 58
        }
      },
      "58": {
        start: {
          line: 314,
          column: 4
        },
        end: {
          line: 316,
          column: 5
        }
      },
      "59": {
        start: {
          line: 315,
          column: 6
        },
        end: {
          line: 315,
          column: 32
        }
      },
      "60": {
        start: {
          line: 317,
          column: 4
        },
        end: {
          line: 319,
          column: 5
        }
      },
      "61": {
        start: {
          line: 318,
          column: 6
        },
        end: {
          line: 318,
          column: 32
        }
      },
      "62": {
        start: {
          line: 321,
          column: 4
        },
        end: {
          line: 321,
          column: 19
        }
      },
      "63": {
        start: {
          line: 329,
          column: 51
        },
        end: {
          line: 337,
          column: 5
        }
      },
      "64": {
        start: {
          line: 339,
          column: 4
        },
        end: {
          line: 339,
          column: 65
        }
      },
      "65": {
        start: {
          line: 346,
          column: 4
        },
        end: {
          line: 346,
          column: 48
        }
      },
      "66": {
        start: {
          line: 353,
          column: 4
        },
        end: {
          line: 353,
          column: 30
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 54,
            column: 2
          },
          end: {
            line: 54,
            column: 3
          }
        },
        loc: {
          start: {
            line: 54,
            column: 56
          },
          end: {
            line: 57,
            column: 3
          }
        },
        line: 54
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 62,
            column: 2
          },
          end: {
            line: 62,
            column: 3
          }
        },
        loc: {
          start: {
            line: 62,
            column: 50
          },
          end: {
            line: 149,
            column: 3
          }
        },
        line: 62
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 154,
            column: 2
          },
          end: {
            line: 154,
            column: 3
          }
        },
        loc: {
          start: {
            line: 154,
            column: 56
          },
          end: {
            line: 184,
            column: 3
          }
        },
        line: 154
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 189,
            column: 2
          },
          end: {
            line: 189,
            column: 3
          }
        },
        loc: {
          start: {
            line: 189,
            column: 67
          },
          end: {
            line: 224,
            column: 3
          }
        },
        line: 189
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 229,
            column: 2
          },
          end: {
            line: 229,
            column: 3
          }
        },
        loc: {
          start: {
            line: 229,
            column: 75
          },
          end: {
            line: 250,
            column: 3
          }
        },
        line: 229
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 237,
            column: 42
          },
          end: {
            line: 237,
            column: 43
          }
        },
        loc: {
          start: {
            line: 237,
            column: 52
          },
          end: {
            line: 237,
            column: 87
          }
        },
        line: 237
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 255,
            column: 2
          },
          end: {
            line: 255,
            column: 3
          }
        },
        loc: {
          start: {
            line: 255,
            column: 81
          },
          end: {
            line: 273,
            column: 3
          }
        },
        line: 255
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 278,
            column: 2
          },
          end: {
            line: 278,
            column: 3
          }
        },
        loc: {
          start: {
            line: 278,
            column: 74
          },
          end: {
            line: 301,
            column: 3
          }
        },
        line: 278
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 306,
            column: 2
          },
          end: {
            line: 306,
            column: 3
          }
        },
        loc: {
          start: {
            line: 306,
            column: 78
          },
          end: {
            line: 322,
            column: 3
          }
        },
        line: 306
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 327,
            column: 2
          },
          end: {
            line: 327,
            column: 3
          }
        },
        loc: {
          start: {
            line: 327,
            column: 80
          },
          end: {
            line: 340,
            column: 3
          }
        },
        line: 327
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 345,
            column: 2
          },
          end: {
            line: 345,
            column: 3
          }
        },
        loc: {
          start: {
            line: 345,
            column: 58
          },
          end: {
            line: 347,
            column: 3
          }
        },
        line: 345
      },
      "11": {
        name: "(anonymous_11)",
        decl: {
          start: {
            line: 352,
            column: 2
          },
          end: {
            line: 352,
            column: 3
          }
        },
        loc: {
          start: {
            line: 352,
            column: 34
          },
          end: {
            line: 354,
            column: 3
          }
        },
        line: 352
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 54,
            column: 14
          },
          end: {
            line: 54,
            column: 54
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 54,
            column: 52
          },
          end: {
            line: 54,
            column: 54
          }
        }],
        line: 54
      },
      "1": {
        loc: {
          start: {
            line: 155,
            column: 4
          },
          end: {
            line: 163,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 155,
            column: 4
          },
          end: {
            line: 163,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 155
      },
      "2": {
        loc: {
          start: {
            line: 155,
            column: 8
          },
          end: {
            line: 155,
            column: 69
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 155,
            column: 8
          },
          end: {
            line: 155,
            column: 28
          }
        }, {
          start: {
            line: 155,
            column: 32
          },
          end: {
            line: 155,
            column: 39
          }
        }, {
          start: {
            line: 155,
            column: 43
          },
          end: {
            line: 155,
            column: 69
          }
        }],
        line: 155
      },
      "3": {
        loc: {
          start: {
            line: 172,
            column: 4
          },
          end: {
            line: 175,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 172,
            column: 4
          },
          end: {
            line: 175,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 172
      },
      "4": {
        loc: {
          start: {
            line: 172,
            column: 8
          },
          end: {
            line: 172,
            column: 43
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 172,
            column: 8
          },
          end: {
            line: 172,
            column: 15
          }
        }, {
          start: {
            line: 172,
            column: 19
          },
          end: {
            line: 172,
            column: 43
          }
        }],
        line: 172
      },
      "5": {
        loc: {
          start: {
            line: 194,
            column: 6
          },
          end: {
            line: 196,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 194,
            column: 6
          },
          end: {
            line: 196,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 194
      },
      "6": {
        loc: {
          start: {
            line: 202,
            column: 10
          },
          end: {
            line: 218,
            column: 11
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 202,
            column: 10
          },
          end: {
            line: 218,
            column: 11
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 202
      },
      "7": {
        loc: {
          start: {
            line: 206,
            column: 12
          },
          end: {
            line: 217,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 206,
            column: 12
          },
          end: {
            line: 217,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 206
      },
      "8": {
        loc: {
          start: {
            line: 230,
            column: 4
          },
          end: {
            line: 232,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 230,
            column: 4
          },
          end: {
            line: 232,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 230
      },
      "9": {
        loc: {
          start: {
            line: 260,
            column: 4
          },
          end: {
            line: 264,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 260,
            column: 4
          },
          end: {
            line: 264,
            column: 5
          }
        }, {
          start: {
            line: 262,
            column: 11
          },
          end: {
            line: 264,
            column: 5
          }
        }],
        line: 260
      },
      "10": {
        loc: {
          start: {
            line: 262,
            column: 11
          },
          end: {
            line: 264,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 262,
            column: 11
          },
          end: {
            line: 264,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 262
      },
      "11": {
        loc: {
          start: {
            line: 267,
            column: 4
          },
          end: {
            line: 269,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 267,
            column: 4
          },
          end: {
            line: 269,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 267
      },
      "12": {
        loc: {
          start: {
            line: 279,
            column: 4
          },
          end: {
            line: 281,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 279,
            column: 4
          },
          end: {
            line: 281,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 279
      },
      "13": {
        loc: {
          start: {
            line: 295,
            column: 6
          },
          end: {
            line: 297,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 295,
            column: 6
          },
          end: {
            line: 297,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 295
      },
      "14": {
        loc: {
          start: {
            line: 314,
            column: 4
          },
          end: {
            line: 316,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 314,
            column: 4
          },
          end: {
            line: 316,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 314
      },
      "15": {
        loc: {
          start: {
            line: 317,
            column: 4
          },
          end: {
            line: 319,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 317,
            column: 4
          },
          end: {
            line: 319,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 317
      },
      "16": {
        loc: {
          start: {
            line: 339,
            column: 11
          },
          end: {
            line: 339,
            column: 64
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 339,
            column: 11
          },
          end: {
            line: 339,
            column: 33
          }
        }, {
          start: {
            line: 339,
            column: 37
          },
          end: {
            line: 339,
            column: 64
          }
        }],
        line: 339
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0,
      "65": 0,
      "66": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0
    },
    b: {
      "0": [0],
      "1": [0, 0],
      "2": [0, 0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0, 0],
      "15": [0, 0],
      "16": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "5d94ce671d274087420da69817dc5e6c7e65b2d9"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2f28gx3mc8 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2f28gx3mc8();
/**
 * Bias Detector Module
 * Detects and mitigates demographic bias in AI outputs
 */

import { BiasType, BiasSeverity } from '../types';

/**
 * Configuration for bias detection
 */

/**
 * Default configuration
 */
const DEFAULT_CONFIG =
/* istanbul ignore next */
(cov_2f28gx3mc8().s[0]++, {
  enabled: true,
  confidenceThreshold: 0.6,
  autoMitigate: true,
  severityThreshold: BiasSeverity.MEDIUM,
  biasTypesToCheck: Object.values(BiasType)
});

/**
 * Bias pattern definitions for detection
 */

/**
 * BiasDetector class
 * Implements demographic bias detection and mitigation
 */
export class BiasDetector {
  constructor(config =
  /* istanbul ignore next */
  (cov_2f28gx3mc8().b[0][0]++, {})) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[0]++;
    cov_2f28gx3mc8().s[1]++;
    this.config = {
      ...DEFAULT_CONFIG,
      ...config
    };
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[2]++;
    this.biasPatterns = this.initializeBiasPatterns();
  }

  /**
   * Initialize bias detection patterns
   */
  initializeBiasPatterns() {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[1]++;
    cov_2f28gx3mc8().s[3]++;
    return [
    // Gender bias patterns
    {
      type: BiasType.GENDER,
      patterns: [/\b(men|male|he|him|his)\s+(are|is)\s+(better|superior|smarter|stronger)\b/gi, /\b(women|female|she|her)\s+(are|is)\s+(worse|inferior|weaker|emotional)\b/gi, /\b(girls?|ladies)\s+(should|must|need to)\s+(stay|remain|be)\b/gi, /\b(boys?|men)\s+(don't|shouldn't|can't)\s+(cry|show emotion|be sensitive)\b/gi, /\b(woman|female)\s+driver\b/gi, /\b(man|male)\s+nurse\b/gi, /\bfor\s+a\s+(woman|girl|female)\b/gi],
      severity: BiasSeverity.HIGH,
      description: 'Gender-based stereotyping or discrimination'
    },
    // Race bias patterns
    {
      type: BiasType.RACE,
      patterns: [/\b(white|black|asian|hispanic|latino)\s+(people|person)\s+(are|is)\s+(better|worse|smarter|dumber)\b/gi, /\b(race|ethnicity)\s+(determines|defines|dictates)\b/gi, /\b(all|every)\s+(whites?|blacks?|asians?|hispanics?|latinos?)\s+(are|do|have)\b/gi, /\b(typical|stereotypical)\s+(white|black|asian|hispanic|latino)\b/gi],
      severity: BiasSeverity.CRITICAL,
      description: 'Racial stereotyping or discrimination'
    },
    // Age bias patterns
    {
      type: BiasType.AGE,
      patterns: [/\b(old|elderly|senior)\s+(people|person)\s+(can't|cannot|shouldn't)\b/gi, /\b(young|millennial|gen\s*z)\s+(people|person)\s+(are|is)\s+(lazy|entitled|irresponsible)\b/gi, /\btoo\s+(old|young)\s+(for|to)\b/gi, /\b(boomers?|millennials?)\s+(are|always|never)\b/gi],
      severity: BiasSeverity.MEDIUM,
      description: 'Age-based stereotyping or discrimination'
    },
    // Religion bias patterns
    {
      type: BiasType.RELIGION,
      patterns: [/\b(muslim|christian|jewish|hindu|buddhist)s?\s+(are|is)\s+(terrorist|extremist|radical)\b/gi, /\b(religion|faith)\s+(makes|causes)\s+(violence|terrorism|hatred)\b/gi, /\b(all|every)\s+(muslim|christian|jewish|hindu|buddhist)s?\s+(believe|think|do)\b/gi],
      severity: BiasSeverity.CRITICAL,
      description: 'Religious stereotyping or discrimination'
    },
    // Disability bias patterns
    {
      type: BiasType.DISABILITY,
      patterns: [/\b(disabled|handicapped)\s+(people|person)\s+(can't|cannot|shouldn't)\b/gi, /\b(wheelchair\s+bound|confined\s+to\s+wheelchair)\b/gi, /\b(suffers?\s+from|victim\s+of)\s+(disability|condition)\b/gi, /\b(normal|regular)\s+people\b/gi, /\b(retarded|crippled|lame)\b/gi],
      severity: BiasSeverity.HIGH,
      description: 'Disability-based stereotyping or ableist language'
    },
    // Socioeconomic bias patterns
    {
      type: BiasType.SOCIOECONOMIC,
      patterns: [/\b(poor|low-income)\s+(people|person)\s+(are|is)\s+(lazy|stupid|criminal)\b/gi, /\b(rich|wealthy)\s+(people|person)\s+(deserve|earned)\s+(everything|success)\b/gi, /\b(poverty|being\s+poor)\s+(is|means)\s+(their\s+fault|a\s+choice)\b/gi],
      severity: BiasSeverity.MEDIUM,
      description: 'Socioeconomic stereotyping or discrimination'
    },
    // Nationality bias patterns
    {
      type: BiasType.NATIONALITY,
      patterns: [/\b(all|every)\s+([A-Z][a-z]+)\s+(people|person)\s+(are|is)\s+(lazy|criminal|terrorist)\b/gi, /\b([A-Z][a-z]+)\s+(people|person)\s+(should|must)\s+(go\s+back|leave|stay\s+out)\b/gi],
      severity: BiasSeverity.HIGH,
      description: 'Nationality-based stereotyping or discrimination'
    }];
  }

  /**
   * Detect bias in output text
   */
  async detectBias(output) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[2]++;
    cov_2f28gx3mc8().s[4]++;
    if (
    /* istanbul ignore next */
    (cov_2f28gx3mc8().b[2][0]++, !this.config.enabled) ||
    /* istanbul ignore next */
    (cov_2f28gx3mc8().b[2][1]++, !output) ||
    /* istanbul ignore next */
    (cov_2f28gx3mc8().b[2][2]++, output.trim().length === 0)) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[1][0]++;
      cov_2f28gx3mc8().s[5]++;
      return {
        hasBias: false,
        biasTypes: [],
        overallSeverity: BiasSeverity.LOW,
        mitigatedOutput: undefined,
        mitigationApplied: false
      };
    } else
    /* istanbul ignore next */
    {
      cov_2f28gx3mc8().b[1][1]++;
    }
    const biasScores =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[6]++, await this.checkDemographicBias(output));
    const hasBias =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[7]++, biasScores.length > 0);
    const overallSeverity =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[8]++, this.calculateOverallSeverity(biasScores));
    let mitigatedOutput;
    let mitigationApplied =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[9]++, false);
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[10]++;
    if (
    /* istanbul ignore next */
    (cov_2f28gx3mc8().b[4][0]++, hasBias) &&
    /* istanbul ignore next */
    (cov_2f28gx3mc8().b[4][1]++, this.config.autoMitigate)) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[3][0]++;
      cov_2f28gx3mc8().s[11]++;
      mitigatedOutput = await this.mitigateBias(output, biasScores);
      /* istanbul ignore next */
      cov_2f28gx3mc8().s[12]++;
      mitigationApplied = true;
    } else
    /* istanbul ignore next */
    {
      cov_2f28gx3mc8().b[3][1]++;
    }
    cov_2f28gx3mc8().s[13]++;
    return {
      hasBias,
      biasTypes: biasScores,
      overallSeverity,
      mitigatedOutput,
      mitigationApplied
    };
  }

  /**
   * Check for demographic bias in text
   */
  async checkDemographicBias(output) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[3]++;
    const biasScores =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[14]++, []);
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[15]++;
    for (const pattern of this.biasPatterns) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().s[16]++;
      // Skip if this bias type is not configured to be checked
      if (!this.config.biasTypesToCheck.includes(pattern.type)) {
        /* istanbul ignore next */
        cov_2f28gx3mc8().b[5][0]++;
        cov_2f28gx3mc8().s[17]++;
        continue;
      } else
      /* istanbul ignore next */
      {
        cov_2f28gx3mc8().b[5][1]++;
      }
      cov_2f28gx3mc8().s[18]++;
      for (const regex of pattern.patterns) {
        const matches =
        /* istanbul ignore next */
        (cov_2f28gx3mc8().s[19]++, Array.from(output.matchAll(regex)));
        /* istanbul ignore next */
        cov_2f28gx3mc8().s[20]++;
        for (const match of matches) {
          /* istanbul ignore next */
          cov_2f28gx3mc8().s[21]++;
          if (match.index !== undefined) {
            /* istanbul ignore next */
            cov_2f28gx3mc8().b[6][0]++;
            const confidence =
            /* istanbul ignore next */
            (cov_2f28gx3mc8().s[22]++, this.calculateConfidence(match[0], pattern));

            // Only include if confidence meets threshold
            /* istanbul ignore next */
            cov_2f28gx3mc8().s[23]++;
            if (confidence >= this.config.confidenceThreshold) {
              /* istanbul ignore next */
              cov_2f28gx3mc8().b[7][0]++;
              cov_2f28gx3mc8().s[24]++;
              biasScores.push({
                type: pattern.type,
                severity: pattern.severity,
                confidence,
                context: this.extractContext(output, match.index, match[0].length),
                location: {
                  start: match.index,
                  end: match.index + match[0].length
                }
              });
            } else
            /* istanbul ignore next */
            {
              cov_2f28gx3mc8().b[7][1]++;
            }
          } else
          /* istanbul ignore next */
          {
            cov_2f28gx3mc8().b[6][1]++;
          }
        }
      }
    }
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[25]++;
    return biasScores;
  }

  /**
   * Mitigate detected bias in text
   */
  async mitigateBias(output, biases) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[4]++;
    cov_2f28gx3mc8().s[26]++;
    if (biases.length === 0) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[8][0]++;
      cov_2f28gx3mc8().s[27]++;
      return output;
    } else
    /* istanbul ignore next */
    {
      cov_2f28gx3mc8().b[8][1]++;
    }
    let mitigatedText =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[28]++, output);

    // Sort biases by location (descending) to avoid index shifting
    const sortedBiases =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[29]++, [...biases].sort((a, b) => {
      /* istanbul ignore next */
      cov_2f28gx3mc8().f[5]++;
      cov_2f28gx3mc8().s[30]++;
      return b.location.start - a.location.start;
    }));
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[31]++;
    for (const bias of sortedBiases) {
      const biasedText =
      /* istanbul ignore next */
      (cov_2f28gx3mc8().s[32]++, output.substring(bias.location.start, bias.location.end));
      const neutralText =
      /* istanbul ignore next */
      (cov_2f28gx3mc8().s[33]++, this.getNeutralReplacement(biasedText, bias.type));
      /* istanbul ignore next */
      cov_2f28gx3mc8().s[34]++;
      mitigatedText = mitigatedText.substring(0, bias.location.start) + neutralText + mitigatedText.substring(bias.location.end);
    }
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[35]++;
    return mitigatedText;
  }

  /**
   * Calculate confidence score for a bias match
   */
  calculateConfidence(matchedText, pattern) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[6]++;
    // Base confidence on pattern severity and match characteristics
    let confidence =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[36]++, 0.7); // Base confidence

    // Increase confidence for critical severity patterns
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[37]++;
    if (pattern.severity === BiasSeverity.CRITICAL) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[9][0]++;
      cov_2f28gx3mc8().s[38]++;
      confidence += 0.2;
    } else {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[9][1]++;
      cov_2f28gx3mc8().s[39]++;
      if (pattern.severity === BiasSeverity.HIGH) {
        /* istanbul ignore next */
        cov_2f28gx3mc8().b[10][0]++;
        cov_2f28gx3mc8().s[40]++;
        confidence += 0.1;
      } else
      /* istanbul ignore next */
      {
        cov_2f28gx3mc8().b[10][1]++;
      }
    }

    // Increase confidence for longer matches (more specific)
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[41]++;
    if (matchedText.length > 30) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[11][0]++;
      cov_2f28gx3mc8().s[42]++;
      confidence += 0.1;
    } else
    /* istanbul ignore next */
    {
      cov_2f28gx3mc8().b[11][1]++;
    }

    // Cap at 1.0
    cov_2f28gx3mc8().s[43]++;
    return Math.min(confidence, 1.0);
  }

  /**
   * Calculate overall severity from multiple bias scores
   */
  calculateOverallSeverity(biasScores) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[7]++;
    cov_2f28gx3mc8().s[44]++;
    if (biasScores.length === 0) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[12][0]++;
      cov_2f28gx3mc8().s[45]++;
      return BiasSeverity.LOW;
    } else
    /* istanbul ignore next */
    {
      cov_2f28gx3mc8().b[12][1]++;
    }

    // Find the highest severity
    const severityOrder =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[46]++, [BiasSeverity.LOW, BiasSeverity.MEDIUM, BiasSeverity.HIGH, BiasSeverity.CRITICAL]);
    let maxSeverity =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[47]++, BiasSeverity.LOW);
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[48]++;
    for (const score of biasScores) {
      const currentIndex =
      /* istanbul ignore next */
      (cov_2f28gx3mc8().s[49]++, severityOrder.indexOf(score.severity));
      const maxIndex =
      /* istanbul ignore next */
      (cov_2f28gx3mc8().s[50]++, severityOrder.indexOf(maxSeverity));
      /* istanbul ignore next */
      cov_2f28gx3mc8().s[51]++;
      if (currentIndex > maxIndex) {
        /* istanbul ignore next */
        cov_2f28gx3mc8().b[13][0]++;
        cov_2f28gx3mc8().s[52]++;
        maxSeverity = score.severity;
      } else
      /* istanbul ignore next */
      {
        cov_2f28gx3mc8().b[13][1]++;
      }
    }
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[53]++;
    return maxSeverity;
  }

  /**
   * Extract context around a bias match
   */
  extractContext(text, start, length) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[8]++;
    const contextRadius =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[54]++, 50);
    const contextStart =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[55]++, Math.max(0, start - contextRadius));
    const contextEnd =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[56]++, Math.min(text.length, start + length + contextRadius));
    let context =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[57]++, text.substring(contextStart, contextEnd));

    // Add ellipsis if truncated
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[58]++;
    if (contextStart > 0) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[14][0]++;
      cov_2f28gx3mc8().s[59]++;
      context = '...' + context;
    } else
    /* istanbul ignore next */
    {
      cov_2f28gx3mc8().b[14][1]++;
    }
    cov_2f28gx3mc8().s[60]++;
    if (contextEnd < text.length) {
      /* istanbul ignore next */
      cov_2f28gx3mc8().b[15][0]++;
      cov_2f28gx3mc8().s[61]++;
      context = context + '...';
    } else
    /* istanbul ignore next */
    {
      cov_2f28gx3mc8().b[15][1]++;
    }
    cov_2f28gx3mc8().s[62]++;
    return context;
  }

  /**
   * Get neutral replacement for biased text
   */
  getNeutralReplacement(biasedText, biasType) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[9]++;
    // Simple mitigation strategy: replace with neutral language
    const replacements =
    /* istanbul ignore next */
    (cov_2f28gx3mc8().s[63]++, {
      [BiasType.GENDER]: '[neutral language needed]',
      [BiasType.RACE]: '[neutral language needed]',
      [BiasType.AGE]: '[neutral language needed]',
      [BiasType.RELIGION]: '[neutral language needed]',
      [BiasType.DISABILITY]: '[neutral language needed]',
      [BiasType.SOCIOECONOMIC]: '[neutral language needed]',
      [BiasType.NATIONALITY]: '[neutral language needed]'
    });
    /* istanbul ignore next */
    cov_2f28gx3mc8().s[64]++;
    return /* istanbul ignore next */(cov_2f28gx3mc8().b[16][0]++, replacements[biasType]) ||
    /* istanbul ignore next */
    (cov_2f28gx3mc8().b[16][1]++, '[neutral language needed]');
  }

  /**
   * Update configuration
   */
  updateConfig(config) {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[10]++;
    cov_2f28gx3mc8().s[65]++;
    this.config = {
      ...this.config,
      ...config
    };
  }

  /**
   * Get current configuration
   */
  getConfig() {
    /* istanbul ignore next */
    cov_2f28gx3mc8().f[11]++;
    cov_2f28gx3mc8().s[66]++;
    return {
      ...this.config
    };
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMmYyOGd4M21jOCIsImFjdHVhbENvdmVyYWdlIiwiQmlhc1R5cGUiLCJCaWFzU2V2ZXJpdHkiLCJERUZBVUxUX0NPTkZJRyIsInMiLCJlbmFibGVkIiwiY29uZmlkZW5jZVRocmVzaG9sZCIsImF1dG9NaXRpZ2F0ZSIsInNldmVyaXR5VGhyZXNob2xkIiwiTUVESVVNIiwiYmlhc1R5cGVzVG9DaGVjayIsIk9iamVjdCIsInZhbHVlcyIsIkJpYXNEZXRlY3RvciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwiYiIsImYiLCJiaWFzUGF0dGVybnMiLCJpbml0aWFsaXplQmlhc1BhdHRlcm5zIiwidHlwZSIsIkdFTkRFUiIsInBhdHRlcm5zIiwic2V2ZXJpdHkiLCJISUdIIiwiZGVzY3JpcHRpb24iLCJSQUNFIiwiQ1JJVElDQUwiLCJBR0UiLCJSRUxJR0lPTiIsIkRJU0FCSUxJVFkiLCJTT0NJT0VDT05PTUlDIiwiTkFUSU9OQUxJVFkiLCJkZXRlY3RCaWFzIiwib3V0cHV0IiwidHJpbSIsImxlbmd0aCIsImhhc0JpYXMiLCJiaWFzVHlwZXMiLCJvdmVyYWxsU2V2ZXJpdHkiLCJMT1ciLCJtaXRpZ2F0ZWRPdXRwdXQiLCJ1bmRlZmluZWQiLCJtaXRpZ2F0aW9uQXBwbGllZCIsImJpYXNTY29yZXMiLCJjaGVja0RlbW9ncmFwaGljQmlhcyIsImNhbGN1bGF0ZU92ZXJhbGxTZXZlcml0eSIsIm1pdGlnYXRlQmlhcyIsInBhdHRlcm4iLCJpbmNsdWRlcyIsInJlZ2V4IiwibWF0Y2hlcyIsIkFycmF5IiwiZnJvbSIsIm1hdGNoQWxsIiwibWF0Y2giLCJpbmRleCIsImNvbmZpZGVuY2UiLCJjYWxjdWxhdGVDb25maWRlbmNlIiwicHVzaCIsImNvbnRleHQiLCJleHRyYWN0Q29udGV4dCIsImxvY2F0aW9uIiwic3RhcnQiLCJlbmQiLCJiaWFzZXMiLCJtaXRpZ2F0ZWRUZXh0Iiwic29ydGVkQmlhc2VzIiwic29ydCIsImEiLCJiaWFzIiwiYmlhc2VkVGV4dCIsInN1YnN0cmluZyIsIm5ldXRyYWxUZXh0IiwiZ2V0TmV1dHJhbFJlcGxhY2VtZW50IiwibWF0Y2hlZFRleHQiLCJNYXRoIiwibWluIiwic2V2ZXJpdHlPcmRlciIsIm1heFNldmVyaXR5Iiwic2NvcmUiLCJjdXJyZW50SW5kZXgiLCJpbmRleE9mIiwibWF4SW5kZXgiLCJ0ZXh0IiwiY29udGV4dFJhZGl1cyIsImNvbnRleHRTdGFydCIsIm1heCIsImNvbnRleHRFbmQiLCJiaWFzVHlwZSIsInJlcGxhY2VtZW50cyIsInVwZGF0ZUNvbmZpZyIsImdldENvbmZpZyJdLCJzb3VyY2VzIjpbImJpYXMtZGV0ZWN0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBCaWFzIERldGVjdG9yIE1vZHVsZVxuICogRGV0ZWN0cyBhbmQgbWl0aWdhdGVzIGRlbW9ncmFwaGljIGJpYXMgaW4gQUkgb3V0cHV0c1xuICovXG5cbmltcG9ydCB7XG4gIEJpYXNSZXBvcnQsXG4gIEJpYXNTY29yZSxcbiAgQmlhc1R5cGUsXG4gIEJpYXNTZXZlcml0eSxcbiAgSUJpYXNEZXRlY3RvclxufSBmcm9tICcuLi90eXBlcyc7XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBmb3IgYmlhcyBkZXRlY3Rpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBCaWFzRGV0ZWN0b3JDb25maWcge1xuICBlbmFibGVkOiBib29sZWFuO1xuICBjb25maWRlbmNlVGhyZXNob2xkOiBudW1iZXI7IC8vIDAtMVxuICBhdXRvTWl0aWdhdGU6IGJvb2xlYW47XG4gIHNldmVyaXR5VGhyZXNob2xkOiBCaWFzU2V2ZXJpdHk7XG4gIGJpYXNUeXBlc1RvQ2hlY2s6IEJpYXNUeXBlW107XG59XG5cbi8qKlxuICogRGVmYXVsdCBjb25maWd1cmF0aW9uXG4gKi9cbmNvbnN0IERFRkFVTFRfQ09ORklHOiBCaWFzRGV0ZWN0b3JDb25maWcgPSB7XG4gIGVuYWJsZWQ6IHRydWUsXG4gIGNvbmZpZGVuY2VUaHJlc2hvbGQ6IDAuNixcbiAgYXV0b01pdGlnYXRlOiB0cnVlLFxuICBzZXZlcml0eVRocmVzaG9sZDogQmlhc1NldmVyaXR5Lk1FRElVTSxcbiAgYmlhc1R5cGVzVG9DaGVjazogT2JqZWN0LnZhbHVlcyhCaWFzVHlwZSlcbn07XG5cbi8qKlxuICogQmlhcyBwYXR0ZXJuIGRlZmluaXRpb25zIGZvciBkZXRlY3Rpb25cbiAqL1xuaW50ZXJmYWNlIEJpYXNQYXR0ZXJuIHtcbiAgdHlwZTogQmlhc1R5cGU7XG4gIHBhdHRlcm5zOiBSZWdFeHBbXTtcbiAgc2V2ZXJpdHk6IEJpYXNTZXZlcml0eTtcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbn1cblxuLyoqXG4gKiBCaWFzRGV0ZWN0b3IgY2xhc3NcbiAqIEltcGxlbWVudHMgZGVtb2dyYXBoaWMgYmlhcyBkZXRlY3Rpb24gYW5kIG1pdGlnYXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIEJpYXNEZXRlY3RvciBpbXBsZW1lbnRzIElCaWFzRGV0ZWN0b3Ige1xuICBwcml2YXRlIGNvbmZpZzogQmlhc0RldGVjdG9yQ29uZmlnO1xuICBwcml2YXRlIGJpYXNQYXR0ZXJuczogQmlhc1BhdHRlcm5bXTtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IFBhcnRpYWw8Qmlhc0RldGVjdG9yQ29uZmlnPiA9IHt9KSB7XG4gICAgdGhpcy5jb25maWcgPSB7IC4uLkRFRkFVTFRfQ09ORklHLCAuLi5jb25maWcgfTtcbiAgICB0aGlzLmJpYXNQYXR0ZXJucyA9IHRoaXMuaW5pdGlhbGl6ZUJpYXNQYXR0ZXJucygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYmlhcyBkZXRlY3Rpb24gcGF0dGVybnNcbiAgICovXG4gIHByaXZhdGUgaW5pdGlhbGl6ZUJpYXNQYXR0ZXJucygpOiBCaWFzUGF0dGVybltdIHtcbiAgICByZXR1cm4gW1xuICAgICAgLy8gR2VuZGVyIGJpYXMgcGF0dGVybnNcbiAgICAgIHtcbiAgICAgICAgdHlwZTogQmlhc1R5cGUuR0VOREVSLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgIC9cXGIobWVufG1hbGV8aGV8aGltfGhpcylcXHMrKGFyZXxpcylcXHMrKGJldHRlcnxzdXBlcmlvcnxzbWFydGVyfHN0cm9uZ2VyKVxcYi9naSxcbiAgICAgICAgICAvXFxiKHdvbWVufGZlbWFsZXxzaGV8aGVyKVxccysoYXJlfGlzKVxccysod29yc2V8aW5mZXJpb3J8d2Vha2VyfGVtb3Rpb25hbClcXGIvZ2ksXG4gICAgICAgICAgL1xcYihnaXJscz98bGFkaWVzKVxccysoc2hvdWxkfG11c3R8bmVlZCB0bylcXHMrKHN0YXl8cmVtYWlufGJlKVxcYi9naSxcbiAgICAgICAgICAvXFxiKGJveXM/fG1lbilcXHMrKGRvbid0fHNob3VsZG4ndHxjYW4ndClcXHMrKGNyeXxzaG93IGVtb3Rpb258YmUgc2Vuc2l0aXZlKVxcYi9naSxcbiAgICAgICAgICAvXFxiKHdvbWFufGZlbWFsZSlcXHMrZHJpdmVyXFxiL2dpLFxuICAgICAgICAgIC9cXGIobWFufG1hbGUpXFxzK251cnNlXFxiL2dpLFxuICAgICAgICAgIC9cXGJmb3JcXHMrYVxccysod29tYW58Z2lybHxmZW1hbGUpXFxiL2dpXG4gICAgICAgIF0sXG4gICAgICAgIHNldmVyaXR5OiBCaWFzU2V2ZXJpdHkuSElHSCxcbiAgICAgICAgZGVzY3JpcHRpb246ICdHZW5kZXItYmFzZWQgc3RlcmVvdHlwaW5nIG9yIGRpc2NyaW1pbmF0aW9uJ1xuICAgICAgfSxcbiAgICAgIC8vIFJhY2UgYmlhcyBwYXR0ZXJuc1xuICAgICAge1xuICAgICAgICB0eXBlOiBCaWFzVHlwZS5SQUNFLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgIC9cXGIod2hpdGV8YmxhY2t8YXNpYW58aGlzcGFuaWN8bGF0aW5vKVxccysocGVvcGxlfHBlcnNvbilcXHMrKGFyZXxpcylcXHMrKGJldHRlcnx3b3JzZXxzbWFydGVyfGR1bWJlcilcXGIvZ2ksXG4gICAgICAgICAgL1xcYihyYWNlfGV0aG5pY2l0eSlcXHMrKGRldGVybWluZXN8ZGVmaW5lc3xkaWN0YXRlcylcXGIvZ2ksXG4gICAgICAgICAgL1xcYihhbGx8ZXZlcnkpXFxzKyh3aGl0ZXM/fGJsYWNrcz98YXNpYW5zP3xoaXNwYW5pY3M/fGxhdGlub3M/KVxccysoYXJlfGRvfGhhdmUpXFxiL2dpLFxuICAgICAgICAgIC9cXGIodHlwaWNhbHxzdGVyZW90eXBpY2FsKVxccysod2hpdGV8YmxhY2t8YXNpYW58aGlzcGFuaWN8bGF0aW5vKVxcYi9naVxuICAgICAgICBdLFxuICAgICAgICBzZXZlcml0eTogQmlhc1NldmVyaXR5LkNSSVRJQ0FMLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1JhY2lhbCBzdGVyZW90eXBpbmcgb3IgZGlzY3JpbWluYXRpb24nXG4gICAgICB9LFxuICAgICAgLy8gQWdlIGJpYXMgcGF0dGVybnNcbiAgICAgIHtcbiAgICAgICAgdHlwZTogQmlhc1R5cGUuQUdFLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgIC9cXGIob2xkfGVsZGVybHl8c2VuaW9yKVxccysocGVvcGxlfHBlcnNvbilcXHMrKGNhbid0fGNhbm5vdHxzaG91bGRuJ3QpXFxiL2dpLFxuICAgICAgICAgIC9cXGIoeW91bmd8bWlsbGVubmlhbHxnZW5cXHMqeilcXHMrKHBlb3BsZXxwZXJzb24pXFxzKyhhcmV8aXMpXFxzKyhsYXp5fGVudGl0bGVkfGlycmVzcG9uc2libGUpXFxiL2dpLFxuICAgICAgICAgIC9cXGJ0b29cXHMrKG9sZHx5b3VuZylcXHMrKGZvcnx0bylcXGIvZ2ksXG4gICAgICAgICAgL1xcYihib29tZXJzP3xtaWxsZW5uaWFscz8pXFxzKyhhcmV8YWx3YXlzfG5ldmVyKVxcYi9naVxuICAgICAgICBdLFxuICAgICAgICBzZXZlcml0eTogQmlhc1NldmVyaXR5Lk1FRElVTSxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBZ2UtYmFzZWQgc3RlcmVvdHlwaW5nIG9yIGRpc2NyaW1pbmF0aW9uJ1xuICAgICAgfSxcbiAgICAgIC8vIFJlbGlnaW9uIGJpYXMgcGF0dGVybnNcbiAgICAgIHtcbiAgICAgICAgdHlwZTogQmlhc1R5cGUuUkVMSUdJT04sXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgL1xcYihtdXNsaW18Y2hyaXN0aWFufGpld2lzaHxoaW5kdXxidWRkaGlzdClzP1xccysoYXJlfGlzKVxccysodGVycm9yaXN0fGV4dHJlbWlzdHxyYWRpY2FsKVxcYi9naSxcbiAgICAgICAgICAvXFxiKHJlbGlnaW9ufGZhaXRoKVxccysobWFrZXN8Y2F1c2VzKVxccysodmlvbGVuY2V8dGVycm9yaXNtfGhhdHJlZClcXGIvZ2ksXG4gICAgICAgICAgL1xcYihhbGx8ZXZlcnkpXFxzKyhtdXNsaW18Y2hyaXN0aWFufGpld2lzaHxoaW5kdXxidWRkaGlzdClzP1xccysoYmVsaWV2ZXx0aGlua3xkbylcXGIvZ2lcbiAgICAgICAgXSxcbiAgICAgICAgc2V2ZXJpdHk6IEJpYXNTZXZlcml0eS5DUklUSUNBTCxcbiAgICAgICAgZGVzY3JpcHRpb246ICdSZWxpZ2lvdXMgc3RlcmVvdHlwaW5nIG9yIGRpc2NyaW1pbmF0aW9uJ1xuICAgICAgfSxcbiAgICAgIC8vIERpc2FiaWxpdHkgYmlhcyBwYXR0ZXJuc1xuICAgICAge1xuICAgICAgICB0eXBlOiBCaWFzVHlwZS5ESVNBQklMSVRZLFxuICAgICAgICBwYXR0ZXJuczogW1xuICAgICAgICAgIC9cXGIoZGlzYWJsZWR8aGFuZGljYXBwZWQpXFxzKyhwZW9wbGV8cGVyc29uKVxccysoY2FuJ3R8Y2Fubm90fHNob3VsZG4ndClcXGIvZ2ksXG4gICAgICAgICAgL1xcYih3aGVlbGNoYWlyXFxzK2JvdW5kfGNvbmZpbmVkXFxzK3RvXFxzK3doZWVsY2hhaXIpXFxiL2dpLFxuICAgICAgICAgIC9cXGIoc3VmZmVycz9cXHMrZnJvbXx2aWN0aW1cXHMrb2YpXFxzKyhkaXNhYmlsaXR5fGNvbmRpdGlvbilcXGIvZ2ksXG4gICAgICAgICAgL1xcYihub3JtYWx8cmVndWxhcilcXHMrcGVvcGxlXFxiL2dpLFxuICAgICAgICAgIC9cXGIocmV0YXJkZWR8Y3JpcHBsZWR8bGFtZSlcXGIvZ2lcbiAgICAgICAgXSxcbiAgICAgICAgc2V2ZXJpdHk6IEJpYXNTZXZlcml0eS5ISUdILFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0Rpc2FiaWxpdHktYmFzZWQgc3RlcmVvdHlwaW5nIG9yIGFibGVpc3QgbGFuZ3VhZ2UnXG4gICAgICB9LFxuICAgICAgLy8gU29jaW9lY29ub21pYyBiaWFzIHBhdHRlcm5zXG4gICAgICB7XG4gICAgICAgIHR5cGU6IEJpYXNUeXBlLlNPQ0lPRUNPTk9NSUMsXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgL1xcYihwb29yfGxvdy1pbmNvbWUpXFxzKyhwZW9wbGV8cGVyc29uKVxccysoYXJlfGlzKVxccysobGF6eXxzdHVwaWR8Y3JpbWluYWwpXFxiL2dpLFxuICAgICAgICAgIC9cXGIocmljaHx3ZWFsdGh5KVxccysocGVvcGxlfHBlcnNvbilcXHMrKGRlc2VydmV8ZWFybmVkKVxccysoZXZlcnl0aGluZ3xzdWNjZXNzKVxcYi9naSxcbiAgICAgICAgICAvXFxiKHBvdmVydHl8YmVpbmdcXHMrcG9vcilcXHMrKGlzfG1lYW5zKVxccysodGhlaXJcXHMrZmF1bHR8YVxccytjaG9pY2UpXFxiL2dpXG4gICAgICAgIF0sXG4gICAgICAgIHNldmVyaXR5OiBCaWFzU2V2ZXJpdHkuTUVESVVNLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1NvY2lvZWNvbm9taWMgc3RlcmVvdHlwaW5nIG9yIGRpc2NyaW1pbmF0aW9uJ1xuICAgICAgfSxcbiAgICAgIC8vIE5hdGlvbmFsaXR5IGJpYXMgcGF0dGVybnNcbiAgICAgIHtcbiAgICAgICAgdHlwZTogQmlhc1R5cGUuTkFUSU9OQUxJVFksXG4gICAgICAgIHBhdHRlcm5zOiBbXG4gICAgICAgICAgL1xcYihhbGx8ZXZlcnkpXFxzKyhbQS1aXVthLXpdKylcXHMrKHBlb3BsZXxwZXJzb24pXFxzKyhhcmV8aXMpXFxzKyhsYXp5fGNyaW1pbmFsfHRlcnJvcmlzdClcXGIvZ2ksXG4gICAgICAgICAgL1xcYihbQS1aXVthLXpdKylcXHMrKHBlb3BsZXxwZXJzb24pXFxzKyhzaG91bGR8bXVzdClcXHMrKGdvXFxzK2JhY2t8bGVhdmV8c3RheVxccytvdXQpXFxiL2dpXG4gICAgICAgIF0sXG4gICAgICAgIHNldmVyaXR5OiBCaWFzU2V2ZXJpdHkuSElHSCxcbiAgICAgICAgZGVzY3JpcHRpb246ICdOYXRpb25hbGl0eS1iYXNlZCBzdGVyZW90eXBpbmcgb3IgZGlzY3JpbWluYXRpb24nXG4gICAgICB9XG4gICAgXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlY3QgYmlhcyBpbiBvdXRwdXQgdGV4dFxuICAgKi9cbiAgYXN5bmMgZGV0ZWN0QmlhcyhvdXRwdXQ6IHN0cmluZyk6IFByb21pc2U8Qmlhc1JlcG9ydD4ge1xuICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlZCB8fCAhb3V0cHV0IHx8IG91dHB1dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBoYXNCaWFzOiBmYWxzZSxcbiAgICAgICAgYmlhc1R5cGVzOiBbXSxcbiAgICAgICAgb3ZlcmFsbFNldmVyaXR5OiBCaWFzU2V2ZXJpdHkuTE9XLFxuICAgICAgICBtaXRpZ2F0ZWRPdXRwdXQ6IHVuZGVmaW5lZCxcbiAgICAgICAgbWl0aWdhdGlvbkFwcGxpZWQ6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IGJpYXNTY29yZXMgPSBhd2FpdCB0aGlzLmNoZWNrRGVtb2dyYXBoaWNCaWFzKG91dHB1dCk7XG4gICAgY29uc3QgaGFzQmlhcyA9IGJpYXNTY29yZXMubGVuZ3RoID4gMDtcbiAgICBjb25zdCBvdmVyYWxsU2V2ZXJpdHkgPSB0aGlzLmNhbGN1bGF0ZU92ZXJhbGxTZXZlcml0eShiaWFzU2NvcmVzKTtcblxuICAgIGxldCBtaXRpZ2F0ZWRPdXRwdXQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICBsZXQgbWl0aWdhdGlvbkFwcGxpZWQgPSBmYWxzZTtcblxuICAgIGlmIChoYXNCaWFzICYmIHRoaXMuY29uZmlnLmF1dG9NaXRpZ2F0ZSkge1xuICAgICAgbWl0aWdhdGVkT3V0cHV0ID0gYXdhaXQgdGhpcy5taXRpZ2F0ZUJpYXMob3V0cHV0LCBiaWFzU2NvcmVzKTtcbiAgICAgIG1pdGlnYXRpb25BcHBsaWVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgaGFzQmlhcyxcbiAgICAgIGJpYXNUeXBlczogYmlhc1Njb3JlcyxcbiAgICAgIG92ZXJhbGxTZXZlcml0eSxcbiAgICAgIG1pdGlnYXRlZE91dHB1dCxcbiAgICAgIG1pdGlnYXRpb25BcHBsaWVkXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBmb3IgZGVtb2dyYXBoaWMgYmlhcyBpbiB0ZXh0XG4gICAqL1xuICBhc3luYyBjaGVja0RlbW9ncmFwaGljQmlhcyhvdXRwdXQ6IHN0cmluZyk6IFByb21pc2U8Qmlhc1Njb3JlW10+IHtcbiAgICBjb25zdCBiaWFzU2NvcmVzOiBCaWFzU2NvcmVbXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHRoaXMuYmlhc1BhdHRlcm5zKSB7XG4gICAgICAvLyBTa2lwIGlmIHRoaXMgYmlhcyB0eXBlIGlzIG5vdCBjb25maWd1cmVkIHRvIGJlIGNoZWNrZWRcbiAgICAgIGlmICghdGhpcy5jb25maWcuYmlhc1R5cGVzVG9DaGVjay5pbmNsdWRlcyhwYXR0ZXJuLnR5cGUpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGNvbnN0IHJlZ2V4IG9mIHBhdHRlcm4ucGF0dGVybnMpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IEFycmF5LmZyb20ob3V0cHV0Lm1hdGNoQWxsKHJlZ2V4KSk7XG5cbiAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRjaGVzKSB7XG4gICAgICAgICAgaWYgKG1hdGNoLmluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZGVuY2UgPSB0aGlzLmNhbGN1bGF0ZUNvbmZpZGVuY2UobWF0Y2hbMF0sIHBhdHRlcm4pO1xuXG4gICAgICAgICAgICAvLyBPbmx5IGluY2x1ZGUgaWYgY29uZmlkZW5jZSBtZWV0cyB0aHJlc2hvbGRcbiAgICAgICAgICAgIGlmIChjb25maWRlbmNlID49IHRoaXMuY29uZmlnLmNvbmZpZGVuY2VUaHJlc2hvbGQpIHtcbiAgICAgICAgICAgICAgYmlhc1Njb3Jlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiBwYXR0ZXJuLnR5cGUsXG4gICAgICAgICAgICAgICAgc2V2ZXJpdHk6IHBhdHRlcm4uc2V2ZXJpdHksXG4gICAgICAgICAgICAgICAgY29uZmlkZW5jZSxcbiAgICAgICAgICAgICAgICBjb250ZXh0OiB0aGlzLmV4dHJhY3RDb250ZXh0KG91dHB1dCwgbWF0Y2guaW5kZXgsIG1hdGNoWzBdLmxlbmd0aCksXG4gICAgICAgICAgICAgICAgbG9jYXRpb246IHtcbiAgICAgICAgICAgICAgICAgIHN0YXJ0OiBtYXRjaC5pbmRleCxcbiAgICAgICAgICAgICAgICAgIGVuZDogbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGhcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBiaWFzU2NvcmVzO1xuICB9XG5cbiAgLyoqXG4gICAqIE1pdGlnYXRlIGRldGVjdGVkIGJpYXMgaW4gdGV4dFxuICAgKi9cbiAgYXN5bmMgbWl0aWdhdGVCaWFzKG91dHB1dDogc3RyaW5nLCBiaWFzZXM6IEJpYXNTY29yZVtdKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBpZiAoYmlhc2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG5cbiAgICBsZXQgbWl0aWdhdGVkVGV4dCA9IG91dHB1dDtcblxuICAgIC8vIFNvcnQgYmlhc2VzIGJ5IGxvY2F0aW9uIChkZXNjZW5kaW5nKSB0byBhdm9pZCBpbmRleCBzaGlmdGluZ1xuICAgIGNvbnN0IHNvcnRlZEJpYXNlcyA9IFsuLi5iaWFzZXNdLnNvcnQoKGEsIGIpID0+IGIubG9jYXRpb24uc3RhcnQgLSBhLmxvY2F0aW9uLnN0YXJ0KTtcblxuICAgIGZvciAoY29uc3QgYmlhcyBvZiBzb3J0ZWRCaWFzZXMpIHtcbiAgICAgIGNvbnN0IGJpYXNlZFRleHQgPSBvdXRwdXQuc3Vic3RyaW5nKGJpYXMubG9jYXRpb24uc3RhcnQsIGJpYXMubG9jYXRpb24uZW5kKTtcbiAgICAgIGNvbnN0IG5ldXRyYWxUZXh0ID0gdGhpcy5nZXROZXV0cmFsUmVwbGFjZW1lbnQoYmlhc2VkVGV4dCwgYmlhcy50eXBlKTtcblxuICAgICAgbWl0aWdhdGVkVGV4dCA9XG4gICAgICAgIG1pdGlnYXRlZFRleHQuc3Vic3RyaW5nKDAsIGJpYXMubG9jYXRpb24uc3RhcnQpICtcbiAgICAgICAgbmV1dHJhbFRleHQgK1xuICAgICAgICBtaXRpZ2F0ZWRUZXh0LnN1YnN0cmluZyhiaWFzLmxvY2F0aW9uLmVuZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1pdGlnYXRlZFRleHQ7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIGNvbmZpZGVuY2Ugc2NvcmUgZm9yIGEgYmlhcyBtYXRjaFxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVDb25maWRlbmNlKG1hdGNoZWRUZXh0OiBzdHJpbmcsIHBhdHRlcm46IEJpYXNQYXR0ZXJuKTogbnVtYmVyIHtcbiAgICAvLyBCYXNlIGNvbmZpZGVuY2Ugb24gcGF0dGVybiBzZXZlcml0eSBhbmQgbWF0Y2ggY2hhcmFjdGVyaXN0aWNzXG4gICAgbGV0IGNvbmZpZGVuY2UgPSAwLjc7IC8vIEJhc2UgY29uZmlkZW5jZVxuXG4gICAgLy8gSW5jcmVhc2UgY29uZmlkZW5jZSBmb3IgY3JpdGljYWwgc2V2ZXJpdHkgcGF0dGVybnNcbiAgICBpZiAocGF0dGVybi5zZXZlcml0eSA9PT0gQmlhc1NldmVyaXR5LkNSSVRJQ0FMKSB7XG4gICAgICBjb25maWRlbmNlICs9IDAuMjtcbiAgICB9IGVsc2UgaWYgKHBhdHRlcm4uc2V2ZXJpdHkgPT09IEJpYXNTZXZlcml0eS5ISUdIKSB7XG4gICAgICBjb25maWRlbmNlICs9IDAuMTtcbiAgICB9XG5cbiAgICAvLyBJbmNyZWFzZSBjb25maWRlbmNlIGZvciBsb25nZXIgbWF0Y2hlcyAobW9yZSBzcGVjaWZpYylcbiAgICBpZiAobWF0Y2hlZFRleHQubGVuZ3RoID4gMzApIHtcbiAgICAgIGNvbmZpZGVuY2UgKz0gMC4xO1xuICAgIH1cblxuICAgIC8vIENhcCBhdCAxLjBcbiAgICByZXR1cm4gTWF0aC5taW4oY29uZmlkZW5jZSwgMS4wKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgb3ZlcmFsbCBzZXZlcml0eSBmcm9tIG11bHRpcGxlIGJpYXMgc2NvcmVzXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZU92ZXJhbGxTZXZlcml0eShiaWFzU2NvcmVzOiBCaWFzU2NvcmVbXSk6IEJpYXNTZXZlcml0eSB7XG4gICAgaWYgKGJpYXNTY29yZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gQmlhc1NldmVyaXR5LkxPVztcbiAgICB9XG5cbiAgICAvLyBGaW5kIHRoZSBoaWdoZXN0IHNldmVyaXR5XG4gICAgY29uc3Qgc2V2ZXJpdHlPcmRlciA9IFtcbiAgICAgIEJpYXNTZXZlcml0eS5MT1csXG4gICAgICBCaWFzU2V2ZXJpdHkuTUVESVVNLFxuICAgICAgQmlhc1NldmVyaXR5LkhJR0gsXG4gICAgICBCaWFzU2V2ZXJpdHkuQ1JJVElDQUxcbiAgICBdO1xuXG4gICAgbGV0IG1heFNldmVyaXR5ID0gQmlhc1NldmVyaXR5LkxPVztcbiAgICBmb3IgKGNvbnN0IHNjb3JlIG9mIGJpYXNTY29yZXMpIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IHNldmVyaXR5T3JkZXIuaW5kZXhPZihzY29yZS5zZXZlcml0eSk7XG4gICAgICBjb25zdCBtYXhJbmRleCA9IHNldmVyaXR5T3JkZXIuaW5kZXhPZihtYXhTZXZlcml0eSk7XG4gICAgICBpZiAoY3VycmVudEluZGV4ID4gbWF4SW5kZXgpIHtcbiAgICAgICAgbWF4U2V2ZXJpdHkgPSBzY29yZS5zZXZlcml0eTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbWF4U2V2ZXJpdHk7XG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdCBjb250ZXh0IGFyb3VuZCBhIGJpYXMgbWF0Y2hcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdENvbnRleHQodGV4dDogc3RyaW5nLCBzdGFydDogbnVtYmVyLCBsZW5ndGg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgY29udGV4dFJhZGl1cyA9IDUwO1xuICAgIGNvbnN0IGNvbnRleHRTdGFydCA9IE1hdGgubWF4KDAsIHN0YXJ0IC0gY29udGV4dFJhZGl1cyk7XG4gICAgY29uc3QgY29udGV4dEVuZCA9IE1hdGgubWluKHRleHQubGVuZ3RoLCBzdGFydCArIGxlbmd0aCArIGNvbnRleHRSYWRpdXMpO1xuXG4gICAgbGV0IGNvbnRleHQgPSB0ZXh0LnN1YnN0cmluZyhjb250ZXh0U3RhcnQsIGNvbnRleHRFbmQpO1xuXG4gICAgLy8gQWRkIGVsbGlwc2lzIGlmIHRydW5jYXRlZFxuICAgIGlmIChjb250ZXh0U3RhcnQgPiAwKSB7XG4gICAgICBjb250ZXh0ID0gJy4uLicgKyBjb250ZXh0O1xuICAgIH1cbiAgICBpZiAoY29udGV4dEVuZCA8IHRleHQubGVuZ3RoKSB7XG4gICAgICBjb250ZXh0ID0gY29udGV4dCArICcuLi4nO1xuICAgIH1cblxuICAgIHJldHVybiBjb250ZXh0O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBuZXV0cmFsIHJlcGxhY2VtZW50IGZvciBiaWFzZWQgdGV4dFxuICAgKi9cbiAgcHJpdmF0ZSBnZXROZXV0cmFsUmVwbGFjZW1lbnQoYmlhc2VkVGV4dDogc3RyaW5nLCBiaWFzVHlwZTogQmlhc1R5cGUpOiBzdHJpbmcge1xuICAgIC8vIFNpbXBsZSBtaXRpZ2F0aW9uIHN0cmF0ZWd5OiByZXBsYWNlIHdpdGggbmV1dHJhbCBsYW5ndWFnZVxuICAgIGNvbnN0IHJlcGxhY2VtZW50czogUmVjb3JkPEJpYXNUeXBlLCBzdHJpbmc+ID0ge1xuICAgICAgW0JpYXNUeXBlLkdFTkRFUl06ICdbbmV1dHJhbCBsYW5ndWFnZSBuZWVkZWRdJyxcbiAgICAgIFtCaWFzVHlwZS5SQUNFXTogJ1tuZXV0cmFsIGxhbmd1YWdlIG5lZWRlZF0nLFxuICAgICAgW0JpYXNUeXBlLkFHRV06ICdbbmV1dHJhbCBsYW5ndWFnZSBuZWVkZWRdJyxcbiAgICAgIFtCaWFzVHlwZS5SRUxJR0lPTl06ICdbbmV1dHJhbCBsYW5ndWFnZSBuZWVkZWRdJyxcbiAgICAgIFtCaWFzVHlwZS5ESVNBQklMSVRZXTogJ1tuZXV0cmFsIGxhbmd1YWdlIG5lZWRlZF0nLFxuICAgICAgW0JpYXNUeXBlLlNPQ0lPRUNPTk9NSUNdOiAnW25ldXRyYWwgbGFuZ3VhZ2UgbmVlZGVkXScsXG4gICAgICBbQmlhc1R5cGUuTkFUSU9OQUxJVFldOiAnW25ldXRyYWwgbGFuZ3VhZ2UgbmVlZGVkXSdcbiAgICB9O1xuXG4gICAgcmV0dXJuIHJlcGxhY2VtZW50c1tiaWFzVHlwZV0gfHwgJ1tuZXV0cmFsIGxhbmd1YWdlIG5lZWRlZF0nO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBjb25maWd1cmF0aW9uXG4gICAqL1xuICB1cGRhdGVDb25maWcoY29uZmlnOiBQYXJ0aWFsPEJpYXNEZXRlY3RvckNvbmZpZz4pOiB2b2lkIHtcbiAgICB0aGlzLmNvbmZpZyA9IHsgLi4udGhpcy5jb25maWcsIC4uLmNvbmZpZyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIGdldENvbmZpZygpOiBCaWFzRGV0ZWN0b3JDb25maWcge1xuICAgIHJldHVybiB7IC4uLnRoaXMuY29uZmlnIH07XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBZVk7SUFBQUEsY0FBQSxZQUFBQSxDQUFBO01BQUEsT0FBQUMsY0FBQTtJQUFBO0VBQUE7RUFBQSxPQUFBQSxjQUFBO0FBQUE7QUFBQUQsY0FBQTtBQWZaO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFNBR0VFLFFBQVEsRUFDUkMsWUFBWSxR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