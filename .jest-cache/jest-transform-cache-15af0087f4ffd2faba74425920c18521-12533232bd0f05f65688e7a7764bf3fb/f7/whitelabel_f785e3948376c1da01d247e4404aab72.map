{"version":3,"names":["cov_utmfwsa8o","actualCoverage","PrismaClient","logger","ErrorHandler","prisma","s","WhiteLabelService","enableWhiteLabel","licenseId","f","info","license","enterpriseLicense","findUnique","where","id","b","Error","update","data","whiteLabel","error","handle","setCustomDomain","domain","domainRegex","test","existingLicense","findFirst","customDomain","not","enterpriseCustomization","upsert","licenseId_type_key","type","key","value","create","description","setBranding","branding","brandingEntries","primaryColor","secondaryColor","logoUrl","faviconUrl","companyName","supportEmail","supportPhone","entry","getBranding","customizations","findMany","forEach","custom","enableSSO","ssoConfig","ssoEnabled","JSON","stringify","getSSO","parse","enableAPI","apiConfig","apiAccessEnabled","getWhiteLabelConfig","config","apiCustom","getCustomizations","orderBy","map","c","deleteCustomization","customizationId","delete"],"sources":["white-label.ts"],"sourcesContent":["/**\n * White-Label Features Service\n * Manages custom branding, domains, and white-label configurations\n */\n\nimport { PrismaClient, CustomizationType } from '@prisma/client';\nimport { logger } from '../shared/logging';\nimport { ErrorHandler } from '../payment/error-handler';\n\nconst prisma = new PrismaClient();\n\nexport interface BrandingConfig {\n  primaryColor?: string;\n  secondaryColor?: string;\n  logoUrl?: string;\n  faviconUrl?: string;\n  companyName?: string;\n  supportEmail?: string;\n  supportPhone?: string;\n}\n\nexport interface WhiteLabelConfig {\n  customDomain?: string;\n  branding?: BrandingConfig;\n  ssoConfig?: any;\n  apiConfig?: any;\n  features?: string[];\n}\n\nexport class WhiteLabelService {\n  /**\n   * Enable white-label for license\n   */\n  async enableWhiteLabel(licenseId: string): Promise<void> {\n    try {\n      logger.info('Enabling white-label', { licenseId });\n\n      const license = await prisma.enterpriseLicense.findUnique({\n        where: { id: licenseId },\n      });\n\n      if (!license) {\n        throw new Error(`License ${licenseId} not found`);\n      }\n\n      await prisma.enterpriseLicense.update({\n        where: { id: licenseId },\n        data: { whiteLabel: true },\n      });\n\n      logger.info('White-label enabled', { licenseId });\n    } catch (error) {\n      logger.error('Failed to enable white-label', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Set custom domain\n   */\n  async setCustomDomain(licenseId: string, domain: string): Promise<void> {\n    try {\n      logger.info('Setting custom domain', { licenseId, domain });\n\n      // Validate domain format\n      const domainRegex = /^([a-z0-9]([a-z0-9-]*[a-z0-9])?\\.)+[a-z]{2,}$/i;\n      if (!domainRegex.test(domain)) {\n        throw new Error('Invalid domain format');\n      }\n\n      // Check if domain is already in use\n      const existingLicense = await prisma.enterpriseLicense.findFirst({\n        where: {\n          customDomain: domain,\n          id: { not: licenseId },\n        },\n      });\n\n      if (existingLicense) {\n        throw new Error('Domain is already in use');\n      }\n\n      await prisma.enterpriseLicense.update({\n        where: { id: licenseId },\n        data: { customDomain: domain },\n      });\n\n      // Store customization\n      await prisma.enterpriseCustomization.upsert({\n        where: {\n          licenseId_type_key: {\n            licenseId,\n            type: 'DOMAIN',\n            key: 'customDomain',\n          },\n        },\n        update: { value: domain },\n        create: {\n          licenseId,\n          type: 'DOMAIN',\n          key: 'customDomain',\n          value: domain,\n          description: 'Custom domain for white-label',\n        },\n      });\n\n      logger.info('Custom domain set', { licenseId, domain });\n    } catch (error) {\n      logger.error('Failed to set custom domain', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Set branding configuration\n   */\n  async setBranding(licenseId: string, branding: BrandingConfig): Promise<void> {\n    try {\n      logger.info('Setting branding', { licenseId });\n\n      // Store each branding element\n      const brandingEntries = [\n        { key: 'primaryColor', value: branding.primaryColor },\n        { key: 'secondaryColor', value: branding.secondaryColor },\n        { key: 'logoUrl', value: branding.logoUrl },\n        { key: 'faviconUrl', value: branding.faviconUrl },\n        { key: 'companyName', value: branding.companyName },\n        { key: 'supportEmail', value: branding.supportEmail },\n        { key: 'supportPhone', value: branding.supportPhone },\n      ];\n\n      for (const entry of brandingEntries) {\n        if (entry.value) {\n          await prisma.enterpriseCustomization.upsert({\n            where: {\n              licenseId_type_key: {\n                licenseId,\n                type: 'BRANDING',\n                key: entry.key,\n              },\n            },\n            update: { value: entry.value },\n            create: {\n              licenseId,\n              type: 'BRANDING',\n              key: entry.key,\n              value: entry.value,\n              description: `Branding: ${entry.key}`,\n            },\n          });\n        }\n      }\n\n      logger.info('Branding set', { licenseId });\n    } catch (error) {\n      logger.error('Failed to set branding', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Get branding configuration\n   */\n  async getBranding(licenseId: string): Promise<BrandingConfig> {\n    try {\n      const customizations = await prisma.enterpriseCustomization.findMany({\n        where: {\n          licenseId,\n          type: 'BRANDING',\n        },\n      });\n\n      const branding: BrandingConfig = {};\n\n      customizations.forEach((custom) => {\n        branding[custom.key as keyof BrandingConfig] = custom.value as any;\n      });\n\n      return branding;\n    } catch (error) {\n      logger.error('Failed to get branding', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Enable SSO integration\n   */\n  async enableSSO(licenseId: string, ssoConfig: any): Promise<void> {\n    try {\n      logger.info('Enabling SSO', { licenseId });\n\n      await prisma.enterpriseLicense.update({\n        where: { id: licenseId },\n        data: { ssoEnabled: true },\n      });\n\n      // Store SSO configuration\n      await prisma.enterpriseCustomization.upsert({\n        where: {\n          licenseId_type_key: {\n            licenseId,\n            type: 'SSO',\n            key: 'ssoConfig',\n          },\n        },\n        update: { value: JSON.stringify(ssoConfig) },\n        create: {\n          licenseId,\n          type: 'SSO',\n          key: 'ssoConfig',\n          value: JSON.stringify(ssoConfig),\n          description: 'SSO configuration',\n        },\n      });\n\n      logger.info('SSO enabled', { licenseId });\n    } catch (error) {\n      logger.error('Failed to enable SSO', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Get SSO configuration\n   */\n  async getSSO(licenseId: string): Promise<any | null> {\n    try {\n      const custom = await prisma.enterpriseCustomization.findFirst({\n        where: {\n          licenseId,\n          type: 'SSO',\n          key: 'ssoConfig',\n        },\n      });\n\n      if (!custom) {\n        return null;\n      }\n\n      return JSON.parse(custom.value);\n    } catch (error) {\n      logger.error('Failed to get SSO config', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Enable API access\n   */\n  async enableAPI(licenseId: string, apiConfig: any): Promise<void> {\n    try {\n      logger.info('Enabling API access', { licenseId });\n\n      await prisma.enterpriseLicense.update({\n        where: { id: licenseId },\n        data: { apiAccessEnabled: true },\n      });\n\n      // Store API configuration\n      await prisma.enterpriseCustomization.upsert({\n        where: {\n          licenseId_type_key: {\n            licenseId,\n            type: 'API',\n            key: 'apiConfig',\n          },\n        },\n        update: { value: JSON.stringify(apiConfig) },\n        create: {\n          licenseId,\n          type: 'API',\n          key: 'apiConfig',\n          value: JSON.stringify(apiConfig),\n          description: 'API configuration',\n        },\n      });\n\n      logger.info('API access enabled', { licenseId });\n    } catch (error) {\n      logger.error('Failed to enable API', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Get white-label configuration\n   */\n  async getWhiteLabelConfig(licenseId: string): Promise<WhiteLabelConfig> {\n    try {\n      const license = await prisma.enterpriseLicense.findUnique({\n        where: { id: licenseId },\n      });\n\n      if (!license) {\n        throw new Error(`License ${licenseId} not found`);\n      }\n\n      const config: WhiteLabelConfig = {};\n\n      if (license.customDomain) {\n        config.customDomain = license.customDomain;\n      }\n\n      if (license.whiteLabel) {\n        config.branding = await this.getBranding(licenseId);\n      }\n\n      if (license.ssoEnabled) {\n        config.ssoConfig = await this.getSSO(licenseId);\n      }\n\n      if (license.apiAccessEnabled) {\n        const apiCustom = await prisma.enterpriseCustomization.findFirst({\n          where: {\n            licenseId,\n            type: 'API',\n            key: 'apiConfig',\n          },\n        });\n        if (apiCustom) {\n          config.apiConfig = JSON.parse(apiCustom.value);\n        }\n      }\n\n      return config;\n    } catch (error) {\n      logger.error('Failed to get white-label config', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Get all customizations for license\n   */\n  async getCustomizations(licenseId: string): Promise<any[]> {\n    try {\n      const customizations = await prisma.enterpriseCustomization.findMany({\n        where: { licenseId },\n        orderBy: { type: 'asc' },\n      });\n\n      return customizations.map((c) => ({\n        id: c.id,\n        type: c.type,\n        key: c.key,\n        value: c.value,\n        description: c.description,\n      }));\n    } catch (error) {\n      logger.error('Failed to get customizations', { error, licenseId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n\n  /**\n   * Delete customization\n   */\n  async deleteCustomization(customizationId: string): Promise<void> {\n    try {\n      logger.info('Deleting customization', { customizationId });\n\n      await prisma.enterpriseCustomization.delete({\n        where: { id: customizationId },\n      });\n\n      logger.info('Customization deleted', { customizationId });\n    } catch (error) {\n      logger.error('Failed to delete customization', { error, customizationId });\n      throw ErrorHandler.handle(error);\n    }\n  }\n}\n\nexport default new WhiteLabelService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}