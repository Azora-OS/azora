{"version":3,"names":["cov_1pdpooe1pu","actualCoverage","ElaraLogger","ContractService","contracts","s","Map","contractTemplates","founder","student","teacher","researcher","professional","enterprise","government","constructor","f","logger","generateContract","userId","userType","info","contractId","Date","now","template","b","Error","contract","id","contractType","status","content","generateContractContent","createdAt","updatedAt","set","error","getContract","get","getUserContracts","Array","from","values","filter","c","signContract","signedBy","ipAddress","signedAt","signatureData","timestamp","signatureHash","generateSignatureHash","rejectContract","reason","verifySignature","getSignedContracts","baseContent","data","Buffer","toString"],"sources":["contract.service.ts"],"sourcesContent":["/**\n * Contract Service\n * \n * Manages contract generation and e-signature workflows\n */\n\nimport { ElaraLogger } from '../utils/logger';\nimport { UserType } from './user-type-detection.service';\n\nexport interface Contract {\n  id: string;\n  userId: string;\n  userType: UserType;\n  contractType: string;\n  status: 'pending' | 'sent' | 'signed' | 'rejected';\n  content: string;\n  signedAt?: Date;\n  signatureData?: SignatureData;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface SignatureData {\n  signedBy: string;\n  timestamp: Date;\n  ipAddress?: string;\n  signatureHash?: string;\n}\n\nexport class ContractService {\n  private logger: ElaraLogger;\n  private contracts: Map<string, Contract> = new Map();\n\n  private readonly contractTemplates: Record<UserType, string> = {\n    founder: 'Founder Terms and Conditions - Creator Agreement',\n    student: 'Student Terms and Conditions - Educational Access Agreement',\n    teacher: 'Educator Terms and Conditions - Teaching Agreement',\n    researcher: 'Researcher Terms and Conditions - Research Agreement',\n    professional: 'Professional Terms and Conditions - Professional Services Agreement',\n    enterprise: 'Enterprise Terms and Conditions - Enterprise License Agreement',\n    'non-profit': 'Non-Profit Terms and Conditions - Non-Profit Agreement',\n    government: 'Government Terms and Conditions - Government Services Agreement',\n  };\n\n  constructor() {\n    this.logger = new ElaraLogger('ContractService');\n  }\n\n  /**\n   * Generate contract for user\n   */\n  async generateContract(userId: string, userType: UserType): Promise<Contract> {\n    try {\n      this.logger.info(`Generating contract for user: ${userId}, type: ${userType}`);\n\n      const contractId = `contract_${userId}_${Date.now()}`;\n      const template = this.contractTemplates[userType];\n\n      if (!template) {\n        throw new Error(`No contract template for user type: ${userType}`);\n      }\n\n      const contract: Contract = {\n        id: contractId,\n        userId,\n        userType,\n        contractType: template,\n        status: 'pending',\n        content: this.generateContractContent(userType),\n        createdAt: new Date(),\n        updatedAt: new Date(),\n      };\n\n      this.contracts.set(contractId, contract);\n      this.logger.info(`Contract generated: ${contractId}`);\n\n      return contract;\n    } catch (error) {\n      this.logger.error('Error generating contract:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get contract by ID\n   */\n  async getContract(contractId: string): Promise<Contract | null> {\n    try {\n      this.logger.info(`Getting contract: ${contractId}`);\n      return this.contracts.get(contractId) || null;\n    } catch (error) {\n      this.logger.error('Error getting contract:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get contracts for user\n   */\n  async getUserContracts(userId: string): Promise<Contract[]> {\n    try {\n      this.logger.info(`Getting contracts for user: ${userId}`);\n      return Array.from(this.contracts.values()).filter(c => c.userId === userId);\n    } catch (error) {\n      this.logger.error('Error getting user contracts:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Sign contract\n   */\n  async signContract(contractId: string, signedBy: string, ipAddress?: string): Promise<Contract> {\n    try {\n      this.logger.info(`Signing contract: ${contractId}`);\n\n      const contract = this.contracts.get(contractId);\n      if (!contract) {\n        throw new Error(`Contract not found: ${contractId}`);\n      }\n\n      if (contract.status === 'signed') {\n        throw new Error(`Contract already signed: ${contractId}`);\n      }\n\n      contract.status = 'signed';\n      contract.signedAt = new Date();\n      contract.signatureData = {\n        signedBy,\n        timestamp: new Date(),\n        ipAddress,\n        signatureHash: this.generateSignatureHash(contractId, signedBy),\n      };\n      contract.updatedAt = new Date();\n\n      this.contracts.set(contractId, contract);\n      this.logger.info(`Contract signed: ${contractId}`);\n\n      return contract;\n    } catch (error) {\n      this.logger.error('Error signing contract:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Reject contract\n   */\n  async rejectContract(contractId: string, reason: string): Promise<Contract> {\n    try {\n      this.logger.info(`Rejecting contract: ${contractId}, reason: ${reason}`);\n\n      const contract = this.contracts.get(contractId);\n      if (!contract) {\n        throw new Error(`Contract not found: ${contractId}`);\n      }\n\n      contract.status = 'rejected';\n      contract.updatedAt = new Date();\n\n      this.contracts.set(contractId, contract);\n      this.logger.info(`Contract rejected: ${contractId}`);\n\n      return contract;\n    } catch (error) {\n      this.logger.error('Error rejecting contract:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Verify contract signature\n   */\n  async verifySignature(contractId: string): Promise<boolean> {\n    try {\n      this.logger.info(`Verifying signature for contract: ${contractId}`);\n\n      const contract = this.contracts.get(contractId);\n      if (!contract) {\n        throw new Error(`Contract not found: ${contractId}`);\n      }\n\n      if (contract.status !== 'signed' || !contract.signatureData) {\n        return false;\n      }\n\n      // In production, would verify actual signature\n      // For now, just check that signature data exists\n      return !!contract.signatureData.signatureHash;\n    } catch (error) {\n      this.logger.error('Error verifying signature:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get signed contracts for user\n   */\n  async getSignedContracts(userId: string): Promise<Contract[]> {\n    try {\n      this.logger.info(`Getting signed contracts for user: ${userId}`);\n      return Array.from(this.contracts.values()).filter(\n        c => c.userId === userId && c.status === 'signed'\n      );\n    } catch (error) {\n      this.logger.error('Error getting signed contracts:', error);\n      throw error;\n    }\n  }\n\n  // Private helper methods\n\n  private generateContractContent(userType: UserType): string {\n    const baseContent = `\n# ${this.contractTemplates[userType]}\n\n## Terms and Conditions\n\nThis agreement (\"Agreement\") is entered into as of the date of acceptance.\n\n### 1. Services\nThe platform provides services tailored for ${userType} users.\n\n### 2. User Responsibilities\nUser agrees to comply with all applicable laws and regulations.\n\n### 3. Intellectual Property\nAll content and materials are protected by intellectual property laws.\n\n### 4. Limitation of Liability\nThe platform is provided \"as is\" without warranties.\n\n### 5. Termination\nEither party may terminate this agreement with written notice.\n\n### 6. Governing Law\nThis agreement is governed by applicable laws.\n\n### 7. Entire Agreement\nThis constitutes the entire agreement between parties.\n\nBy signing below, you acknowledge that you have read, understood, and agree to be bound by these terms.\n    `;\n    return baseContent;\n  }\n\n  private generateSignatureHash(contractId: string, signedBy: string): string {\n    // In production, would generate actual cryptographic hash\n    // For now, generate a simple hash\n    const data = `${contractId}:${signedBy}:${Date.now()}`;\n    return Buffer.from(data).toString('base64');\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}