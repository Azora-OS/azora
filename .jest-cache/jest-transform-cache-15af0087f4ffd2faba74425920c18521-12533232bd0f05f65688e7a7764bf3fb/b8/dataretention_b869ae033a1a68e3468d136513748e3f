c6cdd4841ba02fe8e5401b708afccb51
/* istanbul ignore next */
function cov_1qtktxslh5() {
  var path = "/workspaces/azora/services/shared/privacy/data-retention.ts";
  var hash = "cce85d4a58c9a3a4502b62375e8d21c1044f29f4";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/workspaces/azora/services/shared/privacy/data-retention.ts",
    statementMap: {
      "0": {
        start: {
          line: 3,
          column: 15
        },
        end: {
          line: 3,
          column: 45
        }
      },
      "1": {
        start: {
          line: 11,
          column: 46
        },
        end: {
          line: 19,
          column: 1
        }
      },
      "2": {
        start: {
          line: 23,
          column: 4
        },
        end: {
          line: 36,
          column: 5
        }
      },
      "3": {
        start: {
          line: 24,
          column: 6
        },
        end: {
          line: 24,
          column: 64
        }
      },
      "4": {
        start: {
          line: 26,
          column: 6
        },
        end: {
          line: 30,
          column: 7
        }
      },
      "5": {
        start: {
          line: 27,
          column: 8
        },
        end: {
          line: 29,
          column: 9
        }
      },
      "6": {
        start: {
          line: 28,
          column: 10
        },
        end: {
          line: 28,
          column: 47
        }
      },
      "7": {
        start: {
          line: 32,
          column: 6
        },
        end: {
          line: 32,
          column: 65
        }
      },
      "8": {
        start: {
          line: 34,
          column: 6
        },
        end: {
          line: 34,
          column: 79
        }
      },
      "9": {
        start: {
          line: 35,
          column: 6
        },
        end: {
          line: 35,
          column: 18
        }
      },
      "10": {
        start: {
          line: 40,
          column: 23
        },
        end: {
          line: 40,
          column: 33
        }
      },
      "11": {
        start: {
          line: 41,
          column: 4
        },
        end: {
          line: 41,
          column: 68
        }
      },
      "12": {
        start: {
          line: 43,
          column: 4
        },
        end: {
          line: 76,
          column: 5
        }
      },
      "13": {
        start: {
          line: 44,
          column: 27
        },
        end: {
          line: 44,
          column: 28
        }
      },
      "14": {
        start: {
          line: 46,
          column: 6
        },
        end: {
          line: 70,
          column: 7
        }
      },
      "15": {
        start: {
          line: 50,
          column: 10
        },
        end: {
          line: 50,
          column: 89
        }
      },
      "16": {
        start: {
          line: 51,
          column: 10
        },
        end: {
          line: 51,
          column: 16
        }
      },
      "17": {
        start: {
          line: 55,
          column: 10
        },
        end: {
          line: 55,
          column: 89
        }
      },
      "18": {
        start: {
          line: 56,
          column: 10
        },
        end: {
          line: 56,
          column: 16
        }
      },
      "19": {
        start: {
          line: 60,
          column: 10
        },
        end: {
          line: 60,
          column: 89
        }
      },
      "20": {
        start: {
          line: 61,
          column: 10
        },
        end: {
          line: 61,
          column: 16
        }
      },
      "21": {
        start: {
          line: 65,
          column: 10
        },
        end: {
          line: 65,
          column: 89
        }
      },
      "22": {
        start: {
          line: 66,
          column: 10
        },
        end: {
          line: 66,
          column: 16
        }
      },
      "23": {
        start: {
          line: 69,
          column: 10
        },
        end: {
          line: 69,
          column: 86
        }
      },
      "24": {
        start: {
          line: 72,
          column: 6
        },
        end: {
          line: 72,
          column: 91
        }
      },
      "25": {
        start: {
          line: 74,
          column: 6
        },
        end: {
          line: 74,
          column: 85
        }
      },
      "26": {
        start: {
          line: 75,
          column: 6
        },
        end: {
          line: 75,
          column: 18
        }
      },
      "27": {
        start: {
          line: 80,
          column: 4
        },
        end: {
          line: 80,
          column: 65
        }
      },
      "28": {
        start: {
          line: 80,
          column: 40
        },
        end: {
          line: 80,
          column: 63
        }
      },
      "29": {
        start: {
          line: 84,
          column: 4
        },
        end: {
          line: 84,
          column: 30
        }
      },
      "30": {
        start: {
          line: 89,
          column: 4
        },
        end: {
          line: 89,
          column: 83
        }
      },
      "31": {
        start: {
          line: 93,
          column: 36
        },
        end: {
          line: 93,
          column: 62
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 22,
            column: 2
          },
          end: {
            line: 22,
            column: 3
          }
        },
        loc: {
          start: {
            line: 22,
            column: 44
          },
          end: {
            line: 37,
            column: 3
          }
        },
        line: 22
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 39,
            column: 2
          },
          end: {
            line: 39,
            column: 3
          }
        },
        loc: {
          start: {
            line: 39,
            column: 74
          },
          end: {
            line: 77,
            column: 3
          }
        },
        line: 39
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 79,
            column: 2
          },
          end: {
            line: 79,
            column: 3
          }
        },
        loc: {
          start: {
            line: 79,
            column: 68
          },
          end: {
            line: 81,
            column: 3
          }
        },
        line: 79
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 80,
            column: 35
          },
          end: {
            line: 80,
            column: 36
          }
        },
        loc: {
          start: {
            line: 80,
            column: 40
          },
          end: {
            line: 80,
            column: 63
          }
        },
        line: 80
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 83,
            column: 2
          },
          end: {
            line: 83,
            column: 3
          }
        },
        loc: {
          start: {
            line: 83,
            column: 47
          },
          end: {
            line: 85,
            column: 3
          }
        },
        line: 83
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 87,
            column: 2
          },
          end: {
            line: 87,
            column: 3
          }
        },
        loc: {
          start: {
            line: 87,
            column: 77
          },
          end: {
            line: 90,
            column: 3
          }
        },
        line: 87
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 27,
            column: 8
          },
          end: {
            line: 29,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 27,
            column: 8
          },
          end: {
            line: 29,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 27
      },
      "1": {
        loc: {
          start: {
            line: 46,
            column: 6
          },
          end: {
            line: 70,
            column: 7
          }
        },
        type: "switch",
        locations: [{
          start: {
            line: 47,
            column: 8
          },
          end: {
            line: 51,
            column: 16
          }
        }, {
          start: {
            line: 53,
            column: 8
          },
          end: {
            line: 56,
            column: 16
          }
        }, {
          start: {
            line: 58,
            column: 8
          },
          end: {
            line: 61,
            column: 16
          }
        }, {
          start: {
            line: 63,
            column: 8
          },
          end: {
            line: 66,
            column: 16
          }
        }, {
          start: {
            line: 68,
            column: 8
          },
          end: {
            line: 69,
            column: 86
          }
        }],
        line: 46
      },
      "2": {
        loc: {
          start: {
            line: 87,
            column: 24
          },
          end: {
            line: 87,
            column: 60
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 87,
            column: 49
          },
          end: {
            line: 87,
            column: 60
          }
        }],
        line: 87
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0, 0, 0, 0],
      "2": [0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "cce85d4a58c9a3a4502b62375e8d21c1044f29f4"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_1qtktxslh5 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_1qtktxslh5();
import { createLogger, logInfo, logError, logWarn } from '../logging';
const logger =
/* istanbul ignore next */
(cov_1qtktxslh5().s[0]++, createLogger('data-retention'));
const RETENTION_POLICIES =
/* istanbul ignore next */
(cov_1qtktxslh5().s[1]++, [{
  dataType: 'user_activity_logs',
  retentionDays: 90,
  autoDelete: true
}, {
  dataType: 'transaction_records',
  retentionDays: 2555,
  autoDelete: false
},
// 7 years
{
  dataType: 'course_progress',
  retentionDays: 1825,
  autoDelete: false
},
// 5 years
{
  dataType: 'session_data',
  retentionDays: 30,
  autoDelete: true
}, {
  dataType: 'audit_logs',
  retentionDays: 2555,
  autoDelete: false
}, {
  dataType: 'error_logs',
  retentionDays: 90,
  autoDelete: true
}, {
  dataType: 'performance_metrics',
  retentionDays: 30,
  autoDelete: true
}]);
export class DataRetentionManager {
  async cleanupExpiredData() {
    /* istanbul ignore next */
    cov_1qtktxslh5().f[0]++;
    cov_1qtktxslh5().s[2]++;
    try {
      /* istanbul ignore next */
      cov_1qtktxslh5().s[3]++;
      logInfo(logger, '[GDPR] Starting data retention cleanup');
      /* istanbul ignore next */
      cov_1qtktxslh5().s[4]++;
      for (const policy of RETENTION_POLICIES) {
        /* istanbul ignore next */
        cov_1qtktxslh5().s[5]++;
        if (policy.autoDelete) {
          /* istanbul ignore next */
          cov_1qtktxslh5().b[0][0]++;
          cov_1qtktxslh5().s[6]++;
          await this.deleteExpiredData(policy);
        } else
        /* istanbul ignore next */
        {
          cov_1qtktxslh5().b[0][1]++;
        }
      }
      /* istanbul ignore next */
      cov_1qtktxslh5().s[7]++;
      logInfo(logger, '[GDPR] Data retention cleanup completed');
    } catch (error) {
      /* istanbul ignore next */
      cov_1qtktxslh5().s[8]++;
      logError(logger, '[GDPR] Data retention cleanup failed', error);
      /* istanbul ignore next */
      cov_1qtktxslh5().s[9]++;
      throw error;
    }
  }
  async deleteExpiredData(policy) {
    /* istanbul ignore next */
    cov_1qtktxslh5().f[1]++;
    const cutoffDate =
    /* istanbul ignore next */
    (cov_1qtktxslh5().s[10]++, new Date());
    /* istanbul ignore next */
    cov_1qtktxslh5().s[11]++;
    cutoffDate.setDate(cutoffDate.getDate() - policy.retentionDays);
    /* istanbul ignore next */
    cov_1qtktxslh5().s[12]++;
    try {
      const deletedCount =
      /* istanbul ignore next */
      (cov_1qtktxslh5().s[13]++, 0);
      /* istanbul ignore next */
      cov_1qtktxslh5().s[14]++;
      switch (policy.dataType) {
        case 'user_activity_logs':
          /* istanbul ignore next */
          cov_1qtktxslh5().b[1][0]++;
          cov_1qtktxslh5().s[15]++;
          // Delete old activity logs (if stored in database)
          // This is a placeholder - actual implementation depends on logging system
          logInfo(logger, `[GDPR] Cleanup: ${policy.dataType} older than ${cutoffDate}`);
          /* istanbul ignore next */
          cov_1qtktxslh5().s[16]++;
          break;
        case 'session_data':
          /* istanbul ignore next */
          cov_1qtktxslh5().b[1][1]++;
          cov_1qtktxslh5().s[17]++;
          // Delete expired sessions
          logInfo(logger, `[GDPR] Cleanup: ${policy.dataType} older than ${cutoffDate}`);
          /* istanbul ignore next */
          cov_1qtktxslh5().s[18]++;
          break;
        case 'error_logs':
          /* istanbul ignore next */
          cov_1qtktxslh5().b[1][2]++;
          cov_1qtktxslh5().s[19]++;
          // Delete old error logs
          logInfo(logger, `[GDPR] Cleanup: ${policy.dataType} older than ${cutoffDate}`);
          /* istanbul ignore next */
          cov_1qtktxslh5().s[20]++;
          break;
        case 'performance_metrics':
          /* istanbul ignore next */
          cov_1qtktxslh5().b[1][3]++;
          cov_1qtktxslh5().s[21]++;
          // Delete old performance metrics
          logInfo(logger, `[GDPR] Cleanup: ${policy.dataType} older than ${cutoffDate}`);
          /* istanbul ignore next */
          cov_1qtktxslh5().s[22]++;
          break;
        default:
          /* istanbul ignore next */
          cov_1qtktxslh5().b[1][4]++;
          cov_1qtktxslh5().s[23]++;
          logWarn(logger, `[GDPR] Unknown data type for cleanup: ${policy.dataType}`);
      }
      /* istanbul ignore next */
      cov_1qtktxslh5().s[24]++;
      logInfo(logger, `[GDPR] Deleted ${deletedCount} records of type ${policy.dataType}`);
    } catch (error) {
      /* istanbul ignore next */
      cov_1qtktxslh5().s[25]++;
      logError(logger, `[GDPR] Failed to delete ${policy.dataType}`, error);
      /* istanbul ignore next */
      cov_1qtktxslh5().s[26]++;
      throw error;
    }
  }
  getRetentionPolicy(dataType) {
    /* istanbul ignore next */
    cov_1qtktxslh5().f[2]++;
    cov_1qtktxslh5().s[27]++;
    return RETENTION_POLICIES.find(p => {
      /* istanbul ignore next */
      cov_1qtktxslh5().f[3]++;
      cov_1qtktxslh5().s[28]++;
      return p.dataType === dataType;
    });
  }
  getAllRetentionPolicies() {
    /* istanbul ignore next */
    cov_1qtktxslh5().f[4]++;
    cov_1qtktxslh5().s[29]++;
    return RETENTION_POLICIES;
  }
  async scheduleCleanup(cronExpression =
  /* istanbul ignore next */
  (cov_1qtktxslh5().b[2][0]++, '0 2 * * *')) {
    /* istanbul ignore next */
    cov_1qtktxslh5().f[5]++;
    cov_1qtktxslh5().s[30]++;
    // This would be implemented with a job scheduler like node-cron
    logInfo(logger, '[GDPR] Data retention cleanup scheduled', {
      cronExpression
    });
  }
}
export const dataRetentionManager =
/* istanbul ignore next */
(cov_1qtktxslh5().s[31]++, new DataRetentionManager());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMXF0a3R4c2xoNSIsImFjdHVhbENvdmVyYWdlIiwiY3JlYXRlTG9nZ2VyIiwibG9nSW5mbyIsImxvZ0Vycm9yIiwibG9nV2FybiIsImxvZ2dlciIsInMiLCJSRVRFTlRJT05fUE9MSUNJRVMiLCJkYXRhVHlwZSIsInJldGVudGlvbkRheXMiLCJhdXRvRGVsZXRlIiwiRGF0YVJldGVudGlvbk1hbmFnZXIiLCJjbGVhbnVwRXhwaXJlZERhdGEiLCJmIiwicG9saWN5IiwiYiIsImRlbGV0ZUV4cGlyZWREYXRhIiwiZXJyb3IiLCJjdXRvZmZEYXRlIiwiRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwiZGVsZXRlZENvdW50IiwiZ2V0UmV0ZW50aW9uUG9saWN5IiwiZmluZCIsInAiLCJnZXRBbGxSZXRlbnRpb25Qb2xpY2llcyIsInNjaGVkdWxlQ2xlYW51cCIsImNyb25FeHByZXNzaW9uIiwiZGF0YVJldGVudGlvbk1hbmFnZXIiXSwic291cmNlcyI6WyJkYXRhLXJldGVudGlvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVMb2dnZXIsIGxvZ0luZm8sIGxvZ0Vycm9yLCBsb2dXYXJuIH0gZnJvbSAnLi4vbG9nZ2luZyc7XG5cbmNvbnN0IGxvZ2dlciA9IGNyZWF0ZUxvZ2dlcignZGF0YS1yZXRlbnRpb24nKTtcblxuZXhwb3J0IGludGVyZmFjZSBSZXRlbnRpb25Qb2xpY3kge1xuICBkYXRhVHlwZTogc3RyaW5nO1xuICByZXRlbnRpb25EYXlzOiBudW1iZXI7XG4gIGF1dG9EZWxldGU6IGJvb2xlYW47XG59XG5cbmNvbnN0IFJFVEVOVElPTl9QT0xJQ0lFUzogUmV0ZW50aW9uUG9saWN5W10gPSBbXG4gIHsgZGF0YVR5cGU6ICd1c2VyX2FjdGl2aXR5X2xvZ3MnLCByZXRlbnRpb25EYXlzOiA5MCwgYXV0b0RlbGV0ZTogdHJ1ZSB9LFxuICB7IGRhdGFUeXBlOiAndHJhbnNhY3Rpb25fcmVjb3JkcycsIHJldGVudGlvbkRheXM6IDI1NTUsIGF1dG9EZWxldGU6IGZhbHNlIH0sIC8vIDcgeWVhcnNcbiAgeyBkYXRhVHlwZTogJ2NvdXJzZV9wcm9ncmVzcycsIHJldGVudGlvbkRheXM6IDE4MjUsIGF1dG9EZWxldGU6IGZhbHNlIH0sIC8vIDUgeWVhcnNcbiAgeyBkYXRhVHlwZTogJ3Nlc3Npb25fZGF0YScsIHJldGVudGlvbkRheXM6IDMwLCBhdXRvRGVsZXRlOiB0cnVlIH0sXG4gIHsgZGF0YVR5cGU6ICdhdWRpdF9sb2dzJywgcmV0ZW50aW9uRGF5czogMjU1NSwgYXV0b0RlbGV0ZTogZmFsc2UgfSxcbiAgeyBkYXRhVHlwZTogJ2Vycm9yX2xvZ3MnLCByZXRlbnRpb25EYXlzOiA5MCwgYXV0b0RlbGV0ZTogdHJ1ZSB9LFxuICB7IGRhdGFUeXBlOiAncGVyZm9ybWFuY2VfbWV0cmljcycsIHJldGVudGlvbkRheXM6IDMwLCBhdXRvRGVsZXRlOiB0cnVlIH1cbl07XG5cbmV4cG9ydCBjbGFzcyBEYXRhUmV0ZW50aW9uTWFuYWdlciB7XG4gIGFzeW5jIGNsZWFudXBFeHBpcmVkRGF0YSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgbG9nSW5mbyhsb2dnZXIsICdbR0RQUl0gU3RhcnRpbmcgZGF0YSByZXRlbnRpb24gY2xlYW51cCcpO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHBvbGljeSBvZiBSRVRFTlRJT05fUE9MSUNJRVMpIHtcbiAgICAgICAgaWYgKHBvbGljeS5hdXRvRGVsZXRlKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVFeHBpcmVkRGF0YShwb2xpY3kpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGxvZ0luZm8obG9nZ2VyLCAnW0dEUFJdIERhdGEgcmV0ZW50aW9uIGNsZWFudXAgY29tcGxldGVkJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ0Vycm9yKGxvZ2dlciwgJ1tHRFBSXSBEYXRhIHJldGVudGlvbiBjbGVhbnVwIGZhaWxlZCcsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZGVsZXRlRXhwaXJlZERhdGEocG9saWN5OiBSZXRlbnRpb25Qb2xpY3kpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjdXRvZmZEYXRlID0gbmV3IERhdGUoKTtcbiAgICBjdXRvZmZEYXRlLnNldERhdGUoY3V0b2ZmRGF0ZS5nZXREYXRlKCkgLSBwb2xpY3kucmV0ZW50aW9uRGF5cyk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGVsZXRlZENvdW50ID0gMDtcblxuICAgICAgc3dpdGNoIChwb2xpY3kuZGF0YVR5cGUpIHtcbiAgICAgICAgY2FzZSAndXNlcl9hY3Rpdml0eV9sb2dzJzpcbiAgICAgICAgICAvLyBEZWxldGUgb2xkIGFjdGl2aXR5IGxvZ3MgKGlmIHN0b3JlZCBpbiBkYXRhYmFzZSlcbiAgICAgICAgICAvLyBUaGlzIGlzIGEgcGxhY2Vob2xkZXIgLSBhY3R1YWwgaW1wbGVtZW50YXRpb24gZGVwZW5kcyBvbiBsb2dnaW5nIHN5c3RlbVxuICAgICAgICAgIGxvZ0luZm8obG9nZ2VyLCBgW0dEUFJdIENsZWFudXA6ICR7cG9saWN5LmRhdGFUeXBlfSBvbGRlciB0aGFuICR7Y3V0b2ZmRGF0ZX1gKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdzZXNzaW9uX2RhdGEnOlxuICAgICAgICAgIC8vIERlbGV0ZSBleHBpcmVkIHNlc3Npb25zXG4gICAgICAgICAgbG9nSW5mbyhsb2dnZXIsIGBbR0RQUl0gQ2xlYW51cDogJHtwb2xpY3kuZGF0YVR5cGV9IG9sZGVyIHRoYW4gJHtjdXRvZmZEYXRlfWApO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2Vycm9yX2xvZ3MnOlxuICAgICAgICAgIC8vIERlbGV0ZSBvbGQgZXJyb3IgbG9nc1xuICAgICAgICAgIGxvZ0luZm8obG9nZ2VyLCBgW0dEUFJdIENsZWFudXA6ICR7cG9saWN5LmRhdGFUeXBlfSBvbGRlciB0aGFuICR7Y3V0b2ZmRGF0ZX1gKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdwZXJmb3JtYW5jZV9tZXRyaWNzJzpcbiAgICAgICAgICAvLyBEZWxldGUgb2xkIHBlcmZvcm1hbmNlIG1ldHJpY3NcbiAgICAgICAgICBsb2dJbmZvKGxvZ2dlciwgYFtHRFBSXSBDbGVhbnVwOiAke3BvbGljeS5kYXRhVHlwZX0gb2xkZXIgdGhhbiAke2N1dG9mZkRhdGV9YCk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBsb2dXYXJuKGxvZ2dlciwgYFtHRFBSXSBVbmtub3duIGRhdGEgdHlwZSBmb3IgY2xlYW51cDogJHtwb2xpY3kuZGF0YVR5cGV9YCk7XG4gICAgICB9XG5cbiAgICAgIGxvZ0luZm8obG9nZ2VyLCBgW0dEUFJdIERlbGV0ZWQgJHtkZWxldGVkQ291bnR9IHJlY29yZHMgb2YgdHlwZSAke3BvbGljeS5kYXRhVHlwZX1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nRXJyb3IobG9nZ2VyLCBgW0dEUFJdIEZhaWxlZCB0byBkZWxldGUgJHtwb2xpY3kuZGF0YVR5cGV9YCwgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgZ2V0UmV0ZW50aW9uUG9saWN5KGRhdGFUeXBlOiBzdHJpbmcpOiBSZXRlbnRpb25Qb2xpY3kgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiBSRVRFTlRJT05fUE9MSUNJRVMuZmluZChwID0+IHAuZGF0YVR5cGUgPT09IGRhdGFUeXBlKTtcbiAgfVxuXG4gIGdldEFsbFJldGVudGlvblBvbGljaWVzKCk6IFJldGVudGlvblBvbGljeVtdIHtcbiAgICByZXR1cm4gUkVURU5USU9OX1BPTElDSUVTO1xuICB9XG5cbiAgYXN5bmMgc2NoZWR1bGVDbGVhbnVwKGNyb25FeHByZXNzaW9uOiBzdHJpbmcgPSAnMCAyICogKiAqJyk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIFRoaXMgd291bGQgYmUgaW1wbGVtZW50ZWQgd2l0aCBhIGpvYiBzY2hlZHVsZXIgbGlrZSBub2RlLWNyb25cbiAgICBsb2dJbmZvKGxvZ2dlciwgJ1tHRFBSXSBEYXRhIHJldGVudGlvbiBjbGVhbnVwIHNjaGVkdWxlZCcsIHsgY3JvbkV4cHJlc3Npb24gfSk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGRhdGFSZXRlbnRpb25NYW5hZ2VyID0gbmV3IERhdGFSZXRlbnRpb25NYW5hZ2VyKCk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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