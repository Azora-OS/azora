{"version":3,"names":["cov_1phgzjom8s","actualCoverage","fs","path","dotenv","s","config","ElaraVideoGenerator","constructor","f","videoDir","join","__dirname","existsSync","b","mkdirSync","recursive","generateVideo","params","console","log","lessonId","style","generateAvatarVideo","generateCodeVideo","generateSlideVideo","getMockVideo","slides","generateSlides","script","codeExamples","videoMetadata","title","audioUrl","duration","calculateDuration","filename","Date","now","filepath","writeFileSync","JSON","stringify","url","thumbnail","paragraphs","split","filter","p","trim","push","type","content","forEach","paragraph","index","Math","max","length","text","words","ceil","generateVideoForLesson","lesson","video","toLowerCase","replace","generateVideosForCourse","lessons","lessonsWithVideo","lessonWithVideo","audio"],"sources":["video-generator.ts"],"sourcesContent":["import * as fs from 'fs';\nimport * as path from 'path';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nexport class ElaraVideoGenerator {\n    private videoDir: string;\n\n    constructor() {\n        // Create video directory if it doesn't exist\n        this.videoDir = path.join(__dirname, 'generated-videos');\n        if (!fs.existsSync(this.videoDir)) {\n            fs.mkdirSync(this.videoDir, { recursive: true });\n        }\n    }\n\n    async generateVideo(params: {\n        lessonId: string;\n        title: string;\n        script: string;\n        codeExamples?: any[];\n        audioUrl?: string;\n        style?: 'slides' | 'avatar' | 'code';\n    }): Promise<{ url: string; thumbnail: string }> {\n        console.log(`Generating video for lesson: ${params.lessonId}`);\n\n        const style = params.style || 'slides';\n\n        if (style === 'avatar') {\n            return this.generateAvatarVideo(params);\n        } else if (style === 'code') {\n            return this.generateCodeVideo(params);\n        } else {\n            return this.generateSlideVideo(params);\n        }\n    }\n\n    private async generateAvatarVideo(params: any): Promise<{ url: string; thumbnail: string }> {\n        // HeyGen/D-ID integration would go here\n        // For MVP, return mock video\n        console.log('Avatar video generation requires HeyGen API key');\n        return this.getMockVideo(params);\n    }\n\n    private async generateCodeVideo(params: any): Promise<{ url: string; thumbnail: string }> {\n        // Code-focused video with syntax highlighting\n        // Could use Remotion or similar\n        console.log('Code video generation - using slide approach');\n        return this.generateSlideVideo(params);\n    }\n\n    private async generateSlideVideo(params: any): Promise<{ url: string; thumbnail: string }> {\n        // Generate slides from script\n        const slides = this.generateSlides(params.script, params.codeExamples || []);\n\n        // In production, would use Remotion or similar to render video\n        // For MVP, return metadata for slide-based presentation\n        const videoMetadata = {\n            lessonId: params.lessonId,\n            title: params.title,\n            slides: slides,\n            audioUrl: params.audioUrl || null,\n            duration: this.calculateDuration(params.script)\n        };\n\n        // Save metadata\n        const filename = `${params.lessonId}-${Date.now()}.json`;\n        const filepath = path.join(this.videoDir, filename);\n        fs.writeFileSync(filepath, JSON.stringify(videoMetadata, null, 2));\n\n        return {\n            url: `/videos/${filename}`,\n            thumbnail: `/thumbnails/${params.lessonId}.jpg`\n        };\n    }\n\n    private generateSlides(script: string, codeExamples: any[]): any[] {\n        // Split script into logical sections\n        const paragraphs = script.split('\\n\\n').filter(p => p.trim());\n        const slides = [];\n\n        // Title slide\n        slides.push({\n            type: 'title',\n            content: 'Lesson Introduction',\n            duration: 3\n        });\n\n        // Content slides\n        paragraphs.forEach((paragraph, index) => {\n            slides.push({\n                type: 'content',\n                content: paragraph.trim(),\n                duration: Math.max(5, paragraph.split(' ').length / 2) // ~2 words per second\n            });\n\n            // Insert code example slides\n            if (codeExamples[index]) {\n                slides.push({\n                    type: 'code',\n                    content: codeExamples[index],\n                    duration: 10\n                });\n            }\n        });\n\n        // Summary slide\n        slides.push({\n            type: 'summary',\n            content: 'Key Takeaways',\n            duration: 5\n        });\n\n        return slides;\n    }\n\n    private calculateDuration(text: string): number {\n        const words = text.split(/\\s+/).length;\n        return Math.ceil(words / 150 * 60); // 150 words per minute\n    }\n\n    private getMockVideo(params: any): { url: string; thumbnail: string } {\n        return {\n            url: `/videos/mock-${params.lessonId}.mp4`,\n            thumbnail: `/thumbnails/mock-${params.lessonId}.jpg`\n        };\n    }\n\n    async generateVideoForLesson(lesson: any, audioUrl?: string): Promise<any> {\n        const video = await this.generateVideo({\n            lessonId: lesson.title.toLowerCase().replace(/\\s+/g, '-'),\n            title: lesson.title,\n            script: lesson.script,\n            codeExamples: lesson.codeExamples,\n            audioUrl: audioUrl,\n            style: 'slides'\n        });\n\n        return {\n            ...lesson,\n            video: {\n                url: video.url,\n                thumbnail: video.thumbnail\n            }\n        };\n    }\n\n    async generateVideosForCourse(lessons: any[]): Promise<any[]> {\n        const lessonsWithVideo = [];\n\n        for (const lesson of lessons) {\n            const lessonWithVideo = await this.generateVideoForLesson(\n                lesson.content,\n                lesson.content.audio?.url\n            );\n            lessonsWithVideo.push({\n                ...lesson,\n                content: lessonWithVideo\n            });\n        }\n\n        return lessonsWithVideo;\n    }\n}\n"],"mappings":"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","ignoreList":[]}