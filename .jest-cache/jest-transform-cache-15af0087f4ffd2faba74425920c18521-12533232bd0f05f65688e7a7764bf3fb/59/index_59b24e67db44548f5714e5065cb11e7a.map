{"version":3,"names":["cov_21htorimzy","actualCoverage","AuthManager","config","s","constructor","b","f","setTokens","tokens","accessToken","refreshToken","expiresAt","Date","now","expiresIn","getAccessToken","apiKey","refreshCallback","newTokens","error","console","onTokenRefresh","callback","isAuthenticated","clearAuth","getAuthHeaders","token","createJWT","payload","secret","header","btoa","JSON","stringify","alg","typ","body","exp","Math","floor","signature","decodeJWT","split","parse","atob","isJWTExpired","decoded"],"sources":["index.ts"],"sourcesContent":["/*\nAZORA PROPRIETARY LICENSE\n\nCopyright Â© 2025 Azora ES (Pty) Ltd. All Rights Reserved.\n\nSee LICENSE file for details.\n*/\n\n/**\n * AUTH HELPERS\n * \n * Authentication utilities for the Azora SDK\n */\n\nexport interface AuthConfig {\n  apiKey?: string;\n  accessToken?: string;\n  refreshToken?: string;\n  expiresAt?: number;\n}\n\nexport class AuthManager {\n  private config: AuthConfig = {};\n  private refreshCallback?: () => Promise<{ accessToken: string; refreshToken: string; expiresIn: number }>;\n\n  constructor(config: AuthConfig = {}) {\n    this.config = config;\n  }\n\n  /**\n   * Set authentication tokens\n   */\n  setTokens(tokens: { accessToken: string; refreshToken: string; expiresIn: number }): void {\n    this.config.accessToken = tokens.accessToken;\n    this.config.refreshToken = tokens.refreshToken;\n    this.config.expiresAt = Date.now() + (tokens.expiresIn * 1000);\n  }\n\n  /**\n   * Get current access token\n   */\n  async getAccessToken(): Promise<string | null> {\n    if (!this.config.accessToken) {\n      return this.config.apiKey || null;\n    }\n\n    // Check if token is expired\n    if (this.config.expiresAt && Date.now() >= this.config.expiresAt) {\n      // Try to refresh\n      if (this.refreshCallback) {\n        try {\n          const newTokens = await this.refreshCallback();\n          this.setTokens(newTokens);\n          return this.config.accessToken;\n        } catch (error) {\n          console.error('Token refresh failed:', error);\n          return null;\n        }\n      }\n      return null;\n    }\n\n    return this.config.accessToken;\n  }\n\n  /**\n   * Set token refresh callback\n   */\n  onTokenRefresh(callback: () => Promise<{ accessToken: string; refreshToken: string; expiresIn: number }>): void {\n    this.refreshCallback = callback;\n  }\n\n  /**\n   * Check if authenticated\n   */\n  isAuthenticated(): boolean {\n    return !!(this.config.accessToken || this.config.apiKey);\n  }\n\n  /**\n   * Clear authentication\n   */\n  clearAuth(): void {\n    this.config = {};\n  }\n\n  /**\n   * Get authentication headers\n   */\n  async getAuthHeaders(): Promise<Record<string, string>> {\n    const token = await this.getAccessToken();\n    if (!token) {\n      return {};\n    }\n\n    return {\n      'Authorization': `Bearer ${token}`\n    };\n  }\n}\n\n/**\n * Create JWT token (utility)\n */\nexport function createJWT(payload: Record<string, any>, secret: string, expiresIn: number = 3600): string {\n  // In production: use actual JWT library\n  const header = btoa(JSON.stringify({ alg: 'HS256', typ: 'JWT' }));\n  const body = btoa(JSON.stringify({ ...payload, exp: Math.floor(Date.now() / 1000) + expiresIn }));\n  const signature = btoa(`${header}.${body}.${secret}`);\n  \n  return `${header}.${body}.${signature}`;\n}\n\n/**\n * Decode JWT token (utility)\n */\nexport function decodeJWT(token: string): { header: any; payload: any; signature: string } | null {\n  try {\n    const [header, payload, signature] = token.split('.');\n    \n    return {\n      header: JSON.parse(atob(header)),\n      payload: JSON.parse(atob(payload)),\n      signature\n    };\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Check if JWT is expired\n */\nexport function isJWTExpired(token: string): boolean {\n  const decoded = decodeJWT(token);\n  if (!decoded) {return true;}\n\n  const exp = decoded.payload.exp;\n  if (!exp) {return false;}\n\n  return Date.now() >= exp * 1000;\n}\n"],"mappings":"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","ignoreList":[]}