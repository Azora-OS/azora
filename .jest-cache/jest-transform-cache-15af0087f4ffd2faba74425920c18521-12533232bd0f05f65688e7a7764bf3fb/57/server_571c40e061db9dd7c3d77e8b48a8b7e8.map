{"version":3,"names":["cov_qlkys7erf","actualCoverage","express","s","require","compression","cors","helmet","app","PORT","b","process","env","use","json","limit","shieldRoutes","get","req","res","f","status","service","timestamp","Date","toISOString","message","description","endpoints","error","next","console","listen","log","module","exports"],"sources":["server.js"],"sourcesContent":["const express = require('express');\nconst compression = require('compression');\nconst cors = require('cors');\nconst helmet = require('helmet');\n\nconst app = express();\nconst PORT = process.env.PORT || 3007;\n\n// Security middleware\napp.use(helmet());\napp.use(cors());\napp.use(compression());\napp.use(express.json({ limit: '10mb' }));\n\n// Import routes\nconst shieldRoutes = require('./api/routes');\n\n// Routes\napp.use('/api/shield', shieldRoutes);\n\n// Health check endpoint\napp.get('/api/health', (req, res) => {\n  res.json({\n    status: 'OK',\n    service: 'Shield Service',\n    timestamp: new Date().toISOString()\n  });\n});\n\n// Root endpoint\napp.get('/', (req, res) => {\n  res.json({\n    message: 'Welcome to the Azora Shield Service API',\n    description: 'Security monitoring and threat detection service',\n    endpoints: {\n      'POST /api/shield/analyze': 'Analyze a request for security threats',\n      'GET /api/shield/events': 'Get security events with filtering',\n      'POST /api/shield/block-ip': 'Block an IP address',\n      'POST /api/shield/unblock-ip': 'Unblock an IP address',\n      'GET /api/shield/ip-status/:ip': 'Check if an IP is blocked',\n      'GET /api/shield/stats': 'Get threat statistics',\n      'DELETE /api/shield/events/old': 'Clear old security events',\n      'GET /api/health': 'Health check endpoint'\n    }\n  });\n});\n\n// 404 handler\napp.use((req, res) => {\n  res.status(404).json({ error: 'Endpoint not found' });\n});\n\n// Error handling middleware\napp.use((error, req, res, next) => {\n  console.error('Server error:', error);\n  res.status(500).json({ error: 'Internal server error' });\n});\n\n// Start server\napp.listen(PORT, () => {\n  console.log(`üõ°Ô∏è Shield Service running on port ${PORT}`);\n  console.log(`üîó Health check: http://localhost:${PORT}/api/health`);\n  console.log(`üìö API docs: http://localhost:${PORT}`);\n});\n\nmodule.exports = app;\n"],"mappings":"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","ignoreList":[]}