// Azora OS - azora-education-payments Database Schema
// Ubuntu: "My data strengthens our foundation"

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}


model Transaction {
  id            String            @id @default(uuid())
  userId        String
  amount        Decimal           @db.Decimal(18, 8)
  currency      String            @default("AZR")
  type          TransactionType
  status        TransactionStatus @default(PENDING)
  metadata      Json?
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  
  @@index([userId])
  @@index([status])
  @@map("transactions")
}

enum TransactionType {
  DEPOSIT
  WITHDRAWAL
  TRANSFER
  MINING_REWARD
  PAYMENT
}

enum TransactionStatus {
  PENDING
  COMPLETED
  FAILED
  CANCELLED
}

// Constitutional Compliance
model ConstitutionalLog {
  id        String   @id @default(uuid())
  action    String
  userId    String?
  metadata  Json?
  createdAt DateTime @default(now())
  
  @@index([userId])
  @@index([createdAt])
  @@map("constitutional_logs")
}
