// Phase 3 Monitoring Service Tests
const request = require('supertest');\nconst { expect } = require('chai');\n\nclass MonitoringTests {\n  constructor(app) {\n    this.app = app;\n  }\n\n  // Task 10: Alert threshold tests\n  testAlertThresholds() {\n    describe('Alert Thresholds (Task 10)', () => {\n      it('should get current thresholds', async () => {\n        const response = await request(this.app)\n          .get('/alerts/thresholds')\n          .expect(200);\n        \n        expect(response.body).to.have.property('cpu');\n        expect(response.body.cpu).to.have.property('warning');\n        expect(response.body.cpu).to.have.property('critical');\n      });\n\n      it('should update threshold values', async () => {\n        await request(this.app)\n          .put('/alerts/thresholds/cpu/warning')\n          .send({ value: 75 })\n          .expect(200);\n      });\n    });\n  }\n\n  // Task 11: Distributed tracing tests\n  testDistributedTracing() {\n    describe('Distributed Tracing (Task 11)', () => {\n      it('should add trace headers to responses', async () => {\n        const response = await request(this.app)\n          .get('/health')\n          .expect(200);\n        \n        expect(response.headers).to.have.property('x-trace-id');\n      });\n\n      it('should retrieve trace information', async () => {\n        // First make a request to generate a trace\n        const healthResponse = await request(this.app)\n          .get('/health');\n        \n        const traceId = healthResponse.headers['x-trace-id'];\n        \n        const traceResponse = await request(this.app)\n          .get(`/traces/${traceId}`)\n          .expect(200);\n        \n        expect(traceResponse.body).to.have.property('traceId', traceId);\n      });\n    });\n  }\n\n  // Task 12: Custom metrics tests\n  testCustomMetrics() {\n    describe('Custom Metrics (Task 12)', () => {\n      it('should collect and return metrics', async () => {\n        // Simulate some metrics\n        await request(this.app)\n          .post('/simulate/metrics')\n          .send({\n            type: 'user_registration',\n            data: { userId: 'test123', source: 'web' }\n          })\n          .expect(200);\n\n        const response = await request(this.app)\n          .get('/metrics')\n          .expect(200);\n        \n        expect(response.body).to.have.property('counters');\n        expect(response.body).to.have.property('gauges');\n      });\n\n      it('should export Prometheus format', async () => {\n        const response = await request(this.app)\n          .get('/metrics/prometheus')\n          .expect(200);\n        \n        expect(response.text).to.be.a('string');\n        expect(response.headers['content-type']).to.include('text/plain');\n      });\n    });\n  }\n\n  // Task 13: Dashboard tests\n  testAdvancedDashboards() {\n    describe('Advanced Dashboards (Task 13)', () => {\n      it('should generate all dashboard types', async () => {\n        const response = await request(this.app)\n          .get('/dashboards')\n          .expect(200);\n        \n        expect(response.body).to.have.property('system_health');\n        expect(response.body).to.have.property('business_metrics');\n        expect(response.body).to.have.property('performance');\n        expect(response.body).to.have.property('security');\n      });\n\n      it('should export Grafana dashboard format', async () => {\n        const response = await request(this.app)\n          .get('/dashboards/system_health/grafana')\n          .expect(200);\n        \n        expect(response.body).to.have.property('dashboard');\n        expect(response.body.dashboard).to.have.property('panels');\n      });\n    });\n  }\n\n  // Performance tests\n  testPerformance() {\n    describe('Performance Tests', () => {\n      it('should respond within acceptable time', async () => {\n        const start = Date.now();\n        await request(this.app)\n          .get('/health')\n          .expect(200);\n        const duration = Date.now() - start;\n        \n        expect(duration).to.be.below(1000);\n      });\n    });\n  }\n\n  // Run all Phase 3 tests\n  runAllTests() {\n    describe('Phase 3: Monitoring & Observability', () => {\n      this.testAlertThresholds();\n      this.testDistributedTracing();\n      this.testCustomMetrics();\n      this.testAdvancedDashboards();\n      this.testPerformance();\n    });\n  }\n}\n\n// Export for use in test runner\nmodule.exports = MonitoringTests;