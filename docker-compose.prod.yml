version: '3.8'

services:
  # üß† Constitutional AI
  ai-orchestrator:
    build: ./services/ai-orchestrator
    ports:
      - "3014:3014"
    environment:
      - PORT=3014
      - NODE_ENV=production
    restart: always
    networks:
      - azora-net

  # üîê Authentication
  azora-auth:
    build: ./services/azora-auth
    ports:
      - "4001:4001"
    environment:
      - PORT=4001
      - NODE_ENV=production
    restart: always
    networks:
      - azora-net

  # ‚õìÔ∏è Blockchain & Tokenomics
  azora-mint:
    build: ./services/azora-mint
    ports:
      - "3011:3011"
    environment:
      - PORT=3011
      - NODE_ENV=production
    restart: always
    networks:
      - azora-net

  # üí∞ Payments
  azora-pay:
    build: ./services/azora-pay
    ports:
      - "3010:3010"
    environment:
      - PORT=3010
      - NODE_ENV=production
    restart: always
    networks:
      - azora-net

  # üêµ Antifragile Infrastructure
  chaos-monkey:
    build: ./services/chaos-monkey
    ports:
      - "3050:3050"
    environment:
      - PORT=3050
      - NODE_ENV=production
    restart: always
    networks:
      - azora-net

  phoenix-server:
    build: ./services/phoenix-server
    ports:
      - "3051:3051"
    environment:
      - PORT=3051
      - NODE_ENV=production
    restart: always
    networks:
      - azora-net

  # üîÆ Citadel PredAISensor (Central Nervous System)
  citadel-predai-sensor:
    build: ./services/citadel-predai-sensor
    ports:
      - "3015:3015"
    environment:
      - PORT=3015
      - NODE_ENV=production
      - AWS_REGION=${AWS_REGION}
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
    logging:
      driver: awslogs
      options:
        awslogs-region: ${AWS_REGION}
        awslogs-group: /azora/citadel-predai-sensor
        awslogs-create-group: "true"
    restart: always
    networks:
      - azora-net

networks:
  azora-net:
    driver: bridge
